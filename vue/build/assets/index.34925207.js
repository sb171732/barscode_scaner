function ah(){import("data:text/javascript,")}(function(){const i=document.createElement("link").relList;if(i&&i.supports&&i.supports("modulepreload"))return;for(const g of document.querySelectorAll('link[rel="modulepreload"]'))f(g);new MutationObserver(g=>{for(const p of g)if(p.type==="childList")for(const m of p.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&f(m)}).observe(document,{childList:!0,subtree:!0});function s(g){const p={};return g.integrity&&(p.integrity=g.integrity),g.referrerpolicy&&(p.referrerPolicy=g.referrerpolicy),g.crossorigin==="use-credentials"?p.credentials="include":g.crossorigin==="anonymous"?p.credentials="omit":p.credentials="same-origin",p}function f(g){if(g.ep)return;g.ep=!0;const p=s(g);fetch(g.href,p)}})();/*!
 * Vue.js v2.7.15
 * (c) 2014-2023 Evan You
 * Released under the MIT License.
 */var Pe=Object.freeze({}),fe=Array.isArray;function he(e){return e==null}function Y(e){return e!=null}function ye(e){return e===!0}function _o(e){return e===!1}function Qt(e){return typeof e=="string"||typeof e=="number"||typeof e=="symbol"||typeof e=="boolean"}function me(e){return typeof e=="function"}function Ae(e){return e!==null&&typeof e=="object"}var _r=Object.prototype.toString;function Me(e){return _r.call(e)==="[object Object]"}function mo(e){return _r.call(e)==="[object RegExp]"}function gs(e){var i=parseFloat(String(e));return i>=0&&Math.floor(i)===i&&isFinite(e)}function zi(e){return Y(e)&&typeof e.then=="function"&&typeof e.catch=="function"}function vo(e){return e==null?"":Array.isArray(e)||Me(e)&&e.toString===_r?JSON.stringify(e,null,2):String(e)}function zt(e){var i=parseFloat(e);return isNaN(i)?e:i}function Ue(e,i){for(var s=Object.create(null),f=e.split(","),g=0;g<f.length;g++)s[f[g]]=!0;return i?function(p){return s[p.toLowerCase()]}:function(p){return s[p]}}Ue("slot,component",!0);var yo=Ue("key,ref,slot,slot-scope,is");function at(e,i){var s=e.length;if(s){if(i===e[s-1]){e.length=s-1;return}var f=e.indexOf(i);if(f>-1)return e.splice(f,1)}}var Co=Object.prototype.hasOwnProperty;function De(e,i){return Co.call(e,i)}function bt(e){var i=Object.create(null);return function(f){var g=i[f];return g||(i[f]=e(f))}}var bo=/-(\w)/g,_t=bt(function(e){return e.replace(bo,function(i,s){return s?s.toUpperCase():""})}),So=bt(function(e){return e.charAt(0).toUpperCase()+e.slice(1)}),xo=/\B([A-Z])/g,ei=bt(function(e){return e.replace(xo,"-$1").toLowerCase()});function To(e,i){function s(f){var g=arguments.length;return g?g>1?e.apply(i,arguments):e.call(i,f):e.call(i)}return s._length=e.length,s}function wo(e,i){return e.bind(i)}var _s=Function.prototype.bind?wo:To;function $i(e,i){i=i||0;for(var s=e.length-i,f=new Array(s);s--;)f[s]=e[s+i];return f}function ge(e,i){for(var s in i)e[s]=i[s];return e}function ms(e){for(var i={},s=0;s<e.length;s++)e[s]&&ge(i,e[s]);return i}function Te(e,i,s){}var ni=function(e,i,s){return!1},vs=function(e){return e};function mt(e,i){if(e===i)return!0;var s=Ae(e),f=Ae(i);if(s&&f)try{var g=Array.isArray(e),p=Array.isArray(i);if(g&&p)return e.length===i.length&&e.every(function(T,A){return mt(T,i[A])});if(e instanceof Date&&i instanceof Date)return e.getTime()===i.getTime();if(!g&&!p){var m=Object.keys(e),b=Object.keys(i);return m.length===b.length&&m.every(function(T){return mt(e[T],i[T])})}else return!1}catch(T){return!1}else return!s&&!f?String(e)===String(i):!1}function ys(e,i){for(var s=0;s<e.length;s++)if(mt(e[s],i))return s;return-1}function yi(e){var i=!1;return function(){i||(i=!0,e.apply(this,arguments))}}function Ao(e,i){return e===i?e===0&&1/e!==1/i:e===e||i===i}var Wr="data-server-rendered",Fi=["component","directive","filter"],Cs=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeDestroy","destroyed","activated","deactivated","errorCaptured","serverPrefetch","renderTracked","renderTriggered"],Ne={optionMergeStrategies:Object.create(null),silent:!1,productionTip:!1,devtools:!1,performance:!1,errorHandler:null,warnHandler:null,ignoredElements:[],keyCodes:Object.create(null),isReservedTag:ni,isReservedAttr:ni,isUnknownElement:ni,getTagNamespace:Te,parsePlatformTagName:vs,mustUseProp:ni,async:!0,_lifecycleHooks:Cs},Oo=/a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/;function bs(e){var i=(e+"").charCodeAt(0);return i===36||i===95}function it(e,i,s,f){Object.defineProperty(e,i,{value:s,enumerable:!!f,writable:!0,configurable:!0})}var Eo=new RegExp("[^".concat(Oo.source,".$_\\d]"));function Io(e){if(!Eo.test(e)){var i=e.split(".");return function(s){for(var f=0;f<i.length;f++){if(!s)return;s=s[i[f]]}return s}}}var Do="__proto__"in{},ke=typeof window<"u",Oe=ke&&window.navigator.userAgent.toLowerCase(),Rt=Oe&&/msie|trident/.test(Oe),Pt=Oe&&Oe.indexOf("msie 9.0")>0,mr=Oe&&Oe.indexOf("edge/")>0;Oe&&Oe.indexOf("android")>0;var Ro=Oe&&/iphone|ipad|ipod|ios/.test(Oe);Oe&&/chrome\/\d+/.test(Oe);Oe&&/phantomjs/.test(Oe);var Hr=Oe&&Oe.match(/firefox\/(\d+)/),Ki={}.watch,Ss=!1;if(ke)try{var Xr={};Object.defineProperty(Xr,"passive",{get:function(){Ss=!0}}),window.addEventListener("test-passive",null,Xr)}catch(e){}var si,ti=function(){return si===void 0&&(!ke&&typeof global<"u"?si=global.process&&global.process.env.VUE_ENV==="server":si=!1),si},Ci=ke&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__;function Dt(e){return typeof e=="function"&&/native code/.test(e.toString())}var ii=typeof Symbol<"u"&&Dt(Symbol)&&typeof Reflect<"u"&&Dt(Reflect.ownKeys),$t;typeof Set<"u"&&Dt(Set)?$t=Set:$t=function(){function e(){this.set=Object.create(null)}return e.prototype.has=function(i){return this.set[i]===!0},e.prototype.add=function(i){this.set[i]=!0},e.prototype.clear=function(){this.set=Object.create(null)},e}();var Xt=null;function rt(e){e===void 0&&(e=null),e||Xt&&Xt._scope.off(),Xt=e,e&&e._scope.on()}var Le=function(){function e(i,s,f,g,p,m,b,T){this.tag=i,this.data=s,this.children=f,this.text=g,this.elm=p,this.ns=void 0,this.context=m,this.fnContext=void 0,this.fnOptions=void 0,this.fnScopeId=void 0,this.key=s&&s.key,this.componentOptions=b,this.componentInstance=void 0,this.parent=void 0,this.raw=!1,this.isStatic=!1,this.isRootInsert=!0,this.isComment=!1,this.isCloned=!1,this.isOnce=!1,this.asyncFactory=T,this.asyncMeta=void 0,this.isAsyncPlaceholder=!1}return Object.defineProperty(e.prototype,"child",{get:function(){return this.componentInstance},enumerable:!1,configurable:!0}),e}(),ft=function(e){e===void 0&&(e="");var i=new Le;return i.text=e,i.isComment=!0,i};function At(e){return new Le(void 0,void 0,void 0,String(e))}function qi(e){var i=new Le(e.tag,e.data,e.children&&e.children.slice(),e.text,e.elm,e.context,e.componentOptions,e.asyncFactory);return i.ns=e.ns,i.isStatic=e.isStatic,i.key=e.key,i.isComment=e.isComment,i.fnContext=e.fnContext,i.fnOptions=e.fnOptions,i.fnScopeId=e.fnScopeId,i.asyncMeta=e.asyncMeta,i.isCloned=!0,i}var Po=0,pi=[],Mo=function(){for(var e=0;e<pi.length;e++){var i=pi[e];i.subs=i.subs.filter(function(s){return s}),i._pending=!1}pi.length=0},nt=function(){function e(){this._pending=!1,this.id=Po++,this.subs=[]}return e.prototype.addSub=function(i){this.subs.push(i)},e.prototype.removeSub=function(i){this.subs[this.subs.indexOf(i)]=null,this._pending||(this._pending=!0,pi.push(this))},e.prototype.depend=function(i){e.target&&e.target.addDep(this)},e.prototype.notify=function(i){for(var s=this.subs.filter(function(m){return m}),f=0,g=s.length;f<g;f++){var p=s[f];p.update()}},e}();nt.target=null;var gi=[];function Mt(e){gi.push(e),nt.target=e}function Lt(){gi.pop(),nt.target=gi[gi.length-1]}var xs=Array.prototype,bi=Object.create(xs),Lo=["push","pop","shift","unshift","splice","sort","reverse"];Lo.forEach(function(e){var i=xs[e];it(bi,e,function(){for(var f=[],g=0;g<arguments.length;g++)f[g]=arguments[g];var p=i.apply(this,f),m=this.__ob__,b;switch(e){case"push":case"unshift":b=f;break;case"splice":b=f.slice(2);break}return b&&m.observeArray(b),m.dep.notify(),p})});var Yr=Object.getOwnPropertyNames(bi),Ts={},vr=!0;function st(e){vr=e}var ko={notify:Te,depend:Te,addSub:Te,removeSub:Te},zr=function(){function e(i,s,f){if(s===void 0&&(s=!1),f===void 0&&(f=!1),this.value=i,this.shallow=s,this.mock=f,this.dep=f?ko:new nt,this.vmCount=0,it(i,"__ob__",this),fe(i)){if(!f)if(Do)i.__proto__=bi;else for(var g=0,p=Yr.length;g<p;g++){var m=Yr[g];it(i,m,bi[m])}s||this.observeArray(i)}else for(var b=Object.keys(i),g=0;g<b.length;g++){var m=b[g];vt(i,m,Ts,void 0,s,f)}}return e.prototype.observeArray=function(i){for(var s=0,f=i.length;s<f;s++)Je(i[s],!1,this.mock)},e}();function Je(e,i,s){if(e&&De(e,"__ob__")&&e.__ob__ instanceof zr)return e.__ob__;if(vr&&(s||!ti())&&(fe(e)||Me(e))&&Object.isExtensible(e)&&!e.__v_skip&&!Ye(e)&&!(e instanceof Le))return new zr(e,i,s)}function vt(e,i,s,f,g,p){var m=new nt,b=Object.getOwnPropertyDescriptor(e,i);if(!(b&&b.configurable===!1)){var T=b&&b.get,A=b&&b.set;(!T||A)&&(s===Ts||arguments.length===2)&&(s=e[i]);var O=!g&&Je(s,!1,p);return Object.defineProperty(e,i,{enumerable:!0,configurable:!0,get:function(){var k=T?T.call(e):s;return nt.target&&(m.depend(),O&&(O.dep.depend(),fe(k)&&As(k))),Ye(k)&&!g?k.value:k},set:function(k){var Z=T?T.call(e):s;if(!!Ao(Z,k)){if(A)A.call(e,k);else{if(T)return;if(!g&&Ye(Z)&&!Ye(k)){Z.value=k;return}else s=k}O=!g&&Je(k,!1,p),m.notify()}}}),m}}function yr(e,i,s){if(!Cr(e)){var f=e.__ob__;return fe(e)&&gs(i)?(e.length=Math.max(e.length,i),e.splice(i,1,s),f&&!f.shallow&&f.mock&&Je(s,!1,!0),s):i in e&&!(i in Object.prototype)?(e[i]=s,s):e._isVue||f&&f.vmCount?s:f?(vt(f.value,i,s,void 0,f.shallow,f.mock),f.dep.notify(),s):(e[i]=s,s)}}function ws(e,i){if(fe(e)&&gs(i)){e.splice(i,1);return}var s=e.__ob__;e._isVue||s&&s.vmCount||Cr(e)||!De(e,i)||(delete e[i],s&&s.dep.notify())}function As(e){for(var i=void 0,s=0,f=e.length;s<f;s++)i=e[s],i&&i.__ob__&&i.__ob__.dep.depend(),fe(i)&&As(i)}function Os(e){return Fo(e,!0),it(e,"__v_isShallow",!0),e}function Fo(e,i){Cr(e)||Je(e,i,ti())}function Cr(e){return!!(e&&e.__v_isReadonly)}function Ye(e){return!!(e&&e.__v_isRef===!0)}function Zi(e,i,s){Object.defineProperty(e,s,{enumerable:!0,configurable:!0,get:function(){var f=i[s];if(Ye(f))return f.value;var g=f&&f.__ob__;return g&&g.dep.depend(),f},set:function(f){var g=i[s];Ye(g)&&!Ye(f)?g.value=f:i[s]=f}})}var Re,Bo=function(){function e(i){i===void 0&&(i=!1),this.detached=i,this.active=!0,this.effects=[],this.cleanups=[],this.parent=Re,!i&&Re&&(this.index=(Re.scopes||(Re.scopes=[])).push(this)-1)}return e.prototype.run=function(i){if(this.active){var s=Re;try{return Re=this,i()}finally{Re=s}}},e.prototype.on=function(){Re=this},e.prototype.off=function(){Re=this.parent},e.prototype.stop=function(i){if(this.active){var s=void 0,f=void 0;for(s=0,f=this.effects.length;s<f;s++)this.effects[s].teardown();for(s=0,f=this.cleanups.length;s<f;s++)this.cleanups[s]();if(this.scopes)for(s=0,f=this.scopes.length;s<f;s++)this.scopes[s].stop(!0);if(!this.detached&&this.parent&&!i){var g=this.parent.scopes.pop();g&&g!==this&&(this.parent.scopes[this.index]=g,g.index=this.index)}this.parent=void 0,this.active=!1}},e}();function No(e,i){i===void 0&&(i=Re),i&&i.active&&i.effects.push(e)}function jo(){return Re}function Uo(e){var i=e._provided,s=e.$parent&&e.$parent._provided;return s===i?e._provided=Object.create(s):i}var $r=bt(function(e){var i=e.charAt(0)==="&";e=i?e.slice(1):e;var s=e.charAt(0)==="~";e=s?e.slice(1):e;var f=e.charAt(0)==="!";return e=f?e.slice(1):e,{name:e,once:s,capture:f,passive:i}});function Ji(e,i){function s(){var f=s.fns;if(fe(f))for(var g=f.slice(),p=0;p<g.length;p++)ot(g[p],null,arguments,i,"v-on handler");else return ot(f,null,arguments,i,"v-on handler")}return s.fns=e,s}function Es(e,i,s,f,g,p){var m,b,T,A;for(m in e)b=e[m],T=i[m],A=$r(m),he(b)||(he(T)?(he(b.fns)&&(b=e[m]=Ji(b,p)),ye(A.once)&&(b=e[m]=g(A.name,b,A.capture)),s(A.name,b,A.capture,A.passive,A.params)):b!==T&&(T.fns=b,e[m]=T));for(m in i)he(e[m])&&(A=$r(m),f(A.name,i[m],A.capture))}function et(e,i,s){e instanceof Le&&(e=e.data.hook||(e.data.hook={}));var f,g=e[i];function p(){s.apply(this,arguments),at(f.fns,p)}he(g)?f=Ji([p]):Y(g.fns)&&ye(g.merged)?(f=g,f.fns.push(p)):f=Ji([g,p]),f.merged=!0,e[i]=f}function Go(e,i,s){var f=i.options.props;if(!he(f)){var g={},p=e.attrs,m=e.props;if(Y(p)||Y(m))for(var b in f){var T=ei(b);Kr(g,m,b,T,!0)||Kr(g,p,b,T,!1)}return g}}function Kr(e,i,s,f,g){if(Y(i)){if(De(i,s))return e[s]=i[s],g||delete i[s],!0;if(De(i,f))return e[s]=i[f],g||delete i[f],!0}return!1}function Vo(e){for(var i=0;i<e.length;i++)if(fe(e[i]))return Array.prototype.concat.apply([],e);return e}function br(e){return Qt(e)?[At(e)]:fe(e)?Is(e):void 0}function Nt(e){return Y(e)&&Y(e.text)&&_o(e.isComment)}function Is(e,i){var s=[],f,g,p,m;for(f=0;f<e.length;f++)g=e[f],!(he(g)||typeof g=="boolean")&&(p=s.length-1,m=s[p],fe(g)?g.length>0&&(g=Is(g,"".concat(i||"","_").concat(f)),Nt(g[0])&&Nt(m)&&(s[p]=At(m.text+g[0].text),g.shift()),s.push.apply(s,g)):Qt(g)?Nt(m)?s[p]=At(m.text+g):g!==""&&s.push(At(g)):Nt(g)&&Nt(m)?s[p]=At(m.text+g.text):(ye(e._isVList)&&Y(g.tag)&&he(g.key)&&Y(i)&&(g.key="__vlist".concat(i,"_").concat(f,"__")),s.push(g)));return s}function Wo(e,i){var s=null,f,g,p,m;if(fe(e)||typeof e=="string")for(s=new Array(e.length),f=0,g=e.length;f<g;f++)s[f]=i(e[f],f);else if(typeof e=="number")for(s=new Array(e),f=0;f<e;f++)s[f]=i(f+1,f);else if(Ae(e))if(ii&&e[Symbol.iterator]){s=[];for(var b=e[Symbol.iterator](),T=b.next();!T.done;)s.push(i(T.value,s.length)),T=b.next()}else for(p=Object.keys(e),s=new Array(p.length),f=0,g=p.length;f<g;f++)m=p[f],s[f]=i(e[m],m,f);return Y(s)||(s=[]),s._isVList=!0,s}function Ho(e,i,s,f){var g=this.$scopedSlots[e],p;g?(s=s||{},f&&(s=ge(ge({},f),s)),p=g(s)||(me(i)?i():i)):p=this.$slots[e]||(me(i)?i():i);var m=s&&s.slot;return m?this.$createElement("template",{slot:m},p):p}function Xo(e){return Oi(this.$options,"filters",e)||vs}function qr(e,i){return fe(e)?e.indexOf(i)===-1:e!==i}function Yo(e,i,s,f,g){var p=Ne.keyCodes[i]||s;return g&&f&&!Ne.keyCodes[i]?qr(g,f):p?qr(p,e):f?ei(f)!==i:e===void 0}function zo(e,i,s,f,g){if(s&&Ae(s)){fe(s)&&(s=ms(s));var p=void 0,m=function(T){if(T==="class"||T==="style"||yo(T))p=e;else{var A=e.attrs&&e.attrs.type;p=f||Ne.mustUseProp(i,A,T)?e.domProps||(e.domProps={}):e.attrs||(e.attrs={})}var O=_t(T),B=ei(T);if(!(O in p)&&!(B in p)&&(p[T]=s[T],g)){var k=e.on||(e.on={});k["update:".concat(T)]=function(Z){s[T]=Z}}};for(var b in s)m(b)}return e}function $o(e,i){var s=this._staticTrees||(this._staticTrees=[]),f=s[e];return f&&!i||(f=s[e]=this.$options.staticRenderFns[e].call(this._renderProxy,this._c,this),Ds(f,"__static__".concat(e),!1)),f}function Ko(e,i,s){return Ds(e,"__once__".concat(i).concat(s?"_".concat(s):""),!0),e}function Ds(e,i,s){if(fe(e))for(var f=0;f<e.length;f++)e[f]&&typeof e[f]!="string"&&Zr(e[f],"".concat(i,"_").concat(f),s);else Zr(e,i,s)}function Zr(e,i,s){e.isStatic=!0,e.key=i,e.isOnce=s}function qo(e,i){if(i&&Me(i)){var s=e.on=e.on?ge({},e.on):{};for(var f in i){var g=s[f],p=i[f];s[f]=g?[].concat(g,p):p}}return e}function Rs(e,i,s,f){i=i||{$stable:!s};for(var g=0;g<e.length;g++){var p=e[g];fe(p)?Rs(p,i,s):p&&(p.proxy&&(p.fn.proxy=!0),i[p.key]=p.fn)}return f&&(i.$key=f),i}function Zo(e,i){for(var s=0;s<i.length;s+=2){var f=i[s];typeof f=="string"&&f&&(e[i[s]]=i[s+1])}return e}function Jo(e,i){return typeof e=="string"?i+e:e}function Ps(e){e._o=Ko,e._n=zt,e._s=vo,e._l=Wo,e._t=Ho,e._q=mt,e._i=ys,e._m=$o,e._f=Xo,e._k=Yo,e._b=zo,e._v=At,e._e=ft,e._u=Rs,e._g=qo,e._d=Zo,e._p=Jo}function Sr(e,i){if(!e||!e.length)return{};for(var s={},f=0,g=e.length;f<g;f++){var p=e[f],m=p.data;if(m&&m.attrs&&m.attrs.slot&&delete m.attrs.slot,(p.context===i||p.fnContext===i)&&m&&m.slot!=null){var b=m.slot,T=s[b]||(s[b]=[]);p.tag==="template"?T.push.apply(T,p.children||[]):T.push(p)}else(s.default||(s.default=[])).push(p)}for(var A in s)s[A].every(Qo)&&delete s[A];return s}function Qo(e){return e.isComment&&!e.asyncFactory||e.text===" "}function Kt(e){return e.isComment&&e.asyncFactory}function Yt(e,i,s,f){var g,p=Object.keys(s).length>0,m=i?!!i.$stable:!p,b=i&&i.$key;if(!i)g={};else{if(i._normalized)return i._normalized;if(m&&f&&f!==Pe&&b===f.$key&&!p&&!f.$hasNormal)return f;g={};for(var T in i)i[T]&&T[0]!=="$"&&(g[T]=ea(e,s,T,i[T]))}for(var A in s)A in g||(g[A]=ta(s,A));return i&&Object.isExtensible(i)&&(i._normalized=g),it(g,"$stable",m),it(g,"$key",b),it(g,"$hasNormal",p),g}function ea(e,i,s,f){var g=function(){var p=Xt;rt(e);var m=arguments.length?f.apply(null,arguments):f({});m=m&&typeof m=="object"&&!fe(m)?[m]:br(m);var b=m&&m[0];return rt(p),m&&(!b||m.length===1&&b.isComment&&!Kt(b))?void 0:m};return f.proxy&&Object.defineProperty(i,s,{get:g,enumerable:!0,configurable:!0}),g}function ta(e,i){return function(){return e[i]}}function ia(e){var i=e.$options,s=i.setup;if(s){var f=e._setupContext=ra(e);rt(e),Mt();var g=ot(s,null,[e._props||Os({}),f],e,"setup");if(Lt(),rt(),me(g))i.render=g;else if(Ae(g))if(e._setupState=g,g.__sfc){var m=e._setupProxy={};for(var p in g)p!=="__sfc"&&Zi(m,g,p)}else for(var p in g)bs(p)||Zi(e,g,p)}}function ra(e){return{get attrs(){if(!e._attrsProxy){var i=e._attrsProxy={};it(i,"_v_attr_proxy",!0),Si(i,e.$attrs,Pe,e,"$attrs")}return e._attrsProxy},get listeners(){if(!e._listenersProxy){var i=e._listenersProxy={};Si(i,e.$listeners,Pe,e,"$listeners")}return e._listenersProxy},get slots(){return sa(e)},emit:_s(e.$emit,e),expose:function(i){i&&Object.keys(i).forEach(function(s){return Zi(e,i,s)})}}}function Si(e,i,s,f,g){var p=!1;for(var m in i)m in e?i[m]!==s[m]&&(p=!0):(p=!0,na(e,m,f,g));for(var m in e)m in i||(p=!0,delete e[m]);return p}function na(e,i,s,f){Object.defineProperty(e,i,{enumerable:!0,configurable:!0,get:function(){return s[f][i]}})}function sa(e){return e._slotsProxy||Ms(e._slotsProxy={},e.$scopedSlots),e._slotsProxy}function Ms(e,i){for(var s in i)e[s]=i[s];for(var s in e)s in i||delete e[s]}function oa(e){e._vnode=null,e._staticTrees=null;var i=e.$options,s=e.$vnode=i._parentVnode,f=s&&s.context;e.$slots=Sr(i._renderChildren,f),e.$scopedSlots=s?Yt(e.$parent,s.data.scopedSlots,e.$slots):Pe,e._c=function(p,m,b,T){return xi(e,p,m,b,T,!1)},e.$createElement=function(p,m,b,T){return xi(e,p,m,b,T,!0)};var g=s&&s.data;vt(e,"$attrs",g&&g.attrs||Pe,null,!0),vt(e,"$listeners",i._parentListeners||Pe,null,!0)}var Qi=null;function aa(e){Ps(e.prototype),e.prototype.$nextTick=function(i){return xr(i,this)},e.prototype._render=function(){var i=this,s=i.$options,f=s.render,g=s._parentVnode;g&&i._isMounted&&(i.$scopedSlots=Yt(i.$parent,g.data.scopedSlots,i.$slots,i.$scopedSlots),i._slotsProxy&&Ms(i._slotsProxy,i.$scopedSlots)),i.$vnode=g;var p;try{rt(i),Qi=i,p=f.call(i._renderProxy,i.$createElement)}catch(m){yt(m,i,"render"),p=i._vnode}finally{Qi=null,rt()}return fe(p)&&p.length===1&&(p=p[0]),p instanceof Le||(p=ft()),p.parent=g,p}}function Ni(e,i){return(e.__esModule||ii&&e[Symbol.toStringTag]==="Module")&&(e=e.default),Ae(e)?i.extend(e):e}function ca(e,i,s,f,g){var p=ft();return p.asyncFactory=e,p.asyncMeta={data:i,context:s,children:f,tag:g},p}function la(e,i){if(ye(e.error)&&Y(e.errorComp))return e.errorComp;if(Y(e.resolved))return e.resolved;var s=Qi;if(s&&Y(e.owners)&&e.owners.indexOf(s)===-1&&e.owners.push(s),ye(e.loading)&&Y(e.loadingComp))return e.loadingComp;if(s&&!Y(e.owners)){var f=e.owners=[s],g=!0,p=null,m=null;s.$on("hook:destroyed",function(){return at(f,s)});var b=function(B){for(var k=0,Z=f.length;k<Z;k++)f[k].$forceUpdate();B&&(f.length=0,p!==null&&(clearTimeout(p),p=null),m!==null&&(clearTimeout(m),m=null))},T=yi(function(B){e.resolved=Ni(B,i),g?f.length=0:b(!0)}),A=yi(function(B){Y(e.errorComp)&&(e.error=!0,b(!0))}),O=e(T,A);return Ae(O)&&(zi(O)?he(e.resolved)&&O.then(T,A):zi(O.component)&&(O.component.then(T,A),Y(O.error)&&(e.errorComp=Ni(O.error,i)),Y(O.loading)&&(e.loadingComp=Ni(O.loading,i),O.delay===0?e.loading=!0:p=setTimeout(function(){p=null,he(e.resolved)&&he(e.error)&&(e.loading=!0,b(!1))},O.delay||200)),Y(O.timeout)&&(m=setTimeout(function(){m=null,he(e.resolved)&&A(null)},O.timeout)))),g=!1,e.loading?e.loadingComp:e.resolved}}function Ls(e){if(fe(e))for(var i=0;i<e.length;i++){var s=e[i];if(Y(s)&&(Y(s.componentOptions)||Kt(s)))return s}}var ha=1,ks=2;function xi(e,i,s,f,g,p){return(fe(s)||Qt(s))&&(g=f,f=s,s=void 0),ye(p)&&(g=ks),ua(e,i,s,f,g)}function ua(e,i,s,f,g){if(Y(s)&&Y(s.__ob__)||(Y(s)&&Y(s.is)&&(i=s.is),!i))return ft();fe(f)&&me(f[0])&&(s=s||{},s.scopedSlots={default:f[0]},f.length=0),g===ks?f=br(f):g===ha&&(f=Vo(f));var p,m;if(typeof i=="string"){var b=void 0;m=e.$vnode&&e.$vnode.ns||Ne.getTagNamespace(i),Ne.isReservedTag(i)?p=new Le(Ne.parsePlatformTagName(i),s,f,void 0,void 0,e):(!s||!s.pre)&&Y(b=Oi(e.$options,"components",i))?p=on(b,s,e,f,i):p=new Le(i,s,f,void 0,void 0,e)}else p=on(i,s,e,f);return fe(p)?p:Y(p)?(Y(m)&&Fs(p,m),Y(s)&&fa(s),p):ft()}function Fs(e,i,s){if(e.ns=i,e.tag==="foreignObject"&&(i=void 0,s=!0),Y(e.children))for(var f=0,g=e.children.length;f<g;f++){var p=e.children[f];Y(p.tag)&&(he(p.ns)||ye(s)&&p.tag!=="svg")&&Fs(p,i,s)}}function fa(e){Ae(e.style)&&Ti(e.style),Ae(e.class)&&Ti(e.class)}function yt(e,i,s){Mt();try{if(i)for(var f=i;f=f.$parent;){var g=f.$options.errorCaptured;if(g)for(var p=0;p<g.length;p++)try{var m=g[p].call(f,e,i,s)===!1;if(m)return}catch(b){Jr(b,f,"errorCaptured hook")}}Jr(e,i,s)}finally{Lt()}}function ot(e,i,s,f,g){var p;try{p=s?e.apply(i,s):e.call(i),p&&!p._isVue&&zi(p)&&!p._handled&&(p.catch(function(m){return yt(m,f,g+" (Promise/async)")}),p._handled=!0)}catch(m){yt(m,f,g)}return p}function Jr(e,i,s){if(Ne.errorHandler)try{return Ne.errorHandler.call(null,e,i,s)}catch(f){f!==e&&Qr(f)}Qr(e)}function Qr(e,i,s){if(ke&&typeof console<"u")console.error(e);else throw e}var er=!1,tr=[],ir=!1;function oi(){ir=!1;var e=tr.slice(0);tr.length=0;for(var i=0;i<e.length;i++)e[i]()}var Ht;if(typeof Promise<"u"&&Dt(Promise)){var da=Promise.resolve();Ht=function(){da.then(oi),Ro&&setTimeout(Te)},er=!0}else if(!Rt&&typeof MutationObserver<"u"&&(Dt(MutationObserver)||MutationObserver.toString()==="[object MutationObserverConstructor]")){var ai=1,pa=new MutationObserver(oi),en=document.createTextNode(String(ai));pa.observe(en,{characterData:!0}),Ht=function(){ai=(ai+1)%2,en.data=String(ai)},er=!0}else typeof setImmediate<"u"&&Dt(setImmediate)?Ht=function(){setImmediate(oi)}:Ht=function(){setTimeout(oi,0)};function xr(e,i){var s;if(tr.push(function(){if(e)try{e.call(i)}catch(f){yt(f,i,"nextTick")}else s&&s(i)}),ir||(ir=!0,Ht()),!e&&typeof Promise<"u")return new Promise(function(f){s=f})}var ga="2.7.15",tn=new $t;function Ti(e){return _i(e,tn),tn.clear(),e}function _i(e,i){var s,f,g=fe(e);if(!(!g&&!Ae(e)||e.__v_skip||Object.isFrozen(e)||e instanceof Le)){if(e.__ob__){var p=e.__ob__.dep.id;if(i.has(p))return;i.add(p)}if(g)for(s=e.length;s--;)_i(e[s],i);else if(Ye(e))_i(e.value,i);else for(f=Object.keys(e),s=f.length;s--;)_i(e[f[s]],i)}}var _a=0,Tr=function(){function e(i,s,f,g,p){No(this,Re&&!Re._vm?Re:i?i._scope:void 0),(this.vm=i)&&p&&(i._watcher=this),g?(this.deep=!!g.deep,this.user=!!g.user,this.lazy=!!g.lazy,this.sync=!!g.sync,this.before=g.before):this.deep=this.user=this.lazy=this.sync=!1,this.cb=f,this.id=++_a,this.active=!0,this.post=!1,this.dirty=this.lazy,this.deps=[],this.newDeps=[],this.depIds=new $t,this.newDepIds=new $t,this.expression="",me(s)?this.getter=s:(this.getter=Io(s),this.getter||(this.getter=Te)),this.value=this.lazy?void 0:this.get()}return e.prototype.get=function(){Mt(this);var i,s=this.vm;try{i=this.getter.call(s,s)}catch(f){if(this.user)yt(f,s,'getter for watcher "'.concat(this.expression,'"'));else throw f}finally{this.deep&&Ti(i),Lt(),this.cleanupDeps()}return i},e.prototype.addDep=function(i){var s=i.id;this.newDepIds.has(s)||(this.newDepIds.add(s),this.newDeps.push(i),this.depIds.has(s)||i.addSub(this))},e.prototype.cleanupDeps=function(){for(var i=this.deps.length;i--;){var s=this.deps[i];this.newDepIds.has(s.id)||s.removeSub(this)}var f=this.depIds;this.depIds=this.newDepIds,this.newDepIds=f,this.newDepIds.clear(),f=this.deps,this.deps=this.newDeps,this.newDeps=f,this.newDeps.length=0},e.prototype.update=function(){this.lazy?this.dirty=!0:this.sync?this.run():Pa(this)},e.prototype.run=function(){if(this.active){var i=this.get();if(i!==this.value||Ae(i)||this.deep){var s=this.value;if(this.value=i,this.user){var f='callback for watcher "'.concat(this.expression,'"');ot(this.cb,this.vm,[i,s],this.vm,f)}else this.cb.call(this.vm,i,s)}}},e.prototype.evaluate=function(){this.value=this.get(),this.dirty=!1},e.prototype.depend=function(){for(var i=this.deps.length;i--;)this.deps[i].depend()},e.prototype.teardown=function(){if(this.vm&&!this.vm._isBeingDestroyed&&at(this.vm._scope.effects,this),this.active){for(var i=this.deps.length;i--;)this.deps[i].removeSub(this);this.active=!1,this.onStop&&this.onStop()}},e}();function ma(e){e._events=Object.create(null),e._hasHookEvent=!1;var i=e.$options._parentListeners;i&&Bs(e,i)}var qt;function va(e,i){qt.$on(e,i)}function ya(e,i){qt.$off(e,i)}function Ca(e,i){var s=qt;return function f(){var g=i.apply(null,arguments);g!==null&&s.$off(e,f)}}function Bs(e,i,s){qt=e,Es(i,s||{},va,ya,Ca,e),qt=void 0}function ba(e){var i=/^hook:/;e.prototype.$on=function(s,f){var g=this;if(fe(s))for(var p=0,m=s.length;p<m;p++)g.$on(s[p],f);else(g._events[s]||(g._events[s]=[])).push(f),i.test(s)&&(g._hasHookEvent=!0);return g},e.prototype.$once=function(s,f){var g=this;function p(){g.$off(s,p),f.apply(g,arguments)}return p.fn=f,g.$on(s,p),g},e.prototype.$off=function(s,f){var g=this;if(!arguments.length)return g._events=Object.create(null),g;if(fe(s)){for(var p=0,m=s.length;p<m;p++)g.$off(s[p],f);return g}var b=g._events[s];if(!b)return g;if(!f)return g._events[s]=null,g;for(var T,A=b.length;A--;)if(T=b[A],T===f||T.fn===f){b.splice(A,1);break}return g},e.prototype.$emit=function(s){var f=this,g=f._events[s];if(g){g=g.length>1?$i(g):g;for(var p=$i(arguments,1),m='event handler for "'.concat(s,'"'),b=0,T=g.length;b<T;b++)ot(g[b],f,p,f,m)}return f}}var dt=null;function Ns(e){var i=dt;return dt=e,function(){dt=i}}function Sa(e){var i=e.$options,s=i.parent;if(s&&!i.abstract){for(;s.$options.abstract&&s.$parent;)s=s.$parent;s.$children.push(e)}e.$parent=s,e.$root=s?s.$root:e,e.$children=[],e.$refs={},e._provided=s?s._provided:Object.create(null),e._watcher=null,e._inactive=null,e._directInactive=!1,e._isMounted=!1,e._isDestroyed=!1,e._isBeingDestroyed=!1}function xa(e){e.prototype._update=function(i,s){var f=this,g=f.$el,p=f._vnode,m=Ns(f);f._vnode=i,p?f.$el=f.__patch__(p,i):f.$el=f.__patch__(f.$el,i,s,!1),m(),g&&(g.__vue__=null),f.$el&&(f.$el.__vue__=f);for(var b=f;b&&b.$vnode&&b.$parent&&b.$vnode===b.$parent._vnode;)b.$parent.$el=b.$el,b=b.$parent},e.prototype.$forceUpdate=function(){var i=this;i._watcher&&i._watcher.update()},e.prototype.$destroy=function(){var i=this;if(!i._isBeingDestroyed){je(i,"beforeDestroy"),i._isBeingDestroyed=!0;var s=i.$parent;s&&!s._isBeingDestroyed&&!i.$options.abstract&&at(s.$children,i),i._scope.stop(),i._data.__ob__&&i._data.__ob__.vmCount--,i._isDestroyed=!0,i.__patch__(i._vnode,null),je(i,"destroyed"),i.$off(),i.$el&&(i.$el.__vue__=null),i.$vnode&&(i.$vnode.parent=null)}}}function Ta(e,i,s){e.$el=i,e.$options.render||(e.$options.render=ft),je(e,"beforeMount");var f;f=function(){e._update(e._render(),s)};var g={before:function(){e._isMounted&&!e._isDestroyed&&je(e,"beforeUpdate")}};new Tr(e,f,Te,g,!0),s=!1;var p=e._preWatchers;if(p)for(var m=0;m<p.length;m++)p[m].run();return e.$vnode==null&&(e._isMounted=!0,je(e,"mounted")),e}function wa(e,i,s,f,g){var p=f.data.scopedSlots,m=e.$scopedSlots,b=!!(p&&!p.$stable||m!==Pe&&!m.$stable||p&&e.$scopedSlots.$key!==p.$key||!p&&e.$scopedSlots.$key),T=!!(g||e.$options._renderChildren||b),A=e.$vnode;e.$options._parentVnode=f,e.$vnode=f,e._vnode&&(e._vnode.parent=f),e.$options._renderChildren=g;var O=f.data.attrs||Pe;e._attrsProxy&&Si(e._attrsProxy,O,A.data&&A.data.attrs||Pe,e,"$attrs")&&(T=!0),e.$attrs=O,s=s||Pe;var B=e.$options._parentListeners;if(e._listenersProxy&&Si(e._listenersProxy,s,B||Pe,e,"$listeners"),e.$listeners=e.$options._parentListeners=s,Bs(e,s,B),i&&e.$options.props){st(!1);for(var k=e._props,Z=e.$options._propKeys||[],ie=0;ie<Z.length;ie++){var le=Z[ie],ce=e.$options.props;k[le]=Dr(le,ce,i,e)}st(!0),e.$options.propsData=i}T&&(e.$slots=Sr(g,f.context),e.$forceUpdate())}function js(e){for(;e&&(e=e.$parent);)if(e._inactive)return!0;return!1}function wr(e,i){if(i){if(e._directInactive=!1,js(e))return}else if(e._directInactive)return;if(e._inactive||e._inactive===null){e._inactive=!1;for(var s=0;s<e.$children.length;s++)wr(e.$children[s]);je(e,"activated")}}function Us(e,i){if(!(i&&(e._directInactive=!0,js(e)))&&!e._inactive){e._inactive=!0;for(var s=0;s<e.$children.length;s++)Us(e.$children[s]);je(e,"deactivated")}}function je(e,i,s,f){f===void 0&&(f=!0),Mt();var g=Xt,p=jo();f&&rt(e);var m=e.$options[i],b="".concat(i," hook");if(m)for(var T=0,A=m.length;T<A;T++)ot(m[T],e,s||null,e,b);e._hasHookEvent&&e.$emit("hook:"+i),f&&(rt(g),p&&p.on()),Lt()}var qe=[],Ar=[],wi={},rr=!1,Or=!1,Ot=0;function Aa(){Ot=qe.length=Ar.length=0,wi={},rr=Or=!1}var Gs=0,nr=Date.now;if(ke&&!Rt){var ji=window.performance;ji&&typeof ji.now=="function"&&nr()>document.createEvent("Event").timeStamp&&(nr=function(){return ji.now()})}var Oa=function(e,i){if(e.post){if(!i.post)return 1}else if(i.post)return-1;return e.id-i.id};function Ea(){Gs=nr(),Or=!0;var e,i;for(qe.sort(Oa),Ot=0;Ot<qe.length;Ot++)e=qe[Ot],e.before&&e.before(),i=e.id,wi[i]=null,e.run();var s=Ar.slice(),f=qe.slice();Aa(),Ra(s),Ia(f),Mo(),Ci&&Ne.devtools&&Ci.emit("flush")}function Ia(e){for(var i=e.length;i--;){var s=e[i],f=s.vm;f&&f._watcher===s&&f._isMounted&&!f._isDestroyed&&je(f,"updated")}}function Da(e){e._inactive=!1,Ar.push(e)}function Ra(e){for(var i=0;i<e.length;i++)e[i]._inactive=!0,wr(e[i],!0)}function Pa(e){var i=e.id;if(wi[i]==null&&!(e===nt.target&&e.noRecurse)){if(wi[i]=!0,!Or)qe.push(e);else{for(var s=qe.length-1;s>Ot&&qe[s].id>e.id;)s--;qe.splice(s+1,0,e)}rr||(rr=!0,xr(Ea))}}function Ma(e){var i=e.$options.provide;if(i){var s=me(i)?i.call(e):i;if(!Ae(s))return;for(var f=Uo(e),g=ii?Reflect.ownKeys(s):Object.keys(s),p=0;p<g.length;p++){var m=g[p];Object.defineProperty(f,m,Object.getOwnPropertyDescriptor(s,m))}}}function La(e){var i=Vs(e.$options.inject,e);i&&(st(!1),Object.keys(i).forEach(function(s){vt(e,s,i[s])}),st(!0))}function Vs(e,i){if(e){for(var s=Object.create(null),f=ii?Reflect.ownKeys(e):Object.keys(e),g=0;g<f.length;g++){var p=f[g];if(p!=="__ob__"){var m=e[p].from;if(m in i._provided)s[p]=i._provided[m];else if("default"in e[p]){var b=e[p].default;s[p]=me(b)?b.call(i):b}}}return s}}function Er(e,i,s,f,g){var p=this,m=g.options,b;De(f,"_uid")?(b=Object.create(f),b._original=f):(b=f,f=f._original);var T=ye(m._compiled),A=!T;this.data=e,this.props=i,this.children=s,this.parent=f,this.listeners=e.on||Pe,this.injections=Vs(m.inject,f),this.slots=function(){return p.$slots||Yt(f,e.scopedSlots,p.$slots=Sr(s,f)),p.$slots},Object.defineProperty(this,"scopedSlots",{enumerable:!0,get:function(){return Yt(f,e.scopedSlots,this.slots())}}),T&&(this.$options=m,this.$slots=this.slots(),this.$scopedSlots=Yt(f,e.scopedSlots,this.$slots)),m._scopeId?this._c=function(O,B,k,Z){var ie=xi(b,O,B,k,Z,A);return ie&&!fe(ie)&&(ie.fnScopeId=m._scopeId,ie.fnContext=f),ie}:this._c=function(O,B,k,Z){return xi(b,O,B,k,Z,A)}}Ps(Er.prototype);function ka(e,i,s,f,g){var p=e.options,m={},b=p.props;if(Y(b))for(var T in b)m[T]=Dr(T,b,i||Pe);else Y(s.attrs)&&nn(m,s.attrs),Y(s.props)&&nn(m,s.props);var A=new Er(s,m,g,f,e),O=p.render.call(null,A._c,A);if(O instanceof Le)return rn(O,s,A.parent,p);if(fe(O)){for(var B=br(O)||[],k=new Array(B.length),Z=0;Z<B.length;Z++)k[Z]=rn(B[Z],s,A.parent,p);return k}}function rn(e,i,s,f,g){var p=qi(e);return p.fnContext=s,p.fnOptions=f,i.slot&&((p.data||(p.data={})).slot=i.slot),p}function nn(e,i){for(var s in i)e[_t(s)]=i[s]}function Ai(e){return e.name||e.__name||e._componentTag}var Ir={init:function(e,i){if(e.componentInstance&&!e.componentInstance._isDestroyed&&e.data.keepAlive){var s=e;Ir.prepatch(s,s)}else{var f=e.componentInstance=Fa(e,dt);f.$mount(i?e.elm:void 0,i)}},prepatch:function(e,i){var s=i.componentOptions,f=i.componentInstance=e.componentInstance;wa(f,s.propsData,s.listeners,i,s.children)},insert:function(e){var i=e.context,s=e.componentInstance;s._isMounted||(s._isMounted=!0,je(s,"mounted")),e.data.keepAlive&&(i._isMounted?Da(s):wr(s,!0))},destroy:function(e){var i=e.componentInstance;i._isDestroyed||(e.data.keepAlive?Us(i,!0):i.$destroy())}},sn=Object.keys(Ir);function on(e,i,s,f,g){if(!he(e)){var p=s.$options._base;if(Ae(e)&&(e=p.extend(e)),typeof e=="function"){var m;if(he(e.cid)&&(m=e,e=la(m,p),e===void 0))return ca(m,i,s,f,g);i=i||{},Pr(e),Y(i.model)&&ja(e.options,i);var b=Go(i,e);if(ye(e.options.functional))return ka(e,b,i,s,f);var T=i.on;if(i.on=i.nativeOn,ye(e.options.abstract)){var A=i.slot;i={},A&&(i.slot=A)}Ba(i);var O=Ai(e.options)||g,B=new Le("vue-component-".concat(e.cid).concat(O?"-".concat(O):""),i,void 0,void 0,void 0,s,{Ctor:e,propsData:b,listeners:T,tag:g,children:f},m);return B}}}function Fa(e,i){var s={_isComponent:!0,_parentVnode:e,parent:i},f=e.data.inlineTemplate;return Y(f)&&(s.render=f.render,s.staticRenderFns=f.staticRenderFns),new e.componentOptions.Ctor(s)}function Ba(e){for(var i=e.hook||(e.hook={}),s=0;s<sn.length;s++){var f=sn[s],g=i[f],p=Ir[f];g!==p&&!(g&&g._merged)&&(i[f]=g?Na(p,g):p)}}function Na(e,i){var s=function(f,g){e(f,g),i(f,g)};return s._merged=!0,s}function ja(e,i){var s=e.model&&e.model.prop||"value",f=e.model&&e.model.event||"input";(i.attrs||(i.attrs={}))[s]=i.model.value;var g=i.on||(i.on={}),p=g[f],m=i.model.callback;Y(p)?(fe(p)?p.indexOf(m)===-1:p!==m)&&(g[f]=[m].concat(p)):g[f]=m}var Ua=Te,Xe=Ne.optionMergeStrategies;function Zt(e,i,s){if(s===void 0&&(s=!0),!i)return e;for(var f,g,p,m=ii?Reflect.ownKeys(i):Object.keys(i),b=0;b<m.length;b++)f=m[b],f!=="__ob__"&&(g=e[f],p=i[f],!s||!De(e,f)?yr(e,f,p):g!==p&&Me(g)&&Me(p)&&Zt(g,p));return e}function an(e,i,s){return s?function(){var g=me(i)?i.call(s,s):i,p=me(e)?e.call(s,s):e;return g?Zt(g,p):p}:i?e?function(){return Zt(me(i)?i.call(this,this):i,me(e)?e.call(this,this):e)}:i:e}Xe.data=function(e,i,s){return s?an(e,i,s):i&&typeof i!="function"?e:an(e,i)};function Ga(e,i){var s=i?e?e.concat(i):fe(i)?i:[i]:e;return s&&Va(s)}function Va(e){for(var i=[],s=0;s<e.length;s++)i.indexOf(e[s])===-1&&i.push(e[s]);return i}Cs.forEach(function(e){Xe[e]=Ga});function Wa(e,i,s,f){var g=Object.create(e||null);return i?ge(g,i):g}Fi.forEach(function(e){Xe[e+"s"]=Wa});Xe.watch=function(e,i,s,f){if(e===Ki&&(e=void 0),i===Ki&&(i=void 0),!i)return Object.create(e||null);if(!e)return i;var g={};ge(g,e);for(var p in i){var m=g[p],b=i[p];m&&!fe(m)&&(m=[m]),g[p]=m?m.concat(b):fe(b)?b:[b]}return g};Xe.props=Xe.methods=Xe.inject=Xe.computed=function(e,i,s,f){if(!e)return i;var g=Object.create(null);return ge(g,e),i&&ge(g,i),g};Xe.provide=function(e,i){return e?function(){var s=Object.create(null);return Zt(s,me(e)?e.call(this):e),i&&Zt(s,me(i)?i.call(this):i,!1),s}:i};var Ha=function(e,i){return i===void 0?e:i};function Xa(e,i){var s=e.props;if(!!s){var f={},g,p,m;if(fe(s))for(g=s.length;g--;)p=s[g],typeof p=="string"&&(m=_t(p),f[m]={type:null});else if(Me(s))for(var b in s)p=s[b],m=_t(b),f[m]=Me(p)?p:{type:p};e.props=f}}function Ya(e,i){var s=e.inject;if(!!s){var f=e.inject={};if(fe(s))for(var g=0;g<s.length;g++)f[s[g]]={from:s[g]};else if(Me(s))for(var p in s){var m=s[p];f[p]=Me(m)?ge({from:p},m):{from:m}}}}function za(e){var i=e.directives;if(i)for(var s in i){var f=i[s];me(f)&&(i[s]={bind:f,update:f})}}function Ct(e,i,s){if(me(i)&&(i=i.options),Xa(i),Ya(i),za(i),!i._base&&(i.extends&&(e=Ct(e,i.extends,s)),i.mixins))for(var f=0,g=i.mixins.length;f<g;f++)e=Ct(e,i.mixins[f],s);var p={},m;for(m in e)b(m);for(m in i)De(e,m)||b(m);function b(T){var A=Xe[T]||Ha;p[T]=A(e[T],i[T],s,T)}return p}function Oi(e,i,s,f){if(typeof s=="string"){var g=e[i];if(De(g,s))return g[s];var p=_t(s);if(De(g,p))return g[p];var m=So(p);if(De(g,m))return g[m];var b=g[s]||g[p]||g[m];return b}}function Dr(e,i,s,f){var g=i[e],p=!De(s,e),m=s[e],b=ln(Boolean,g.type);if(b>-1){if(p&&!De(g,"default"))m=!1;else if(m===""||m===ei(e)){var T=ln(String,g.type);(T<0||b<T)&&(m=!0)}}if(m===void 0){m=$a(f,g,e);var A=vr;st(!0),Je(m),st(A)}return m}function $a(e,i,s){if(!!De(i,"default")){var f=i.default;return e&&e.$options.propsData&&e.$options.propsData[s]===void 0&&e._props[s]!==void 0?e._props[s]:me(f)&&sr(i.type)!=="Function"?f.call(e):f}}var Ka=/^\s*function (\w+)/;function sr(e){var i=e&&e.toString().match(Ka);return i?i[1]:""}function cn(e,i){return sr(e)===sr(i)}function ln(e,i){if(!fe(i))return cn(i,e)?0:-1;for(var s=0,f=i.length;s<f;s++)if(cn(i[s],e))return s;return-1}var Qe={enumerable:!0,configurable:!0,get:Te,set:Te};function Rr(e,i,s){Qe.get=function(){return this[i][s]},Qe.set=function(g){this[i][s]=g},Object.defineProperty(e,s,Qe)}function qa(e){var i=e.$options;if(i.props&&Za(e,i.props),ia(e),i.methods&&ic(e,i.methods),i.data)Ja(e);else{var s=Je(e._data={});s&&s.vmCount++}i.computed&&tc(e,i.computed),i.watch&&i.watch!==Ki&&rc(e,i.watch)}function Za(e,i){var s=e.$options.propsData||{},f=e._props=Os({}),g=e.$options._propKeys=[],p=!e.$parent;p||st(!1);var m=function(T){g.push(T);var A=Dr(T,i,s,e);vt(f,T,A),T in e||Rr(e,"_props",T)};for(var b in i)m(b);st(!0)}function Ja(e){var i=e.$options.data;i=e._data=me(i)?Qa(i,e):i||{},Me(i)||(i={});var s=Object.keys(i),f=e.$options.props;e.$options.methods;for(var g=s.length;g--;){var p=s[g];f&&De(f,p)||bs(p)||Rr(e,"_data",p)}var m=Je(i);m&&m.vmCount++}function Qa(e,i){Mt();try{return e.call(i,i)}catch(s){return yt(s,i,"data()"),{}}finally{Lt()}}var ec={lazy:!0};function tc(e,i){var s=e._computedWatchers=Object.create(null),f=ti();for(var g in i){var p=i[g],m=me(p)?p:p.get;f||(s[g]=new Tr(e,m||Te,Te,ec)),g in e||Ws(e,g,p)}}function Ws(e,i,s){var f=!ti();me(s)?(Qe.get=f?hn(i):un(s),Qe.set=Te):(Qe.get=s.get?f&&s.cache!==!1?hn(i):un(s.get):Te,Qe.set=s.set||Te),Object.defineProperty(e,i,Qe)}function hn(e){return function(){var s=this._computedWatchers&&this._computedWatchers[e];if(s)return s.dirty&&s.evaluate(),nt.target&&s.depend(),s.value}}function un(e){return function(){return e.call(this,this)}}function ic(e,i){e.$options.props;for(var s in i)e[s]=typeof i[s]!="function"?Te:_s(i[s],e)}function rc(e,i){for(var s in i){var f=i[s];if(fe(f))for(var g=0;g<f.length;g++)or(e,s,f[g]);else or(e,s,f)}}function or(e,i,s,f){return Me(s)&&(f=s,s=s.handler),typeof s=="string"&&(s=e[s]),e.$watch(i,s,f)}function nc(e){var i={};i.get=function(){return this._data};var s={};s.get=function(){return this._props},Object.defineProperty(e.prototype,"$data",i),Object.defineProperty(e.prototype,"$props",s),e.prototype.$set=yr,e.prototype.$delete=ws,e.prototype.$watch=function(f,g,p){var m=this;if(Me(g))return or(m,f,g,p);p=p||{},p.user=!0;var b=new Tr(m,f,g,p);if(p.immediate){var T='callback for immediate watcher "'.concat(b.expression,'"');Mt(),ot(g,m,[b.value],m,T),Lt()}return function(){b.teardown()}}}var sc=0;function oc(e){e.prototype._init=function(i){var s=this;s._uid=sc++,s._isVue=!0,s.__v_skip=!0,s._scope=new Bo(!0),s._scope._vm=!0,i&&i._isComponent?ac(s,i):s.$options=Ct(Pr(s.constructor),i||{},s),s._renderProxy=s,s._self=s,Sa(s),ma(s),oa(s),je(s,"beforeCreate",void 0,!1),La(s),qa(s),Ma(s),je(s,"created"),s.$options.el&&s.$mount(s.$options.el)}}function ac(e,i){var s=e.$options=Object.create(e.constructor.options),f=i._parentVnode;s.parent=i.parent,s._parentVnode=f;var g=f.componentOptions;s.propsData=g.propsData,s._parentListeners=g.listeners,s._renderChildren=g.children,s._componentTag=g.tag,i.render&&(s.render=i.render,s.staticRenderFns=i.staticRenderFns)}function Pr(e){var i=e.options;if(e.super){var s=Pr(e.super),f=e.superOptions;if(s!==f){e.superOptions=s;var g=cc(e);g&&ge(e.extendOptions,g),i=e.options=Ct(s,e.extendOptions),i.name&&(i.components[i.name]=e)}}return i}function cc(e){var i,s=e.options,f=e.sealedOptions;for(var g in s)s[g]!==f[g]&&(i||(i={}),i[g]=s[g]);return i}function Se(e){this._init(e)}oc(Se);nc(Se);ba(Se);xa(Se);aa(Se);function lc(e){e.use=function(i){var s=this._installedPlugins||(this._installedPlugins=[]);if(s.indexOf(i)>-1)return this;var f=$i(arguments,1);return f.unshift(this),me(i.install)?i.install.apply(i,f):me(i)&&i.apply(null,f),s.push(i),this}}function hc(e){e.mixin=function(i){return this.options=Ct(this.options,i),this}}function uc(e){e.cid=0;var i=1;e.extend=function(s){s=s||{};var f=this,g=f.cid,p=s._Ctor||(s._Ctor={});if(p[g])return p[g];var m=Ai(s)||Ai(f.options),b=function(A){this._init(A)};return b.prototype=Object.create(f.prototype),b.prototype.constructor=b,b.cid=i++,b.options=Ct(f.options,s),b.super=f,b.options.props&&fc(b),b.options.computed&&dc(b),b.extend=f.extend,b.mixin=f.mixin,b.use=f.use,Fi.forEach(function(T){b[T]=f[T]}),m&&(b.options.components[m]=b),b.superOptions=f.options,b.extendOptions=s,b.sealedOptions=ge({},b.options),p[g]=b,b}}function fc(e){var i=e.options.props;for(var s in i)Rr(e.prototype,"_props",s)}function dc(e){var i=e.options.computed;for(var s in i)Ws(e.prototype,s,i[s])}function pc(e){Fi.forEach(function(i){e[i]=function(s,f){return f?(i==="component"&&Me(f)&&(f.name=f.name||s,f=this.options._base.extend(f)),i==="directive"&&me(f)&&(f={bind:f,update:f}),this.options[i+"s"][s]=f,f):this.options[i+"s"][s]}})}function fn(e){return e&&(Ai(e.Ctor.options)||e.tag)}function ci(e,i){return fe(e)?e.indexOf(i)>-1:typeof e=="string"?e.split(",").indexOf(i)>-1:mo(e)?e.test(i):!1}function dn(e,i){var s=e.cache,f=e.keys,g=e._vnode;for(var p in s){var m=s[p];if(m){var b=m.name;b&&!i(b)&&ar(s,p,f,g)}}}function ar(e,i,s,f){var g=e[i];g&&(!f||g.tag!==f.tag)&&g.componentInstance.$destroy(),e[i]=null,at(s,i)}var pn=[String,RegExp,Array],gc={name:"keep-alive",abstract:!0,props:{include:pn,exclude:pn,max:[String,Number]},methods:{cacheVNode:function(){var e=this,i=e.cache,s=e.keys,f=e.vnodeToCache,g=e.keyToCache;if(f){var p=f.tag,m=f.componentInstance,b=f.componentOptions;i[g]={name:fn(b),tag:p,componentInstance:m},s.push(g),this.max&&s.length>parseInt(this.max)&&ar(i,s[0],s,this._vnode),this.vnodeToCache=null}}},created:function(){this.cache=Object.create(null),this.keys=[]},destroyed:function(){for(var e in this.cache)ar(this.cache,e,this.keys)},mounted:function(){var e=this;this.cacheVNode(),this.$watch("include",function(i){dn(e,function(s){return ci(i,s)})}),this.$watch("exclude",function(i){dn(e,function(s){return!ci(i,s)})})},updated:function(){this.cacheVNode()},render:function(){var e=this.$slots.default,i=Ls(e),s=i&&i.componentOptions;if(s){var f=fn(s),g=this,p=g.include,m=g.exclude;if(p&&(!f||!ci(p,f))||m&&f&&ci(m,f))return i;var b=this,T=b.cache,A=b.keys,O=i.key==null?s.Ctor.cid+(s.tag?"::".concat(s.tag):""):i.key;T[O]?(i.componentInstance=T[O].componentInstance,at(A,O),A.push(O)):(this.vnodeToCache=i,this.keyToCache=O),i.data.keepAlive=!0}return i||e&&e[0]}},_c={KeepAlive:gc};function mc(e){var i={};i.get=function(){return Ne},Object.defineProperty(e,"config",i),e.util={warn:Ua,extend:ge,mergeOptions:Ct,defineReactive:vt},e.set=yr,e.delete=ws,e.nextTick=xr,e.observable=function(s){return Je(s),s},e.options=Object.create(null),Fi.forEach(function(s){e.options[s+"s"]=Object.create(null)}),e.options._base=e,ge(e.options.components,_c),lc(e),hc(e),uc(e),pc(e)}mc(Se);Object.defineProperty(Se.prototype,"$isServer",{get:ti});Object.defineProperty(Se.prototype,"$ssrContext",{get:function(){return this.$vnode&&this.$vnode.ssrContext}});Object.defineProperty(Se,"FunctionalRenderContext",{value:Er});Se.version=ga;var vc=Ue("style,class"),yc=Ue("input,textarea,option,select,progress"),Cc=function(e,i,s){return s==="value"&&yc(e)&&i!=="button"||s==="selected"&&e==="option"||s==="checked"&&e==="input"||s==="muted"&&e==="video"},Hs=Ue("contenteditable,draggable,spellcheck"),bc=Ue("events,caret,typing,plaintext-only"),Sc=function(e,i){return Ei(i)||i==="false"?"false":e==="contenteditable"&&bc(i)?i:"true"},xc=Ue("allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,truespeed,typemustmatch,visible"),cr="http://www.w3.org/1999/xlink",Mr=function(e){return e.charAt(5)===":"&&e.slice(0,5)==="xlink"},Xs=function(e){return Mr(e)?e.slice(6,e.length):""},Ei=function(e){return e==null||e===!1};function Tc(e){for(var i=e.data,s=e,f=e;Y(f.componentInstance);)f=f.componentInstance._vnode,f&&f.data&&(i=gn(f.data,i));for(;Y(s=s.parent);)s&&s.data&&(i=gn(i,s.data));return wc(i.staticClass,i.class)}function gn(e,i){return{staticClass:Lr(e.staticClass,i.staticClass),class:Y(e.class)?[e.class,i.class]:i.class}}function wc(e,i){return Y(e)||Y(i)?Lr(e,kr(i)):""}function Lr(e,i){return e?i?e+" "+i:e:i||""}function kr(e){return Array.isArray(e)?Ac(e):Ae(e)?Oc(e):typeof e=="string"?e:""}function Ac(e){for(var i="",s,f=0,g=e.length;f<g;f++)Y(s=kr(e[f]))&&s!==""&&(i&&(i+=" "),i+=s);return i}function Oc(e){var i="";for(var s in e)e[s]&&(i&&(i+=" "),i+=s);return i}var Ec={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},Ic=Ue("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,menuitem,summary,content,element,shadow,template,blockquote,iframe,tfoot"),Fr=Ue("svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,foreignobject,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view",!0),Ys=function(e){return Ic(e)||Fr(e)};function Dc(e){if(Fr(e))return"svg";if(e==="math")return"math"}var li=Object.create(null);function Rc(e){if(!ke)return!0;if(Ys(e))return!1;if(e=e.toLowerCase(),li[e]!=null)return li[e];var i=document.createElement(e);return e.indexOf("-")>-1?li[e]=i.constructor===window.HTMLUnknownElement||i.constructor===window.HTMLElement:li[e]=/HTMLUnknownElement/.test(i.toString())}var lr=Ue("text,number,password,search,email,tel,url");function Pc(e){if(typeof e=="string"){var i=document.querySelector(e);return i||document.createElement("div")}else return e}function Mc(e,i){var s=document.createElement(e);return e!=="select"||i.data&&i.data.attrs&&i.data.attrs.multiple!==void 0&&s.setAttribute("multiple","multiple"),s}function Lc(e,i){return document.createElementNS(Ec[e],i)}function kc(e){return document.createTextNode(e)}function Fc(e){return document.createComment(e)}function Bc(e,i,s){e.insertBefore(i,s)}function Nc(e,i){e.removeChild(i)}function jc(e,i){e.appendChild(i)}function Uc(e){return e.parentNode}function Gc(e){return e.nextSibling}function Vc(e){return e.tagName}function Wc(e,i){e.textContent=i}function Hc(e,i){e.setAttribute(i,"")}var Xc=Object.freeze({__proto__:null,createElement:Mc,createElementNS:Lc,createTextNode:kc,createComment:Fc,insertBefore:Bc,removeChild:Nc,appendChild:jc,parentNode:Uc,nextSibling:Gc,tagName:Vc,setTextContent:Wc,setStyleScope:Hc}),Yc={create:function(e,i){Et(i)},update:function(e,i){e.data.ref!==i.data.ref&&(Et(e,!0),Et(i))},destroy:function(e){Et(e,!0)}};function Et(e,i){var s=e.data.ref;if(!!Y(s)){var f=e.context,g=e.componentInstance||e.elm,p=i?null:g,m=i?void 0:g;if(me(s)){ot(s,f,[p],f,"template ref function");return}var b=e.data.refInFor,T=typeof s=="string"||typeof s=="number",A=Ye(s),O=f.$refs;if(T||A){if(b){var B=T?O[s]:s.value;i?fe(B)&&at(B,g):fe(B)?B.includes(g)||B.push(g):T?(O[s]=[g],_n(f,s,O[s])):s.value=[g]}else if(T){if(i&&O[s]!==g)return;O[s]=m,_n(f,s,p)}else if(A){if(i&&s.value!==g)return;s.value=p}}}}function _n(e,i,s){var f=e._setupState;f&&De(f,i)&&(Ye(f[i])?f[i].value=s:f[i]=s)}var tt=new Le("",{},[]),jt=["create","activate","update","remove","destroy"];function ht(e,i){return e.key===i.key&&e.asyncFactory===i.asyncFactory&&(e.tag===i.tag&&e.isComment===i.isComment&&Y(e.data)===Y(i.data)&&zc(e,i)||ye(e.isAsyncPlaceholder)&&he(i.asyncFactory.error))}function zc(e,i){if(e.tag!=="input")return!0;var s,f=Y(s=e.data)&&Y(s=s.attrs)&&s.type,g=Y(s=i.data)&&Y(s=s.attrs)&&s.type;return f===g||lr(f)&&lr(g)}function $c(e,i,s){var f,g,p={};for(f=i;f<=s;++f)g=e[f].key,Y(g)&&(p[g]=f);return p}function Kc(e){var i,s,f={},g=e.modules,p=e.nodeOps;for(i=0;i<jt.length;++i)for(f[jt[i]]=[],s=0;s<g.length;++s)Y(g[s][jt[i]])&&f[jt[i]].push(g[s][jt[i]]);function m(o){return new Le(p.tagName(o).toLowerCase(),{},[],void 0,o)}function b(o,r){function a(){--a.listeners===0&&T(o)}return a.listeners=r,a}function T(o){var r=p.parentNode(o);Y(r)&&p.removeChild(r,o)}function A(o,r,a,l,t,n,c){if(Y(o.elm)&&Y(n)&&(o=n[c]=qi(o)),o.isRootInsert=!t,!O(o,r,a,l)){var d=o.data,h=o.children,u=o.tag;Y(u)?(o.elm=o.ns?p.createElementNS(o.ns,u):p.createElement(u,o),de(o),ie(o,h,r),Y(d)&&ce(o,r),Z(a,o.elm,l)):ye(o.isComment)?(o.elm=p.createComment(o.text),Z(a,o.elm,l)):(o.elm=p.createTextNode(o.text),Z(a,o.elm,l))}}function O(o,r,a,l){var t=o.data;if(Y(t)){var n=Y(o.componentInstance)&&t.keepAlive;if(Y(t=t.hook)&&Y(t=t.init)&&t(o,!1),Y(o.componentInstance))return B(o,r),Z(a,o.elm,l),ye(n)&&k(o,r,a,l),!0}}function B(o,r){Y(o.data.pendingInsert)&&(r.push.apply(r,o.data.pendingInsert),o.data.pendingInsert=null),o.elm=o.componentInstance.$el,le(o)?(ce(o,r),de(o)):(Et(o),r.push(o))}function k(o,r,a,l){for(var t,n=o;n.componentInstance;)if(n=n.componentInstance._vnode,Y(t=n.data)&&Y(t=t.transition)){for(t=0;t<f.activate.length;++t)f.activate[t](tt,n);r.push(n);break}Z(a,o.elm,l)}function Z(o,r,a){Y(o)&&(Y(a)?p.parentNode(a)===o&&p.insertBefore(o,r,a):p.appendChild(o,r))}function ie(o,r,a){if(fe(r))for(var l=0;l<r.length;++l)A(r[l],a,o.elm,null,!0,r,l);else Qt(o.text)&&p.appendChild(o.elm,p.createTextNode(String(o.text)))}function le(o){for(;o.componentInstance;)o=o.componentInstance._vnode;return Y(o.tag)}function ce(o,r){for(var a=0;a<f.create.length;++a)f.create[a](tt,o);i=o.data.hook,Y(i)&&(Y(i.create)&&i.create(tt,o),Y(i.insert)&&r.push(o))}function de(o){var r;if(Y(r=o.fnScopeId))p.setStyleScope(o.elm,r);else for(var a=o;a;)Y(r=a.context)&&Y(r=r.$options._scopeId)&&p.setStyleScope(o.elm,r),a=a.parent;Y(r=dt)&&r!==o.context&&r!==o.fnContext&&Y(r=r.$options._scopeId)&&p.setStyleScope(o.elm,r)}function oe(o,r,a,l,t,n){for(;l<=t;++l)A(a[l],n,o,r,!1,a,l)}function ae(o){var r,a,l=o.data;if(Y(l))for(Y(r=l.hook)&&Y(r=r.destroy)&&r(o),r=0;r<f.destroy.length;++r)f.destroy[r](o);if(Y(r=o.children))for(a=0;a<o.children.length;++a)ae(o.children[a])}function ve(o,r,a){for(;r<=a;++r){var l=o[r];Y(l)&&(Y(l.tag)?(Ee(l),ae(l)):T(l.elm))}}function Ee(o,r){if(Y(r)||Y(o.data)){var a,l=f.remove.length+1;for(Y(r)?r.listeners+=l:r=b(o.elm,l),Y(a=o.componentInstance)&&Y(a=a._vnode)&&Y(a.data)&&Ee(a,r),a=0;a<f.remove.length;++a)f.remove[a](o,r);Y(a=o.data.hook)&&Y(a=a.remove)?a(o,r):r()}else T(o.elm)}function Ie(o,r,a,l,t){for(var n=0,c=0,d=r.length-1,h=r[0],u=r[d],_=a.length-1,y=a[0],C=a[_],x,S,w,E,M=!t;n<=d&&c<=_;)he(h)?h=r[++n]:he(u)?u=r[--d]:ht(h,y)?(v(h,y,l,a,c),h=r[++n],y=a[++c]):ht(u,C)?(v(u,C,l,a,_),u=r[--d],C=a[--_]):ht(h,C)?(v(h,C,l,a,_),M&&p.insertBefore(o,h.elm,p.nextSibling(u.elm)),h=r[++n],C=a[--_]):ht(u,y)?(v(u,y,l,a,c),M&&p.insertBefore(o,u.elm,h.elm),u=r[--d],y=a[++c]):(he(x)&&(x=$c(r,n,d)),S=Y(y.key)?x[y.key]:Ce(y,r,n,d),he(S)?A(y,l,o,h.elm,!1,a,c):(w=r[S],ht(w,y)?(v(w,y,l,a,c),r[S]=void 0,M&&p.insertBefore(o,w.elm,h.elm)):A(y,l,o,h.elm,!1,a,c)),y=a[++c]);n>d?(E=he(a[_+1])?null:a[_+1].elm,oe(o,E,a,c,_,l)):c>_&&ve(r,n,d)}function Ce(o,r,a,l){for(var t=a;t<l;t++){var n=r[t];if(Y(n)&&ht(o,n))return t}}function v(o,r,a,l,t,n){if(o!==r){Y(r.elm)&&Y(l)&&(r=l[t]=qi(r));var c=r.elm=o.elm;if(ye(o.isAsyncPlaceholder)){Y(r.asyncFactory.resolved)?We(o.elm,r,a):r.isAsyncPlaceholder=!0;return}if(ye(r.isStatic)&&ye(o.isStatic)&&r.key===o.key&&(ye(r.isCloned)||ye(r.isOnce))){r.componentInstance=o.componentInstance;return}var d,h=r.data;Y(h)&&Y(d=h.hook)&&Y(d=d.prepatch)&&d(o,r);var u=o.children,_=r.children;if(Y(h)&&le(r)){for(d=0;d<f.update.length;++d)f.update[d](o,r);Y(d=h.hook)&&Y(d=d.update)&&d(o,r)}he(r.text)?Y(u)&&Y(_)?u!==_&&Ie(c,u,_,a,n):Y(_)?(Y(o.text)&&p.setTextContent(c,""),oe(c,null,_,0,_.length-1,a)):Y(u)?ve(u,0,u.length-1):Y(o.text)&&p.setTextContent(c,""):o.text!==r.text&&p.setTextContent(c,r.text),Y(h)&&Y(d=h.hook)&&Y(d=d.postpatch)&&d(o,r)}}function Ge(o,r,a){if(ye(a)&&Y(o.parent))o.parent.data.pendingInsert=r;else for(var l=0;l<r.length;++l)r[l].data.hook.insert(r[l])}var Ve=Ue("attrs,class,staticClass,staticStyle,key");function We(o,r,a,l){var t,n=r.tag,c=r.data,d=r.children;if(l=l||c&&c.pre,r.elm=o,ye(r.isComment)&&Y(r.asyncFactory))return r.isAsyncPlaceholder=!0,!0;if(Y(c)&&(Y(t=c.hook)&&Y(t=t.init)&&t(r,!0),Y(t=r.componentInstance)))return B(r,a),!0;if(Y(n)){if(Y(d))if(!o.hasChildNodes())ie(r,d,a);else if(Y(t=c)&&Y(t=t.domProps)&&Y(t=t.innerHTML)){if(t!==o.innerHTML)return!1}else{for(var h=!0,u=o.firstChild,_=0;_<d.length;_++){if(!u||!We(u,d[_],a,l)){h=!1;break}u=u.nextSibling}if(!h||u)return!1}if(Y(c)){var y=!1;for(var C in c)if(!Ve(C)){y=!0,ce(r,a);break}!y&&c.class&&Ti(c.class)}}else o.data!==r.text&&(o.data=r.text);return!0}return function(r,a,l,t){if(he(a)){Y(r)&&ae(r);return}var n=!1,c=[];if(he(r))n=!0,A(a,c);else{var d=Y(r.nodeType);if(!d&&ht(r,a))v(r,a,c,null,null,t);else{if(d){if(r.nodeType===1&&r.hasAttribute(Wr)&&(r.removeAttribute(Wr),l=!0),ye(l)&&We(r,a,c))return Ge(a,c,!0),r;r=m(r)}var h=r.elm,u=p.parentNode(h);if(A(a,c,h._leaveCb?null:u,p.nextSibling(h)),Y(a.parent))for(var _=a.parent,y=le(a);_;){for(var C=0;C<f.destroy.length;++C)f.destroy[C](_);if(_.elm=a.elm,y){for(var x=0;x<f.create.length;++x)f.create[x](tt,_);var S=_.data.hook.insert;if(S.merged)for(var w=S.fns.slice(1),E=0;E<w.length;E++)w[E]()}else Et(_);_=_.parent}Y(u)?ve([r],0,0):Y(r.tag)&&ae(r)}}return Ge(a,c,n),a.elm}}var qc={create:Ui,update:Ui,destroy:function(i){Ui(i,tt)}};function Ui(e,i){(e.data.directives||i.data.directives)&&Zc(e,i)}function Zc(e,i){var s=e===tt,f=i===tt,g=mn(e.data.directives,e.context),p=mn(i.data.directives,i.context),m=[],b=[],T,A,O;for(T in p)A=g[T],O=p[T],A?(O.oldValue=A.value,O.oldArg=A.arg,Ut(O,"update",i,e),O.def&&O.def.componentUpdated&&b.push(O)):(Ut(O,"bind",i,e),O.def&&O.def.inserted&&m.push(O));if(m.length){var B=function(){for(var k=0;k<m.length;k++)Ut(m[k],"inserted",i,e)};s?et(i,"insert",B):B()}if(b.length&&et(i,"postpatch",function(){for(var k=0;k<b.length;k++)Ut(b[k],"componentUpdated",i,e)}),!s)for(T in g)p[T]||Ut(g[T],"unbind",e,e,f)}var Jc=Object.create(null);function mn(e,i){var s=Object.create(null);if(!e)return s;var f,g;for(f=0;f<e.length;f++){if(g=e[f],g.modifiers||(g.modifiers=Jc),s[Qc(g)]=g,i._setupState&&i._setupState.__sfc){var p=g.def||Oi(i,"_setupState","v-"+g.name);typeof p=="function"?g.def={bind:p,update:p}:g.def=p}g.def=g.def||Oi(i.$options,"directives",g.name)}return s}function Qc(e){return e.rawName||"".concat(e.name,".").concat(Object.keys(e.modifiers||{}).join("."))}function Ut(e,i,s,f,g){var p=e.def&&e.def[i];if(p)try{p(s.elm,e,s,f,g)}catch(m){yt(m,s.context,"directive ".concat(e.name," ").concat(i," hook"))}}var el=[Yc,qc];function vn(e,i){var s=i.componentOptions;if(!(Y(s)&&s.Ctor.options.inheritAttrs===!1)&&!(he(e.data.attrs)&&he(i.data.attrs))){var f,g,p,m=i.elm,b=e.data.attrs||{},T=i.data.attrs||{};(Y(T.__ob__)||ye(T._v_attr_proxy))&&(T=i.data.attrs=ge({},T));for(f in T)g=T[f],p=b[f],p!==g&&yn(m,f,g,i.data.pre);(Rt||mr)&&T.value!==b.value&&yn(m,"value",T.value);for(f in b)he(T[f])&&(Mr(f)?m.removeAttributeNS(cr,Xs(f)):Hs(f)||m.removeAttribute(f))}}function yn(e,i,s,f){f||e.tagName.indexOf("-")>-1?Cn(e,i,s):xc(i)?Ei(s)?e.removeAttribute(i):(s=i==="allowfullscreen"&&e.tagName==="EMBED"?"true":i,e.setAttribute(i,s)):Hs(i)?e.setAttribute(i,Sc(i,s)):Mr(i)?Ei(s)?e.removeAttributeNS(cr,Xs(i)):e.setAttributeNS(cr,i,s):Cn(e,i,s)}function Cn(e,i,s){if(Ei(s))e.removeAttribute(i);else{if(Rt&&!Pt&&e.tagName==="TEXTAREA"&&i==="placeholder"&&s!==""&&!e.__ieph){var f=function(g){g.stopImmediatePropagation(),e.removeEventListener("input",f)};e.addEventListener("input",f),e.__ieph=!0}e.setAttribute(i,s)}}var tl={create:vn,update:vn};function bn(e,i){var s=i.elm,f=i.data,g=e.data;if(!(he(f.staticClass)&&he(f.class)&&(he(g)||he(g.staticClass)&&he(g.class)))){var p=Tc(i),m=s._transitionClasses;Y(m)&&(p=Lr(p,kr(m))),p!==s._prevClass&&(s.setAttribute("class",p),s._prevClass=p)}}var il={create:bn,update:bn},Gi="__r",Vi="__c";function rl(e){if(Y(e[Gi])){var i=Rt?"change":"input";e[i]=[].concat(e[Gi],e[i]||[]),delete e[Gi]}Y(e[Vi])&&(e.change=[].concat(e[Vi],e.change||[]),delete e[Vi])}var Jt;function nl(e,i,s){var f=Jt;return function g(){var p=i.apply(null,arguments);p!==null&&zs(e,g,s,f)}}var sl=er&&!(Hr&&Number(Hr[1])<=53);function ol(e,i,s,f){if(sl){var g=Gs,p=i;i=p._wrapper=function(m){if(m.target===m.currentTarget||m.timeStamp>=g||m.timeStamp<=0||m.target.ownerDocument!==document)return p.apply(this,arguments)}}Jt.addEventListener(e,i,Ss?{capture:s,passive:f}:s)}function zs(e,i,s,f){(f||Jt).removeEventListener(e,i._wrapper||i,s)}function Wi(e,i){if(!(he(e.data.on)&&he(i.data.on))){var s=i.data.on||{},f=e.data.on||{};Jt=i.elm||e.elm,rl(s),Es(s,f,ol,zs,nl,i.context),Jt=void 0}}var al={create:Wi,update:Wi,destroy:function(e){return Wi(e,tt)}},hi;function Sn(e,i){if(!(he(e.data.domProps)&&he(i.data.domProps))){var s,f,g=i.elm,p=e.data.domProps||{},m=i.data.domProps||{};(Y(m.__ob__)||ye(m._v_attr_proxy))&&(m=i.data.domProps=ge({},m));for(s in p)s in m||(g[s]="");for(s in m){if(f=m[s],s==="textContent"||s==="innerHTML"){if(i.children&&(i.children.length=0),f===p[s])continue;g.childNodes.length===1&&g.removeChild(g.childNodes[0])}if(s==="value"&&g.tagName!=="PROGRESS"){g._value=f;var b=he(f)?"":String(f);cl(g,b)&&(g.value=b)}else if(s==="innerHTML"&&Fr(g.tagName)&&he(g.innerHTML)){hi=hi||document.createElement("div"),hi.innerHTML="<svg>".concat(f,"</svg>");for(var T=hi.firstChild;g.firstChild;)g.removeChild(g.firstChild);for(;T.firstChild;)g.appendChild(T.firstChild)}else if(f!==p[s])try{g[s]=f}catch(A){}}}}function cl(e,i){return!e.composing&&(e.tagName==="OPTION"||ll(e,i)||hl(e,i))}function ll(e,i){var s=!0;try{s=document.activeElement!==e}catch(f){}return s&&e.value!==i}function hl(e,i){var s=e.value,f=e._vModifiers;if(Y(f)){if(f.number)return zt(s)!==zt(i);if(f.trim)return s.trim()!==i.trim()}return s!==i}var ul={create:Sn,update:Sn},fl=bt(function(e){var i={},s=/;(?![^(]*\))/g,f=/:(.+)/;return e.split(s).forEach(function(g){if(g){var p=g.split(f);p.length>1&&(i[p[0].trim()]=p[1].trim())}}),i});function Hi(e){var i=$s(e.style);return e.staticStyle?ge(e.staticStyle,i):i}function $s(e){return Array.isArray(e)?ms(e):typeof e=="string"?fl(e):e}function dl(e,i){var s={},f;if(i)for(var g=e;g.componentInstance;)g=g.componentInstance._vnode,g&&g.data&&(f=Hi(g.data))&&ge(s,f);(f=Hi(e.data))&&ge(s,f);for(var p=e;p=p.parent;)p.data&&(f=Hi(p.data))&&ge(s,f);return s}var pl=/^--/,xn=/\s*!important$/,Tn=function(e,i,s){if(pl.test(i))e.style.setProperty(i,s);else if(xn.test(s))e.style.setProperty(ei(i),s.replace(xn,""),"important");else{var f=gl(i);if(Array.isArray(s))for(var g=0,p=s.length;g<p;g++)e.style[f]=s[g];else e.style[f]=s}},wn=["Webkit","Moz","ms"],ui,gl=bt(function(e){if(ui=ui||document.createElement("div").style,e=_t(e),e!=="filter"&&e in ui)return e;for(var i=e.charAt(0).toUpperCase()+e.slice(1),s=0;s<wn.length;s++){var f=wn[s]+i;if(f in ui)return f}});function An(e,i){var s=i.data,f=e.data;if(!(he(s.staticStyle)&&he(s.style)&&he(f.staticStyle)&&he(f.style))){var g,p,m=i.elm,b=f.staticStyle,T=f.normalizedStyle||f.style||{},A=b||T,O=$s(i.data.style)||{};i.data.normalizedStyle=Y(O.__ob__)?ge({},O):O;var B=dl(i,!0);for(p in A)he(B[p])&&Tn(m,p,"");for(p in B)g=B[p],g!==A[p]&&Tn(m,p,g==null?"":g)}}var _l={create:An,update:An},Ks=/\s+/;function qs(e,i){if(!(!i||!(i=i.trim())))if(e.classList)i.indexOf(" ")>-1?i.split(Ks).forEach(function(f){return e.classList.add(f)}):e.classList.add(i);else{var s=" ".concat(e.getAttribute("class")||""," ");s.indexOf(" "+i+" ")<0&&e.setAttribute("class",(s+i).trim())}}function Zs(e,i){if(!(!i||!(i=i.trim())))if(e.classList)i.indexOf(" ")>-1?i.split(Ks).forEach(function(g){return e.classList.remove(g)}):e.classList.remove(i),e.classList.length||e.removeAttribute("class");else{for(var s=" ".concat(e.getAttribute("class")||""," "),f=" "+i+" ";s.indexOf(f)>=0;)s=s.replace(f," ");s=s.trim(),s?e.setAttribute("class",s):e.removeAttribute("class")}}function Js(e){if(!!e){if(typeof e=="object"){var i={};return e.css!==!1&&ge(i,On(e.name||"v")),ge(i,e),i}else if(typeof e=="string")return On(e)}}var On=bt(function(e){return{enterClass:"".concat(e,"-enter"),enterToClass:"".concat(e,"-enter-to"),enterActiveClass:"".concat(e,"-enter-active"),leaveClass:"".concat(e,"-leave"),leaveToClass:"".concat(e,"-leave-to"),leaveActiveClass:"".concat(e,"-leave-active")}}),Qs=ke&&!Pt,wt="transition",Xi="animation",mi="transition",Ii="transitionend",hr="animation",eo="animationend";Qs&&(window.ontransitionend===void 0&&window.onwebkittransitionend!==void 0&&(mi="WebkitTransition",Ii="webkitTransitionEnd"),window.onanimationend===void 0&&window.onwebkitanimationend!==void 0&&(hr="WebkitAnimation",eo="webkitAnimationEnd"));var En=ke?window.requestAnimationFrame?window.requestAnimationFrame.bind(window):setTimeout:function(e){return e()};function to(e){En(function(){En(e)})}function pt(e,i){var s=e._transitionClasses||(e._transitionClasses=[]);s.indexOf(i)<0&&(s.push(i),qs(e,i))}function Ze(e,i){e._transitionClasses&&at(e._transitionClasses,i),Zs(e,i)}function io(e,i,s){var f=ro(e,i),g=f.type,p=f.timeout,m=f.propCount;if(!g)return s();var b=g===wt?Ii:eo,T=0,A=function(){e.removeEventListener(b,O),s()},O=function(B){B.target===e&&++T>=m&&A()};setTimeout(function(){T<m&&A()},p+1),e.addEventListener(b,O)}var ml=/\b(transform|all)(,|$)/;function ro(e,i){var s=window.getComputedStyle(e),f=(s[mi+"Delay"]||"").split(", "),g=(s[mi+"Duration"]||"").split(", "),p=In(f,g),m=(s[hr+"Delay"]||"").split(", "),b=(s[hr+"Duration"]||"").split(", "),T=In(m,b),A,O=0,B=0;i===wt?p>0&&(A=wt,O=p,B=g.length):i===Xi?T>0&&(A=Xi,O=T,B=b.length):(O=Math.max(p,T),A=O>0?p>T?wt:Xi:null,B=A?A===wt?g.length:b.length:0);var k=A===wt&&ml.test(s[mi+"Property"]);return{type:A,timeout:O,propCount:B,hasTransform:k}}function In(e,i){for(;e.length<i.length;)e=e.concat(e);return Math.max.apply(null,i.map(function(s,f){return Dn(s)+Dn(e[f])}))}function Dn(e){return Number(e.slice(0,-1).replace(",","."))*1e3}function ur(e,i){var s=e.elm;Y(s._leaveCb)&&(s._leaveCb.cancelled=!0,s._leaveCb());var f=Js(e.data.transition);if(!he(f)&&!(Y(s._enterCb)||s.nodeType!==1)){for(var g=f.css,p=f.type,m=f.enterClass,b=f.enterToClass,T=f.enterActiveClass,A=f.appearClass,O=f.appearToClass,B=f.appearActiveClass,k=f.beforeEnter,Z=f.enter,ie=f.afterEnter,le=f.enterCancelled,ce=f.beforeAppear,de=f.appear,oe=f.afterAppear,ae=f.appearCancelled,ve=f.duration,Ee=dt,Ie=dt.$vnode;Ie&&Ie.parent;)Ee=Ie.context,Ie=Ie.parent;var Ce=!Ee._isMounted||!e.isRootInsert;if(!(Ce&&!de&&de!=="")){var v=Ce&&A?A:m,Ge=Ce&&B?B:T,Ve=Ce&&O?O:b,We=Ce&&ce||k,o=Ce&&me(de)?de:Z,r=Ce&&oe||ie,a=Ce&&ae||le,l=zt(Ae(ve)?ve.enter:ve),t=g!==!1&&!Pt,n=Br(o),c=s._enterCb=yi(function(){t&&(Ze(s,Ve),Ze(s,Ge)),c.cancelled?(t&&Ze(s,v),a&&a(s)):r&&r(s),s._enterCb=null});e.data.show||et(e,"insert",function(){var d=s.parentNode,h=d&&d._pending&&d._pending[e.key];h&&h.tag===e.tag&&h.elm._leaveCb&&h.elm._leaveCb(),o&&o(s,c)}),We&&We(s),t&&(pt(s,v),pt(s,Ge),to(function(){Ze(s,v),c.cancelled||(pt(s,Ve),n||(so(l)?setTimeout(c,l):io(s,p,c)))})),e.data.show&&(i&&i(),o&&o(s,c)),!t&&!n&&c()}}}function no(e,i){var s=e.elm;Y(s._enterCb)&&(s._enterCb.cancelled=!0,s._enterCb());var f=Js(e.data.transition);if(he(f)||s.nodeType!==1)return i();if(Y(s._leaveCb))return;var g=f.css,p=f.type,m=f.leaveClass,b=f.leaveToClass,T=f.leaveActiveClass,A=f.beforeLeave,O=f.leave,B=f.afterLeave,k=f.leaveCancelled,Z=f.delayLeave,ie=f.duration,le=g!==!1&&!Pt,ce=Br(O),de=zt(Ae(ie)?ie.leave:ie),oe=s._leaveCb=yi(function(){s.parentNode&&s.parentNode._pending&&(s.parentNode._pending[e.key]=null),le&&(Ze(s,b),Ze(s,T)),oe.cancelled?(le&&Ze(s,m),k&&k(s)):(i(),B&&B(s)),s._leaveCb=null});Z?Z(ae):ae();function ae(){oe.cancelled||(!e.data.show&&s.parentNode&&((s.parentNode._pending||(s.parentNode._pending={}))[e.key]=e),A&&A(s),le&&(pt(s,m),pt(s,T),to(function(){Ze(s,m),oe.cancelled||(pt(s,b),ce||(so(de)?setTimeout(oe,de):io(s,p,oe)))})),O&&O(s,oe),!le&&!ce&&oe())}}function so(e){return typeof e=="number"&&!isNaN(e)}function Br(e){if(he(e))return!1;var i=e.fns;return Y(i)?Br(Array.isArray(i)?i[0]:i):(e._length||e.length)>1}function Rn(e,i){i.data.show!==!0&&ur(i)}var vl=ke?{create:Rn,activate:Rn,remove:function(e,i){e.data.show!==!0?no(e,i):i()}}:{},yl=[tl,il,al,ul,_l,vl],Cl=yl.concat(el),bl=Kc({nodeOps:Xc,modules:Cl});Pt&&document.addEventListener("selectionchange",function(){var e=document.activeElement;e&&e.vmodel&&Nr(e,"input")});var oo={inserted:function(e,i,s,f){s.tag==="select"?(f.elm&&!f.elm._vOptions?et(s,"postpatch",function(){oo.componentUpdated(e,i,s)}):Pn(e,i,s.context),e._vOptions=[].map.call(e.options,Di)):(s.tag==="textarea"||lr(e.type))&&(e._vModifiers=i.modifiers,i.modifiers.lazy||(e.addEventListener("compositionstart",Sl),e.addEventListener("compositionend",kn),e.addEventListener("change",kn),Pt&&(e.vmodel=!0)))},componentUpdated:function(e,i,s){if(s.tag==="select"){Pn(e,i,s.context);var f=e._vOptions,g=e._vOptions=[].map.call(e.options,Di);if(g.some(function(m,b){return!mt(m,f[b])})){var p=e.multiple?i.value.some(function(m){return Ln(m,g)}):i.value!==i.oldValue&&Ln(i.value,g);p&&Nr(e,"change")}}}};function Pn(e,i,s){Mn(e,i),(Rt||mr)&&setTimeout(function(){Mn(e,i)},0)}function Mn(e,i,s){var f=i.value,g=e.multiple;if(!(g&&!Array.isArray(f))){for(var p,m,b=0,T=e.options.length;b<T;b++)if(m=e.options[b],g)p=ys(f,Di(m))>-1,m.selected!==p&&(m.selected=p);else if(mt(Di(m),f)){e.selectedIndex!==b&&(e.selectedIndex=b);return}g||(e.selectedIndex=-1)}}function Ln(e,i){return i.every(function(s){return!mt(s,e)})}function Di(e){return"_value"in e?e._value:e.value}function Sl(e){e.target.composing=!0}function kn(e){!e.target.composing||(e.target.composing=!1,Nr(e.target,"input"))}function Nr(e,i){var s=document.createEvent("HTMLEvents");s.initEvent(i,!0,!0),e.dispatchEvent(s)}function fr(e){return e.componentInstance&&(!e.data||!e.data.transition)?fr(e.componentInstance._vnode):e}var xl={bind:function(e,i,s){var f=i.value;s=fr(s);var g=s.data&&s.data.transition,p=e.__vOriginalDisplay=e.style.display==="none"?"":e.style.display;f&&g?(s.data.show=!0,ur(s,function(){e.style.display=p})):e.style.display=f?p:"none"},update:function(e,i,s){var f=i.value,g=i.oldValue;if(!f!=!g){s=fr(s);var p=s.data&&s.data.transition;p?(s.data.show=!0,f?ur(s,function(){e.style.display=e.__vOriginalDisplay}):no(s,function(){e.style.display="none"})):e.style.display=f?e.__vOriginalDisplay:"none"}},unbind:function(e,i,s,f,g){g||(e.style.display=e.__vOriginalDisplay)}},Tl={model:oo,show:xl},ao={name:String,appear:Boolean,css:Boolean,mode:String,type:String,enterClass:String,leaveClass:String,enterToClass:String,leaveToClass:String,enterActiveClass:String,leaveActiveClass:String,appearClass:String,appearActiveClass:String,appearToClass:String,duration:[Number,String,Object]};function dr(e){var i=e&&e.componentOptions;return i&&i.Ctor.options.abstract?dr(Ls(i.children)):e}function co(e){var i={},s=e.$options;for(var f in s.propsData)i[f]=e[f];var g=s._parentListeners;for(var f in g)i[_t(f)]=g[f];return i}function Fn(e,i){if(/\d-keep-alive$/.test(i.tag))return e("keep-alive",{props:i.componentOptions.propsData})}function wl(e){for(;e=e.parent;)if(e.data.transition)return!0}function Al(e,i){return i.key===e.key&&i.tag===e.tag}var Ol=function(e){return e.tag||Kt(e)},El=function(e){return e.name==="show"},Il={name:"transition",props:ao,abstract:!0,render:function(e){var i=this,s=this.$slots.default;if(!!s&&(s=s.filter(Ol),!!s.length)){var f=this.mode,g=s[0];if(wl(this.$vnode))return g;var p=dr(g);if(!p)return g;if(this._leaving)return Fn(e,g);var m="__transition-".concat(this._uid,"-");p.key=p.key==null?p.isComment?m+"comment":m+p.tag:Qt(p.key)?String(p.key).indexOf(m)===0?p.key:m+p.key:p.key;var b=(p.data||(p.data={})).transition=co(this),T=this._vnode,A=dr(T);if(p.data.directives&&p.data.directives.some(El)&&(p.data.show=!0),A&&A.data&&!Al(p,A)&&!Kt(A)&&!(A.componentInstance&&A.componentInstance._vnode.isComment)){var O=A.data.transition=ge({},b);if(f==="out-in")return this._leaving=!0,et(O,"afterLeave",function(){i._leaving=!1,i.$forceUpdate()}),Fn(e,g);if(f==="in-out"){if(Kt(p))return T;var B,k=function(){B()};et(b,"afterEnter",k),et(b,"enterCancelled",k),et(O,"delayLeave",function(Z){B=Z})}}return g}}},lo=ge({tag:String,moveClass:String},ao);delete lo.mode;var Dl={props:lo,beforeMount:function(){var e=this,i=this._update;this._update=function(s,f){var g=Ns(e);e.__patch__(e._vnode,e.kept,!1,!0),e._vnode=e.kept,g(),i.call(e,s,f)}},render:function(e){for(var i=this.tag||this.$vnode.data.tag||"span",s=Object.create(null),f=this.prevChildren=this.children,g=this.$slots.default||[],p=this.children=[],m=co(this),b=0;b<g.length;b++){var T=g[b];T.tag&&T.key!=null&&String(T.key).indexOf("__vlist")!==0&&(p.push(T),s[T.key]=T,(T.data||(T.data={})).transition=m)}if(f){for(var A=[],O=[],b=0;b<f.length;b++){var T=f[b];T.data.transition=m,T.data.pos=T.elm.getBoundingClientRect(),s[T.key]?A.push(T):O.push(T)}this.kept=e(i,null,A),this.removed=O}return e(i,null,p)},updated:function(){var e=this.prevChildren,i=this.moveClass||(this.name||"v")+"-move";!e.length||!this.hasMove(e[0].elm,i)||(e.forEach(Rl),e.forEach(Pl),e.forEach(Ml),this._reflow=document.body.offsetHeight,e.forEach(function(s){if(s.data.moved){var f=s.elm,g=f.style;pt(f,i),g.transform=g.WebkitTransform=g.transitionDuration="",f.addEventListener(Ii,f._moveCb=function p(m){m&&m.target!==f||(!m||/transform$/.test(m.propertyName))&&(f.removeEventListener(Ii,p),f._moveCb=null,Ze(f,i))})}}))},methods:{hasMove:function(e,i){if(!Qs)return!1;if(this._hasMove)return this._hasMove;var s=e.cloneNode();e._transitionClasses&&e._transitionClasses.forEach(function(g){Zs(s,g)}),qs(s,i),s.style.display="none",this.$el.appendChild(s);var f=ro(s);return this.$el.removeChild(s),this._hasMove=f.hasTransform}}};function Rl(e){e.elm._moveCb&&e.elm._moveCb(),e.elm._enterCb&&e.elm._enterCb()}function Pl(e){e.data.newPos=e.elm.getBoundingClientRect()}function Ml(e){var i=e.data.pos,s=e.data.newPos,f=i.left-s.left,g=i.top-s.top;if(f||g){e.data.moved=!0;var p=e.elm.style;p.transform=p.WebkitTransform="translate(".concat(f,"px,").concat(g,"px)"),p.transitionDuration="0s"}}var Ll={Transition:Il,TransitionGroup:Dl};Se.config.mustUseProp=Cc;Se.config.isReservedTag=Ys;Se.config.isReservedAttr=vc;Se.config.getTagNamespace=Dc;Se.config.isUnknownElement=Rc;ge(Se.options.directives,Tl);ge(Se.options.components,Ll);Se.prototype.__patch__=ke?bl:Te;Se.prototype.$mount=function(e,i){return e=e&&ke?Pc(e):void 0,Ta(this,e,i)};ke&&setTimeout(function(){Ne.devtools&&Ci&&Ci.emit("init",Se)},0);/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */function kl(e,i,s,f){e.prototype._pos=[0,0,0],e.prototype._orientation=[0,0,-1,0,1,0],e.prototype.stereo=function(p){var m=this;if(!m.ctx||!m.ctx.listener)return m;for(var b=m._howls.length-1;b>=0;b--)m._howls[b].stereo(p);return m},e.prototype.pos=function(p,m,b){var T=this;if(!T.ctx||!T.ctx.listener)return T;if(m=typeof m!="number"?T._pos[1]:m,b=typeof b!="number"?T._pos[2]:b,typeof p=="number")T._pos=[p,m,b],typeof T.ctx.listener.positionX<"u"?(T.ctx.listener.positionX.setTargetAtTime(T._pos[0],i.ctx.currentTime,.1),T.ctx.listener.positionY.setTargetAtTime(T._pos[1],i.ctx.currentTime,.1),T.ctx.listener.positionZ.setTargetAtTime(T._pos[2],i.ctx.currentTime,.1)):T.ctx.listener.setPosition(T._pos[0],T._pos[1],T._pos[2]);else return T._pos;return T},e.prototype.orientation=function(p,m,b,T,A,O){var B=this;if(!B.ctx||!B.ctx.listener)return B;var k=B._orientation;if(m=typeof m!="number"?k[1]:m,b=typeof b!="number"?k[2]:b,T=typeof T!="number"?k[3]:T,A=typeof A!="number"?k[4]:A,O=typeof O!="number"?k[5]:O,typeof p=="number")B._orientation=[p,m,b,T,A,O],typeof B.ctx.listener.forwardX<"u"?(B.ctx.listener.forwardX.setTargetAtTime(p,i.ctx.currentTime,.1),B.ctx.listener.forwardY.setTargetAtTime(m,i.ctx.currentTime,.1),B.ctx.listener.forwardZ.setTargetAtTime(b,i.ctx.currentTime,.1),B.ctx.listener.upX.setTargetAtTime(T,i.ctx.currentTime,.1),B.ctx.listener.upY.setTargetAtTime(A,i.ctx.currentTime,.1),B.ctx.listener.upZ.setTargetAtTime(O,i.ctx.currentTime,.1)):B.ctx.listener.setOrientation(p,m,b,T,A,O);else return k;return B},s.prototype.init=function(p){return function(m){var b=this;return b._orientation=m.orientation||[1,0,0],b._stereo=m.stereo||null,b._pos=m.pos||null,b._pannerAttr={coneInnerAngle:typeof m.coneInnerAngle<"u"?m.coneInnerAngle:360,coneOuterAngle:typeof m.coneOuterAngle<"u"?m.coneOuterAngle:360,coneOuterGain:typeof m.coneOuterGain<"u"?m.coneOuterGain:0,distanceModel:typeof m.distanceModel<"u"?m.distanceModel:"inverse",maxDistance:typeof m.maxDistance<"u"?m.maxDistance:1e4,panningModel:typeof m.panningModel<"u"?m.panningModel:"HRTF",refDistance:typeof m.refDistance<"u"?m.refDistance:1,rolloffFactor:typeof m.rolloffFactor<"u"?m.rolloffFactor:1},b._onstereo=m.onstereo?[{fn:m.onstereo}]:[],b._onpos=m.onpos?[{fn:m.onpos}]:[],b._onorientation=m.onorientation?[{fn:m.onorientation}]:[],p.call(this,m)}}(s.prototype.init),s.prototype.stereo=function(p,m){var b=this;if(!b._webAudio)return b;if(b._state!=="loaded")return b._queue.push({event:"stereo",action:function(){b.stereo(p,m)}}),b;var T=typeof i.ctx.createStereoPanner>"u"?"spatial":"stereo";if(typeof m>"u")if(typeof p=="number")b._stereo=p,b._pos=[p,0,0];else return b._stereo;for(var A=b._getSoundIds(m),O=0;O<A.length;O++){var B=b._soundById(A[O]);if(B)if(typeof p=="number")B._stereo=p,B._pos=[p,0,0],B._node&&(B._pannerAttr.panningModel="equalpower",(!B._panner||!B._panner.pan)&&g(B,T),T==="spatial"?typeof B._panner.positionX<"u"?(B._panner.positionX.setValueAtTime(p,i.ctx.currentTime),B._panner.positionY.setValueAtTime(0,i.ctx.currentTime),B._panner.positionZ.setValueAtTime(0,i.ctx.currentTime)):B._panner.setPosition(p,0,0):B._panner.pan.setValueAtTime(p,i.ctx.currentTime)),b._emit("stereo",B._id);else return B._stereo}return b},s.prototype.pos=function(p,m,b,T){var A=this;if(!A._webAudio)return A;if(A._state!=="loaded")return A._queue.push({event:"pos",action:function(){A.pos(p,m,b,T)}}),A;if(m=typeof m!="number"?0:m,b=typeof b!="number"?-.5:b,typeof T>"u")if(typeof p=="number")A._pos=[p,m,b];else return A._pos;for(var O=A._getSoundIds(T),B=0;B<O.length;B++){var k=A._soundById(O[B]);if(k)if(typeof p=="number")k._pos=[p,m,b],k._node&&((!k._panner||k._panner.pan)&&g(k,"spatial"),typeof k._panner.positionX<"u"?(k._panner.positionX.setValueAtTime(p,i.ctx.currentTime),k._panner.positionY.setValueAtTime(m,i.ctx.currentTime),k._panner.positionZ.setValueAtTime(b,i.ctx.currentTime)):k._panner.setPosition(p,m,b)),A._emit("pos",k._id);else return k._pos}return A},s.prototype.orientation=function(p,m,b,T){var A=this;if(!A._webAudio)return A;if(A._state!=="loaded")return A._queue.push({event:"orientation",action:function(){A.orientation(p,m,b,T)}}),A;if(m=typeof m!="number"?A._orientation[1]:m,b=typeof b!="number"?A._orientation[2]:b,typeof T>"u")if(typeof p=="number")A._orientation=[p,m,b];else return A._orientation;for(var O=A._getSoundIds(T),B=0;B<O.length;B++){var k=A._soundById(O[B]);if(k)if(typeof p=="number")k._orientation=[p,m,b],k._node&&(k._panner||(k._pos||(k._pos=A._pos||[0,0,-.5]),g(k,"spatial")),typeof k._panner.orientationX<"u"?(k._panner.orientationX.setValueAtTime(p,i.ctx.currentTime),k._panner.orientationY.setValueAtTime(m,i.ctx.currentTime),k._panner.orientationZ.setValueAtTime(b,i.ctx.currentTime)):k._panner.setOrientation(p,m,b)),A._emit("orientation",k._id);else return k._orientation}return A},s.prototype.pannerAttr=function(){var p=this,m=arguments,b,T,A;if(!p._webAudio)return p;if(m.length===0)return p._pannerAttr;if(m.length===1)if(typeof m[0]=="object")b=m[0],typeof T>"u"&&(b.pannerAttr||(b.pannerAttr={coneInnerAngle:b.coneInnerAngle,coneOuterAngle:b.coneOuterAngle,coneOuterGain:b.coneOuterGain,distanceModel:b.distanceModel,maxDistance:b.maxDistance,refDistance:b.refDistance,rolloffFactor:b.rolloffFactor,panningModel:b.panningModel}),p._pannerAttr={coneInnerAngle:typeof b.pannerAttr.coneInnerAngle<"u"?b.pannerAttr.coneInnerAngle:p._coneInnerAngle,coneOuterAngle:typeof b.pannerAttr.coneOuterAngle<"u"?b.pannerAttr.coneOuterAngle:p._coneOuterAngle,coneOuterGain:typeof b.pannerAttr.coneOuterGain<"u"?b.pannerAttr.coneOuterGain:p._coneOuterGain,distanceModel:typeof b.pannerAttr.distanceModel<"u"?b.pannerAttr.distanceModel:p._distanceModel,maxDistance:typeof b.pannerAttr.maxDistance<"u"?b.pannerAttr.maxDistance:p._maxDistance,refDistance:typeof b.pannerAttr.refDistance<"u"?b.pannerAttr.refDistance:p._refDistance,rolloffFactor:typeof b.pannerAttr.rolloffFactor<"u"?b.pannerAttr.rolloffFactor:p._rolloffFactor,panningModel:typeof b.pannerAttr.panningModel<"u"?b.pannerAttr.panningModel:p._panningModel});else return A=p._soundById(parseInt(m[0],10)),A?A._pannerAttr:p._pannerAttr;else m.length===2&&(b=m[0],T=parseInt(m[1],10));for(var O=p._getSoundIds(T),B=0;B<O.length;B++)if(A=p._soundById(O[B]),A){var k=A._pannerAttr;k={coneInnerAngle:typeof b.coneInnerAngle<"u"?b.coneInnerAngle:k.coneInnerAngle,coneOuterAngle:typeof b.coneOuterAngle<"u"?b.coneOuterAngle:k.coneOuterAngle,coneOuterGain:typeof b.coneOuterGain<"u"?b.coneOuterGain:k.coneOuterGain,distanceModel:typeof b.distanceModel<"u"?b.distanceModel:k.distanceModel,maxDistance:typeof b.maxDistance<"u"?b.maxDistance:k.maxDistance,refDistance:typeof b.refDistance<"u"?b.refDistance:k.refDistance,rolloffFactor:typeof b.rolloffFactor<"u"?b.rolloffFactor:k.rolloffFactor,panningModel:typeof b.panningModel<"u"?b.panningModel:k.panningModel};var Z=A._panner;Z||(A._pos||(A._pos=p._pos||[0,0,-.5]),g(A,"spatial"),Z=A._panner),Z.coneInnerAngle=k.coneInnerAngle,Z.coneOuterAngle=k.coneOuterAngle,Z.coneOuterGain=k.coneOuterGain,Z.distanceModel=k.distanceModel,Z.maxDistance=k.maxDistance,Z.refDistance=k.refDistance,Z.rolloffFactor=k.rolloffFactor,Z.panningModel=k.panningModel}return p},f.prototype.init=function(p){return function(){var m=this,b=m._parent;m._orientation=b._orientation,m._stereo=b._stereo,m._pos=b._pos,m._pannerAttr=b._pannerAttr,p.call(this),m._stereo?b.stereo(m._stereo):m._pos&&b.pos(m._pos[0],m._pos[1],m._pos[2],m._id)}}(f.prototype.init),f.prototype.reset=function(p){return function(){var m=this,b=m._parent;return m._orientation=b._orientation,m._stereo=b._stereo,m._pos=b._pos,m._pannerAttr=b._pannerAttr,m._stereo?b.stereo(m._stereo):m._pos?b.pos(m._pos[0],m._pos[1],m._pos[2],m._id):m._panner&&(m._panner.disconnect(0),m._panner=void 0,b._refreshBuffer(m)),p.call(this)}}(f.prototype.reset);var g=function(p,m){m=m||"spatial",m==="spatial"?(p._panner=i.ctx.createPanner(),p._panner.coneInnerAngle=p._pannerAttr.coneInnerAngle,p._panner.coneOuterAngle=p._pannerAttr.coneOuterAngle,p._panner.coneOuterGain=p._pannerAttr.coneOuterGain,p._panner.distanceModel=p._pannerAttr.distanceModel,p._panner.maxDistance=p._pannerAttr.maxDistance,p._panner.refDistance=p._pannerAttr.refDistance,p._panner.rolloffFactor=p._pannerAttr.rolloffFactor,p._panner.panningModel=p._pannerAttr.panningModel,typeof p._panner.positionX<"u"?(p._panner.positionX.setValueAtTime(p._pos[0],i.ctx.currentTime),p._panner.positionY.setValueAtTime(p._pos[1],i.ctx.currentTime),p._panner.positionZ.setValueAtTime(p._pos[2],i.ctx.currentTime)):p._panner.setPosition(p._pos[0],p._pos[1],p._pos[2]),typeof p._panner.orientationX<"u"?(p._panner.orientationX.setValueAtTime(p._orientation[0],i.ctx.currentTime),p._panner.orientationY.setValueAtTime(p._orientation[1],i.ctx.currentTime),p._panner.orientationZ.setValueAtTime(p._orientation[2],i.ctx.currentTime)):p._panner.setOrientation(p._orientation[0],p._orientation[1],p._orientation[2])):(p._panner=i.ctx.createStereoPanner(),p._panner.pan.setValueAtTime(p._stereo,i.ctx.currentTime)),p._panner.connect(p._node),p._paused||p._parent.pause(p._id,!0).play(p._id,!0)}}/*!
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */var jr=function(){this.init()};jr.prototype={init:function(){var e=this||K;return e._counter=1e3,e._html5AudioPool=[],e.html5PoolSize=10,e._codecs={},e._howls=[],e._muted=!1,e._volume=1,e._canPlayEvent="canplaythrough",e._navigator=typeof window<"u"&&window.navigator?window.navigator:null,e.masterGain=null,e.noAudio=!1,e.usingWebAudio=!0,e.autoSuspend=!0,e.ctx=null,e.autoUnlock=!0,e._setup(),e},volume:function(e){var i=this||K;if(e=parseFloat(e),i.ctx||vi(),typeof e<"u"&&e>=0&&e<=1){if(i._volume=e,i._muted)return i;i.usingWebAudio&&i.masterGain.gain.setValueAtTime(e,K.ctx.currentTime);for(var s=0;s<i._howls.length;s++)if(!i._howls[s]._webAudio)for(var f=i._howls[s]._getSoundIds(),g=0;g<f.length;g++){var p=i._howls[s]._soundById(f[g]);p&&p._node&&(p._node.volume=p._volume*e)}return i}return i._volume},mute:function(e){var i=this||K;i.ctx||vi(),i._muted=e,i.usingWebAudio&&i.masterGain.gain.setValueAtTime(e?0:i._volume,K.ctx.currentTime);for(var s=0;s<i._howls.length;s++)if(!i._howls[s]._webAudio)for(var f=i._howls[s]._getSoundIds(),g=0;g<f.length;g++){var p=i._howls[s]._soundById(f[g]);p&&p._node&&(p._node.muted=e?!0:p._muted)}return i},stop:function(){for(var e=this||K,i=0;i<e._howls.length;i++)e._howls[i].stop();return e},unload:function(){for(var e=this||K,i=e._howls.length-1;i>=0;i--)e._howls[i].unload();return e.usingWebAudio&&e.ctx&&typeof e.ctx.close<"u"&&(e.ctx.close(),e.ctx=null,vi()),e},codecs:function(e){return(this||K)._codecs[e.replace(/^x-/,"")]},_setup:function(){var e=this||K;if(e.state=e.ctx&&e.ctx.state||"suspended",e._autoSuspend(),!e.usingWebAudio)if(typeof Audio<"u")try{var i=new Audio;typeof i.oncanplaythrough>"u"&&(e._canPlayEvent="canplay")}catch(s){e.noAudio=!0}else e.noAudio=!0;try{var i=new Audio;i.muted&&(e.noAudio=!0)}catch(s){}return e.noAudio||e._setupCodecs(),e},_setupCodecs:function(){var e=this||K,i=null;try{i=typeof Audio<"u"?new Audio:null}catch(A){return e}if(!i||typeof i.canPlayType!="function")return e;var s=i.canPlayType("audio/mpeg;").replace(/^no$/,""),f=e._navigator?e._navigator.userAgent:"",g=f.match(/OPR\/([0-6].)/g),p=g&&parseInt(g[0].split("/")[1],10)<33,m=f.indexOf("Safari")!==-1&&f.indexOf("Chrome")===-1,b=f.match(/Version\/(.*?) /),T=m&&b&&parseInt(b[1],10)<15;return e._codecs={mp3:!!(!p&&(s||i.canPlayType("audio/mp3;").replace(/^no$/,""))),mpeg:!!s,opus:!!i.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!i.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!i.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(i.canPlayType('audio/wav; codecs="1"')||i.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!i.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!i.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(i.canPlayType("audio/x-m4a;")||i.canPlayType("audio/m4a;")||i.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(i.canPlayType("audio/x-m4b;")||i.canPlayType("audio/m4b;")||i.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(i.canPlayType("audio/x-mp4;")||i.canPlayType("audio/mp4;")||i.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!!(!T&&i.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!!(!T&&i.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!i.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(i.canPlayType("audio/x-flac;")||i.canPlayType("audio/flac;")).replace(/^no$/,"")},e},_unlockAudio:function(){var e=this||K;if(!(e._audioUnlocked||!e.ctx)){e._audioUnlocked=!1,e.autoUnlock=!1,!e._mobileUnloaded&&e.ctx.sampleRate!==44100&&(e._mobileUnloaded=!0,e.unload()),e._scratchBuffer=e.ctx.createBuffer(1,1,22050);var i=function(s){for(;e._html5AudioPool.length<e.html5PoolSize;)try{var f=new Audio;f._unlocked=!0,e._releaseHtml5Audio(f)}catch(A){e.noAudio=!0;break}for(var g=0;g<e._howls.length;g++)if(!e._howls[g]._webAudio)for(var p=e._howls[g]._getSoundIds(),m=0;m<p.length;m++){var b=e._howls[g]._soundById(p[m]);b&&b._node&&!b._node._unlocked&&(b._node._unlocked=!0,b._node.load())}e._autoResume();var T=e.ctx.createBufferSource();T.buffer=e._scratchBuffer,T.connect(e.ctx.destination),typeof T.start>"u"?T.noteOn(0):T.start(0),typeof e.ctx.resume=="function"&&e.ctx.resume(),T.onended=function(){T.disconnect(0),e._audioUnlocked=!0,document.removeEventListener("touchstart",i,!0),document.removeEventListener("touchend",i,!0),document.removeEventListener("click",i,!0),document.removeEventListener("keydown",i,!0);for(var A=0;A<e._howls.length;A++)e._howls[A]._emit("unlock")}};return document.addEventListener("touchstart",i,!0),document.addEventListener("touchend",i,!0),document.addEventListener("click",i,!0),document.addEventListener("keydown",i,!0),e}},_obtainHtml5Audio:function(){var e=this||K;if(e._html5AudioPool.length)return e._html5AudioPool.pop();var i=new Audio().play();return i&&typeof Promise<"u"&&(i instanceof Promise||typeof i.then=="function")&&i.catch(function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")}),new Audio},_releaseHtml5Audio:function(e){var i=this||K;return e._unlocked&&i._html5AudioPool.push(e),i},_autoSuspend:function(){var e=this;if(!(!e.autoSuspend||!e.ctx||typeof e.ctx.suspend>"u"||!K.usingWebAudio)){for(var i=0;i<e._howls.length;i++)if(e._howls[i]._webAudio){for(var s=0;s<e._howls[i]._sounds.length;s++)if(!e._howls[i]._sounds[s]._paused)return e}return e._suspendTimer&&clearTimeout(e._suspendTimer),e._suspendTimer=setTimeout(function(){if(!!e.autoSuspend){e._suspendTimer=null,e.state="suspending";var f=function(){e.state="suspended",e._resumeAfterSuspend&&(delete e._resumeAfterSuspend,e._autoResume())};e.ctx.suspend().then(f,f)}},3e4),e}},_autoResume:function(){var e=this;if(!(!e.ctx||typeof e.ctx.resume>"u"||!K.usingWebAudio))return e.state==="running"&&e.ctx.state!=="interrupted"&&e._suspendTimer?(clearTimeout(e._suspendTimer),e._suspendTimer=null):e.state==="suspended"||e.state==="running"&&e.ctx.state==="interrupted"?(e.ctx.resume().then(function(){e.state="running";for(var i=0;i<e._howls.length;i++)e._howls[i]._emit("resume")}),e._suspendTimer&&(clearTimeout(e._suspendTimer),e._suspendTimer=null)):e.state==="suspending"&&(e._resumeAfterSuspend=!0),e}};var K=new jr,Ri=function(e){var i=this;if(!e.src||e.src.length===0){console.error("An array of source files must be passed with any new Howl.");return}i.init(e)};Ri.prototype={init:function(e){var i=this;return K.ctx||vi(),i._autoplay=e.autoplay||!1,i._format=typeof e.format!="string"?e.format:[e.format],i._html5=e.html5||!1,i._muted=e.mute||!1,i._loop=e.loop||!1,i._pool=e.pool||5,i._preload=typeof e.preload=="boolean"||e.preload==="metadata"?e.preload:!0,i._rate=e.rate||1,i._sprite=e.sprite||{},i._src=typeof e.src!="string"?e.src:[e.src],i._volume=e.volume!==void 0?e.volume:1,i._xhr={method:e.xhr&&e.xhr.method?e.xhr.method:"GET",headers:e.xhr&&e.xhr.headers?e.xhr.headers:null,withCredentials:e.xhr&&e.xhr.withCredentials?e.xhr.withCredentials:!1},i._duration=0,i._state="unloaded",i._sounds=[],i._endTimers={},i._queue=[],i._playLock=!1,i._onend=e.onend?[{fn:e.onend}]:[],i._onfade=e.onfade?[{fn:e.onfade}]:[],i._onload=e.onload?[{fn:e.onload}]:[],i._onloaderror=e.onloaderror?[{fn:e.onloaderror}]:[],i._onplayerror=e.onplayerror?[{fn:e.onplayerror}]:[],i._onpause=e.onpause?[{fn:e.onpause}]:[],i._onplay=e.onplay?[{fn:e.onplay}]:[],i._onstop=e.onstop?[{fn:e.onstop}]:[],i._onmute=e.onmute?[{fn:e.onmute}]:[],i._onvolume=e.onvolume?[{fn:e.onvolume}]:[],i._onrate=e.onrate?[{fn:e.onrate}]:[],i._onseek=e.onseek?[{fn:e.onseek}]:[],i._onunlock=e.onunlock?[{fn:e.onunlock}]:[],i._onresume=[],i._webAudio=K.usingWebAudio&&!i._html5,typeof K.ctx<"u"&&K.ctx&&K.autoUnlock&&K._unlockAudio(),K._howls.push(i),i._autoplay&&i._queue.push({event:"play",action:function(){i.play()}}),i._preload&&i._preload!=="none"&&i.load(),i},load:function(){var e=this,i=null;if(K.noAudio){e._emit("loaderror",null,"No audio support.");return}typeof e._src=="string"&&(e._src=[e._src]);for(var s=0;s<e._src.length;s++){var f,g;if(e._format&&e._format[s])f=e._format[s];else{if(g=e._src[s],typeof g!="string"){e._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}f=/^data:audio\/([^;,]+);/i.exec(g),f||(f=/\.([^.]+)$/.exec(g.split("?",1)[0])),f&&(f=f[1].toLowerCase())}if(f||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),f&&K.codecs(f)){i=e._src[s];break}}if(!i){e._emit("loaderror",null,"No codec support for selected audio sources.");return}return e._src=i,e._state="loading",window.location.protocol==="https:"&&i.slice(0,5)==="http:"&&(e._html5=!0,e._webAudio=!1),new Pi(e),e._webAudio&&Fl(e),e},play:function(e,i){var s=this,f=null;if(typeof e=="number")f=e,e=null;else{if(typeof e=="string"&&s._state==="loaded"&&!s._sprite[e])return null;if(typeof e>"u"&&(e="__default",!s._playLock)){for(var g=0,p=0;p<s._sounds.length;p++)s._sounds[p]._paused&&!s._sounds[p]._ended&&(g++,f=s._sounds[p]._id);g===1?e=null:f=null}}var m=f?s._soundById(f):s._inactiveSound();if(!m)return null;if(f&&!e&&(e=m._sprite||"__default"),s._state!=="loaded"){m._sprite=e,m._ended=!1;var b=m._id;return s._queue.push({event:"play",action:function(){s.play(b)}}),b}if(f&&!m._paused)return i||s._loadQueue("play"),m._id;s._webAudio&&K._autoResume();var T=Math.max(0,m._seek>0?m._seek:s._sprite[e][0]/1e3),A=Math.max(0,(s._sprite[e][0]+s._sprite[e][1])/1e3-T),O=A*1e3/Math.abs(m._rate),B=s._sprite[e][0]/1e3,k=(s._sprite[e][0]+s._sprite[e][1])/1e3;m._sprite=e,m._ended=!1;var Z=function(){m._paused=!1,m._seek=T,m._start=B,m._stop=k,m._loop=!!(m._loop||s._sprite[e][2])};if(T>=k){s._ended(m);return}var ie=m._node;if(s._webAudio){var le=function(){s._playLock=!1,Z(),s._refreshBuffer(m);var ae=m._muted||s._muted?0:m._volume;ie.gain.setValueAtTime(ae,K.ctx.currentTime),m._playStart=K.ctx.currentTime,typeof ie.bufferSource.start>"u"?m._loop?ie.bufferSource.noteGrainOn(0,T,86400):ie.bufferSource.noteGrainOn(0,T,A):m._loop?ie.bufferSource.start(0,T,86400):ie.bufferSource.start(0,T,A),O!==1/0&&(s._endTimers[m._id]=setTimeout(s._ended.bind(s,m),O)),i||setTimeout(function(){s._emit("play",m._id),s._loadQueue()},0)};K.state==="running"&&K.ctx.state!=="interrupted"?le():(s._playLock=!0,s.once("resume",le),s._clearTimer(m._id))}else{var ce=function(){ie.currentTime=T,ie.muted=m._muted||s._muted||K._muted||ie.muted,ie.volume=m._volume*K.volume(),ie.playbackRate=m._rate;try{var ae=ie.play();if(ae&&typeof Promise<"u"&&(ae instanceof Promise||typeof ae.then=="function")?(s._playLock=!0,Z(),ae.then(function(){s._playLock=!1,ie._unlocked=!0,i?s._loadQueue():s._emit("play",m._id)}).catch(function(){s._playLock=!1,s._emit("playerror",m._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),m._ended=!0,m._paused=!0})):i||(s._playLock=!1,Z(),s._emit("play",m._id)),ie.playbackRate=m._rate,ie.paused){s._emit("playerror",m._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");return}e!=="__default"||m._loop?s._endTimers[m._id]=setTimeout(s._ended.bind(s,m),O):(s._endTimers[m._id]=function(){s._ended(m),ie.removeEventListener("ended",s._endTimers[m._id],!1)},ie.addEventListener("ended",s._endTimers[m._id],!1))}catch(ve){s._emit("playerror",m._id,ve)}};ie.src==="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"&&(ie.src=s._src,ie.load());var de=window&&window.ejecta||!ie.readyState&&K._navigator.isCocoonJS;if(ie.readyState>=3||de)ce();else{s._playLock=!0,s._state="loading";var oe=function(){s._state="loaded",ce(),ie.removeEventListener(K._canPlayEvent,oe,!1)};ie.addEventListener(K._canPlayEvent,oe,!1),s._clearTimer(m._id)}}return m._id},pause:function(e){var i=this;if(i._state!=="loaded"||i._playLock)return i._queue.push({event:"pause",action:function(){i.pause(e)}}),i;for(var s=i._getSoundIds(e),f=0;f<s.length;f++){i._clearTimer(s[f]);var g=i._soundById(s[f]);if(g&&!g._paused&&(g._seek=i.seek(s[f]),g._rateSeek=0,g._paused=!0,i._stopFade(s[f]),g._node))if(i._webAudio){if(!g._node.bufferSource)continue;typeof g._node.bufferSource.stop>"u"?g._node.bufferSource.noteOff(0):g._node.bufferSource.stop(0),i._cleanBuffer(g._node)}else(!isNaN(g._node.duration)||g._node.duration===1/0)&&g._node.pause();arguments[1]||i._emit("pause",g?g._id:null)}return i},stop:function(e,i){var s=this;if(s._state!=="loaded"||s._playLock)return s._queue.push({event:"stop",action:function(){s.stop(e)}}),s;for(var f=s._getSoundIds(e),g=0;g<f.length;g++){s._clearTimer(f[g]);var p=s._soundById(f[g]);p&&(p._seek=p._start||0,p._rateSeek=0,p._paused=!0,p._ended=!0,s._stopFade(f[g]),p._node&&(s._webAudio?p._node.bufferSource&&(typeof p._node.bufferSource.stop>"u"?p._node.bufferSource.noteOff(0):p._node.bufferSource.stop(0),s._cleanBuffer(p._node)):(!isNaN(p._node.duration)||p._node.duration===1/0)&&(p._node.currentTime=p._start||0,p._node.pause(),p._node.duration===1/0&&s._clearSound(p._node))),i||s._emit("stop",p._id))}return s},mute:function(e,i){var s=this;if(s._state!=="loaded"||s._playLock)return s._queue.push({event:"mute",action:function(){s.mute(e,i)}}),s;if(typeof i>"u")if(typeof e=="boolean")s._muted=e;else return s._muted;for(var f=s._getSoundIds(i),g=0;g<f.length;g++){var p=s._soundById(f[g]);p&&(p._muted=e,p._interval&&s._stopFade(p._id),s._webAudio&&p._node?p._node.gain.setValueAtTime(e?0:p._volume,K.ctx.currentTime):p._node&&(p._node.muted=K._muted?!0:e),s._emit("mute",p._id))}return s},volume:function(){var e=this,i=arguments,s,f;if(i.length===0)return e._volume;if(i.length===1||i.length===2&&typeof i[1]>"u"){var g=e._getSoundIds(),p=g.indexOf(i[0]);p>=0?f=parseInt(i[0],10):s=parseFloat(i[0])}else i.length>=2&&(s=parseFloat(i[0]),f=parseInt(i[1],10));var m;if(typeof s<"u"&&s>=0&&s<=1){if(e._state!=="loaded"||e._playLock)return e._queue.push({event:"volume",action:function(){e.volume.apply(e,i)}}),e;typeof f>"u"&&(e._volume=s),f=e._getSoundIds(f);for(var b=0;b<f.length;b++)m=e._soundById(f[b]),m&&(m._volume=s,i[2]||e._stopFade(f[b]),e._webAudio&&m._node&&!m._muted?m._node.gain.setValueAtTime(s,K.ctx.currentTime):m._node&&!m._muted&&(m._node.volume=s*K.volume()),e._emit("volume",m._id))}else return m=f?e._soundById(f):e._sounds[0],m?m._volume:0;return e},fade:function(e,i,s,f){var g=this;if(g._state!=="loaded"||g._playLock)return g._queue.push({event:"fade",action:function(){g.fade(e,i,s,f)}}),g;e=Math.min(Math.max(0,parseFloat(e)),1),i=Math.min(Math.max(0,parseFloat(i)),1),s=parseFloat(s),g.volume(e,f);for(var p=g._getSoundIds(f),m=0;m<p.length;m++){var b=g._soundById(p[m]);if(b){if(f||g._stopFade(p[m]),g._webAudio&&!b._muted){var T=K.ctx.currentTime,A=T+s/1e3;b._volume=e,b._node.gain.setValueAtTime(e,T),b._node.gain.linearRampToValueAtTime(i,A)}g._startFadeInterval(b,e,i,s,p[m],typeof f>"u")}}return g},_startFadeInterval:function(e,i,s,f,g,p){var m=this,b=i,T=s-i,A=Math.abs(T/.01),O=Math.max(4,A>0?f/A:f),B=Date.now();e._fadeTo=s,e._interval=setInterval(function(){var k=(Date.now()-B)/f;B=Date.now(),b+=T*k,b=Math.round(b*100)/100,T<0?b=Math.max(s,b):b=Math.min(s,b),m._webAudio?e._volume=b:m.volume(b,e._id,!0),p&&(m._volume=b),(s<i&&b<=s||s>i&&b>=s)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,m.volume(s,e._id),m._emit("fade",e._id))},O)},_stopFade:function(e){var i=this,s=i._soundById(e);return s&&s._interval&&(i._webAudio&&s._node.gain.cancelScheduledValues(K.ctx.currentTime),clearInterval(s._interval),s._interval=null,i.volume(s._fadeTo,e),s._fadeTo=null,i._emit("fade",e)),i},loop:function(){var e=this,i=arguments,s,f,g;if(i.length===0)return e._loop;if(i.length===1)if(typeof i[0]=="boolean")s=i[0],e._loop=s;else return g=e._soundById(parseInt(i[0],10)),g?g._loop:!1;else i.length===2&&(s=i[0],f=parseInt(i[1],10));for(var p=e._getSoundIds(f),m=0;m<p.length;m++)g=e._soundById(p[m]),g&&(g._loop=s,e._webAudio&&g._node&&g._node.bufferSource&&(g._node.bufferSource.loop=s,s&&(g._node.bufferSource.loopStart=g._start||0,g._node.bufferSource.loopEnd=g._stop,e.playing(p[m])&&(e.pause(p[m],!0),e.play(p[m],!0)))));return e},rate:function(){var e=this,i=arguments,s,f;if(i.length===0)f=e._sounds[0]._id;else if(i.length===1){var g=e._getSoundIds(),p=g.indexOf(i[0]);p>=0?f=parseInt(i[0],10):s=parseFloat(i[0])}else i.length===2&&(s=parseFloat(i[0]),f=parseInt(i[1],10));var m;if(typeof s=="number"){if(e._state!=="loaded"||e._playLock)return e._queue.push({event:"rate",action:function(){e.rate.apply(e,i)}}),e;typeof f>"u"&&(e._rate=s),f=e._getSoundIds(f);for(var b=0;b<f.length;b++)if(m=e._soundById(f[b]),m){e.playing(f[b])&&(m._rateSeek=e.seek(f[b]),m._playStart=e._webAudio?K.ctx.currentTime:m._playStart),m._rate=s,e._webAudio&&m._node&&m._node.bufferSource?m._node.bufferSource.playbackRate.setValueAtTime(s,K.ctx.currentTime):m._node&&(m._node.playbackRate=s);var T=e.seek(f[b]),A=(e._sprite[m._sprite][0]+e._sprite[m._sprite][1])/1e3-T,O=A*1e3/Math.abs(m._rate);(e._endTimers[f[b]]||!m._paused)&&(e._clearTimer(f[b]),e._endTimers[f[b]]=setTimeout(e._ended.bind(e,m),O)),e._emit("rate",m._id)}}else return m=e._soundById(f),m?m._rate:e._rate;return e},seek:function(){var e=this,i=arguments,s,f;if(i.length===0)e._sounds.length&&(f=e._sounds[0]._id);else if(i.length===1){var g=e._getSoundIds(),p=g.indexOf(i[0]);p>=0?f=parseInt(i[0],10):e._sounds.length&&(f=e._sounds[0]._id,s=parseFloat(i[0]))}else i.length===2&&(s=parseFloat(i[0]),f=parseInt(i[1],10));if(typeof f>"u")return 0;if(typeof s=="number"&&(e._state!=="loaded"||e._playLock))return e._queue.push({event:"seek",action:function(){e.seek.apply(e,i)}}),e;var m=e._soundById(f);if(m)if(typeof s=="number"&&s>=0){var b=e.playing(f);b&&e.pause(f,!0),m._seek=s,m._ended=!1,e._clearTimer(f),!e._webAudio&&m._node&&!isNaN(m._node.duration)&&(m._node.currentTime=s);var T=function(){b&&e.play(f,!0),e._emit("seek",f)};if(b&&!e._webAudio){var A=function(){e._playLock?setTimeout(A,0):T()};setTimeout(A,0)}else T()}else if(e._webAudio){var O=e.playing(f)?K.ctx.currentTime-m._playStart:0,B=m._rateSeek?m._rateSeek-m._seek:0;return m._seek+(B+O*Math.abs(m._rate))}else return m._node.currentTime;return e},playing:function(e){var i=this;if(typeof e=="number"){var s=i._soundById(e);return s?!s._paused:!1}for(var f=0;f<i._sounds.length;f++)if(!i._sounds[f]._paused)return!0;return!1},duration:function(e){var i=this,s=i._duration,f=i._soundById(e);return f&&(s=i._sprite[f._sprite][1]/1e3),s},state:function(){return this._state},unload:function(){for(var e=this,i=e._sounds,s=0;s<i.length;s++)i[s]._paused||e.stop(i[s]._id),e._webAudio||(e._clearSound(i[s]._node),i[s]._node.removeEventListener("error",i[s]._errorFn,!1),i[s]._node.removeEventListener(K._canPlayEvent,i[s]._loadFn,!1),i[s]._node.removeEventListener("ended",i[s]._endFn,!1),K._releaseHtml5Audio(i[s]._node)),delete i[s]._node,e._clearTimer(i[s]._id);var f=K._howls.indexOf(e);f>=0&&K._howls.splice(f,1);var g=!0;for(s=0;s<K._howls.length;s++)if(K._howls[s]._src===e._src||e._src.indexOf(K._howls[s]._src)>=0){g=!1;break}return gt&&g&&delete gt[e._src],K.noAudio=!1,e._state="unloaded",e._sounds=[],e=null,null},on:function(e,i,s,f){var g=this,p=g["_on"+e];return typeof i=="function"&&p.push(f?{id:s,fn:i,once:f}:{id:s,fn:i}),g},off:function(e,i,s){var f=this,g=f["_on"+e],p=0;if(typeof i=="number"&&(s=i,i=null),i||s)for(p=0;p<g.length;p++){var m=s===g[p].id;if(i===g[p].fn&&m||!i&&m){g.splice(p,1);break}}else if(e)f["_on"+e]=[];else{var b=Object.keys(f);for(p=0;p<b.length;p++)b[p].indexOf("_on")===0&&Array.isArray(f[b[p]])&&(f[b[p]]=[])}return f},once:function(e,i,s){var f=this;return f.on(e,i,s,1),f},_emit:function(e,i,s){for(var f=this,g=f["_on"+e],p=g.length-1;p>=0;p--)(!g[p].id||g[p].id===i||e==="load")&&(setTimeout(function(m){m.call(this,i,s)}.bind(f,g[p].fn),0),g[p].once&&f.off(e,g[p].fn,g[p].id));return f._loadQueue(e),f},_loadQueue:function(e){var i=this;if(i._queue.length>0){var s=i._queue[0];s.event===e&&(i._queue.shift(),i._loadQueue()),e||s.action()}return i},_ended:function(e){var i=this,s=e._sprite;if(!i._webAudio&&e._node&&!e._node.paused&&!e._node.ended&&e._node.currentTime<e._stop)return setTimeout(i._ended.bind(i,e),100),i;var f=!!(e._loop||i._sprite[s][2]);if(i._emit("end",e._id),!i._webAudio&&f&&i.stop(e._id,!0).play(e._id),i._webAudio&&f){i._emit("play",e._id),e._seek=e._start||0,e._rateSeek=0,e._playStart=K.ctx.currentTime;var g=(e._stop-e._start)*1e3/Math.abs(e._rate);i._endTimers[e._id]=setTimeout(i._ended.bind(i,e),g)}return i._webAudio&&!f&&(e._paused=!0,e._ended=!0,e._seek=e._start||0,e._rateSeek=0,i._clearTimer(e._id),i._cleanBuffer(e._node),K._autoSuspend()),!i._webAudio&&!f&&i.stop(e._id,!0),i},_clearTimer:function(e){var i=this;if(i._endTimers[e]){if(typeof i._endTimers[e]!="function")clearTimeout(i._endTimers[e]);else{var s=i._soundById(e);s&&s._node&&s._node.removeEventListener("ended",i._endTimers[e],!1)}delete i._endTimers[e]}return i},_soundById:function(e){for(var i=this,s=0;s<i._sounds.length;s++)if(e===i._sounds[s]._id)return i._sounds[s];return null},_inactiveSound:function(){var e=this;e._drain();for(var i=0;i<e._sounds.length;i++)if(e._sounds[i]._ended)return e._sounds[i].reset();return new Pi(e)},_drain:function(){var e=this,i=e._pool,s=0,f=0;if(!(e._sounds.length<i)){for(f=0;f<e._sounds.length;f++)e._sounds[f]._ended&&s++;for(f=e._sounds.length-1;f>=0;f--){if(s<=i)return;e._sounds[f]._ended&&(e._webAudio&&e._sounds[f]._node&&e._sounds[f]._node.disconnect(0),e._sounds.splice(f,1),s--)}}},_getSoundIds:function(e){var i=this;if(typeof e>"u"){for(var s=[],f=0;f<i._sounds.length;f++)s.push(i._sounds[f]._id);return s}else return[e]},_refreshBuffer:function(e){var i=this;return e._node.bufferSource=K.ctx.createBufferSource(),e._node.bufferSource.buffer=gt[i._src],e._panner?e._node.bufferSource.connect(e._panner):e._node.bufferSource.connect(e._node),e._node.bufferSource.loop=e._loop,e._loop&&(e._node.bufferSource.loopStart=e._start||0,e._node.bufferSource.loopEnd=e._stop||0),e._node.bufferSource.playbackRate.setValueAtTime(e._rate,K.ctx.currentTime),i},_cleanBuffer:function(e){var i=this,s=K._navigator&&K._navigator.vendor.indexOf("Apple")>=0;if(!e.bufferSource)return i;if(K._scratchBuffer&&e.bufferSource&&(e.bufferSource.onended=null,e.bufferSource.disconnect(0),s))try{e.bufferSource.buffer=K._scratchBuffer}catch(f){}return e.bufferSource=null,i},_clearSound:function(e){var i=/MSIE |Trident\//.test(K._navigator&&K._navigator.userAgent);i||(e.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var Pi=function(e){this._parent=e,this.init()};Pi.prototype={init:function(){var e=this,i=e._parent;return e._muted=i._muted,e._loop=i._loop,e._volume=i._volume,e._rate=i._rate,e._seek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++K._counter,i._sounds.push(e),e.create(),e},create:function(){var e=this,i=e._parent,s=K._muted||e._muted||e._parent._muted?0:e._volume;return i._webAudio?(e._node=typeof K.ctx.createGain>"u"?K.ctx.createGainNode():K.ctx.createGain(),e._node.gain.setValueAtTime(s,K.ctx.currentTime),e._node.paused=!0,e._node.connect(K.masterGain)):K.noAudio||(e._node=K._obtainHtml5Audio(),e._errorFn=e._errorListener.bind(e),e._node.addEventListener("error",e._errorFn,!1),e._loadFn=e._loadListener.bind(e),e._node.addEventListener(K._canPlayEvent,e._loadFn,!1),e._endFn=e._endListener.bind(e),e._node.addEventListener("ended",e._endFn,!1),e._node.src=i._src,e._node.preload=i._preload===!0?"auto":i._preload,e._node.volume=s*K.volume(),e._node.load()),e},reset:function(){var e=this,i=e._parent;return e._muted=i._muted,e._loop=i._loop,e._volume=i._volume,e._rate=i._rate,e._seek=0,e._rateSeek=0,e._paused=!0,e._ended=!0,e._sprite="__default",e._id=++K._counter,e},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var e=this,i=e._parent;i._duration=Math.ceil(e._node.duration*10)/10,Object.keys(i._sprite).length===0&&(i._sprite={__default:[0,i._duration*1e3]}),i._state!=="loaded"&&(i._state="loaded",i._emit("load"),i._loadQueue()),e._node.removeEventListener(K._canPlayEvent,e._loadFn,!1)},_endListener:function(){var e=this,i=e._parent;i._duration===1/0&&(i._duration=Math.ceil(e._node.duration*10)/10,i._sprite.__default[1]===1/0&&(i._sprite.__default[1]=i._duration*1e3),i._ended(e)),e._node.removeEventListener("ended",e._endFn,!1)}};var gt={},Fl=function(e){var i=e._src;if(gt[i]){e._duration=gt[i].duration,ho(e);return}if(/^data:[^;]+;base64,/.test(i)){for(var s=atob(i.split(",")[1]),f=new Uint8Array(s.length),g=0;g<s.length;++g)f[g]=s.charCodeAt(g);Bn(f.buffer,e)}else{var p=new XMLHttpRequest;p.open(e._xhr.method,i,!0),p.withCredentials=e._xhr.withCredentials,p.responseType="arraybuffer",e._xhr.headers&&Object.keys(e._xhr.headers).forEach(function(m){p.setRequestHeader(m,e._xhr.headers[m])}),p.onload=function(){var m=(p.status+"")[0];if(m!=="0"&&m!=="2"&&m!=="3"){e._emit("loaderror",null,"Failed loading audio file with status: "+p.status+".");return}Bn(p.response,e)},p.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete gt[i],e.load())},Bl(p)}},Bl=function(e){try{e.send()}catch(i){e.onerror()}},Bn=function(e,i){var s=function(){i._emit("loaderror",null,"Decoding audio data failed.")},f=function(g){g&&i._sounds.length>0?(gt[i._src]=g,ho(i,g)):s()};typeof Promise<"u"&&K.ctx.decodeAudioData.length===1?K.ctx.decodeAudioData(e).then(f).catch(s):K.ctx.decodeAudioData(e,f,s)},ho=function(e,i){i&&!e._duration&&(e._duration=i.duration),Object.keys(e._sprite).length===0&&(e._sprite={__default:[0,e._duration*1e3]}),e._state!=="loaded"&&(e._state="loaded",e._emit("load"),e._loadQueue())},vi=function(){if(!!K.usingWebAudio){try{typeof AudioContext<"u"?K.ctx=new AudioContext:typeof webkitAudioContext<"u"?K.ctx=new webkitAudioContext:K.usingWebAudio=!1}catch(g){K.usingWebAudio=!1}K.ctx||(K.usingWebAudio=!1);var e=/iP(hone|od|ad)/.test(K._navigator&&K._navigator.platform),i=K._navigator&&K._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),s=i?parseInt(i[1],10):null;if(e&&s&&s<9){var f=/safari/.test(K._navigator&&K._navigator.userAgent.toLowerCase());K._navigator&&!f&&(K.usingWebAudio=!1)}K.usingWebAudio&&(K.masterGain=typeof K.ctx.createGain>"u"?K.ctx.createGainNode():K.ctx.createGain(),K.masterGain.gain.setValueAtTime(K._muted?0:K._volume,K.ctx.currentTime),K.masterGain.connect(K.ctx.destination)),K._setup()}};kl(jr,K,Ri,Pi);/*!
 * Dynamsoft JavaScript Library
 * @product Dynamsoft Barcode Reader JS Edition
 * @website http://www.dynamsoft.com
 * @copyright Copyright 2023, Dynamsoft Corporation
 * @author Dynamsoft
 * @version 9.6.32 (js 20231027)
 * @fileoverview Dynamsoft JavaScript Library for Barcode Reader
 * More info on DBR JS: https://www.dynamsoft.com/barcode-reader/sdk-javascript/
 */const ct=typeof self>"u",Nn=ct?{}:self;let Gt,$e,fi,Mi,we;if(typeof navigator<"u"&&(Gt=navigator,$e=Gt.userAgent,fi=Gt.platform,Mi=Gt.mediaDevices),!ct){const e={Edge:{search:"Edg",verSearch:"Edg"},OPR:null,Chrome:null,Safari:{str:Gt.vendor,search:"Apple",verSearch:["Version","iPhone OS","CPU OS"]},Firefox:null,Explorer:{search:"MSIE",verSearch:"MSIE"}},i={HarmonyOS:null,Android:null,iPhone:null,iPad:null,Windows:{str:fi,search:"Win"},Mac:{str:fi},Linux:{str:fi}};let s="unknownBrowser",f=0,g="unknownOS";for(let p in e){const m=e[p]||{};let b=m.str||$e,T=m.search||p,A=m.verStr||$e,O=m.verSearch||p;if(O instanceof Array||(O=[O]),b.indexOf(T)!=-1){s=p;for(let B of O){let k=A.indexOf(B);if(k!=-1){f=parseFloat(A.substring(k+B.length+1));break}}break}}for(let p in i){const m=i[p]||{};let b=m.str||$e,T=m.search||p;if(b.indexOf(T)!=-1){g=p;break}}g=="Linux"&&$e.indexOf("Windows NT")!=-1&&(g="HarmonyOS"),we={browser:s,version:f,OS:g}}ct&&(we={browser:"ssr",version:0,OS:"ssr"});const Nl=typeof WebAssembly<"u"&&$e&&!(/Safari/.test($e)&&!/Chrome/.test($e)&&/\(.+\s11_2_([2-6]).*\)/.test($e)),jl=!(typeof Worker>"u"),uo=!(!Mi||!Mi.getUserMedia),Ul=async()=>{let e=!1;if(uo)try{(await Mi.getUserMedia({video:!0})).getTracks().forEach(i=>{i.stop()}),e=!0}catch(i){}return e};we.browser==="Chrome"&&we.version>66||we.browser==="Safari"&&we.version>13||we.browser==="OPR"&&we.version>43||we.browser==="Edge"&&we.version;const Gl=(()=>{if(!ct&&document.currentScript){let e=document.currentScript.src,i=e.indexOf("?");if(i!=-1)e=e.substring(0,i);else{let s=e.indexOf("#");s!=-1&&(e=e.substring(0,s))}return e.substring(0,e.lastIndexOf("/")+1)}return"./"})(),Vt=" is not allowed to change after `createInstance` or `loadWasm` is called.",Vl=!ct&&document.currentScript&&(document.currentScript.getAttribute("data-license")||document.currentScript.getAttribute("data-productKeys")||document.currentScript.getAttribute("data-licenseKey")||document.currentScript.getAttribute("data-handshakeCode")||document.currentScript.getAttribute("data-organizationID"))||"",Wl=!ct&&document.currentScript&&document.currentScript.getAttribute("data-sessionPassword")||"",jn=e=>{if(e==null)e=[];else{e=e instanceof Array?[...e]:[e];for(let i=0;i<e.length;++i){if(!ct){let s=document.createElement("a");s.href=e[i],e[i]=s.href}e[i].endsWith("/")||(e[i]+="/")}}return e};var xe,Li,pr,It,ki;(function(e){e[e.IPF_Binary=0]="IPF_Binary",e[e.IPF_BinaryInverted=1]="IPF_BinaryInverted",e[e.IPF_GrayScaled=2]="IPF_GrayScaled",e[e.IPF_NV21=3]="IPF_NV21",e[e.IPF_RGB_565=4]="IPF_RGB_565",e[e.IPF_RGB_555=5]="IPF_RGB_555",e[e.IPF_RGB_888=6]="IPF_RGB_888",e[e.IPF_ARGB_8888=7]="IPF_ARGB_8888",e[e.IPF_RGB_161616=8]="IPF_RGB_161616",e[e.IPF_ARGB_16161616=9]="IPF_ARGB_16161616",e[e.IPF_ABGR_8888=10]="IPF_ABGR_8888",e[e.IPF_ABGR_16161616=11]="IPF_ABGR_16161616",e[e.IPF_BGR_888=12]="IPF_BGR_888"})(xe||(xe={})),function(e){e[e.DBR_SYSTEM_EXCEPTION=1]="DBR_SYSTEM_EXCEPTION",e[e.DBR_SUCCESS=0]="DBR_SUCCESS",e[e.DBR_UNKNOWN=-1e4]="DBR_UNKNOWN",e[e.DBR_NO_MEMORY=-10001]="DBR_NO_MEMORY",e[e.DBR_NULL_REFERENCE=-10002]="DBR_NULL_REFERENCE",e[e.DBR_LICENSE_INVALID=-10003]="DBR_LICENSE_INVALID",e[e.DBR_LICENSE_EXPIRED=-10004]="DBR_LICENSE_EXPIRED",e[e.DBR_FILE_NOT_FOUND=-10005]="DBR_FILE_NOT_FOUND",e[e.DBR_FILETYPE_NOT_SUPPORTED=-10006]="DBR_FILETYPE_NOT_SUPPORTED",e[e.DBR_BPP_NOT_SUPPORTED=-10007]="DBR_BPP_NOT_SUPPORTED",e[e.DBR_INDEX_INVALID=-10008]="DBR_INDEX_INVALID",e[e.DBR_BARCODE_FORMAT_INVALID=-10009]="DBR_BARCODE_FORMAT_INVALID",e[e.DBR_CUSTOM_REGION_INVALID=-10010]="DBR_CUSTOM_REGION_INVALID",e[e.DBR_MAX_BARCODE_NUMBER_INVALID=-10011]="DBR_MAX_BARCODE_NUMBER_INVALID",e[e.DBR_IMAGE_READ_FAILED=-10012]="DBR_IMAGE_READ_FAILED",e[e.DBR_TIFF_READ_FAILED=-10013]="DBR_TIFF_READ_FAILED",e[e.DBR_QR_LICENSE_INVALID=-10016]="DBR_QR_LICENSE_INVALID",e[e.DBR_1D_LICENSE_INVALID=-10017]="DBR_1D_LICENSE_INVALID",e[e.DBR_DIB_BUFFER_INVALID=-10018]="DBR_DIB_BUFFER_INVALID",e[e.DBR_PDF417_LICENSE_INVALID=-10019]="DBR_PDF417_LICENSE_INVALID",e[e.DBR_DATAMATRIX_LICENSE_INVALID=-10020]="DBR_DATAMATRIX_LICENSE_INVALID",e[e.DBR_PDF_READ_FAILED=-10021]="DBR_PDF_READ_FAILED",e[e.DBR_PDF_DLL_MISSING=-10022]="DBR_PDF_DLL_MISSING",e[e.DBR_PAGE_NUMBER_INVALID=-10023]="DBR_PAGE_NUMBER_INVALID",e[e.DBR_CUSTOM_SIZE_INVALID=-10024]="DBR_CUSTOM_SIZE_INVALID",e[e.DBR_CUSTOM_MODULESIZE_INVALID=-10025]="DBR_CUSTOM_MODULESIZE_INVALID",e[e.DBR_RECOGNITION_TIMEOUT=-10026]="DBR_RECOGNITION_TIMEOUT",e[e.DBR_JSON_PARSE_FAILED=-10030]="DBR_JSON_PARSE_FAILED",e[e.DBR_JSON_TYPE_INVALID=-10031]="DBR_JSON_TYPE_INVALID",e[e.DBR_JSON_KEY_INVALID=-10032]="DBR_JSON_KEY_INVALID",e[e.DBR_JSON_VALUE_INVALID=-10033]="DBR_JSON_VALUE_INVALID",e[e.DBR_JSON_NAME_KEY_MISSING=-10034]="DBR_JSON_NAME_KEY_MISSING",e[e.DBR_JSON_NAME_VALUE_DUPLICATED=-10035]="DBR_JSON_NAME_VALUE_DUPLICATED",e[e.DBR_TEMPLATE_NAME_INVALID=-10036]="DBR_TEMPLATE_NAME_INVALID",e[e.DBR_JSON_NAME_REFERENCE_INVALID=-10037]="DBR_JSON_NAME_REFERENCE_INVALID",e[e.DBR_PARAMETER_VALUE_INVALID=-10038]="DBR_PARAMETER_VALUE_INVALID",e[e.DBR_DOMAIN_NOT_MATCHED=-10039]="DBR_DOMAIN_NOT_MATCHED",e[e.DBR_RESERVEDINFO_NOT_MATCHED=-10040]="DBR_RESERVEDINFO_NOT_MATCHED",e[e.DBR_AZTEC_LICENSE_INVALID=-10041]="DBR_AZTEC_LICENSE_INVALID",e[e.DBR_LICENSE_DLL_MISSING=-10042]="DBR_LICENSE_DLL_MISSING",e[e.DBR_LICENSEKEY_NOT_MATCHED=-10043]="DBR_LICENSEKEY_NOT_MATCHED",e[e.DBR_REQUESTED_FAILED=-10044]="DBR_REQUESTED_FAILED",e[e.DBR_LICENSE_INIT_FAILED=-10045]="DBR_LICENSE_INIT_FAILED",e[e.DBR_PATCHCODE_LICENSE_INVALID=-10046]="DBR_PATCHCODE_LICENSE_INVALID",e[e.DBR_POSTALCODE_LICENSE_INVALID=-10047]="DBR_POSTALCODE_LICENSE_INVALID",e[e.DBR_DPM_LICENSE_INVALID=-10048]="DBR_DPM_LICENSE_INVALID",e[e.DBR_FRAME_DECODING_THREAD_EXISTS=-10049]="DBR_FRAME_DECODING_THREAD_EXISTS",e[e.DBR_STOP_DECODING_THREAD_FAILED=-10050]="DBR_STOP_DECODING_THREAD_FAILED",e[e.DBR_SET_MODE_ARGUMENT_ERROR=-10051]="DBR_SET_MODE_ARGUMENT_ERROR",e[e.DBR_LICENSE_CONTENT_INVALID=-10052]="DBR_LICENSE_CONTENT_INVALID",e[e.DBR_LICENSE_KEY_INVALID=-10053]="DBR_LICENSE_KEY_INVALID",e[e.DBR_LICENSE_DEVICE_RUNS_OUT=-10054]="DBR_LICENSE_DEVICE_RUNS_OUT",e[e.DBR_GET_MODE_ARGUMENT_ERROR=-10055]="DBR_GET_MODE_ARGUMENT_ERROR",e[e.DBR_IRT_LICENSE_INVALID=-10056]="DBR_IRT_LICENSE_INVALID",e[e.DBR_MAXICODE_LICENSE_INVALID=-10057]="DBR_MAXICODE_LICENSE_INVALID",e[e.DBR_GS1_DATABAR_LICENSE_INVALID=-10058]="DBR_GS1_DATABAR_LICENSE_INVALID",e[e.DBR_GS1_COMPOSITE_LICENSE_INVALID=-10059]="DBR_GS1_COMPOSITE_LICENSE_INVALID",e[e.DBR_PANORAMA_LICENSE_INVALID=-10060]="DBR_PANORAMA_LICENSE_INVALID",e[e.DBR_DOTCODE_LICENSE_INVALID=-10061]="DBR_DOTCODE_LICENSE_INVALID",e[e.DBR_PHARMACODE_LICENSE_INVALID=-10062]="DBR_PHARMACODE_LICENSE_INVALID",e[e.DBR_IMAGE_ORIENTATION_INVALID=-10063]="DBR_IMAGE_ORIENTATION_INVALID",e[e.DMERR_NO_LICENSE=-2e4]="DMERR_NO_LICENSE",e[e.DMERR_LICENSE_SYNC_FAILED=-20003]="DMERR_LICENSE_SYNC_FAILED",e[e.DMERR_TRIAL_LICENSE=-20010]="DMERR_TRIAL_LICENSE",e[e.DMERR_FAILED_TO_REACH_LTS=-20200]="DMERR_FAILED_TO_REACH_LTS"}(Li||(Li={})),function(e){e[e.IMRDT_IMAGE=1]="IMRDT_IMAGE",e[e.IMRDT_CONTOUR=2]="IMRDT_CONTOUR",e[e.IMRDT_LINESEGMENT=4]="IMRDT_LINESEGMENT",e[e.IMRDT_LOCALIZATIONRESULT=8]="IMRDT_LOCALIZATIONRESULT",e[e.IMRDT_REGIONOFINTEREST=16]="IMRDT_REGIONOFINTEREST",e[e.IMRDT_QUADRILATERAL=32]="IMRDT_QUADRILATERAL"}(pr||(pr={})),function(e){e[e.BF_ALL=-29360129]="BF_ALL",e[e.BF_ONED=3147775]="BF_ONED",e[e.BF_GS1_DATABAR=260096]="BF_GS1_DATABAR",e[e.BF_CODE_39=1]="BF_CODE_39",e[e.BF_CODE_128=2]="BF_CODE_128",e[e.BF_CODE_93=4]="BF_CODE_93",e[e.BF_CODABAR=8]="BF_CODABAR",e[e.BF_ITF=16]="BF_ITF",e[e.BF_EAN_13=32]="BF_EAN_13",e[e.BF_EAN_8=64]="BF_EAN_8",e[e.BF_UPC_A=128]="BF_UPC_A",e[e.BF_UPC_E=256]="BF_UPC_E",e[e.BF_INDUSTRIAL_25=512]="BF_INDUSTRIAL_25",e[e.BF_CODE_39_EXTENDED=1024]="BF_CODE_39_EXTENDED",e[e.BF_GS1_DATABAR_OMNIDIRECTIONAL=2048]="BF_GS1_DATABAR_OMNIDIRECTIONAL",e[e.BF_GS1_DATABAR_TRUNCATED=4096]="BF_GS1_DATABAR_TRUNCATED",e[e.BF_GS1_DATABAR_STACKED=8192]="BF_GS1_DATABAR_STACKED",e[e.BF_GS1_DATABAR_STACKED_OMNIDIRECTIONAL=16384]="BF_GS1_DATABAR_STACKED_OMNIDIRECTIONAL",e[e.BF_GS1_DATABAR_EXPANDED=32768]="BF_GS1_DATABAR_EXPANDED",e[e.BF_GS1_DATABAR_EXPANDED_STACKED=65536]="BF_GS1_DATABAR_EXPANDED_STACKED",e[e.BF_GS1_DATABAR_LIMITED=131072]="BF_GS1_DATABAR_LIMITED",e[e.BF_PATCHCODE=262144]="BF_PATCHCODE",e[e.BF_PDF417=33554432]="BF_PDF417",e[e.BF_QR_CODE=67108864]="BF_QR_CODE",e[e.BF_DATAMATRIX=134217728]="BF_DATAMATRIX",e[e.BF_AZTEC=268435456]="BF_AZTEC",e[e.BF_MAXICODE=536870912]="BF_MAXICODE",e[e.BF_MICRO_QR=1073741824]="BF_MICRO_QR",e[e.BF_MICRO_PDF417=524288]="BF_MICRO_PDF417",e[e.BF_GS1_COMPOSITE=-2147483648]="BF_GS1_COMPOSITE",e[e.BF_MSI_CODE=1048576]="BF_MSI_CODE",e[e.BF_CODE_11=2097152]="BF_CODE_11",e[e.BF_NULL=0]="BF_NULL"}(It||(It={})),function(e){e[e.IRT_NO_RESULT=0]="IRT_NO_RESULT",e[e.IRT_ORIGINAL_IMAGE=1]="IRT_ORIGINAL_IMAGE",e[e.IRT_COLOUR_CLUSTERED_IMAGE=2]="IRT_COLOUR_CLUSTERED_IMAGE",e[e.IRT_COLOUR_CONVERTED_GRAYSCALE_IMAGE=4]="IRT_COLOUR_CONVERTED_GRAYSCALE_IMAGE",e[e.IRT_TRANSFORMED_GRAYSCALE_IMAGE=8]="IRT_TRANSFORMED_GRAYSCALE_IMAGE",e[e.IRT_PREDETECTED_REGION=16]="IRT_PREDETECTED_REGION",e[e.IRT_PREPROCESSED_IMAGE=32]="IRT_PREPROCESSED_IMAGE",e[e.IRT_BINARIZED_IMAGE=64]="IRT_BINARIZED_IMAGE",e[e.IRT_TEXT_ZONE=128]="IRT_TEXT_ZONE",e[e.IRT_CONTOUR=256]="IRT_CONTOUR",e[e.IRT_LINE_SEGMENT=512]="IRT_LINE_SEGMENT",e[e.IRT_FORM=1024]="IRT_FORM",e[e.IRT_SEGMENTATION_BLOCK=2048]="IRT_SEGMENTATION_BLOCK",e[e.IRT_TYPED_BARCODE_ZONE=4096]="IRT_TYPED_BARCODE_ZONE",e[e.IRT_PREDETECTED_QUADRILATERAL=8192]="IRT_PREDETECTED_QUADRILATERAL"}(ki||(ki={}));const Un=e=>e&&typeof e=="object"&&typeof e.then=="function";class fo extends Promise{constructor(i){let s,f;super((g,p)=>{s=g,f=p}),this._s="pending",this.resolve=g=>{this.isPending&&(Un(g)?this.task=g:(this._s="fulfilled",s(g)))},this.reject=g=>{this.isPending&&(this._s="rejected",f(g))},this.task=i}get status(){return this._s}get isPending(){return this._s==="pending"}get isFulfilled(){return this._s==="fulfilled"}get isRejected(){return this._s==="rejected"}get task(){return this._task}set task(i){let s;this._task=i,Un(i)?s=i:typeof i=="function"&&(s=new Promise(i)),s&&(async()=>{try{const f=await s;i===this._task&&this.resolve(f)}catch(f){i===this._task&&this.reject(f)}})()}get isEmpty(){return this._task==null}}const Yi=["iPhone","iPad","Android","HarmonyOS"].includes(we.OS)?2048:4096;class L{constructor(){this._instanceID=void 0,this._ifSaveOriginalImageInACanvas=!1,this.oriCanvas=null,this.oriCanvasData=null,this.canvas=null,this.bFilterRegionInJs=!1,this._region=null,this._timeStartDecode=null,this._timeEnterInnerDBR=null,this._timeGetMessage=null,this.decodeRecords={},this.bDestroyed=!1,this._lastErrorCode=0,this._lastErrorString="",this._lastInnerDecodeDuration=0,this.intervalTime=0,this._intervalGetVideoFrame=0,this.array_getFrameTimeCost=[],this.array_decodeFrameTimeCost=[],this._indexCurrentDecodingFrame=0,this._arrPolygons=[],this._bPauseScan=!1,this._intervalDetectVideoPause=1e3,this._soundSource="data:audio/mpeg;base64,SUQzBAAAAAAAI1RTU0UAAAAPAAADTGF2ZjU4LjI5LjEwMAAAAAAAAAAAAAAA/+M4wAAAAAAAAAAAAEluZm8AAAAPAAAABQAAAkAAgICAgICAgICAgICAgICAgICAgKCgoKCgoKCgoKCgoKCgoKCgoKCgwMDAwMDAwMDAwMDAwMDAwMDAwMDg4ODg4ODg4ODg4ODg4ODg4ODg4P//////////////////////////AAAAAExhdmM1OC41NAAAAAAAAAAAAAAAACQEUQAAAAAAAAJAk0uXRQAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA/+MYxAANQAbGeUEQAAHZYZ3fASqD4P5TKBgocg+Bw/8+CAYBA4XB9/4EBAEP4nB9+UOf/6gfUCAIKyjgQ/Kf//wfswAAAwQA/+MYxAYOqrbdkZGQAMA7DJLCsQxNOij///////////+tv///3RWiZGBEhsf/FO/+LoCSFs1dFVS/g8f/4Mhv0nhqAieHleLy/+MYxAYOOrbMAY2gABf/////////////////usPJ66R0wI4boY9/8jQYg//g2SPx1M0N3Z0kVJLIs///Uw4aMyvHJJYmPBYG/+MYxAgPMALBucAQAoGgaBoFQVBUFQWDv6gZBUFQVBUGgaBr5YSgqCoKhIGg7+IQVBUFQVBoGga//SsFSoKnf/iVTEFNRTMu/+MYxAYAAANIAAAAADEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV",this.bPlaySoundOnSuccessfulRead=!1,this.bVibrateOnSuccessfulRead=!1,this.vibrateDuration=300,this.captureAndDecodeInParallel=!0,this.autoSuggestTip=!1,this.suggestTipFrameArray=[],this.suggestTipFrameLimit=[5,3],this.noIntermediateResultsCount=0,this.noIntermediateResultsTipLimit=100,this.tinyBarcodeTipModuleSizeLimit=3,this.hugeBarcodeTipLimit=.9,this.autoZoomInFrameArray=[],this.autoZoomInFrameLimit=[5,3],this.autoZoomInStepRate=1/3,this.autoZoomInMaxStep=1.5,this.autoZoomInMaxTimes=5,this.autoZoomInMinStep=Math.pow(10,1/this.autoZoomInMaxTimes),this.autoZoomInIdealModuleSize=6,this.autoZoomOutFrameCount=0,this.autoZoomOutFrameLimit=3,this.autoZoomOutStepRate=1/3,this.autoZoomOutMinValue=1,this.autoZoomOutMinStep=2,this.autoZoomOutStepRate_2=.05,this.autoZoomOutMinValue_2=2,this.frameArrayInIdealZoom=[],this.frameLimitInIdealZoom=[5,3],this.enableZoomOutInIdealZoom=!1,this.nextActionInIdealZoom="focus",this.autoFocusFrameArray=[],this.autoFocusFrameLimit=[5,3],this.autoZoomIdealArea=[0,.05],this.autoZoomTargetBorder=.9,this.autoZoomDetectionArea=.5,this.autoZoom=!1,this.autoFocus=!1,this._resultHighlightingDuration=-1,this._dce=null,this._imgSource=null,this._maxCvsSideLength=Yi,this._promiseStartScan=null,this.beepSound=new Ri({src:[this._soundSource],onplayerror:(i,s)=>{console.warn(`Sound '${i}' playback failure: ${s}`)}})}static get version(){return this._version}static get license(){return this._license}static set license(i){((s,f)=>{const g=s;if(!g._pLoad.isEmpty)throw new Error("`license`"+Vt);g._license=f})(L,i)}static get productKeys(){return this._license}static set productKeys(i){L.license=i}static get handshakeCode(){return this._license}static set handshakeCode(i){L.license=i}static get organizationID(){return this._license}static set organizationID(i){L.license=i}static set sessionPassword(i){((s,f)=>{const g=s;if(!g._pLoad.isEmpty)throw new Error("`sessionPassword`"+Vt);g._sessionPassword=f})(L,i)}static get sessionPassword(){return this._sessionPassword}static async detectEnvironment(){return await(async()=>({wasm:Nl,worker:jl,getUserMedia:uo,camera:await Ul(),browser:we.browser,version:we.version,OS:we.OS}))()}static get engineResourcePath(){return this._engineResourcePath}static set engineResourcePath(i){if(!this._pLoad.isEmpty)throw new Error("`engineResourcePath` is not allowed to change after `createInstance` or `loadWasm` is called.");L._engineResourcePath=(s=>{if(s==null&&(s="./"),!ct){let f=document.createElement("a");f.href=s,s=f.href}return s.endsWith("/")||(s+="/"),s})(i)}static get licenseServer(){return this._licenseServer}static set licenseServer(i){((s,f)=>{const g=s;if(!g._pLoad.isEmpty)throw new Error("`licenseServer`"+Vt);g._licenseServer=jn(f)})(L,i)}static get deviceFriendlyName(){return this._deviceFriendlyName}static set deviceFriendlyName(i){((s,f)=>{const g=s;if(!g._pLoad.isEmpty)throw new Error("`deviceFriendlyName`"+Vt);g._deviceFriendlyName=f||""})(L,i)}static get _bUseFullFeature(){return this.__bUseFullFeature}static set _bUseFullFeature(i){if(!this._pLoad.isEmpty)throw new Error("`_bUseFullFeature` is not allowed to change after `createInstance` or `loadWasm` is called.");L.__bUseFullFeature=i}static isImageSource(i){return!(!i||typeof i!="object"||Array.isArray(i))&&"getImage"in i}static isDSImage(i){return!(!i||typeof i!="object"||Array.isArray(i))&&"data"in i&&"width"in i&&"height"in i&&"pixelFormat"in i}static isDCEFrame(i){return!(!i||typeof i!="object"||Array.isArray(i))&&"data"in i&&"region"in i&&"sx"in i&&"sy"in i&&"width"in i&&"height"in i&&("colorMode"in i||"pixelFormat"in i)&&"timeSpent"in i&&"timeStamp"in i&&"isCropped"in i&&"toCanvas"in i&&"_sWidth"in i&&"_sHeight"in i&&"_bUseWebGL"in i}get ifSaveOriginalImageInACanvas(){return this._ifSaveOriginalImageInACanvas}set ifSaveOriginalImageInACanvas(i){this._ifSaveOriginalImageInACanvas=i}getOriginalImageInACanvas(){return!this.oriCanvas&&this.oriCanvasData?this.oriCanvasData.toCanvas():this.oriCanvas}set region(i){this._region=i,this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0}get region(){return this._region}static isWasmLoaded(){return this._pLoad.isFulfilled}isContextDestroyed(){return this.bDestroyed}static get lastErrorCode(){return this._lastErrorCode}static get lastErrorString(){return this._lastErrorString}get lastErrorCode(){return this._lastErrorCode}get lastErrorString(){return this._lastErrorString}static get defaultUIElementURL(){var i;return(i=L._defaultUIElementURL)===null||i===void 0?void 0:i.replace("@engineResourcePath/",L.engineResourcePath)}static set defaultUIElementURL(i){L._defaultUIElementURL=i}static _fireHTTPSWarnning(){L.onWarning&&location&&location.protocol!=="https:"&&setTimeout(()=>{L.onWarning&&L.onWarning({id:2,message:"Not connected via SSL (HTTPS), the SDK may not work correctly."})},0)}get soundSource(){return this._soundSource}set soundSource(i){this._soundSource=i,this.beepSound=new Ri({src:[this._soundSource],onplayerror:(s,f)=>{console.warn(`Sound '${s}' playback failure: ${f}`)}})}get whenToPlaySoundforSuccessfulRead(){return this.bPlaySoundOnSuccessfulRead===!0?"frame":this.bPlaySoundOnSuccessfulRead?this.bPlaySoundOnSuccessfulRead:"never"}set whenToPlaySoundforSuccessfulRead(i){this.bPlaySoundOnSuccessfulRead=i!=="never"&&i}get whenToVibrateforSuccessfulRead(){return this.bVibrateOnSuccessfulRead===!0?"frame":this.bVibrateOnSuccessfulRead?this.bVibrateOnSuccessfulRead:"never"}set whenToVibrateforSuccessfulRead(i){this.bVibrateOnSuccessfulRead=i!=="never"&&i}set dce(i){this._dce=i}get dce(){return!this._dce||this._dce.isDisposed||this._dce.disposed?null:this._dce}set maxCvsSideLength(i){this._maxCvsSideLength=i,this._dceControler&&this._dceControler.setDisiredValue(this,"maxCvsSideLength",i)}get maxCvsSideLength(){return this._maxCvsSideLength}async _registerDCEControler(){if(!this.dce)return;L._onLog&&L._onLog("_registerDCEControler()");const i=this.dce;this._dceControler=i._createControler();const s=this._dceControler;s.register(this),s.setDisiredValue(this,"refreshInterval",200),s.setDisiredValue(this,"maxCvsSideLength",this._maxCvsSideLength),this._styleIdBeforeVerification=this.dce.createDrawingStyle({fillStyle:"rgba(248,252,0,0.2)",strokeStyle:"transparent",paintMode:"strokeAndFill"});try{}catch(p){p.name==="ReferenceError"&&window&&(window.ResizeObserver=void 0)}const f=i.getUIElement(),g=this.dce.constructor;if(g._defaultUIElementURL==="@engineResourcePath/dce.ui.html")try{f?f===s._innerSetUI&&(await i.setUIElement(`${g.engineResourcePath}dce.ui.html`),s._innerSetUI=i.getUIElement()):(await i.setUIElement(`${g.engineResourcePath}dbr.ui.html`),s._innerSetUI=i.getUIElement())}catch(p){await i.setUIElement(g.defaultUIElementURL)}else f||await i.setUIElement(g.defaultUIElementURL);this.callbackCameraChange=()=>{this._clearResultsCanvasTimeoutId&&clearTimeout(this._clearResultsCanvasTimeoutId),this._drawResults(null),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0},this.callbackResolutionChange=()=>{this._clearResultsCanvasTimeoutId&&clearTimeout(this._clearResultsCanvasTimeoutId),this._drawResults(null),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0},this.callbackCameraClose=()=>{this.stopScanning(!0),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0,this._bPauseScan=!1},this.callbackSingleFrameAcquired=async p=>{this._clearResultsCanvasTimeoutId&&clearTimeout(this._clearResultsCanvasTimeoutId),this._drawResults(null);let m=await this._decode_DCEFrame(p,{bCopyData:!1}),b=null;if(m&&m.length){const{sx:T,sy:A,width:O,height:B,_sWidth:k,_sHeight:Z}=p;b=m.map(ie=>({localizationResult:JSON.parse(JSON.stringify(ie.localizationResult))})),L.recalculateResultLocation(b,T,A,k,Z,O,B)}if(this._drawResults(b,m),await this.clearMapDecodeRecord(),this.onImageRead&&this.dce.isOpen()&&!this._bPauseScan){let T=this._cloneDecodeResults(m);this.onImageRead(T)}if(this.onUniqueRead&&this.dce.isOpen()&&!this._bPauseScan)for(let T of m)this.onUniqueRead(T.barcodeText,this._cloneDecodeResults(T))},i.on("cameraChange",this.callbackCameraChange),i.on("resolutionChange",this.callbackResolutionChange),i.on("cameraClose",this.callbackCameraClose),i.on("singleFrameAcquired",this.callbackSingleFrameAcquired)}_logoutDCEControler(){this.dce&&this._dceControler&&(L._onLog&&L._onLog("_logoutDCEControler()"),this._dceControler.logout(this),this.dce.off("cameraChange",this.callbackCameraChange),this.dce.off("resolutionChange",this.callbackResolutionChange),this.dce.off("cameraClose",this.callbackCameraClose),this.dce.off("singleFrameAcquired",this.callbackSingleFrameAcquired),this._dceControler=null,this.dce=null)}async setImageSource(i,s){if(i==null)return this._imgSource=null,this._logoutDCEControler(),void(this._drawingItemNamespace=null);if(i&&i.isCameraEnhancer)this.dce=i,await this._registerDCEControler(),this._imgSource=null;else{if(!L.isImageSource(i))throw new Error("Invalid value.");this._logoutDCEControler(),this._imgSource=i}s&&s.resultsHighlightBaseShapes&&(this._drawingItemNamespace=s.resultsHighlightBaseShapes)}static async loadWasm(){if(this._pLoad.isEmpty){let{lt:i,l:s,ls:f,sp:g,rmk:p}=(m=>{const b=m;if(b._pLoad.isEmpty){let T,A,O=b._license||"",B=JSON.parse(JSON.stringify(b._licenseServer)),k=b._sessionPassword,Z=0;if(O.startsWith("t")||O.startsWith("f"))Z=0;else if(O.length===0||O.startsWith("P")||O.startsWith("L")||O.startsWith("Y")||O.startsWith("A"))Z=1;else{Z=2;const ie=O.indexOf(":");if(ie!=-1&&(O=O.substring(ie+1)),O.startsWith("DLS2")){let le;try{let ce=O.substring(4);ce=atob(ce),le=JSON.parse(ce)}catch(ce){throw new Error("Format Error: The license string you specified is invalid, please check to make sure it is correct.")}if(O=le.handshakeCode?le.handshakeCode:le.organizationID?le.organizationID:"",typeof O=="number"&&(O=JSON.stringify(O)),B.length===0){let ce=[];le.mainServerURL&&(ce[0]=le.mainServerURL),le.standbyServerURL&&(ce[1]=le.standbyServerURL),B=jn(ce)}!k&&le.sessionPassword&&(k=le.sessionPassword),T=le.remark}(O==="200001"||O.startsWith("200001-"))&&(B&&B.length||(O="")),O||(Z=1)}if(Z&&(Nn.crypto||(A="Please upgrade your browser to support online key."),Nn.crypto.subtle||(A="Require https to use online key in this browser.")),A){if(Z!==1)throw new Error(A);Z=0,console.warn(A),b._lastErrorCode=-1,b._lastErrorString=A}return Z===1&&(O="",console.warn("Applying for a public trial license ...")),{lt:Z,l:O,ls:B,sp:k,rmk:T}}throw new Error("Can't preprocess license again"+Vt)})(L);this._pLoad.task=async(m,b)=>{let T=L.engineResourcePath+L._workerName;L.engineResourcePath.startsWith(location.origin)||(T=await fetch(T).then(A=>A.blob()).then(A=>URL.createObjectURL(A))),L._dbrWorker=new Worker(T),L._dbrWorker.onerror=A=>{let O=new Error(A.message);b(O)},L._dbrWorker.onmessage=async A=>{let O=A.data?A.data:A;switch(O.type){case"log":L._onLog&&L._onLog(O.message);break;case"load":{O.message&&(O.message=O.message.replace("(https://www.dynamsoft.com/purchase-center/)","(https://www.dynamsoft.com/store/dynamsoft-barcode-reader/#javascript)"));let B,k=!1;i===1&&(k=!0,O.message||(O.message="Using a temporary license. [Register for a 30-day trial license >>>](https://www.dynamsoft.com/customer/license/trialLicense?product=dbr&deploymenttype=browser)")),O.success?(L._dbrWorker.onerror=null,L._version=O.version+"(JS "+L._jsVersion+"."+L._jsEditVersion+")",L._onLog&&L._onLog("load dbr worker success"),O.message&&console.warn(O.message)):(B=new Error(O.message),B.stack=O.stack+`
`+B.stack,B.ltsErrorCode=O.ltsErrorCode,k||O.ltsErrorCode==111&&O.message.toLowerCase().indexOf("trial license")!=-1&&(k=!0)),k&&L.showDialog(O.success?"warn":"error",O.message),O.success?m():b(B);break}case"task":{let B=O.id,k=O.body;try{L._taskCallbackMap.get(B)(k),L._taskCallbackMap.delete(B)}catch(Z){throw L._taskCallbackMap.delete(B),Z}break}default:L._onLog&&L._onLog(A)}},L._dbrWorker.postMessage({type:"loadWasm",engineResourcePath:L.engineResourcePath,bUseFullFeature:L._bUseFullFeature,bd:L._bWasmDebug,v:L._jsVersion,brtk:!!i,bptk:i===1,l:s,dm:location.origin.startsWith("http")?location.origin:"https://localhost",os:we,cv:L.authCacheVersion,fn:L.deviceFriendlyName,ls:f,sp:g,rmk:p})}}await this._pLoad}static async showDialog(i,s){await(async(f,g,p)=>{if(!f._bNeverShowDialog)try{let m=await fetch(f.engineResourcePath+"dls.license.dialog.html");if(!m.ok)throw Error("Get license dialog fail. Network Error: "+m.statusText);let b=await m.text();if(!b.trim().startsWith("<"))throw Error("Get license dialog fail. Can't get valid HTMLElement.");let T=document.createElement("div");T.innerHTML=b;let A=[];for(let oe=0;oe<T.childElementCount;++oe){let ae=T.children[oe];ae instanceof HTMLStyleElement&&(A.push(ae),document.head.append(ae))}let O=T.childElementCount==1?T.children[0]:T;O.remove();let B,k,Z,ie,le,ce=[O],de=O.children;for(let oe of de)ce.push(oe);for(let oe=0;oe<ce.length;++oe)for(let ae of ce[oe].children)ce.push(ae);for(let oe of ce)if(!B&&oe.classList.contains("dls-license-mask"))B=oe,oe.addEventListener("click",ae=>{if(oe==ae.target){O.remove();for(let ve of A)ve.remove()}});else if(!k&&oe.classList.contains("dls-license-icon-close"))k=oe,oe.addEventListener("click",()=>{O.remove();for(let ae of A)ae.remove()});else if(!Z&&oe.classList.contains("dls-license-icon-error"))Z=oe,g!="error"&&oe.remove();else if(!ie&&oe.classList.contains("dls-license-icon-warn"))ie=oe,g!="warn"&&oe.remove();else if(!le&&oe.classList.contains("dls-license-msg-content")){le=oe;let ae=p;for(;ae;){let ve=ae.indexOf("["),Ee=ae.indexOf("]",ve),Ie=ae.indexOf("(",Ee),Ce=ae.indexOf(")",Ie);if(ve==-1||Ee==-1||Ie==-1||Ce==-1){oe.appendChild(new Text(ae));break}ve>0&&oe.appendChild(new Text(ae.substring(0,ve)));let v=document.createElement("a"),Ge=ae.substring(ve+1,Ee);v.innerText=Ge;let Ve=ae.substring(Ie+1,Ce);v.setAttribute("href",Ve),v.setAttribute("target","_blank"),oe.appendChild(v),ae=ae.substring(Ce+1)}}document.body.appendChild(O)}catch(m){f._onLog&&f._onLog(m.message||m)}})(this,i,s)}static async createInstanceInWorker(i=!1){return await L.loadWasm(),await new Promise((s,f)=>{let g=L._nextTaskID++;L._taskCallbackMap.set(g,p=>{if(p.success)return s(p.instanceID);{let m=new Error(p.message);return m.stack=p.stack+`
`+m.stack,f(m)}}),L._dbrWorker.postMessage({type:"createInstance",id:g,bScanner:i})})}static async createInstance(){const i=new L;return i._instanceID=await L.createInstanceInWorker(),L._fireHTTPSWarnning(),i}async clearMapDecodeRecord(){return await new Promise((i,s)=>{let f=L._nextTaskID++;L._taskCallbackMap.set(f,g=>{if(g.success)return i();{let p=new Error(g.message);return p.stack=g.stack+`
`+p.stack,s(p)}}),L._dbrWorker.postMessage({type:"clearMapDecodeRecord",id:f,instanceID:this._instanceID})})}async decode(i){L._onLog&&L._onLog("decode(source: any)"),L._onLog&&(this._timeStartDecode=Date.now());{let s={};return!this.region||this.region instanceof Array||(s.region=JSON.parse(JSON.stringify(this.region))),i instanceof Blob?await this._decode_Blob(i,s):i instanceof ArrayBuffer?await this._decode_ArrayBuffer(i,s):i instanceof Uint8Array||i instanceof Uint8ClampedArray?await this._decode_Uint8Array(i,s):i instanceof HTMLImageElement||typeof ImageBitmap<"u"&&i instanceof ImageBitmap?await this._decode_Image(i,s):i instanceof HTMLCanvasElement?await this._decode_Canvas(i,s):i instanceof HTMLVideoElement?await this._decode_Video(i,s):typeof i=="string"?i.substring(0,11)=="data:image/"?await this._decode_Base64(i,s):await this._decode_Url(i,s):L.isDCEFrame(i)?(s.bCopyData=!0,await this._decode_DCEFrame(i,s)):L.isDSImage(i)?(s.bCopyData=!0,await this._decode_DSImage(i,s)):await Promise.reject(TypeError("'_decode(source, config)': Type of 'source' should be 'Blob', 'ArrayBuffer', 'Uint8Array', 'HTMLImageElement', 'HTMLCanvasElement', 'HTMLVideoElement', 'String(base64 with image mime)' or 'String(url)'."))}}async decodeBase64String(i){let s={};return!this.region||this.region instanceof Array||(s.region=JSON.parse(JSON.stringify(this.region))),this._decode_Base64(i,s)}async decodeUrl(i){let s={};return!this.region||this.region instanceof Array||(s.region=JSON.parse(JSON.stringify(this.region))),this._decode_Url(i,s)}async _decodeBuffer_Uint8Array(i,s,f,g,p,m,b){return await new Promise((T,A)=>{let O=L._nextTaskID++;L._taskCallbackMap.set(O,B=>{if(B.success){let k,Z=L._onLog?Date.now():0;L._onLog&&L._onLog("worker return result: "+Z),this._lastInnerDecodeDuration=B.duration;try{k=this._handleRetJsonString(B.decodeReturn)}catch(ie){return A(ie)}if(L._onLog){let ie=Date.now();L._onLog("DBR getting message from worker timestamp: "+Z),L._onLog("From DBR staring decoding to entering worker costs: "+(this._timeEnterInnerDBR-this._timeStartDecode)),L._onLog("From DBR entering worker to returning message from worker costs: "+(Z-this._timeEnterInnerDBR)),L._onLog("Handling results from DBR worker costs: "+(ie-Z)),L._onLog("Total decoding image costs: "+(ie-this._timeStartDecode))}return T(k)}{let k=new Error(B.message);return k.stack=B.stack+`
`+k.stack,A(k)}}),this._timeEnterInnerDBR=Date.now(),L._onLog&&L._onLog("Sending buffer to worker timestamp:"+this._timeEnterInnerDBR),L._dbrWorker.postMessage({type:"decodeBuffer",id:O,instanceID:this._instanceID,body:{buffer:i,width:s,height:f,stride:g,format:p,orientation:m,config:b}},[i.buffer]),L._onLog&&b&&b.timeStamp&&L._onLog("Delay of decoding image: "+(this._timeEnterInnerDBR-b.timeStamp))})}async _decodeBuffer_Blob(i,s,f,g,p,m,b){L._onLog&&L._onLog("_decodeBuffer_Blob(buffer,width,height,stride,format)");const T=i.arrayBuffer?await i.arrayBuffer():await new Promise((A,O)=>{let B=new FileReader;B.readAsArrayBuffer(i),B.onload=()=>{A(B.result)},B.onerror=()=>{O(B.error)}});return await this._decodeBuffer_Uint8Array(new Uint8Array(T),s,f,g,p,m,b)}async decodeBuffer(i,s,f,g,p,m,b){let T;return L._onLog&&L._onLog("decodeBuffer(buffer,width,height,stride,format)"),L._onLog&&(this._timeStartDecode=Date.now()),i instanceof Uint8Array||i instanceof Uint8ClampedArray?T=await this._decodeBuffer_Uint8Array(i,s,f,g,p,m,b):i instanceof ArrayBuffer?T=await this._decodeBuffer_Uint8Array(new Uint8Array(i),s,f,g,p,m,b):i instanceof Blob&&(T=await this._decodeBuffer_Blob(i,s,f,g,p,m,b)),T}async _decodeFileInMemory_Uint8Array(i){return await new Promise((s,f)=>{let g=L._nextTaskID++;L._taskCallbackMap.set(g,p=>{if(p.success){let m;this._lastInnerDecodeDuration=p.duration;try{m=this._handleRetJsonString(p.decodeReturn)}catch(b){return f(b)}return s(m)}{let m=new Error(p.message);return m.stack=p.stack+`
`+m.stack,f(m)}}),L._dbrWorker.postMessage({type:"decodeFileInMemory",id:g,instanceID:this._instanceID,body:{bytes:i}})})}async getRuntimeSettings(){return await new Promise((i,s)=>{let f=L._nextTaskID++;L._taskCallbackMap.set(f,g=>{if(g.success){let p=JSON.parse(g.results);return this.userDefinedRegion!=null&&(p.region=JSON.parse(JSON.stringify(this.userDefinedRegion))),i(p)}{let p=new Error(g.message);return p.stack=g.stack+`
`+p.stack,s(p)}}),L._dbrWorker.postMessage({type:"getRuntimeSettings",id:f,instanceID:this._instanceID})})}async updateRuntimeSettings(i){let s;if(typeof i=="string")if(i=="speed"){let f=await this.getRuntimeSettings();await this.resetRuntimeSettings(),s=await this.getRuntimeSettings(),s.barcodeFormatIds=f.barcodeFormatIds,s.barcodeFormatIds_2=f.barcodeFormatIds_2,s.region=f.region,s.deblurLevel=3,s.expectedBarcodesCount=0,s.localizationModes=[2,0,0,0,0,0,0,0]}else if(i=="balance"){let f=await this.getRuntimeSettings();await this.resetRuntimeSettings(),s=await this.getRuntimeSettings(),s.barcodeFormatIds=f.barcodeFormatIds,s.barcodeFormatIds_2=f.barcodeFormatIds_2,s.region=f.region,s.deblurLevel=5,s.expectedBarcodesCount=512,s.localizationModes=[2,16,0,0,0,0,0,0]}else if(i=="coverage"){let f=await this.getRuntimeSettings();await this.resetRuntimeSettings(),s=await this.getRuntimeSettings(),s.barcodeFormatIds=f.barcodeFormatIds,s.barcodeFormatIds_2=f.barcodeFormatIds_2,s.region=f.region}else if(i=="dense"){let f=await this.getRuntimeSettings();await this.resetRuntimeSettings(),this.maxCvsSideLength=4096,s=await this.getRuntimeSettings(),s.barcodeFormatIds=f.barcodeFormatIds,s.barcodeFormatIds_2=f.barcodeFormatIds_2,s.region=f.region,s.deblurLevel=9,s.expectedBarcodesCount=0,s.localizationModes=[2,8,0,0,0,0,0,0]}else if(i=="distance"){let f=await this.getRuntimeSettings();await this.resetRuntimeSettings(),this.maxCvsSideLength=4096,s=await this.getRuntimeSettings(),s.barcodeFormatIds=f.barcodeFormatIds,s.barcodeFormatIds_2=f.barcodeFormatIds_2,s.region=f.region,s.deblurLevel=3,s.expectedBarcodesCount=0,s.localizationModes=[2,8,0,0,0,0,0,0]}else s=JSON.parse(i);else{if(typeof i!="object")throw TypeError("'UpdateRuntimeSettings(settings)': Type of 'settings' should be 'string' or 'PlainObject'.");if(s=JSON.parse(JSON.stringify(i)),s.region instanceof Array){let f=s.region;[f.regionLeft,f.regionTop,f.regionLeft,f.regionBottom,f.regionMeasuredByPercentage].some(g=>g!==void 0)&&(s.region={regionLeft:f.regionLeft||0,regionTop:f.regionTop||0,regionRight:f.regionRight||0,regionBottom:f.regionBottom||0,regionMeasuredByPercentage:f.regionMeasuredByPercentage||0})}}if(!L._bUseFullFeature){if((s.barcodeFormatIds&~(It.BF_ONED|It.BF_QR_CODE|It.BF_PDF417|It.BF_DATAMATRIX))!=0||s.barcodeFormatIds_2!=0)throw Error("Some of the specified barcode formats are not supported in the compact version. Please try the full-featured version.");if(s.intermediateResultTypes!=0)throw Error("Intermediate results is not supported in the compact version. Please try the full-featured version.")}if(this.bFilterRegionInJs){let f=s.region;if(f instanceof Array)throw Error("The `region` of type `Array` is only allowed in `BarcodeScanner`.");this.userDefinedRegion=JSON.parse(JSON.stringify(f)),(f.regionLeft||f.regionTop||f.regionRight||f.regionBottom||f.regionMeasuredByPercentage)&&(f.regionLeft||f.regionTop||f.regionRight!=100||f.regionBottom!=100||!f.regionMeasuredByPercentage)?this.region=f:this.region=null,s.region={regionLeft:0,regionTop:0,regionRight:0,regionBottom:0,regionMeasuredByPercentage:0}}else this.userDefinedRegion=null,this.region=null;return(this.autoZoom||this.autoFocus)&&(s.intermediateResultTypes|=ki.IRT_TYPED_BARCODE_ZONE),await new Promise((f,g)=>{let p=L._nextTaskID++;L._taskCallbackMap.set(p,m=>{if(m.success){try{this._handleRetJsonString(m.updateReturn)}catch(b){g(b)}return f()}{let b=new Error(m.message);return b.stack=m.stack+`
`+b.stack,g(b)}}),L._dbrWorker.postMessage({type:"updateRuntimeSettings",id:p,instanceID:this._instanceID,body:{settings:JSON.stringify(s)}})})}async resetRuntimeSettings(){return this.userDefinedRegion=null,this.region=null,this.maxCvsSideLength=Yi,await new Promise((i,s)=>{let f=L._nextTaskID++;L._taskCallbackMap.set(f,g=>{if(g.success)return i();{let p=new Error(g.message);return p.stack=g.stack+`
`+p.stack,s(p)}}),L._dbrWorker.postMessage({type:"resetRuntimeSettings",id:f,instanceID:this._instanceID})})}async _resetRuntimeSettingsToCppDefault(){return this.userDefinedRegion=null,this.region=null,this.maxCvsSideLength=Yi,await new Promise((i,s)=>{let f=L._nextTaskID++;L._taskCallbackMap.set(f,g=>{if(g.success)return i();{let p=new Error(g.message);return p.stack=g.stack+`
`+p.stack,s(p)}}),L._dbrWorker.postMessage({type:"resetRuntimeSettingsToCppDefault",id:f,instanceID:this._instanceID})})}async outputRuntimeSettingsToString(){if(!L._bUseFullFeature)throw Error("outputRuntimeSettingsToString() is not supported in the compact version. Please try the full-featured version.");return await new Promise((i,s)=>{let f=L._nextTaskID++;L._taskCallbackMap.set(f,g=>{if(g.success)return i(g.results);{let p=new Error(g.message);return p.stack=g.stack+`
`+p.stack,s(p)}}),L._dbrWorker.postMessage({type:"outputRuntimeSettingsToString",id:f,instanceID:this._instanceID})})}async initRuntimeSettingsWithString(i){if(!L._bUseFullFeature)throw Error("initRuntimeSettingsWithString() is not supported in the compact version. Please try the full-featured version.");if(typeof i=="string")i=i;else{if(typeof i!="object")throw TypeError("'initRuntimeSettingstWithString(settings)': Type of 'settings' should be 'string' or 'PlainObject'.");i=JSON.stringify(i)}return await new Promise((s,f)=>{let g=L._nextTaskID++;L._taskCallbackMap.set(g,p=>{if(p.success){try{this._handleRetJsonString(p.initReturn)}catch(m){f(m)}return s()}{let m=new Error(p.message);return m.stack=p.stack+`
`+m.stack,f(m)}}),L._dbrWorker.postMessage({type:"initRuntimeSettingsWithString",id:g,instanceID:this._instanceID,body:{settings:i}})})}async _decode_Blob(i,s){L._onLog&&L._onLog("_decode_Blob(blob: Blob)");let f=null,g=null;if(typeof createImageBitmap<"u")try{f=await createImageBitmap(i)}catch(m){}f||(g=await function(m){return new Promise((b,T)=>{let A=URL.createObjectURL(m),O=new Image;O.dbrObjUrl=A,O.src=A,O.onload=()=>{b(O)},O.onerror=B=>{T(new Error("Can't convert blob to image : "+(B instanceof Event?B.type:B)))}})}(i));let p=await this._decode_Image(f||g,s);return f&&f.close(),p}async _decode_ArrayBuffer(i,s){return await this._decode_Blob(new Blob([i]),s)}async _decode_Uint8Array(i,s){return await this._decode_Blob(new Blob([i]),s)}async _decode_Image(i,s){L._onLog&&L._onLog("_decode_Image(image: HTMLImageElement|ImageBitmap)"),s=s||{};let f,g,p=i instanceof HTMLImageElement?i.naturalWidth:i.width,m=i instanceof HTMLImageElement?i.naturalHeight:i.height,b=Math.max(p,m);if(b>this._maxCvsSideLength){let O=this._maxCvsSideLength/b;f=Math.round(p*O),g=Math.round(m*O)}else f=p,g=m;this.canvas||(this.canvas=document.createElement("canvas"));const T=this.canvas;T.width===f&&T.height===g||(T.width=f,T.height=g),T.ctx2d||(T.ctx2d=T.getContext("2d",{willReadFrequently:!0})),T.ctx2d.drawImage(i,0,0,p,m,0,0,f,g),i.dbrObjUrl&&URL.revokeObjectURL(i.dbrObjUrl);let A=await this._decode_Canvas(T,s);if(this.ifSaveOriginalImageInACanvas){const O=document.createElement("canvas");O.width=i.width,O.height=i.height,O.getContext("2d").drawImage(i,0,0),this.oriCanvas=O,this.oriCanvasData=null}return L.recalculateResultLocation(A,0,0,p,m,f,g),A}async _decode_Canvas(i,s){if(L._onLog&&L._onLog("_decode_Canvas(canvas:HTMLCanvasElement)"),i.crossOrigin&&i.crossOrigin!="anonymous")throw"cors";if(i.width===0||i.height===0)throw Error("The width or height of the 'canvas' is 0.");this.ifSaveOriginalImageInACanvas&&(this.oriCanvas=i,this.oriCanvasData=null);let f=(i.ctx2d||i.getContext("2d",{willReadFrequently:!0})).getImageData(0,0,i.width,i.height).data;return await this._decodeBuffer_Uint8Array(f,i.width,i.height,4*i.width,xe.IPF_ABGR_8888,0,s)}async _decode_Video(i,s){if(L._onLog&&L._onLog("_decode_Video(video)"),!(i instanceof HTMLVideoElement))throw TypeError("'_decode_Video(video [, config] )': Type of 'video' should be 'HTMLVideoElement'.");if(i.crossOrigin&&i.crossOrigin!="anonymous")throw"cors";s=s||{};let f,g,p=i.videoWidth,m=i.videoHeight,b=Math.max(p,m);if(b>this._maxCvsSideLength){let O=this._maxCvsSideLength/b;f=Math.round(p*O),g=Math.round(m*O)}else f=p,g=m;this.canvas||(this.canvas=document.createElement("canvas"));const T=this.canvas;T.width===f&&T.height===g||(T.width=f,T.height=g),T.ctx2d||(T.ctx2d=T.getContext("2d",{willReadFrequently:!0})),T.ctx2d.drawImage(i,0,0,p,m,0,0,f,g);let A=await this._decode_Canvas(T,s);if(this.ifSaveOriginalImageInACanvas){const O=document.createElement("canvas");O.width=i.videoWidth,O.height=i.videoHeight,O.getContext("2d").drawImage(i,0,0),this.oriCanvas=O,this.oriCanvasData=null}return L.recalculateResultLocation(A,0,0,p,m,f,g),A}async _decode_DCEFrame(i,s){if(L._onLog&&L._onLog("_decode_DCEFrame(dceFrame)"),!L.isDCEFrame(i))return[];let f=[];this.ifSaveOriginalImageInACanvas&&(this.oriCanvas=null,this.oriCanvasData={width:i.width,height:i.height,colorMode:i.colorMode,pixelFormat:i.pixelFormat,data:new Uint8Array(i.data),toCanvas:i.toCanvas});const{width:g,height:p,colorMode:m,pixelFormat:b,stride:T,timeStamp:A}=i;let O;O=s&&s.bCopyData?new Uint8Array(i.data):i.data;let B=null;if(s?(B=JSON.parse(JSON.stringify(s)),B.timeStamp=A):B={timeStamp:A},b&&T)if(b==="grey")f=await this._decodeBuffer_Uint8Array(O,g,p,T,xe.IPF_GrayScaled,0,B);else if(b==="rgba")f=await this._decodeBuffer_Uint8Array(O,g,p,T,xe.IPF_ABGR_8888,0,B);else{if(b!=="bgra")throw new Error(`Pixel format '${b}' is not supported to decode.`);f=await this._decodeBuffer_Uint8Array(O,g,p,T,xe.IPF_ARGB_8888,0,B)}else if(m==="grey")f=await this._decodeBuffer_Uint8Array(O,g,p,g,xe.IPF_GrayScaled,0,B);else if(m==="rgba")f=await this._decodeBuffer_Uint8Array(O,g,p,4*g,xe.IPF_ABGR_8888,0,B);else{if(m!=="bgra")throw new Error(`Color mode '${m}' is not supported to decode.`);f=await this._decodeBuffer_Uint8Array(O,g,p,4*g,xe.IPF_ARGB_8888,0,B)}return f}async _decode_DSImage(i,s){if(L._onLog&&L._onLog("_decode_DSImage(dsImage)"),!L.isDSImage(i))return null;this.ifSaveOriginalImageInACanvas&&(this.oriCanvas=null,this.oriCanvasData={width:i.width,height:i.height,pixelFormat:i.pixelFormat.toLowerCase(),data:new Uint8Array(i.data),toCanvas:function(){const A=document.createElement("canvas");let O;switch(A.width=this.width,A.height=this.height,this.pixelFormat){case"grey":O=new Uint8ClampedArray(this.width*this.height*4);for(let k=0;k<O.length;k+=4)O[k]=this.data[k/4],O[k+1]=this.data[k/4],O[k+2]=this.data[k/4],O[k+3]=255;break;case"rgb":O=new Uint8ClampedArray(this.width*this.height*4);for(let k=0;k<O.length;k+=4)O[k]=this.data[k],O[k+1]=this.data[k+1],O[k+2]=this.data[k+2],O[k+3]=255;break;case"bgr":O=new Uint8ClampedArray(this.width*this.height*4);for(let k=0;k<O.length;k+=4)O[k]=this.data[k],O[k+1]=this.data[k+1],O[k+2]=this.data[k+2],O[k+3]=255;break;case"rgba":case"bgra":O=new Uint8ClampedArray(this.data);break;default:throw new Error("The content of 2D Canvas is currently limited to the sRGB color space.")}const B=new ImageData(O,this.width,this.height);return A.getContext("2d").putImageData(B,0,0),A}});const{width:f,height:g}=i;let p,m,b,T=i.pixelFormat.toLowerCase();switch(p=s&&s.bCopyData?new Uint8Array(i.data):i.data,T){case"grey":b=xe.IPF_GrayScaled,m=f;break;case"rgb":b=xe.IPF_BGR_888,m=3*f;break;case"bgr":b=xe.IPF_RGB_888,m=3*f;break;case"rgba":b=xe.IPF_ABGR_8888,m=4*f;break;case"bgra":b=xe.IPF_ARGB_8888,m=4*f;break;default:throw new Error("The pixel format is not supported to decode.")}return await this._decodeBuffer_Uint8Array(p,f,g,m,b,0,s)}async _decode_Base64(i,s){if(L._onLog&&L._onLog("_decode_Base64(base64Str)"),typeof i!="string")return Promise.reject("'_decode_Base64(base64Str, config)': Type of 'base64Str' should be 'string'.");i.substring(0,11)=="data:image/"&&(i=i.substring(i.indexOf(",")+1));{let f=atob(i),g=f.length,p=new Uint8Array(g);for(;g--;)p[g]=f.charCodeAt(g);return await this._decode_Blob(new Blob([p]),s)}}async _decode_Url(i,s){if(L._onLog&&L._onLog("_decode_Url(url)"),typeof i!="string")throw TypeError("'_decode_Url(url, config)': Type of 'url' should be 'string'.");i=i;{let f=await new Promise((g,p)=>{let m=new XMLHttpRequest;m.open("GET",i,!0),m.responseType="blob",m.send(),m.onloadend=async()=>{g(m.response)},m.onerror=()=>{p(new Error("Network Error: "+m.statusText))}});return await this._decode_Blob(f,s)}}async _decode_FilePath(i,s){throw L._onLog&&L._onLog("_decode_FilePath(path)"),Error("'_decode_FilePath(path, config)': The method is only supported in node environment.")}static recalculateResultLocation(i,s,f,g,p,m,b){if(i.length>0)for(let T of i){let A=T.localizationResult;A.resultCoordinateType==2&&(A.x1*=.01*m,A.x2*=.01*m,A.x3*=.01*m,A.x4*=.01*m,A.y1*=.01*b,A.y2*=.01*b,A.y3*=.01*b,A.y4*=.01*b);let O=m/g,B=b/p;A.x1=A.x1/O+s,A.x2=A.x2/O+s,A.x3=A.x3/O+s,A.x4=A.x4/O+s,A.y1=A.y1/B+f,A.y2=A.y2/B+f,A.y3=A.y3/B+f,A.y4=A.y4/B+f,A.resultCoordinateType==2&&(A.x1*=100/g,A.x2*=100/g,A.x3*=100/g,A.x4*=100/g,A.y1*=100/p,A.y2*=100/p,A.y3*=100/p,A.y4*=100/p),A.x1=Math.round(A.x1),A.x2=Math.round(A.x2),A.x3=Math.round(A.x3),A.x4=Math.round(A.x4),A.y1=Math.round(A.y1),A.y2=Math.round(A.y2),A.y3=Math.round(A.y3),A.y4=Math.round(A.y4)}}static BarcodeReaderException(i,s){let f,g=Li.DBR_UNKNOWN;return typeof i=="number"?(g=i,f=new Error(s)):f=new Error(i),f.code=g,f}_handleRetJsonString(i){let s=Li;if(i.textResults){for(let f=0;f<i.textResults.length;f++){let g=i.textResults[f];try{let p=g.barcodeText,m="";for(let b=0;b<p.length;b++)m+=String.fromCharCode(p[b]);try{g.barcodeText=decodeURIComponent(escape(m))}catch(b){g.barcodeText=m}}catch(p){g.barcodeText=""}if(g.exception!=null){L._setWarnnedEx.has(g.exception)||(L._setWarnnedEx.add(g.exception),console.warn(g.exception));let p={};g.exception.split(";").forEach(m=>{let b=m.indexOf(":");p[m.substring(0,b)]=m.substring(b+1)}),g.exception=p}}return i.decodeRecords?this.decodeRecords=i.decodeRecords:this.decodeRecords={},this._lastErrorCode=i.exception,this._lastErrorString=i.description,i.exception&&!L._setWarnnedEx.has(i.description)&&(L._setWarnnedEx.add(i.description),console.warn(i.description)),i.textResults}if(i.exception==s.DBR_SUCCESS)return i.data;throw L.BarcodeReaderException(i.exception,i.description)}async setModeArgument(i,s,f,g){return await new Promise((p,m)=>{let b=L._nextTaskID++;L._taskCallbackMap.set(b,T=>{if(T.success){try{this._handleRetJsonString(T.setReturn)}catch(A){return m(A)}return p()}{let A=new Error(T.message);return A.stack=T.stack+`
`+A.stack,m(A)}}),L._dbrWorker.postMessage({type:"setModeArgument",id:b,instanceID:this._instanceID,body:{modeName:i,index:s,argumentName:f,argumentValue:g}})})}async getModeArgument(i,s,f){return await new Promise((g,p)=>{let m=L._nextTaskID++;L._taskCallbackMap.set(m,b=>{if(b.success){let T;try{T=this._handleRetJsonString(b.getReturn)}catch(A){return p(A)}return g(T)}{let T=new Error(b.message);return T.stack=b.stack+`
`+T.stack,p(T)}}),L._dbrWorker.postMessage({type:"getModeArgument",id:m,instanceID:this._instanceID,body:{modeName:i,index:s,argumentName:f}})})}async getIntermediateResults(){return await new Promise((i,s)=>{let f=L._nextTaskID++;L._taskCallbackMap.set(f,g=>{if(g.success)return i(g.results);{let p=new Error(g.message);return p.stack=g.stack+`
`+p.stack,s(p)}}),L._dbrWorker.postMessage({type:"getIntermediateResults",id:f,instanceID:this._instanceID,body:{isCharge:!0}})})}async getIntermediateCanvas(){let i=await this.getIntermediateResults(),s=[];for(let f of i)if(f.dataType==pr.IMRDT_IMAGE)for(let g of f.results){const p=g.bytes;let m;switch(L._onLog&&L._onLog(" "+p.length+" "+p.byteLength+" "+g.width+" "+g.height+" "+g.stride+" "+g.format),g.format){case xe.IPF_ABGR_8888:m=new Uint8ClampedArray(p);break;case xe.IPF_RGB_888:{const A=p.length/3;m=new Uint8ClampedArray(4*A);for(let O=0;O<A;++O)m[4*O]=p[3*O+2],m[4*O+1]=p[3*O+1],m[4*O+2]=p[3*O],m[4*O+3]=255;break}case xe.IPF_GrayScaled:{const A=p.length;m=new Uint8ClampedArray(4*A);for(let O=0;O<A;O++)m[4*O]=m[4*O+1]=m[4*O+2]=p[O],m[4*O+3]=255;break}case xe.IPF_Binary:case xe.IPF_BinaryInverted:{const A=p.length,O=g.width,B=g.height,k=g.stride;m=new Uint8ClampedArray(O*B*4);for(let Z=0;Z<A;Z++){let ie=p[Z],le=Z%k*8,ce=Math.floor(Z/k);for(let de=0;de<8;de++){let oe=le+de,ae=4*(ce*O+oe);if(oe>=O)break;m[ae]=m[ae+1]=m[ae+2]=(128&ie)/128*255,m[ae+3]=255,ie<<=1}}break}default:console.warn("unknow intermediate image",g)}if(!m)continue;let b=new ImageData(m,g.width,g.height),T=document.createElement("canvas");T.width=g.width,T.height=g.height,T.getContext("2d").putImageData(b,0,0),s.push(T)}return s}async getScanSettings(){return await new Promise((i,s)=>{let f=L._nextTaskID++;L._taskCallbackMap.set(f,g=>{if(g.success){let p=g.results;return p.intervalTime=this.intervalTime,p.whenToPlaySoundforSuccessfulRead=this.whenToPlaySoundforSuccessfulRead,p.soundOnSuccessfullRead=this.soundSource,p.whenToVibrateforSuccessfulRead=this.whenToVibrateforSuccessfulRead,p.vibrateDuration=this.vibrateDuration,p.captureAndDecodeInParallel=this.captureAndDecodeInParallel,p.autoZoom=this.autoZoom,p.autoFocus=this.autoFocus,p.autoSuggestTip=this.autoSuggestTip,i(p)}{let p=new Error(g.message);return p.stack+=`
`+g.stack,s(p)}}),L._dbrWorker.postMessage({type:"getScanSettings",id:f,instanceID:this._instanceID})})}async updateScanSettings(i){if(!i)return;const s=JSON.parse(JSON.stringify(i));if(s.autoZoom||s.autoFocus||s.autoSuggestTip){if(!L._bUseFullFeature)throw new Error("'autoZoom', 'autoFocus' and 'autoSuggestTip' are not supported in the compact version. Please try the full-featured version.");const f=await this.getRuntimeSettings();f.intermediateResultTypes|=ki.IRT_TYPED_BARCODE_ZONE,await this.updateRuntimeSettings(f)}return s.hasOwnProperty("intervalTime")&&(this.intervalTime=Math.max(s.intervalTime,0),delete s.intervalTime),s.hasOwnProperty("whenToPlaySoundforSuccessfulRead")&&(this.whenToPlaySoundforSuccessfulRead=s.whenToPlaySoundforSuccessfulRead,delete s.whenToPlaySoundforSuccessfulRead),s.hasOwnProperty("soundOnSuccessfullRead")&&(this.soundSource=s.soundOnSuccessfullRead,delete s.soundOnSuccessfullRead),s.hasOwnProperty("whenToVibrateforSuccessfulRead")&&(this.whenToVibrateforSuccessfulRead=s.whenToVibrateforSuccessfulRead,delete s.whenToVibrateforSuccessfulRead),s.hasOwnProperty("vibrateDuration")&&(this.vibrateDuration=s.vibrateDuration,delete s.vibrateDuration),s.hasOwnProperty("captureAndDecodeInParallel")&&(this.captureAndDecodeInParallel=s.captureAndDecodeInParallel,delete s.captureAndDecodeInParallel),s.hasOwnProperty("autoZoom")&&(this.autoZoom&&this.autoZoom!=s.autoZoom&&this.dce&&this.dce.setZoom({factor:1}).catch(()=>{}),this.autoZoom=s.autoZoom,delete s.autoZoom),s.hasOwnProperty("autoFocus")&&(this.autoFocus=s.autoFocus,this.dce&&this.dce.setFocus({mode:"continuous"}).catch(()=>{}),delete s.autoFocus),s.hasOwnProperty("autoSuggestTip")&&(this.autoSuggestTip=s.autoSuggestTip,delete s.autoFocus),await new Promise((f,g)=>{let p=L._nextTaskID++;L._taskCallbackMap.set(p,m=>{if(m.success)return f();{let b=new Error(m.message);return b.stack+=`
`+m.stack,g(b)}}),L._dbrWorker.postMessage({type:"updateScanSettings",id:p,instanceID:this._instanceID,body:{settings:s}})})}_cloneDecodeResults(i){if(i instanceof Array){let s=[];for(let f of i)s.push(this._cloneDecodeResults(f));return s}{let s=i;return JSON.parse(JSON.stringify(s,(g,p)=>g=="oriVideoCanvas"||g=="searchRegionCanvas"?void 0:p))}}async _loopReadVideo(){if(this.bDestroyed)return this.dce&&this._dceControler&&this._dceControler.setDisiredAction(this,"stopFetchingLoop"),this._clearResultsCanvasTimeoutId&&clearTimeout(this._clearResultsCanvasTimeoutId),void this._drawResults(null);if(this.dce&&!this.dce.isOpen())return this._clearResultsCanvasTimeoutId&&clearTimeout(this._clearResultsCanvasTimeoutId),this._drawResults(null),void await this.clearMapDecodeRecord();if(!this.dce&&!this._imgSource||this._bPauseScan)return L._onLog&&L._onLog("Scan is paused, or imageSource is not set. Ask in 1s."),await this.clearMapDecodeRecord(),this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),void(this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},this._intervalDetectVideoPause));L._onLog&&L._onLog("======= once read ======="),L._onLog&&(this._timeStartDecode=Date.now());let i=null,s=null;if(this.dce)i=this._getVideoFrame();else if(this._imgSource&&(s=await this._imgSource.getImage(),!L.isDSImage(s)))throw new Error("Invalid DSImage.");if(!i&&!s)return L._onLog&&L._onLog("Get invalid frame."),this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),void(this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},0));(async()=>{let f=[];if(i){f=await this._decode_DCEFrame(i,{bScanner:!0,bCopyData:!1});let g=null;if(f&&f.length){const{sx:p,sy:m,width:b,height:T,_sWidth:A,_sHeight:O}=i;g=f.map(B=>({resultState:B.resultState,localizationResult:JSON.parse(JSON.stringify(B.localizationResult))})),L.recalculateResultLocation(g,p,m,A,O,b,T)}this._resultHighlightingDuration==0?this._drawResults(null):this._drawResults(g,f),this._clearResultsCanvasTimeoutId&&clearTimeout(this._clearResultsCanvasTimeoutId),this._resultHighlightingDuration>0&&(this._clearResultsCanvasTimeoutId=setTimeout(()=>{this.bDestroyed||this._drawResults(null)},this._resultHighlightingDuration))}else s&&(f=await this._decode_DSImage(s,{bScanner:!0,bCopyData:!1}));return f})().then(f=>{if(L._onLog&&L._onLog(f),this.dce&&this.captureAndDecodeInParallel){let g=this.array_decodeFrameTimeCost,p=this.array_getFrameTimeCost;const m=()=>{let b=0;if(p&&p.length){let T=Math.min(...g),A=Math.max(...p);T&&A&&(b=T-A)}else b=0;return b>0?b:0};(()=>{for(;g.length>=5;)g.shift();g.push(this._lastInnerDecodeDuration)})(),this._intervalGetVideoFrame=m()+this.intervalTime}if((this.dce&&this.dce.isOpen()||this._imgSource)&&!this._bPauseScan){if(this.bPlaySoundOnSuccessfulRead&&f.length){let g=!1;this.bPlaySoundOnSuccessfulRead===!0||this.bPlaySoundOnSuccessfulRead==="frame"?g=f.some(p=>p.resultState>=0):this.bPlaySoundOnSuccessfulRead==="unique"&&(g=f.some(p=>p.resultState==0)),g&&this.beepSound&&(this.beepSound.stop(),this.beepSound.play())}if(navigator.vibrate&&this.bVibrateOnSuccessfulRead&&f.length){let g=!1;if(this.bVibrateOnSuccessfulRead===!0||this.bVibrateOnSuccessfulRead==="frame"?g=f.some(p=>p.resultState>=0):this.bVibrateOnSuccessfulRead==="unique"&&(g=f.some(p=>p.resultState==0)),g)try{navigator.vibrate(this.vibrateDuration)}catch(p){console.warn("Vibration not allowed. User interaction required: "+(p.message||p))}}if(this.onImageRead){f=f.filter(p=>p.resultState>=0);const g=this._cloneDecodeResults(f);this.onImageRead(g)}if(this.onUniqueRead){f=f.filter(p=>p.resultState==0);const g=this._cloneDecodeResults(f);for(let p of g)this.onUniqueRead(p.barcodeText,p)}}this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this.intervalTime?this._loopReadVideoTimeoutId=setTimeout(()=>{this._loopReadVideo()},this.intervalTime):this._loopReadVideo()}).catch(f=>{this.dce&&this._dceControler&&this._dceControler.setDisiredAction(this,"stopFetchingLoop"),L._onLog&&L._onLog(f.message||f),this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this._loopReadVideoTimeoutId=setTimeout(()=>{this.dce&&(this.dce.startFetchingLoop(),this._dceControler&&this._dceControler.clearUserDisiredAction({user:this,actionName:"stopFetchingLoop"})),this._loopReadVideo()},Math.max(this.intervalTime,1e3)),f.message=="platform error"||console.warn(f.message)})}_getVideoFrame(){if(!this.dce)return null;let i;if(this.captureAndDecodeInParallel){if(L._onLog&&L._onLog("Get frame in parallel."),this._dceControler&&this._dceControler.setDisiredValue(this,"loopInterval",this._intervalGetVideoFrame),!this.dce.numberOfFramesInBuffer)return this._dceControler&&this._dceControler.setDisiredValue(this,"loopInterval",0),null;i=this.dce.getFrameFromBuffer(),(f=>{if(!f)return;let g=f.timeSpent,p=this.array_getFrameTimeCost;for(;p.length>=5;)p.shift();p.push(g)})(i)}else L._onLog&&L._onLog("Get frame in serial."),this._dceControler&&this._dceControler.setDisiredAction(this,"stopFetchingLoop"),i=this.dce.getFrame();return i}_drawResults(i,s){if(!this.dce||this.dce.disposed||this._bPauseScan||!this._drawingItemNamespace||!this._drawingItemNamespace.DT_Polygon)return;if(!this._dbrDrawingLayer){if(!this.dce.isOpen()||!(this.dce.singleFrameMode||this.dce.video&&this.dce._videoTrack))return;this._dbrDrawingLayer=this.dce.getDrawingLayer(3)}const f=this._dbrDrawingLayer;i||(i=[]);let g=this._arrPolygons;for(let p=0;p<i.length;p++){let m,b=i[p].localizationResult;g[p]?(m=g[p],f.hasDrawingItem(m)||f.addDrawingItem(m),m.set("vertices",[{x:b.x1,y:b.y1},{x:b.x2,y:b.y2},{x:b.x3,y:b.y3},{x:b.x4,y:b.y4}]),(m.set||m.setAttribute).call(m,"vertices",[{x:b.x1,y:b.y1},{x:b.x2,y:b.y2},{x:b.x3,y:b.y3},{x:b.x4,y:b.y4}])):(m=new this._drawingItemNamespace.DT_Polygon([{x:b.x1,y:b.y1},{x:b.x2,y:b.y2},{x:b.x3,y:b.y3},{x:b.x4,y:b.y4}]),f.addDrawingItem(m),g[p]=m),i[p].resultState===-1?(m.styleId=this._styleIdBeforeVerification,m._mapStyle.set("default",this.dce.getDrawingStyle(this._styleIdBeforeVerification)),m._mapStyle.set("selected",this.dce.getDrawingStyle(this._styleIdBeforeVerification))):(m.styleId=null,m._mapStyle.set("default",this.dce.getDrawingStyle(3)),m._mapStyle.set("selected",this.dce.getDrawingStyle(7))),s&&s[p]?m.addNote({name:"Barcode_Result",content:s[p]},!0):m.addNote({name:"Barcode_Result",content:i[p]},!0)}for(let p=i.length;p<g.length;p++)g[p].deleteNote("Barcode_Result"),f.removeDrawingItem(g[p]);f.renderAll()}async startScanning(i){if(!this.dce&&!this._imgSource)throw new Error("'imageSource' is not set. call 'setImageSource()' before 'startScanning()'.");if(this._promiseStartScan&&this._promiseStartScan.isPending)return this._promiseStartScan;this._promiseStartScan=new fo;let s=null;if(this.dce){if(this.dce.isOpen())if(i&&this.dce.appendAndShowUI(),this.dce.playCallbackInfo)s=JSON.parse(JSON.stringify(this.dce.playCallbackInfo));else{const f=this.dce.getSelectedCamera();s={width:this.dce.video.videoWidth,height:this.dce.video.videoHeight,deviceId:f&&f.deviceId}}else if(s=await this.dce.open(i),!this._promiseStartScan)return null;this._dceControler&&(this._dceControler.clearUserDisiredAction({user:this,actionName:"close"}),this._dceControler.setDisiredValue(this,"ifShowScanRegionLaser",!0),this.dce.ifShowScanRegionLaser&&this.dce.showScanRegionLaser())}return this._bPauseScan=!1,this.dce&&this.dce.singleFrameMode||(this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this._loopReadVideoTimeoutId=setTimeout(()=>{this.dce&&(this.dce.startFetchingLoop(),this._dceControler&&this._dceControler.clearUserDisiredAction({user:this,actionName:"stopFetchingLoop"})),this._loopReadVideo()},0)),this._promiseStartScan.resolve(s),s}stopScanning(i){this.dce&&(this._clearResultsCanvasTimeoutId&&clearTimeout(this._clearResultsCanvasTimeoutId),this._drawResults(null),this._dceControler&&(this._dceControler.setDisiredValue(this,"ifShowScanRegionLaser",!1),this.dce.ifShowScanRegionLaser||this.dce.hideScanRegionLaser(),this._dceControler.setDisiredAction(this,"close",[i]))),this._bPauseScan=!0,this._loopReadVideoTimeoutId&&clearTimeout(this._loopReadVideoTimeoutId),this.array_decodeFrameTimeCost.length=0,this.array_getFrameTimeCost.length=0,this._intervalGetVideoFrame=0,this._promiseStartScan=null}pauseScanning(i){if(this._clearResultsCanvasTimeoutId&&clearTimeout(this._clearResultsCanvasTimeoutId),i&&i.keepResultsHighlighted||this._drawResults(null),this._bPauseScan=!0,this.dce){if(this.dce.singleFrameMode)throw new Error("'pauseScanning()' is unavailable when property 'singleFrameMode' of the 'CameraEnhancer' instance is true.");this._dceControler&&(this._dceControler.setDisiredValue(this,"ifShowScanRegionLaser",!1),this.dce.ifShowScanRegionLaser||this.dce.hideScanRegionLaser(),this._dceControler.setDisiredAction(this,"stopFetchingLoop"))}}resumeScanning(){if(this._bPauseScan=!1,this.dce){if(this.dce.singleFrameMode)throw new Error("'resumeScanning()' is unavailable when property 'singleFrameMode' of the 'CameraEnhancer' instance is true.");this.dce.startFetchingLoop(),this._dceControler&&(this._dceControler.clearUserDisiredAction({user:this,actionName:"stopFetchingLoop"}),this._dceControler.setDisiredValue(this,"ifShowScanRegionLaser",!0),this.dce.ifShowScanRegionLaser&&this.dce.showScanRegionLaser())}}destroyContext(){if(L._onLog&&L._onLog("destroyContext()"),this.bDestroyed)return;this.bDestroyed=!0,(this.dce||this._promiseStartScan)&&this.stopScanning(),this.setImageSource(null);let i=L._nextTaskID++;L._taskCallbackMap.set(i,s=>{if(!s.success){let f=new Error(s.message);throw f.stack=s.stack+`
`+f.stack,f}}),L._dbrWorker.postMessage({type:"destroyContext",id:i,instanceID:this._instanceID})}}L._jsVersion="9.6.32",L._jsEditVersion="20231027",L._version=`loading...(JS ${L._jsVersion}.${L._jsEditVersion})`,L._license=Vl,L._sessionPassword=Wl,L.browserInfo=we,L._workerName=`dbr-${L._jsVersion}.browser.worker.js`,L._engineResourcePath=Gl,L._licenseServer=[],L._deviceFriendlyName="",L._isShowRelDecodeTimeInResults=!1,L._bWasmDebug=!1,L._bNeverShowDialog=!1,L.__bUseFullFeature=!0,L._nextTaskID=0,L._taskCallbackMap=new Map,L._pLoad=new fo,L._lastErrorCode=0,L._lastErrorString="",L._setWarnnedEx=new Set,L._defaultUIElementURL="@engineResourcePath/dbr.ui.html";var Hl={653:(e,i,s)=>{var f,g,p,m,b,T,A,O,B,k,Z,ie,le,ce,de,oe,ae,ve,Ee,Ie,Ce,v=v||{version:"5.2.1"};if(i.fabric=v,typeof document<"u"&&typeof window<"u")document instanceof(typeof HTMLDocument<"u"?HTMLDocument:Document)?v.document=document:v.document=document.implementation.createHTMLDocument(""),v.window=window;else{var Ge=new(s(192)).JSDOM(decodeURIComponent("%3C!DOCTYPE%20html%3E%3Chtml%3E%3Chead%3E%3C%2Fhead%3E%3Cbody%3E%3C%2Fbody%3E%3C%2Fhtml%3E"),{features:{FetchExternalResources:["img"]},resources:"usable"}).window;v.document=Ge.document,v.jsdomImplForWrapper=s(898).implForWrapper,v.nodeCanvas=s(245).Canvas,v.window=Ge,DOMParser=v.window.DOMParser}function Ve(o,r){var a=o.canvas,l=r.targetCanvas,t=l.getContext("2d");t.translate(0,l.height),t.scale(1,-1);var n=a.height-l.height;t.drawImage(a,0,n,l.width,l.height,0,0,l.width,l.height)}function We(o,r){var a=r.targetCanvas.getContext("2d"),l=r.destinationWidth,t=r.destinationHeight,n=l*t*4,c=new Uint8Array(this.imageBuffer,0,n),d=new Uint8ClampedArray(this.imageBuffer,0,n);o.readPixels(0,0,l,t,o.RGBA,o.UNSIGNED_BYTE,c);var h=new ImageData(d,l,t);a.putImageData(h,0,0)}v.isTouchSupported="ontouchstart"in v.window||"ontouchstart"in v.document||v.window&&v.window.navigator&&v.window.navigator.maxTouchPoints>0,v.isLikelyNode=typeof Buffer<"u"&&typeof window>"u",v.SHARED_ATTRIBUTES=["display","transform","fill","fill-opacity","fill-rule","opacity","stroke","stroke-dasharray","stroke-linecap","stroke-dashoffset","stroke-linejoin","stroke-miterlimit","stroke-opacity","stroke-width","id","paint-order","vector-effect","instantiated_by_use","clip-path"],v.DPI=96,v.reNum="(?:[-+]?(?:\\d+|\\d*\\.\\d+)(?:[eE][-+]?\\d+)?)",v.commaWsp="(?:\\s+,?\\s*|,\\s*)",v.rePathCommand=/([-+]?((\d+\.\d+)|((\d+)|(\.\d+)))(?:[eE][-+]?\d+)?)/gi,v.reNonWord=/[ \n\.,;!\?\-]/,v.fontPaths={},v.iMatrix=[1,0,0,1,0,0],v.svgNS="http://www.w3.org/2000/svg",v.perfLimitSizeTotal=2097152,v.maxCacheSideLimit=4096,v.minCacheSideLimit=256,v.charWidthsCache={},v.textureSize=2048,v.disableStyleCopyPaste=!1,v.enableGLFiltering=!0,v.devicePixelRatio=v.window.devicePixelRatio||v.window.webkitDevicePixelRatio||v.window.mozDevicePixelRatio||1,v.browserShadowBlurConstant=1,v.arcToSegmentsCache={},v.boundsOfCurveCache={},v.cachesBoundsOfCurve=!0,v.forceGLPutImageData=!1,v.initFilterBackend=function(){return v.enableGLFiltering&&v.isWebglSupported&&v.isWebglSupported(v.textureSize)?(console.log("max texture size: "+v.maxTextureSize),new v.WebglFilterBackend({tileSize:v.textureSize})):v.Canvas2dFilterBackend?new v.Canvas2dFilterBackend:void 0},typeof document<"u"&&typeof window<"u"&&(window.fabric=v),function(){function o(a,l){if(this.__eventListeners[a]){var t=this.__eventListeners[a];l?t[t.indexOf(l)]=!1:v.util.array.fill(t,!1)}}function r(a,l){var t=function(){l.apply(this,arguments),this.off(a,t)}.bind(this);this.on(a,t)}v.Observable={fire:function(a,l){if(!this.__eventListeners)return this;var t=this.__eventListeners[a];if(!t)return this;for(var n=0,c=t.length;n<c;n++)t[n]&&t[n].call(this,l||{});return this.__eventListeners[a]=t.filter(function(d){return d!==!1}),this},on:function(a,l){if(this.__eventListeners||(this.__eventListeners={}),arguments.length===1)for(var t in a)this.on(t,a[t]);else this.__eventListeners[a]||(this.__eventListeners[a]=[]),this.__eventListeners[a].push(l);return this},once:function(a,l){if(arguments.length===1)for(var t in a)r.call(this,t,a[t]);else r.call(this,a,l);return this},off:function(a,l){if(!this.__eventListeners)return this;if(arguments.length===0)for(a in this.__eventListeners)o.call(this,a);else if(arguments.length===1&&typeof arguments[0]=="object")for(var t in a)o.call(this,t,a[t]);else o.call(this,a,l);return this}}}(),v.Collection={_objects:[],add:function(){if(this._objects.push.apply(this._objects,arguments),this._onObjectAdded)for(var o=0,r=arguments.length;o<r;o++)this._onObjectAdded(arguments[o]);return this.renderOnAddRemove&&this.requestRenderAll(),this},insertAt:function(o,r,a){var l=this._objects;return a?l[r]=o:l.splice(r,0,o),this._onObjectAdded&&this._onObjectAdded(o),this.renderOnAddRemove&&this.requestRenderAll(),this},remove:function(){for(var o,r=this._objects,a=!1,l=0,t=arguments.length;l<t;l++)(o=r.indexOf(arguments[l]))!==-1&&(a=!0,r.splice(o,1),this._onObjectRemoved&&this._onObjectRemoved(arguments[l]));return this.renderOnAddRemove&&a&&this.requestRenderAll(),this},forEachObject:function(o,r){for(var a=this.getObjects(),l=0,t=a.length;l<t;l++)o.call(r,a[l],l,a);return this},getObjects:function(o){return o===void 0?this._objects.concat():this._objects.filter(function(r){return r.type===o})},item:function(o){return this._objects[o]},isEmpty:function(){return this._objects.length===0},size:function(){return this._objects.length},contains:function(o,r){return this._objects.indexOf(o)>-1||!!r&&this._objects.some(function(a){return typeof a.contains=="function"&&a.contains(o,!0)})},complexity:function(){return this._objects.reduce(function(o,r){return o+(r.complexity?r.complexity():0)},0)}},v.CommonMethods={_setOptions:function(o){for(var r in o)this.set(r,o[r])},_initGradient:function(o,r){!o||!o.colorStops||o instanceof v.Gradient||this.set(r,new v.Gradient(o))},_initPattern:function(o,r,a){!o||!o.source||o instanceof v.Pattern?a&&a():this.set(r,new v.Pattern(o,a))},_setObject:function(o){for(var r in o)this._set(r,o[r])},set:function(o,r){return typeof o=="object"?this._setObject(o):this._set(o,r),this},_set:function(o,r){this[o]=r},toggle:function(o){var r=this.get(o);return typeof r=="boolean"&&this.set(o,!r),this},get:function(o){return this[o]}},f=i,g=Math.sqrt,p=Math.atan2,m=Math.pow,b=Math.PI/180,T=Math.PI/2,v.util={cos:function(o){if(o===0)return 1;switch(o<0&&(o=-o),o/T){case 1:case 3:return 0;case 2:return-1}return Math.cos(o)},sin:function(o){if(o===0)return 0;var r=1;switch(o<0&&(r=-1),o/T){case 1:return r;case 2:return 0;case 3:return-r}return Math.sin(o)},removeFromArray:function(o,r){var a=o.indexOf(r);return a!==-1&&o.splice(a,1),o},getRandomInt:function(o,r){return Math.floor(Math.random()*(r-o+1))+o},degreesToRadians:function(o){return o*b},radiansToDegrees:function(o){return o/b},rotatePoint:function(o,r,a){var l=new v.Point(o.x-r.x,o.y-r.y),t=v.util.rotateVector(l,a);return new v.Point(t.x,t.y).addEquals(r)},rotateVector:function(o,r){var a=v.util.sin(r),l=v.util.cos(r);return{x:o.x*l-o.y*a,y:o.x*a+o.y*l}},createVector:function(o,r){return new v.Point(r.x-o.x,r.y-o.y)},calcAngleBetweenVectors:function(o,r){return Math.acos((o.x*r.x+o.y*r.y)/(Math.hypot(o.x,o.y)*Math.hypot(r.x,r.y)))},getHatVector:function(o){return new v.Point(o.x,o.y).multiply(1/Math.hypot(o.x,o.y))},getBisector:function(o,r,a){var l=v.util.createVector(o,r),t=v.util.createVector(o,a),n=v.util.calcAngleBetweenVectors(l,t),c=n*(v.util.calcAngleBetweenVectors(v.util.rotateVector(l,n),t)===0?1:-1)/2;return{vector:v.util.getHatVector(v.util.rotateVector(l,c)),angle:n}},projectStrokeOnPoints:function(o,r,a){var l=[],t=r.strokeWidth/2,n=r.strokeUniform?new v.Point(1/r.scaleX,1/r.scaleY):new v.Point(1,1),c=function(d){var h=t/Math.hypot(d.x,d.y);return new v.Point(d.x*h*n.x,d.y*h*n.y)};return o.length<=1||o.forEach(function(d,h){var u,_,y=new v.Point(d.x,d.y);h===0?(_=o[h+1],u=a?c(v.util.createVector(_,y)).addEquals(y):o[o.length-1]):h===o.length-1?(u=o[h-1],_=a?c(v.util.createVector(u,y)).addEquals(y):o[0]):(u=o[h-1],_=o[h+1]);var C,x,S=v.util.getBisector(y,u,_),w=S.vector,E=S.angle;if(r.strokeLineJoin==="miter"&&(C=-t/Math.sin(E/2),x=new v.Point(w.x*C*n.x,w.y*C*n.y),Math.hypot(x.x,x.y)/t<=r.strokeMiterLimit))return l.push(y.add(x)),void l.push(y.subtract(x));C=-t*Math.SQRT2,x=new v.Point(w.x*C*n.x,w.y*C*n.y),l.push(y.add(x)),l.push(y.subtract(x))}),l},transformPoint:function(o,r,a){return a?new v.Point(r[0]*o.x+r[2]*o.y,r[1]*o.x+r[3]*o.y):new v.Point(r[0]*o.x+r[2]*o.y+r[4],r[1]*o.x+r[3]*o.y+r[5])},makeBoundingBoxFromPoints:function(o,r){if(r)for(var a=0;a<o.length;a++)o[a]=v.util.transformPoint(o[a],r);var l=[o[0].x,o[1].x,o[2].x,o[3].x],t=v.util.array.min(l),n=v.util.array.max(l)-t,c=[o[0].y,o[1].y,o[2].y,o[3].y],d=v.util.array.min(c);return{left:t,top:d,width:n,height:v.util.array.max(c)-d}},invertTransform:function(o){var r=1/(o[0]*o[3]-o[1]*o[2]),a=[r*o[3],-r*o[1],-r*o[2],r*o[0]],l=v.util.transformPoint({x:o[4],y:o[5]},a,!0);return a[4]=-l.x,a[5]=-l.y,a},toFixed:function(o,r){return parseFloat(Number(o).toFixed(r))},parseUnit:function(o,r){var a=/\D{0,2}$/.exec(o),l=parseFloat(o);switch(r||(r=v.Text.DEFAULT_SVG_FONT_SIZE),a[0]){case"mm":return l*v.DPI/25.4;case"cm":return l*v.DPI/2.54;case"in":return l*v.DPI;case"pt":return l*v.DPI/72;case"pc":return l*v.DPI/72*12;case"em":return l*r;default:return l}},falseFunction:function(){return!1},getKlass:function(o,r){return o=v.util.string.camelize(o.charAt(0).toUpperCase()+o.slice(1)),v.util.resolveNamespace(r)[o]},getSvgAttributes:function(o){var r=["instantiated_by_use","style","id","class"];switch(o){case"linearGradient":r=r.concat(["x1","y1","x2","y2","gradientUnits","gradientTransform"]);break;case"radialGradient":r=r.concat(["gradientUnits","gradientTransform","cx","cy","r","fx","fy","fr"]);break;case"stop":r=r.concat(["offset","stop-color","stop-opacity"])}return r},resolveNamespace:function(o){if(!o)return v;var r,a=o.split("."),l=a.length,t=f||v.window;for(r=0;r<l;++r)t=t[a[r]];return t},loadImage:function(o,r,a,l){if(o){var t=v.util.createImage(),n=function(){r&&r.call(a,t,!1),t=t.onload=t.onerror=null};t.onload=n,t.onerror=function(){v.log("Error loading "+t.src),r&&r.call(a,null,!0),t=t.onload=t.onerror=null},o.indexOf("data")!==0&&l!=null&&(t.crossOrigin=l),o.substring(0,14)==="data:image/svg"&&(t.onload=null,v.util.loadImageInDom(t,n)),t.src=o}else r&&r.call(a,o)},loadImageInDom:function(o,r){var a=v.document.createElement("div");a.style.width=a.style.height="1px",a.style.left=a.style.top="-100%",a.style.position="absolute",a.appendChild(o),v.document.querySelector("body").appendChild(a),o.onload=function(){r(),a.parentNode.removeChild(a),a=null}},enlivenObjects:function(o,r,a,l){var t=[],n=0,c=(o=o||[]).length;function d(){++n===c&&r&&r(t.filter(function(h){return h}))}c?o.forEach(function(h,u){h&&h.type?v.util.getKlass(h.type,a).fromObject(h,function(_,y){y||(t[u]=_),l&&l(h,_,y),d()}):d()}):r&&r(t)},enlivenObjectEnlivables:function(o,r,a){var l=v.Object.ENLIVEN_PROPS.filter(function(t){return!!o[t]});v.util.enlivenObjects(l.map(function(t){return o[t]}),function(t){var n={};l.forEach(function(c,d){n[c]=t[d],r&&(r[c]=t[d])}),a&&a(n)})},enlivenPatterns:function(o,r){function a(){++t===n&&r&&r(l)}var l=[],t=0,n=(o=o||[]).length;n?o.forEach(function(c,d){c&&c.source?new v.Pattern(c,function(h){l[d]=h,a()}):(l[d]=c,a())}):r&&r(l)},groupSVGElements:function(o,r,a){var l;return o&&o.length===1?o[0]:(r&&(r.width&&r.height?r.centerPoint={x:r.width/2,y:r.height/2}:(delete r.width,delete r.height)),l=new v.Group(o,r),a!==void 0&&(l.sourcePath=a),l)},populateWithProperties:function(o,r,a){if(a&&Array.isArray(a))for(var l=0,t=a.length;l<t;l++)a[l]in o&&(r[a[l]]=o[a[l]])},createCanvasElement:function(){return v.document.createElement("canvas")},copyCanvasElement:function(o){var r=v.util.createCanvasElement();return r.width=o.width,r.height=o.height,r.getContext("2d").drawImage(o,0,0),r},toDataURL:function(o,r,a){return o.toDataURL("image/"+r,a)},createImage:function(){return v.document.createElement("img")},multiplyTransformMatrices:function(o,r,a){return[o[0]*r[0]+o[2]*r[1],o[1]*r[0]+o[3]*r[1],o[0]*r[2]+o[2]*r[3],o[1]*r[2]+o[3]*r[3],a?0:o[0]*r[4]+o[2]*r[5]+o[4],a?0:o[1]*r[4]+o[3]*r[5]+o[5]]},qrDecompose:function(o){var r=p(o[1],o[0]),a=m(o[0],2)+m(o[1],2),l=g(a),t=(o[0]*o[3]-o[2]*o[1])/l,n=p(o[0]*o[2]+o[1]*o[3],a);return{angle:r/b,scaleX:l,scaleY:t,skewX:n/b,skewY:0,translateX:o[4],translateY:o[5]}},calcRotateMatrix:function(o){if(!o.angle)return v.iMatrix.concat();var r=v.util.degreesToRadians(o.angle),a=v.util.cos(r),l=v.util.sin(r);return[a,l,-l,a,0,0]},calcDimensionsMatrix:function(o){var r=o.scaleX===void 0?1:o.scaleX,a=o.scaleY===void 0?1:o.scaleY,l=[o.flipX?-r:r,0,0,o.flipY?-a:a,0,0],t=v.util.multiplyTransformMatrices,n=v.util.degreesToRadians;return o.skewX&&(l=t(l,[1,0,Math.tan(n(o.skewX)),1],!0)),o.skewY&&(l=t(l,[1,Math.tan(n(o.skewY)),0,1],!0)),l},composeMatrix:function(o){var r=[1,0,0,1,o.translateX||0,o.translateY||0],a=v.util.multiplyTransformMatrices;return o.angle&&(r=a(r,v.util.calcRotateMatrix(o))),(o.scaleX!==1||o.scaleY!==1||o.skewX||o.skewY||o.flipX||o.flipY)&&(r=a(r,v.util.calcDimensionsMatrix(o))),r},resetObjectTransform:function(o){o.scaleX=1,o.scaleY=1,o.skewX=0,o.skewY=0,o.flipX=!1,o.flipY=!1,o.rotate(0)},saveObjectTransform:function(o){return{scaleX:o.scaleX,scaleY:o.scaleY,skewX:o.skewX,skewY:o.skewY,angle:o.angle,left:o.left,flipX:o.flipX,flipY:o.flipY,top:o.top}},isTransparent:function(o,r,a,l){l>0&&(r>l?r-=l:r=0,a>l?a-=l:a=0);var t,n=!0,c=o.getImageData(r,a,2*l||1,2*l||1),d=c.data.length;for(t=3;t<d&&(n=c.data[t]<=0)!=0;t+=4);return c=null,n},parsePreserveAspectRatioAttribute:function(o){var r,a="meet",l=o.split(" ");return l&&l.length&&((a=l.pop())!=="meet"&&a!=="slice"?(r=a,a="meet"):l.length&&(r=l.pop())),{meetOrSlice:a,alignX:r!=="none"?r.slice(1,4):"none",alignY:r!=="none"?r.slice(5,8):"none"}},clearFabricFontCache:function(o){(o=(o||"").toLowerCase())?v.charWidthsCache[o]&&delete v.charWidthsCache[o]:v.charWidthsCache={}},limitDimsByArea:function(o,r){var a=Math.sqrt(r*o),l=Math.floor(r/a);return{x:Math.floor(a),y:l}},capValue:function(o,r,a){return Math.max(o,Math.min(r,a))},findScaleToFit:function(o,r){return Math.min(r.width/o.width,r.height/o.height)},findScaleToCover:function(o,r){return Math.max(r.width/o.width,r.height/o.height)},matrixToSVG:function(o){return"matrix("+o.map(function(r){return v.util.toFixed(r,v.Object.NUM_FRACTION_DIGITS)}).join(" ")+")"},removeTransformFromObject:function(o,r){var a=v.util.invertTransform(r),l=v.util.multiplyTransformMatrices(a,o.calcOwnMatrix());v.util.applyTransformToObject(o,l)},addTransformToObject:function(o,r){v.util.applyTransformToObject(o,v.util.multiplyTransformMatrices(r,o.calcOwnMatrix()))},applyTransformToObject:function(o,r){var a=v.util.qrDecompose(r),l=new v.Point(a.translateX,a.translateY);o.flipX=!1,o.flipY=!1,o.set("scaleX",a.scaleX),o.set("scaleY",a.scaleY),o.skewX=a.skewX,o.skewY=a.skewY,o.angle=a.angle,o.setPositionByOrigin(l,"center","center")},sizeAfterTransform:function(o,r,a){var l=o/2,t=r/2,n=[{x:-l,y:-t},{x:l,y:-t},{x:-l,y:t},{x:l,y:t}],c=v.util.calcDimensionsMatrix(a),d=v.util.makeBoundingBoxFromPoints(n,c);return{x:d.width,y:d.height}},mergeClipPaths:function(o,r){var a=o,l=r;a.inverted&&!l.inverted&&(a=r,l=o),v.util.applyTransformToObject(l,v.util.multiplyTransformMatrices(v.util.invertTransform(a.calcTransformMatrix()),l.calcTransformMatrix()));var t=a.inverted&&l.inverted;return t&&(a.inverted=l.inverted=!1),new v.Group([a],{clipPath:l,inverted:t})}},function(){var o=Array.prototype.join,r={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7},a={m:"l",M:"L"};function l(x,S,w,E,M,F,H,G,U,D,I){var N=v.util.cos(x),W=v.util.sin(x),X=v.util.cos(S),P=v.util.sin(S),R=w*M*X-E*F*P+H,j=E*M*X+w*F*P+G;return["C",D+U*(-w*M*W-E*F*N),I+U*(-E*M*W+w*F*N),R+U*(w*M*P+E*F*X),j+U*(E*M*P-w*F*X),R,j]}function t(x,S,w,E){var M=Math.atan2(S,x),F=Math.atan2(E,w);return F>=M?F-M:2*Math.PI-(M-F)}function n(x,S,w){for(var E=w[1],M=w[2],F=w[3],H=w[4],G=w[5],U=function(N,W,X,P,R,j,z){var V=Math.PI,$=z*V/180,te=v.util.sin($),J=v.util.cos($),q=0,ee=0,Q=-J*N*.5-te*W*.5,re=-J*W*.5+te*N*.5,se=(X=Math.abs(X))*X,ne=(P=Math.abs(P))*P,ue=re*re,pe=Q*Q,Fe=se*ne-se*ue-ne*pe,ze=0;if(Fe<0){var St=Math.sqrt(1-Fe/(se*ne));X*=St,P*=St}else ze=(R===j?-1:1)*Math.sqrt(Fe/(se*ue+ne*pe));var _e=ze*X*re/P,Be=-ze*P*Q/X,kt=J*_e-te*Be+.5*N,xt=te*_e+J*Be+.5*W,lt=t(1,0,(Q-_e)/X,(re-Be)/P),Tt=t((Q-_e)/X,(re-Be)/P,(-Q-_e)/X,(-re-Be)/P);j===0&&Tt>0?Tt-=2*V:j===1&&Tt<0&&(Tt+=2*V);for(var Vr=Math.ceil(Math.abs(Tt/V*2)),ri=[],Ft=Tt/Vr,go=8/3*Math.sin(Ft/4)*Math.sin(Ft/4)/Math.sin(Ft/2),Bi=lt+Ft,Bt=0;Bt<Vr;Bt++)ri[Bt]=l(lt,Bi,J,te,X,P,kt,xt,go,q,ee),q=ri[Bt][5],ee=ri[Bt][6],lt=Bi,Bi+=Ft;return ri}(w[6]-x,w[7]-S,E,M,H,G,F),D=0,I=U.length;D<I;D++)U[D][1]+=x,U[D][2]+=S,U[D][3]+=x,U[D][4]+=S,U[D][5]+=x,U[D][6]+=S;return U}function c(x,S,w,E){return Math.sqrt((w-x)*(w-x)+(E-S)*(E-S))}function d(x,S,w,E,M,F,H,G){return function(U){var D,I=(D=U)*D*D,N=function(P){return 3*P*P*(1-P)}(U),W=function(P){return 3*P*(1-P)*(1-P)}(U),X=function(P){return(1-P)*(1-P)*(1-P)}(U);return{x:H*I+M*N+w*W+x*X,y:G*I+F*N+E*W+S*X}}}function h(x,S,w,E,M,F,H,G){return function(U){var D=1-U,I=3*D*D*(w-x)+6*D*U*(M-w)+3*U*U*(H-M),N=3*D*D*(E-S)+6*D*U*(F-E)+3*U*U*(G-F);return Math.atan2(N,I)}}function u(x,S,w,E,M,F){return function(H){var G,U=(G=H)*G,D=function(N){return 2*N*(1-N)}(H),I=function(N){return(1-N)*(1-N)}(H);return{x:M*U+w*D+x*I,y:F*U+E*D+S*I}}}function _(x,S,w,E,M,F){return function(H){var G=1-H,U=2*G*(w-x)+2*H*(M-w),D=2*G*(E-S)+2*H*(F-E);return Math.atan2(D,U)}}function y(x,S,w){var E,M,F={x:S,y:w},H=0;for(M=1;M<=100;M+=1)E=x(M/100),H+=c(F.x,F.y,E.x,E.y),F=E;return H}function C(x){for(var S,w,E,M,F=0,H=x.length,G=0,U=0,D=0,I=0,N=[],W=0;W<H;W++){switch(E={x:G,y:U,command:(S=x[W])[0]},S[0]){case"M":E.length=0,D=G=S[1],I=U=S[2];break;case"L":E.length=c(G,U,S[1],S[2]),G=S[1],U=S[2];break;case"C":w=d(G,U,S[1],S[2],S[3],S[4],S[5],S[6]),M=h(G,U,S[1],S[2],S[3],S[4],S[5],S[6]),E.iterator=w,E.angleFinder=M,E.length=y(w,G,U),G=S[5],U=S[6];break;case"Q":w=u(G,U,S[1],S[2],S[3],S[4]),M=_(G,U,S[1],S[2],S[3],S[4]),E.iterator=w,E.angleFinder=M,E.length=y(w,G,U),G=S[3],U=S[4];break;case"Z":case"z":E.destX=D,E.destY=I,E.length=c(G,U,D,I),G=D,U=I}F+=E.length,N.push(E)}return N.push({length:F,x:G,y:U}),N}v.util.joinPath=function(x){return x.map(function(S){return S.join(" ")}).join(" ")},v.util.parsePath=function(x){var S,w,E,M,F,H=[],G=[],U=v.rePathCommand,D="[-+]?(?:\\d*\\.\\d+|\\d+\\.?)(?:[eE][-+]?\\d+)?\\s*",I="("+D+")"+v.commaWsp,N="([01])"+v.commaWsp+"?",W=new RegExp(I+"?"+I+"?"+I+N+N+I+"?("+D+")","g");if(!x||!x.match)return H;for(var X,P=0,R=(F=x.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi)).length;P<R;P++){M=(S=F[P]).slice(1).trim(),G.length=0;var j=S.charAt(0);if(X=[j],j.toLowerCase()==="a")for(var z;z=W.exec(M);)for(var V=1;V<z.length;V++)G.push(z[V]);else for(;E=U.exec(M);)G.push(E[0]);V=0;for(var $=G.length;V<$;V++)w=parseFloat(G[V]),isNaN(w)||X.push(w);var te=r[j.toLowerCase()],J=a[j]||j;if(X.length-1>te)for(var q=1,ee=X.length;q<ee;q+=te)H.push([j].concat(X.slice(q,q+te))),j=J;else H.push(X)}return H},v.util.makePathSimpler=function(x){var S,w,E,M,F,H,G=0,U=0,D=x.length,I=0,N=0,W=[];for(w=0;w<D;++w){switch(E=!1,(S=x[w].slice(0))[0]){case"l":S[0]="L",S[1]+=G,S[2]+=U;case"L":G=S[1],U=S[2];break;case"h":S[1]+=G;case"H":S[0]="L",S[2]=U,G=S[1];break;case"v":S[1]+=U;case"V":S[0]="L",U=S[1],S[1]=G,S[2]=U;break;case"m":S[0]="M",S[1]+=G,S[2]+=U;case"M":G=S[1],U=S[2],I=S[1],N=S[2];break;case"c":S[0]="C",S[1]+=G,S[2]+=U,S[3]+=G,S[4]+=U,S[5]+=G,S[6]+=U;case"C":F=S[3],H=S[4],G=S[5],U=S[6];break;case"s":S[0]="S",S[1]+=G,S[2]+=U,S[3]+=G,S[4]+=U;case"S":M==="C"?(F=2*G-F,H=2*U-H):(F=G,H=U),G=S[3],U=S[4],S[0]="C",S[5]=S[3],S[6]=S[4],S[3]=S[1],S[4]=S[2],S[1]=F,S[2]=H,F=S[3],H=S[4];break;case"q":S[0]="Q",S[1]+=G,S[2]+=U,S[3]+=G,S[4]+=U;case"Q":F=S[1],H=S[2],G=S[3],U=S[4];break;case"t":S[0]="T",S[1]+=G,S[2]+=U;case"T":M==="Q"?(F=2*G-F,H=2*U-H):(F=G,H=U),S[0]="Q",G=S[1],U=S[2],S[1]=F,S[2]=H,S[3]=G,S[4]=U;break;case"a":S[0]="A",S[6]+=G,S[7]+=U;case"A":E=!0,W=W.concat(n(G,U,S)),G=S[6],U=S[7];break;case"z":case"Z":G=I,U=N}E||W.push(S),M=S[0]}return W},v.util.getSmoothPathFromPoints=function(x,S){var w,E=[],M=new v.Point(x[0].x,x[0].y),F=new v.Point(x[1].x,x[1].y),H=x.length,G=1,U=0,D=H>2;for(S=S||0,D&&(G=x[2].x<F.x?-1:x[2].x===F.x?0:1,U=x[2].y<F.y?-1:x[2].y===F.y?0:1),E.push(["M",M.x-G*S,M.y-U*S]),w=1;w<H;w++){if(!M.eq(F)){var I=M.midPointFrom(F);E.push(["Q",M.x,M.y,I.x,I.y])}M=x[w],w+1<x.length&&(F=x[w+1])}return D&&(G=M.x>x[w-2].x?1:M.x===x[w-2].x?0:-1,U=M.y>x[w-2].y?1:M.y===x[w-2].y?0:-1),E.push(["L",M.x+G*S,M.y+U*S]),E},v.util.getPathSegmentsInfo=C,v.util.getBoundsOfCurve=function(x,S,w,E,M,F,H,G){var U;if(v.cachesBoundsOfCurve&&(U=o.call(arguments),v.boundsOfCurveCache[U]))return v.boundsOfCurveCache[U];var D,I,N,W,X,P,R,j,z=Math.sqrt,V=Math.min,$=Math.max,te=Math.abs,J=[],q=[[],[]];I=6*x-12*w+6*M,D=-3*x+9*w-9*M+3*H,N=3*w-3*x;for(var ee=0;ee<2;++ee)if(ee>0&&(I=6*S-12*E+6*F,D=-3*S+9*E-9*F+3*G,N=3*E-3*S),te(D)<1e-12){if(te(I)<1e-12)continue;0<(W=-N/I)&&W<1&&J.push(W)}else(R=I*I-4*N*D)<0||(0<(X=(-I+(j=z(R)))/(2*D))&&X<1&&J.push(X),0<(P=(-I-j)/(2*D))&&P<1&&J.push(P));for(var Q,re,se,ne=J.length,ue=ne;ne--;)Q=(se=1-(W=J[ne]))*se*se*x+3*se*se*W*w+3*se*W*W*M+W*W*W*H,q[0][ne]=Q,re=se*se*se*S+3*se*se*W*E+3*se*W*W*F+W*W*W*G,q[1][ne]=re;q[0][ue]=x,q[1][ue]=S,q[0][ue+1]=H,q[1][ue+1]=G;var pe=[{x:V.apply(null,q[0]),y:V.apply(null,q[1])},{x:$.apply(null,q[0]),y:$.apply(null,q[1])}];return v.cachesBoundsOfCurve&&(v.boundsOfCurveCache[U]=pe),pe},v.util.getPointOnPath=function(x,S,w){w||(w=C(x));for(var E=0;S-w[E].length>0&&E<w.length-2;)S-=w[E].length,E++;var M,F=w[E],H=S/F.length,G=F.command,U=x[E];switch(G){case"M":return{x:F.x,y:F.y,angle:0};case"Z":case"z":return(M=new v.Point(F.x,F.y).lerp(new v.Point(F.destX,F.destY),H)).angle=Math.atan2(F.destY-F.y,F.destX-F.x),M;case"L":return(M=new v.Point(F.x,F.y).lerp(new v.Point(U[1],U[2]),H)).angle=Math.atan2(U[2]-F.y,U[1]-F.x),M;case"C":case"Q":return function(D,I){for(var N,W,X,P=0,R=0,j=D.iterator,z={x:D.x,y:D.y},V=.01,$=D.angleFinder;R<I&&V>1e-4;)N=j(P),X=P,(W=c(z.x,z.y,N.x,N.y))+R>I?(P-=V,V/=2):(z=N,P+=V,R+=W);return N.angle=$(X),N}(F,S)}},v.util.transformPath=function(x,S,w){return w&&(S=v.util.multiplyTransformMatrices(S,[1,0,0,1,-w.x,-w.y])),x.map(function(E){for(var M=E.slice(0),F={},H=1;H<E.length-1;H+=2)F.x=E[H],F.y=E[H+1],F=v.util.transformPoint(F,S),M[H]=F.x,M[H+1]=F.y;return M})}}(),function(){var o=Array.prototype.slice;function r(a,l,t){if(a&&a.length!==0){var n=a.length-1,c=l?a[n][l]:a[n];if(l)for(;n--;)t(a[n][l],c)&&(c=a[n][l]);else for(;n--;)t(a[n],c)&&(c=a[n]);return c}}v.util.array={fill:function(a,l){for(var t=a.length;t--;)a[t]=l;return a},invoke:function(a,l){for(var t=o.call(arguments,2),n=[],c=0,d=a.length;c<d;c++)n[c]=t.length?a[c][l].apply(a[c],t):a[c][l].call(a[c]);return n},min:function(a,l){return r(a,l,function(t,n){return t<n})},max:function(a,l){return r(a,l,function(t,n){return t>=n})}}}(),function(){function o(r,a,l){if(l)if(!v.isLikelyNode&&a instanceof Element)r=a;else if(a instanceof Array){r=[];for(var t=0,n=a.length;t<n;t++)r[t]=o({},a[t],l)}else if(a&&typeof a=="object")for(var c in a)c==="canvas"||c==="group"?r[c]=null:a.hasOwnProperty(c)&&(r[c]=o({},a[c],l));else r=a;else for(var c in a)r[c]=a[c];return r}v.util.object={extend:o,clone:function(r,a){return o({},r,a)}},v.util.object.extend(v.util,v.Observable)}(),function(){function o(r,a){var l=r.charCodeAt(a);if(isNaN(l))return"";if(l<55296||l>57343)return r.charAt(a);if(55296<=l&&l<=56319){if(r.length<=a+1)throw"High surrogate without following low surrogate";var t=r.charCodeAt(a+1);if(56320>t||t>57343)throw"High surrogate without following low surrogate";return r.charAt(a)+r.charAt(a+1)}if(a===0)throw"Low surrogate without preceding high surrogate";var n=r.charCodeAt(a-1);if(55296>n||n>56319)throw"Low surrogate without preceding high surrogate";return!1}v.util.string={camelize:function(r){return r.replace(/-+(.)?/g,function(a,l){return l?l.toUpperCase():""})},capitalize:function(r,a){return r.charAt(0).toUpperCase()+(a?r.slice(1):r.slice(1).toLowerCase())},escapeXml:function(r){return r.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},graphemeSplit:function(r){var a,l=0,t=[];for(l=0;l<r.length;l++)(a=o(r,l))!==!1&&t.push(a);return t}}}(),function(){var o=Array.prototype.slice,r=function(){},a=function(){for(var c in{toString:1})if(c==="toString")return!1;return!0}(),l=function(c,d,h){for(var u in d)u in c.prototype&&typeof c.prototype[u]=="function"&&(d[u]+"").indexOf("callSuper")>-1?c.prototype[u]=function(_){return function(){var y=this.constructor.superclass;this.constructor.superclass=h;var C=d[_].apply(this,arguments);if(this.constructor.superclass=y,_!=="initialize")return C}}(u):c.prototype[u]=d[u],a&&(d.toString!==Object.prototype.toString&&(c.prototype.toString=d.toString),d.valueOf!==Object.prototype.valueOf&&(c.prototype.valueOf=d.valueOf))};function t(){}function n(c){for(var d=null,h=this;h.constructor.superclass;){var u=h.constructor.superclass.prototype[c];if(h[c]!==u){d=u;break}h=h.constructor.superclass.prototype}return d?arguments.length>1?d.apply(this,o.call(arguments,1)):d.call(this):console.log("tried to callSuper "+c+", method not found in prototype chain",this)}v.util.createClass=function(){var c=null,d=o.call(arguments,0);function h(){this.initialize.apply(this,arguments)}typeof d[0]=="function"&&(c=d.shift()),h.superclass=c,h.subclasses=[],c&&(t.prototype=c.prototype,h.prototype=new t,c.subclasses.push(h));for(var u=0,_=d.length;u<_;u++)l(h,d[u],c);return h.prototype.initialize||(h.prototype.initialize=r),h.prototype.constructor=h,h.prototype.callSuper=n,h}}(),A=!!v.document.createElement("div").attachEvent,O=["touchstart","touchmove","touchend"],v.util.addListener=function(o,r,a,l){o&&o.addEventListener(r,a,!A&&l)},v.util.removeListener=function(o,r,a,l){o&&o.removeEventListener(r,a,!A&&l)},v.util.getPointer=function(o){var r=o.target,a=v.util.getScrollLeftTop(r),l=function(t){var n=t.changedTouches;return n&&n[0]?n[0]:t}(o);return{x:l.clientX+a.left,y:l.clientY+a.top}},v.util.isTouchEvent=function(o){return O.indexOf(o.type)>-1||o.pointerType==="touch"},k=typeof(B=v.document.createElement("div")).style.opacity=="string",Z=typeof B.style.filter=="string",ie=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,le=function(o){return o},k?le=function(o,r){return o.style.opacity=r,o}:Z&&(le=function(o,r){var a=o.style;return o.currentStyle&&!o.currentStyle.hasLayout&&(a.zoom=1),ie.test(a.filter)?(r=r>=.9999?"":"alpha(opacity="+100*r+")",a.filter=a.filter.replace(ie,r)):a.filter+=" alpha(opacity="+100*r+")",o}),v.util.setStyle=function(o,r){var a=o.style;if(!a)return o;if(typeof r=="string")return o.style.cssText+=";"+r,r.indexOf("opacity")>-1?le(o,r.match(/opacity:\s*(\d?\.?\d*)/)[1]):o;for(var l in r)l==="opacity"?le(o,r[l]):a[l==="float"||l==="cssFloat"?a.styleFloat===void 0?"cssFloat":"styleFloat":l]=r[l];return o},function(){var o,r,a,l,t=Array.prototype.slice,n=function(h){return t.call(h,0)};try{o=n(v.document.childNodes)instanceof Array}catch(h){}function c(h,u){var _=v.document.createElement(h);for(var y in u)y==="class"?_.className=u[y]:y==="for"?_.htmlFor=u[y]:_.setAttribute(y,u[y]);return _}function d(h){for(var u=0,_=0,y=v.document.documentElement,C=v.document.body||{scrollLeft:0,scrollTop:0};h&&(h.parentNode||h.host)&&((h=h.parentNode||h.host)===v.document?(u=C.scrollLeft||y.scrollLeft||0,_=C.scrollTop||y.scrollTop||0):(u+=h.scrollLeft||0,_+=h.scrollTop||0),h.nodeType!==1||h.style.position!=="fixed"););return{left:u,top:_}}o||(n=function(h){for(var u=new Array(h.length),_=h.length;_--;)u[_]=h[_];return u}),r=v.document.defaultView&&v.document.defaultView.getComputedStyle?function(h,u){var _=v.document.defaultView.getComputedStyle(h,null);return _?_[u]:void 0}:function(h,u){var _=h.style[u];return!_&&h.currentStyle&&(_=h.currentStyle[u]),_},a=v.document.documentElement.style,l="userSelect"in a?"userSelect":"MozUserSelect"in a?"MozUserSelect":"WebkitUserSelect"in a?"WebkitUserSelect":"KhtmlUserSelect"in a?"KhtmlUserSelect":"",v.util.makeElementUnselectable=function(h){return h.onselectstart!==void 0&&(h.onselectstart=v.util.falseFunction),l?h.style[l]="none":typeof h.unselectable=="string"&&(h.unselectable="on"),h},v.util.makeElementSelectable=function(h){return h.onselectstart!==void 0&&(h.onselectstart=null),l?h.style[l]="":typeof h.unselectable=="string"&&(h.unselectable=""),h},v.util.setImageSmoothing=function(h,u){h.imageSmoothingEnabled=h.imageSmoothingEnabled||h.webkitImageSmoothingEnabled||h.mozImageSmoothingEnabled||h.msImageSmoothingEnabled||h.oImageSmoothingEnabled,h.imageSmoothingEnabled=u},v.util.getById=function(h){return typeof h=="string"?v.document.getElementById(h):h},v.util.toArray=n,v.util.addClass=function(h,u){h&&(" "+h.className+" ").indexOf(" "+u+" ")===-1&&(h.className+=(h.className?" ":"")+u)},v.util.makeElement=c,v.util.wrapElement=function(h,u,_){return typeof u=="string"&&(u=c(u,_)),h.parentNode&&h.parentNode.replaceChild(u,h),u.appendChild(h),u},v.util.getScrollLeftTop=d,v.util.getElementOffset=function(h){var u,_,y=h&&h.ownerDocument,C={left:0,top:0},x={left:0,top:0},S={borderLeftWidth:"left",borderTopWidth:"top",paddingLeft:"left",paddingTop:"top"};if(!y)return x;for(var w in S)x[S[w]]+=parseInt(r(h,w),10)||0;return u=y.documentElement,h.getBoundingClientRect!==void 0&&(C=h.getBoundingClientRect()),_=d(h),{left:C.left+_.left-(u.clientLeft||0)+x.left,top:C.top+_.top-(u.clientTop||0)+x.top}},v.util.getNodeCanvas=function(h){var u=v.jsdomImplForWrapper(h);return u._canvas||u._image},v.util.cleanUpJsdomNode=function(h){if(v.isLikelyNode){var u=v.jsdomImplForWrapper(h);u&&(u._image=null,u._canvas=null,u._currentSrc=null,u._attributes=null,u._classList=null)}}}(),function(){function o(){}v.util.request=function(r,a){a||(a={});var l=a.method?a.method.toUpperCase():"GET",t=a.onComplete||function(){},n=new v.window.XMLHttpRequest,c=a.body||a.parameters;return n.onreadystatechange=function(){n.readyState===4&&(t(n),n.onreadystatechange=o)},l==="GET"&&(c=null,typeof a.parameters=="string"&&(r=function(d,h){return d+(/\?/.test(d)?"&":"?")+h}(r,a.parameters))),n.open(l,r,!0),l!=="POST"&&l!=="PUT"||n.setRequestHeader("Content-Type","application/x-www-form-urlencoded"),n.send(c),n}}(),v.log=console.log,v.warn=console.warn,function(){var o=v.util.object.extend,r=v.util.object.clone,a=[];function l(){return!1}function t(h,u,_,y){return-_*Math.cos(h/y*(Math.PI/2))+_+u}v.util.object.extend(a,{cancelAll:function(){var h=this.splice(0);return h.forEach(function(u){u.cancel()}),h},cancelByCanvas:function(h){if(!h)return[];var u=this.filter(function(_){return typeof _.target=="object"&&_.target.canvas===h});return u.forEach(function(_){_.cancel()}),u},cancelByTarget:function(h){var u=this.findAnimationsByTarget(h);return u.forEach(function(_){_.cancel()}),u},findAnimationIndex:function(h){return this.indexOf(this.findAnimation(h))},findAnimation:function(h){return this.find(function(u){return u.cancel===h})},findAnimationsByTarget:function(h){return h?this.filter(function(u){return u.target===h}):[]}});var n=v.window.requestAnimationFrame||v.window.webkitRequestAnimationFrame||v.window.mozRequestAnimationFrame||v.window.oRequestAnimationFrame||v.window.msRequestAnimationFrame||function(h){return v.window.setTimeout(h,1e3/60)},c=v.window.cancelAnimationFrame||v.window.clearTimeout;function d(){return n.apply(v.window,arguments)}v.util.animate=function(h){h||(h={});var u,_=!1,y=function(){var C=v.runningAnimations.indexOf(u);return C>-1&&v.runningAnimations.splice(C,1)[0]};return u=o(r(h),{cancel:function(){return _=!0,y()},currentValue:"startValue"in h?h.startValue:0,completionRate:0,durationRate:0}),v.runningAnimations.push(u),d(function(C){var x,S=C||+new Date,w=h.duration||500,E=S+w,M=h.onChange||l,F=h.abort||l,H=h.onComplete||l,G=h.easing||t,U="startValue"in h&&h.startValue.length>0,D="startValue"in h?h.startValue:0,I="endValue"in h?h.endValue:100,N=h.byValue||(U?D.map(function(W,X){return I[X]-D[X]}):I-D);h.onStart&&h.onStart(),function W(X){var P=(x=X||+new Date)>E?w:x-S,R=P/w,j=U?D.map(function(V,$){return G(P,D[$],N[$],w)}):G(P,D,N,w),z=Math.abs(U?(j[0]-D[0])/N[0]:(j-D)/N);if(u.currentValue=U?j.slice():j,u.completionRate=z,u.durationRate=R,!_){if(!F(j,z,R))return x>E?(u.currentValue=U?I.slice():I,u.completionRate=1,u.durationRate=1,M(U?I.slice():I,1,1),H(I,1,1),void y()):(M(j,z,R),void d(W));y()}}(S)}),u.cancel},v.util.requestAnimFrame=d,v.util.cancelAnimFrame=function(){return c.apply(v.window,arguments)},v.runningAnimations=a}(),function(){function o(r,a,l){var t="rgba("+parseInt(r[0]+l*(a[0]-r[0]),10)+","+parseInt(r[1]+l*(a[1]-r[1]),10)+","+parseInt(r[2]+l*(a[2]-r[2]),10);return(t+=","+(r&&a?parseFloat(r[3]+l*(a[3]-r[3])):1))+")"}v.util.animateColor=function(r,a,l,t){var n=new v.Color(r).getSource(),c=new v.Color(a).getSource(),d=t.onComplete,h=t.onChange;return t=t||{},v.util.animate(v.util.object.extend(t,{duration:l||500,startValue:n,endValue:c,byValue:c,easing:function(u,_,y,C){return o(_,y,t.colorEasing?t.colorEasing(u,C):1-Math.cos(u/C*(Math.PI/2)))},onComplete:function(u,_,y){if(d)return d(o(c,c,0),_,y)},onChange:function(u,_,y){if(h){if(Array.isArray(u))return h(o(u,u,0),_,y);h(u,_,y)}}}))}}(),function(){function o(t,n,c,d){return t<Math.abs(n)?(t=n,d=c/4):d=n===0&&t===0?c/(2*Math.PI)*Math.asin(1):c/(2*Math.PI)*Math.asin(n/t),{a:t,c:n,p:c,s:d}}function r(t,n,c){return t.a*Math.pow(2,10*(n-=1))*Math.sin((n*c-t.s)*(2*Math.PI)/t.p)}function a(t,n,c,d){return c-l(d-t,0,c,d)+n}function l(t,n,c,d){return(t/=d)<1/2.75?c*(7.5625*t*t)+n:t<2/2.75?c*(7.5625*(t-=1.5/2.75)*t+.75)+n:t<2.5/2.75?c*(7.5625*(t-=2.25/2.75)*t+.9375)+n:c*(7.5625*(t-=2.625/2.75)*t+.984375)+n}v.util.ease={easeInQuad:function(t,n,c,d){return c*(t/=d)*t+n},easeOutQuad:function(t,n,c,d){return-c*(t/=d)*(t-2)+n},easeInOutQuad:function(t,n,c,d){return(t/=d/2)<1?c/2*t*t+n:-c/2*(--t*(t-2)-1)+n},easeInCubic:function(t,n,c,d){return c*(t/=d)*t*t+n},easeOutCubic:function(t,n,c,d){return c*((t=t/d-1)*t*t+1)+n},easeInOutCubic:function(t,n,c,d){return(t/=d/2)<1?c/2*t*t*t+n:c/2*((t-=2)*t*t+2)+n},easeInQuart:function(t,n,c,d){return c*(t/=d)*t*t*t+n},easeOutQuart:function(t,n,c,d){return-c*((t=t/d-1)*t*t*t-1)+n},easeInOutQuart:function(t,n,c,d){return(t/=d/2)<1?c/2*t*t*t*t+n:-c/2*((t-=2)*t*t*t-2)+n},easeInQuint:function(t,n,c,d){return c*(t/=d)*t*t*t*t+n},easeOutQuint:function(t,n,c,d){return c*((t=t/d-1)*t*t*t*t+1)+n},easeInOutQuint:function(t,n,c,d){return(t/=d/2)<1?c/2*t*t*t*t*t+n:c/2*((t-=2)*t*t*t*t+2)+n},easeInSine:function(t,n,c,d){return-c*Math.cos(t/d*(Math.PI/2))+c+n},easeOutSine:function(t,n,c,d){return c*Math.sin(t/d*(Math.PI/2))+n},easeInOutSine:function(t,n,c,d){return-c/2*(Math.cos(Math.PI*t/d)-1)+n},easeInExpo:function(t,n,c,d){return t===0?n:c*Math.pow(2,10*(t/d-1))+n},easeOutExpo:function(t,n,c,d){return t===d?n+c:c*(1-Math.pow(2,-10*t/d))+n},easeInOutExpo:function(t,n,c,d){return t===0?n:t===d?n+c:(t/=d/2)<1?c/2*Math.pow(2,10*(t-1))+n:c/2*(2-Math.pow(2,-10*--t))+n},easeInCirc:function(t,n,c,d){return-c*(Math.sqrt(1-(t/=d)*t)-1)+n},easeOutCirc:function(t,n,c,d){return c*Math.sqrt(1-(t=t/d-1)*t)+n},easeInOutCirc:function(t,n,c,d){return(t/=d/2)<1?-c/2*(Math.sqrt(1-t*t)-1)+n:c/2*(Math.sqrt(1-(t-=2)*t)+1)+n},easeInElastic:function(t,n,c,d){var h=0;return t===0?n:(t/=d)==1?n+c:(h||(h=.3*d),-r(o(c,c,h,1.70158),t,d)+n)},easeOutElastic:function(t,n,c,d){var h=0;if(t===0)return n;if((t/=d)==1)return n+c;h||(h=.3*d);var u=o(c,c,h,1.70158);return u.a*Math.pow(2,-10*t)*Math.sin((t*d-u.s)*(2*Math.PI)/u.p)+u.c+n},easeInOutElastic:function(t,n,c,d){var h=0;if(t===0)return n;if((t/=d/2)==2)return n+c;h||(h=d*(.3*1.5));var u=o(c,c,h,1.70158);return t<1?-.5*r(u,t,d)+n:u.a*Math.pow(2,-10*(t-=1))*Math.sin((t*d-u.s)*(2*Math.PI)/u.p)*.5+u.c+n},easeInBack:function(t,n,c,d,h){return h===void 0&&(h=1.70158),c*(t/=d)*t*((h+1)*t-h)+n},easeOutBack:function(t,n,c,d,h){return h===void 0&&(h=1.70158),c*((t=t/d-1)*t*((h+1)*t+h)+1)+n},easeInOutBack:function(t,n,c,d,h){return h===void 0&&(h=1.70158),(t/=d/2)<1?c/2*(t*t*((1+(h*=1.525))*t-h))+n:c/2*((t-=2)*t*((1+(h*=1.525))*t+h)+2)+n},easeInBounce:a,easeOutBounce:l,easeInOutBounce:function(t,n,c,d){return t<d/2?.5*a(2*t,0,c,d)+n:.5*l(2*t-d,0,c,d)+.5*c+n}}}(),function(o){var r=o.fabric||(o.fabric={}),a=r.util.object.extend,l=r.util.object.clone,t=r.util.toFixed,n=r.util.parseUnit,c=r.util.multiplyTransformMatrices,d={cx:"left",x:"left",r:"radius",cy:"top",y:"top",display:"visible",visibility:"visible",transform:"transformMatrix","fill-opacity":"fillOpacity","fill-rule":"fillRule","font-family":"fontFamily","font-size":"fontSize","font-style":"fontStyle","font-weight":"fontWeight","letter-spacing":"charSpacing","paint-order":"paintFirst","stroke-dasharray":"strokeDashArray","stroke-dashoffset":"strokeDashOffset","stroke-linecap":"strokeLineCap","stroke-linejoin":"strokeLineJoin","stroke-miterlimit":"strokeMiterLimit","stroke-opacity":"strokeOpacity","stroke-width":"strokeWidth","text-decoration":"textDecoration","text-anchor":"textAnchor",opacity:"opacity","clip-path":"clipPath","clip-rule":"clipRule","vector-effect":"strokeUniform","image-rendering":"imageSmoothing"},h={stroke:"strokeOpacity",fill:"fillOpacity"},u="font-size",_="clip-path";function y(D){return D in d?d[D]:D}function C(D,I,N,W){var X,P=Array.isArray(I);if(D!=="fill"&&D!=="stroke"||I!=="none"){if(D==="strokeUniform")return I==="non-scaling-stroke";if(D==="strokeDashArray")I=I==="none"?null:I.replace(/,/g," ").split(/\s+/).map(parseFloat);else if(D==="transformMatrix")I=N&&N.transformMatrix?c(N.transformMatrix,r.parseTransformAttribute(I)):r.parseTransformAttribute(I);else if(D==="visible")I=I!=="none"&&I!=="hidden",N&&N.visible===!1&&(I=!1);else if(D==="opacity")I=parseFloat(I),N&&N.opacity!==void 0&&(I*=N.opacity);else if(D==="textAnchor")I=I==="start"?"left":I==="end"?"right":"center";else if(D==="charSpacing")X=n(I,W)/W*1e3;else if(D==="paintFirst"){var R=I.indexOf("fill"),j=I.indexOf("stroke");I="fill",(R>-1&&j>-1&&j<R||R===-1&&j>-1)&&(I="stroke")}else{if(D==="href"||D==="xlink:href"||D==="font")return I;if(D==="imageSmoothing")return I==="optimizeQuality";X=P?I.map(n):n(I,W)}}else I="";return!P&&isNaN(X)?I:X}function x(D){return new RegExp("^("+D.join("|")+")\\b","i")}function S(D,I){var N,W,X,P,R=[];for(X=0,P=I.length;X<P;X++)N=I[X],W=D.getElementsByTagName(N),R=R.concat(Array.prototype.slice.call(W));return R}function w(D,I){var N,W=!0;return(N=E(D,I.pop()))&&I.length&&(W=function(X,P){for(var R,j=!0;X.parentNode&&X.parentNode.nodeType===1&&P.length;)j&&(R=P.pop()),j=E(X=X.parentNode,R);return P.length===0}(D,I)),N&&W&&I.length===0}function E(D,I){var N,W,X=D.nodeName,P=D.getAttribute("class"),R=D.getAttribute("id");if(N=new RegExp("^"+X,"i"),I=I.replace(N,""),R&&I.length&&(N=new RegExp("#"+R+"(?![a-zA-Z\\-]+)","i"),I=I.replace(N,"")),P&&I.length)for(W=(P=P.split(" ")).length;W--;)N=new RegExp("\\."+P[W]+"(?![a-zA-Z\\-]+)","i"),I=I.replace(N,"");return I.length===0}function M(D,I){var N;if(D.getElementById&&(N=D.getElementById(I)),N)return N;var W,X,P,R=D.getElementsByTagName("*");for(X=0,P=R.length;X<P;X++)if(I===(W=R[X]).getAttribute("id"))return W}r.svgValidTagNamesRegEx=x(["path","circle","polygon","polyline","ellipse","rect","line","image","text"]),r.svgViewBoxElementsRegEx=x(["symbol","image","marker","pattern","view","svg"]),r.svgInvalidAncestorsRegEx=x(["pattern","defs","symbol","metadata","clipPath","mask","desc"]),r.svgValidParentsRegEx=x(["symbol","g","a","svg","clipPath","defs"]),r.cssRules={},r.gradientDefs={},r.clipPaths={},r.parseTransformAttribute=function(){function D(j,z,V){j[V]=Math.tan(r.util.degreesToRadians(z[0]))}var I=r.iMatrix,N=r.reNum,W=r.commaWsp,X="(?:(?:(matrix)\\s*\\(\\s*("+N+")"+W+"("+N+")"+W+"("+N+")"+W+"("+N+")"+W+"("+N+")"+W+"("+N+")\\s*\\))|(?:(translate)\\s*\\(\\s*("+N+")(?:"+W+"("+N+"))?\\s*\\))|(?:(scale)\\s*\\(\\s*("+N+")(?:"+W+"("+N+"))?\\s*\\))|(?:(rotate)\\s*\\(\\s*("+N+")(?:"+W+"("+N+")"+W+"("+N+"))?\\s*\\))|(?:(skewX)\\s*\\(\\s*("+N+")\\s*\\))|(?:(skewY)\\s*\\(\\s*("+N+")\\s*\\)))",P=new RegExp("^\\s*(?:(?:"+X+"(?:"+W+"*"+X+")*)?)\\s*$"),R=new RegExp(X,"g");return function(j){var z=I.concat(),V=[];if(!j||j&&!P.test(j))return z;j.replace(R,function(te){var J=new RegExp(X).exec(te).filter(function(Q){return!!Q}),q=J[1],ee=J.slice(2).map(parseFloat);switch(q){case"translate":(function(Q,re){Q[4]=re[0],re.length===2&&(Q[5]=re[1])})(z,ee);break;case"rotate":ee[0]=r.util.degreesToRadians(ee[0]),function(Q,re){var se=r.util.cos(re[0]),ne=r.util.sin(re[0]),ue=0,pe=0;re.length===3&&(ue=re[1],pe=re[2]),Q[0]=se,Q[1]=ne,Q[2]=-ne,Q[3]=se,Q[4]=ue-(se*ue-ne*pe),Q[5]=pe-(ne*ue+se*pe)}(z,ee);break;case"scale":(function(Q,re){var se=re[0],ne=re.length===2?re[1]:re[0];Q[0]=se,Q[3]=ne})(z,ee);break;case"skewX":D(z,ee,2);break;case"skewY":D(z,ee,1);break;case"matrix":z=ee}V.push(z.concat()),z=I.concat()});for(var $=V[0];V.length>1;)V.shift(),$=r.util.multiplyTransformMatrices($,V[0]);return $}}();var F=new RegExp("^\\s*("+r.reNum+"+)\\s*,?\\s*("+r.reNum+"+)\\s*,?\\s*("+r.reNum+"+)\\s*,?\\s*("+r.reNum+"+)\\s*$");function H(D){if(!r.svgViewBoxElementsRegEx.test(D.nodeName))return{};var I,N,W,X,P,R,j=D.getAttribute("viewBox"),z=1,V=1,$=D.getAttribute("width"),te=D.getAttribute("height"),J=D.getAttribute("x")||0,q=D.getAttribute("y")||0,ee=D.getAttribute("preserveAspectRatio")||"",Q=!j||!(j=j.match(F)),re=!$||!te||$==="100%"||te==="100%",se=Q&&re,ne={},ue="",pe=0,Fe=0;if(ne.width=0,ne.height=0,ne.toBeParsed=se,Q&&(J||q)&&D.parentNode&&D.parentNode.nodeName!=="#document"&&(ue=" translate("+n(J)+" "+n(q)+") ",P=(D.getAttribute("transform")||"")+ue,D.setAttribute("transform",P),D.removeAttribute("x"),D.removeAttribute("y")),se)return ne;if(Q)return ne.width=n($),ne.height=n(te),ne;if(I=-parseFloat(j[1]),N=-parseFloat(j[2]),W=parseFloat(j[3]),X=parseFloat(j[4]),ne.minX=I,ne.minY=N,ne.viewBoxWidth=W,ne.viewBoxHeight=X,re?(ne.width=W,ne.height=X):(ne.width=n($),ne.height=n(te),z=ne.width/W,V=ne.height/X),(ee=r.util.parsePreserveAspectRatioAttribute(ee)).alignX!=="none"&&(ee.meetOrSlice==="meet"&&(V=z=z>V?V:z),ee.meetOrSlice==="slice"&&(V=z=z>V?z:V),pe=ne.width-W*z,Fe=ne.height-X*z,ee.alignX==="Mid"&&(pe/=2),ee.alignY==="Mid"&&(Fe/=2),ee.alignX==="Min"&&(pe=0),ee.alignY==="Min"&&(Fe=0)),z===1&&V===1&&I===0&&N===0&&J===0&&q===0)return ne;if((J||q)&&D.parentNode.nodeName!=="#document"&&(ue=" translate("+n(J)+" "+n(q)+") "),P=ue+" matrix("+z+" 0 0 "+V+" "+(I*z+pe)+" "+(N*V+Fe)+") ",D.nodeName==="svg"){for(R=D.ownerDocument.createElementNS(r.svgNS,"g");D.firstChild;)R.appendChild(D.firstChild);D.appendChild(R)}else(R=D).removeAttribute("x"),R.removeAttribute("y"),P=R.getAttribute("transform")+P;return R.setAttribute("transform",P),ne}function G(D,I){var N="xlink:href",W=M(D,I.getAttribute(N).slice(1));if(W&&W.getAttribute(N)&&G(D,W),["gradientTransform","x1","x2","y1","y2","gradientUnits","cx","cy","r","fx","fy"].forEach(function(P){W&&!I.hasAttribute(P)&&W.hasAttribute(P)&&I.setAttribute(P,W.getAttribute(P))}),!I.children.length)for(var X=W.cloneNode(!0);X.firstChild;)I.appendChild(X.firstChild);I.removeAttribute(N)}r.parseSVGDocument=function(D,I,N,W){if(D){(function(J){for(var q=S(J,["use","svg:use"]),ee=0;q.length&&ee<q.length;){var Q=q[ee],re=Q.getAttribute("xlink:href")||Q.getAttribute("href");if(re===null)return;var se,ne,ue,pe,Fe=re.slice(1),ze=Q.getAttribute("x")||0,St=Q.getAttribute("y")||0,_e=M(J,Fe).cloneNode(!0),Be=(_e.getAttribute("transform")||"")+" translate("+ze+", "+St+")",kt=q.length,xt=r.svgNS;if(H(_e),/^svg$/i.test(_e.nodeName)){var lt=_e.ownerDocument.createElementNS(xt,"g");for(ne=0,pe=(ue=_e.attributes).length;ne<pe;ne++)se=ue.item(ne),lt.setAttributeNS(xt,se.nodeName,se.nodeValue);for(;_e.firstChild;)lt.appendChild(_e.firstChild);_e=lt}for(ne=0,pe=(ue=Q.attributes).length;ne<pe;ne++)(se=ue.item(ne)).nodeName!=="x"&&se.nodeName!=="y"&&se.nodeName!=="xlink:href"&&se.nodeName!=="href"&&(se.nodeName==="transform"?Be=se.nodeValue+" "+Be:_e.setAttribute(se.nodeName,se.nodeValue));_e.setAttribute("transform",Be),_e.setAttribute("instantiated_by_use","1"),_e.removeAttribute("id"),Q.parentNode.replaceChild(_e,Q),q.length===kt&&ee++}})(D);var X,P,R=r.Object.__uid++,j=H(D),z=r.util.toArray(D.getElementsByTagName("*"));if(j.crossOrigin=W&&W.crossOrigin,j.svgUid=R,z.length===0&&r.isLikelyNode){var V=[];for(X=0,P=(z=D.selectNodes('//*[name(.)!="svg"]')).length;X<P;X++)V[X]=z[X];z=V}var $=z.filter(function(J){return H(J),r.svgValidTagNamesRegEx.test(J.nodeName.replace("svg:",""))&&!function(q,ee){for(;q&&(q=q.parentNode);)if(q.nodeName&&ee.test(q.nodeName.replace("svg:",""))&&!q.getAttribute("instantiated_by_use"))return!0;return!1}(J,r.svgInvalidAncestorsRegEx)});if(!$||$&&!$.length)I&&I([],{});else{var te={};z.filter(function(J){return J.nodeName.replace("svg:","")==="clipPath"}).forEach(function(J){var q=J.getAttribute("id");te[q]=r.util.toArray(J.getElementsByTagName("*")).filter(function(ee){return r.svgValidTagNamesRegEx.test(ee.nodeName.replace("svg:",""))})}),r.gradientDefs[R]=r.getGradientDefs(D),r.cssRules[R]=r.getCSSRules(D),r.clipPaths[R]=te,r.parseElements($,function(J,q){I&&(I(J,j,q,z),delete r.gradientDefs[R],delete r.cssRules[R],delete r.clipPaths[R])},l(j),N,W)}}};var U=new RegExp("(normal|italic)?\\s*(normal|small-caps)?\\s*(normal|bold|bolder|lighter|100|200|300|400|500|600|700|800|900)?\\s*("+r.reNum+"(?:px|cm|mm|em|pt|pc|in)*)(?:\\/(normal|"+r.reNum+"))?\\s+(.*)");a(r,{parseFontDeclaration:function(D,I){var N=D.match(U);if(N){var W=N[1],X=N[3],P=N[4],R=N[5],j=N[6];W&&(I.fontStyle=W),X&&(I.fontWeight=isNaN(parseFloat(X))?X:parseFloat(X)),P&&(I.fontSize=n(P)),j&&(I.fontFamily=j),R&&(I.lineHeight=R==="normal"?1:R)}},getGradientDefs:function(D){var I,N=S(D,["linearGradient","radialGradient","svg:linearGradient","svg:radialGradient"]),W=0,X={};for(W=N.length;W--;)(I=N[W]).getAttribute("xlink:href")&&G(D,I),X[I.getAttribute("id")]=I;return X},parseAttributes:function(D,I,N){if(D){var W,X,P,R={};N===void 0&&(N=D.getAttribute("svgUid")),D.parentNode&&r.svgValidParentsRegEx.test(D.parentNode.nodeName)&&(R=r.parseAttributes(D.parentNode,I,N));var j=I.reduce(function(ee,Q){return(W=D.getAttribute(Q))&&(ee[Q]=W),ee},{}),z=a(function(ee,Q){var re={};for(var se in r.cssRules[Q])if(w(ee,se.split(" ")))for(var ne in r.cssRules[Q][se])re[ne]=r.cssRules[Q][se][ne];return re}(D,N),r.parseStyleAttribute(D));j=a(j,z),z[_]&&D.setAttribute(_,z[_]),X=P=R.fontSize||r.Text.DEFAULT_SVG_FONT_SIZE,j[u]&&(j[u]=X=n(j[u],P));var V,$,te={};for(var J in j)$=C(V=y(J),j[J],R,X),te[V]=$;te&&te.font&&r.parseFontDeclaration(te.font,te);var q=a(R,te);return r.svgValidParentsRegEx.test(D.nodeName)?q:function(ee){for(var Q in h)if(ee[h[Q]]!==void 0&&ee[Q]!==""){if(ee[Q]===void 0){if(!r.Object.prototype[Q])continue;ee[Q]=r.Object.prototype[Q]}if(ee[Q].indexOf("url(")!==0){var re=new r.Color(ee[Q]);ee[Q]=re.setAlpha(t(re.getAlpha()*ee[h[Q]],2)).toRgba()}}return ee}(q)}},parseElements:function(D,I,N,W,X){new r.ElementsParser(D,I,N,W,X).parse()},parseStyleAttribute:function(D){var I={},N=D.getAttribute("style");return N&&(typeof N=="string"?function(W,X){var P,R;W.replace(/;\s*$/,"").split(";").forEach(function(j){var z=j.split(":");P=z[0].trim().toLowerCase(),R=z[1].trim(),X[P]=R})}(N,I):function(W,X){var P,R;for(var j in W)W[j]!==void 0&&(P=j.toLowerCase(),R=W[j],X[P]=R)}(N,I)),I},parsePointsAttribute:function(D){if(!D)return null;var I,N,W=[];for(I=0,N=(D=(D=D.replace(/,/g," ").trim()).split(/\s+/)).length;I<N;I+=2)W.push({x:parseFloat(D[I]),y:parseFloat(D[I+1])});return W},getCSSRules:function(D){var I,N,W=D.getElementsByTagName("style"),X={};for(I=0,N=W.length;I<N;I++){var P=W[I].textContent;(P=P.replace(/\/\*[\s\S]*?\*\//g,"")).trim()!==""&&P.split("}").filter(function(R){return R.trim()}).forEach(function(R){var j=R.split("{"),z={},V=j[1].trim().split(";").filter(function(q){return q.trim()});for(I=0,N=V.length;I<N;I++){var $=V[I].split(":"),te=$[0].trim(),J=$[1].trim();z[te]=J}(R=j[0].trim()).split(",").forEach(function(q){(q=q.replace(/^svg/i,"").trim())!==""&&(X[q]?r.util.object.extend(X[q],z):X[q]=r.util.object.clone(z))})})}return X},loadSVGFromURL:function(D,I,N,W){D=D.replace(/^\n\s*/,"").trim(),new r.util.request(D,{method:"get",onComplete:function(X){var P=X.responseXML;if(!P||!P.documentElement)return I&&I(null),!1;r.parseSVGDocument(P.documentElement,function(R,j,z,V){I&&I(R,j,z,V)},N,W)}})},loadSVGFromString:function(D,I,N,W){var X=new r.window.DOMParser().parseFromString(D.trim(),"text/xml");r.parseSVGDocument(X.documentElement,function(P,R,j,z){I(P,R,j,z)},N,W)}})}(i),v.ElementsParser=function(o,r,a,l,t,n){this.elements=o,this.callback=r,this.options=a,this.reviver=l,this.svgUid=a&&a.svgUid||0,this.parsingOptions=t,this.regexUrl=/^url\(['"]?#([^'"]+)['"]?\)/g,this.doc=n},(ce=v.ElementsParser.prototype).parse=function(){this.instances=new Array(this.elements.length),this.numElements=this.elements.length,this.createObjects()},ce.createObjects=function(){var o=this;this.elements.forEach(function(r,a){r.setAttribute("svgUid",o.svgUid),o.createObject(r,a)})},ce.findTag=function(o){return v[v.util.string.capitalize(o.tagName.replace("svg:",""))]},ce.createObject=function(o,r){var a=this.findTag(o);if(a&&a.fromElement)try{a.fromElement(o,this.createCallback(r,o),this.options)}catch(l){v.log(l)}else this.checkIfDone()},ce.createCallback=function(o,r){var a=this;return function(l){var t;a.resolveGradient(l,r,"fill"),a.resolveGradient(l,r,"stroke"),l instanceof v.Image&&l._originalElement&&(t=l.parsePreserveAspectRatioAttribute(r)),l._removeTransformMatrix(t),a.resolveClipPath(l,r),a.reviver&&a.reviver(r,l),a.instances[o]=l,a.checkIfDone()}},ce.extractPropertyDefinition=function(o,r,a){var l=o[r],t=this.regexUrl;if(t.test(l)){t.lastIndex=0;var n=t.exec(l)[1];return t.lastIndex=0,v[a][this.svgUid][n]}},ce.resolveGradient=function(o,r,a){var l=this.extractPropertyDefinition(o,a,"gradientDefs");if(l){var t=r.getAttribute(a+"-opacity"),n=v.Gradient.fromElement(l,o,t,this.options);o.set(a,n)}},ce.createClipPathCallback=function(o,r){return function(a){a._removeTransformMatrix(),a.fillRule=a.clipRule,r.push(a)}},ce.resolveClipPath=function(o,r){var a,l,t,n,c=this.extractPropertyDefinition(o,"clipPath","clipPaths");if(c){t=[],l=v.util.invertTransform(o.calcTransformMatrix());for(var d=c[0].parentNode,h=r;h.parentNode&&h.getAttribute("clip-path")!==o.clipPath;)h=h.parentNode;h.parentNode.appendChild(d);for(var u=0;u<c.length;u++)a=c[u],this.findTag(a).fromElement(a,this.createClipPathCallback(o,t),this.options);c=t.length===1?t[0]:new v.Group(t),n=v.util.multiplyTransformMatrices(l,c.calcTransformMatrix()),c.clipPath&&this.resolveClipPath(c,h);var _=v.util.qrDecompose(n);c.flipX=!1,c.flipY=!1,c.set("scaleX",_.scaleX),c.set("scaleY",_.scaleY),c.angle=_.angle,c.skewX=_.skewX,c.skewY=0,c.setPositionByOrigin({x:_.translateX,y:_.translateY},"center","center"),o.clipPath=c}else delete o.clipPath},ce.checkIfDone=function(){--this.numElements==0&&(this.instances=this.instances.filter(function(o){return o!=null}),this.callback(this.instances,this.elements))},function(o){var r=o.fabric||(o.fabric={});function a(l,t){this.x=l,this.y=t}r.Point?r.warn("fabric.Point is already defined"):(r.Point=a,a.prototype={type:"point",constructor:a,add:function(l){return new a(this.x+l.x,this.y+l.y)},addEquals:function(l){return this.x+=l.x,this.y+=l.y,this},scalarAdd:function(l){return new a(this.x+l,this.y+l)},scalarAddEquals:function(l){return this.x+=l,this.y+=l,this},subtract:function(l){return new a(this.x-l.x,this.y-l.y)},subtractEquals:function(l){return this.x-=l.x,this.y-=l.y,this},scalarSubtract:function(l){return new a(this.x-l,this.y-l)},scalarSubtractEquals:function(l){return this.x-=l,this.y-=l,this},multiply:function(l){return new a(this.x*l,this.y*l)},multiplyEquals:function(l){return this.x*=l,this.y*=l,this},divide:function(l){return new a(this.x/l,this.y/l)},divideEquals:function(l){return this.x/=l,this.y/=l,this},eq:function(l){return this.x===l.x&&this.y===l.y},lt:function(l){return this.x<l.x&&this.y<l.y},lte:function(l){return this.x<=l.x&&this.y<=l.y},gt:function(l){return this.x>l.x&&this.y>l.y},gte:function(l){return this.x>=l.x&&this.y>=l.y},lerp:function(l,t){return t===void 0&&(t=.5),t=Math.max(Math.min(1,t),0),new a(this.x+(l.x-this.x)*t,this.y+(l.y-this.y)*t)},distanceFrom:function(l){var t=this.x-l.x,n=this.y-l.y;return Math.sqrt(t*t+n*n)},midPointFrom:function(l){return this.lerp(l)},min:function(l){return new a(Math.min(this.x,l.x),Math.min(this.y,l.y))},max:function(l){return new a(Math.max(this.x,l.x),Math.max(this.y,l.y))},toString:function(){return this.x+","+this.y},setXY:function(l,t){return this.x=l,this.y=t,this},setX:function(l){return this.x=l,this},setY:function(l){return this.y=l,this},setFromPoint:function(l){return this.x=l.x,this.y=l.y,this},swap:function(l){var t=this.x,n=this.y;this.x=l.x,this.y=l.y,l.x=t,l.y=n},clone:function(){return new a(this.x,this.y)}})}(i),function(o){var r=o.fabric||(o.fabric={});function a(l){this.status=l,this.points=[]}r.Intersection?r.warn("fabric.Intersection is already defined"):(r.Intersection=a,r.Intersection.prototype={constructor:a,appendPoint:function(l){return this.points.push(l),this},appendPoints:function(l){return this.points=this.points.concat(l),this}},r.Intersection.intersectLineLine=function(l,t,n,c){var d,h=(c.x-n.x)*(l.y-n.y)-(c.y-n.y)*(l.x-n.x),u=(t.x-l.x)*(l.y-n.y)-(t.y-l.y)*(l.x-n.x),_=(c.y-n.y)*(t.x-l.x)-(c.x-n.x)*(t.y-l.y);if(_!==0){var y=h/_,C=u/_;0<=y&&y<=1&&0<=C&&C<=1?(d=new a("Intersection")).appendPoint(new r.Point(l.x+y*(t.x-l.x),l.y+y*(t.y-l.y))):d=new a}else d=new a(h===0||u===0?"Coincident":"Parallel");return d},r.Intersection.intersectLinePolygon=function(l,t,n){var c,d,h,u,_=new a,y=n.length;for(u=0;u<y;u++)c=n[u],d=n[(u+1)%y],h=a.intersectLineLine(l,t,c,d),_.appendPoints(h.points);return _.points.length>0&&(_.status="Intersection"),_},r.Intersection.intersectPolygonPolygon=function(l,t){var n,c=new a,d=l.length;for(n=0;n<d;n++){var h=l[n],u=l[(n+1)%d],_=a.intersectLinePolygon(h,u,t);c.appendPoints(_.points)}return c.points.length>0&&(c.status="Intersection"),c},r.Intersection.intersectPolygonRectangle=function(l,t,n){var c=t.min(n),d=t.max(n),h=new r.Point(d.x,c.y),u=new r.Point(c.x,d.y),_=a.intersectLinePolygon(c,h,l),y=a.intersectLinePolygon(h,d,l),C=a.intersectLinePolygon(d,u,l),x=a.intersectLinePolygon(u,c,l),S=new a;return S.appendPoints(_.points),S.appendPoints(y.points),S.appendPoints(C.points),S.appendPoints(x.points),S.points.length>0&&(S.status="Intersection"),S})}(i),function(o){var r=o.fabric||(o.fabric={});function a(t){t?this._tryParsingColor(t):this.setSource([0,0,0,1])}function l(t,n,c){return c<0&&(c+=1),c>1&&(c-=1),c<1/6?t+6*(n-t)*c:c<.5?n:c<2/3?t+(n-t)*(2/3-c)*6:t}r.Color?r.warn("fabric.Color is already defined."):(r.Color=a,r.Color.prototype={_tryParsingColor:function(t){var n;t in a.colorNameMap&&(t=a.colorNameMap[t]),t==="transparent"&&(n=[255,255,255,0]),n||(n=a.sourceFromHex(t)),n||(n=a.sourceFromRgb(t)),n||(n=a.sourceFromHsl(t)),n||(n=[0,0,0,1]),n&&this.setSource(n)},_rgbToHsl:function(t,n,c){t/=255,n/=255,c/=255;var d,h,u,_=r.util.array.max([t,n,c]),y=r.util.array.min([t,n,c]);if(u=(_+y)/2,_===y)d=h=0;else{var C=_-y;switch(h=u>.5?C/(2-_-y):C/(_+y),_){case t:d=(n-c)/C+(n<c?6:0);break;case n:d=(c-t)/C+2;break;case c:d=(t-n)/C+4}d/=6}return[Math.round(360*d),Math.round(100*h),Math.round(100*u)]},getSource:function(){return this._source},setSource:function(t){this._source=t},toRgb:function(){var t=this.getSource();return"rgb("+t[0]+","+t[1]+","+t[2]+")"},toRgba:function(){var t=this.getSource();return"rgba("+t[0]+","+t[1]+","+t[2]+","+t[3]+")"},toHsl:function(){var t=this.getSource(),n=this._rgbToHsl(t[0],t[1],t[2]);return"hsl("+n[0]+","+n[1]+"%,"+n[2]+"%)"},toHsla:function(){var t=this.getSource(),n=this._rgbToHsl(t[0],t[1],t[2]);return"hsla("+n[0]+","+n[1]+"%,"+n[2]+"%,"+t[3]+")"},toHex:function(){var t,n,c,d=this.getSource();return t=(t=d[0].toString(16)).length===1?"0"+t:t,n=(n=d[1].toString(16)).length===1?"0"+n:n,c=(c=d[2].toString(16)).length===1?"0"+c:c,t.toUpperCase()+n.toUpperCase()+c.toUpperCase()},toHexa:function(){var t,n=this.getSource();return t=(t=(t=Math.round(255*n[3])).toString(16)).length===1?"0"+t:t,this.toHex()+t.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(t){var n=this.getSource();return n[3]=t,this.setSource(n),this},toGrayscale:function(){var t=this.getSource(),n=parseInt((.3*t[0]+.59*t[1]+.11*t[2]).toFixed(0),10),c=t[3];return this.setSource([n,n,n,c]),this},toBlackWhite:function(t){var n=this.getSource(),c=(.3*n[0]+.59*n[1]+.11*n[2]).toFixed(0),d=n[3];return t=t||127,c=Number(c)<Number(t)?0:255,this.setSource([c,c,c,d]),this},overlayWith:function(t){t instanceof a||(t=new a(t));var n,c=[],d=this.getAlpha(),h=this.getSource(),u=t.getSource();for(n=0;n<3;n++)c.push(Math.round(.5*h[n]+.5*u[n]));return c[3]=d,this.setSource(c),this}},r.Color.reRGBa=/^rgba?\(\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*,\s*(\d{1,3}(?:\.\d+)?\%?)\s*(?:\s*,\s*((?:\d*\.?\d+)?)\s*)?\)$/i,r.Color.reHSLa=/^hsla?\(\s*(\d{1,3})\s*,\s*(\d{1,3}\%)\s*,\s*(\d{1,3}\%)\s*(?:\s*,\s*(\d+(?:\.\d+)?)\s*)?\)$/i,r.Color.reHex=/^#?([0-9a-f]{8}|[0-9a-f]{6}|[0-9a-f]{4}|[0-9a-f]{3})$/i,r.Color.colorNameMap={aliceblue:"#F0F8FF",antiquewhite:"#FAEBD7",aqua:"#00FFFF",aquamarine:"#7FFFD4",azure:"#F0FFFF",beige:"#F5F5DC",bisque:"#FFE4C4",black:"#000000",blanchedalmond:"#FFEBCD",blue:"#0000FF",blueviolet:"#8A2BE2",brown:"#A52A2A",burlywood:"#DEB887",cadetblue:"#5F9EA0",chartreuse:"#7FFF00",chocolate:"#D2691E",coral:"#FF7F50",cornflowerblue:"#6495ED",cornsilk:"#FFF8DC",crimson:"#DC143C",cyan:"#00FFFF",darkblue:"#00008B",darkcyan:"#008B8B",darkgoldenrod:"#B8860B",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",darkgreen:"#006400",darkkhaki:"#BDB76B",darkmagenta:"#8B008B",darkolivegreen:"#556B2F",darkorange:"#FF8C00",darkorchid:"#9932CC",darkred:"#8B0000",darksalmon:"#E9967A",darkseagreen:"#8FBC8F",darkslateblue:"#483D8B",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",darkturquoise:"#00CED1",darkviolet:"#9400D3",deeppink:"#FF1493",deepskyblue:"#00BFFF",dimgray:"#696969",dimgrey:"#696969",dodgerblue:"#1E90FF",firebrick:"#B22222",floralwhite:"#FFFAF0",forestgreen:"#228B22",fuchsia:"#FF00FF",gainsboro:"#DCDCDC",ghostwhite:"#F8F8FF",gold:"#FFD700",goldenrod:"#DAA520",gray:"#808080",grey:"#808080",green:"#008000",greenyellow:"#ADFF2F",honeydew:"#F0FFF0",hotpink:"#FF69B4",indianred:"#CD5C5C",indigo:"#4B0082",ivory:"#FFFFF0",khaki:"#F0E68C",lavender:"#E6E6FA",lavenderblush:"#FFF0F5",lawngreen:"#7CFC00",lemonchiffon:"#FFFACD",lightblue:"#ADD8E6",lightcoral:"#F08080",lightcyan:"#E0FFFF",lightgoldenrodyellow:"#FAFAD2",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",lightgreen:"#90EE90",lightpink:"#FFB6C1",lightsalmon:"#FFA07A",lightseagreen:"#20B2AA",lightskyblue:"#87CEFA",lightslategray:"#778899",lightslategrey:"#778899",lightsteelblue:"#B0C4DE",lightyellow:"#FFFFE0",lime:"#00FF00",limegreen:"#32CD32",linen:"#FAF0E6",magenta:"#FF00FF",maroon:"#800000",mediumaquamarine:"#66CDAA",mediumblue:"#0000CD",mediumorchid:"#BA55D3",mediumpurple:"#9370DB",mediumseagreen:"#3CB371",mediumslateblue:"#7B68EE",mediumspringgreen:"#00FA9A",mediumturquoise:"#48D1CC",mediumvioletred:"#C71585",midnightblue:"#191970",mintcream:"#F5FFFA",mistyrose:"#FFE4E1",moccasin:"#FFE4B5",navajowhite:"#FFDEAD",navy:"#000080",oldlace:"#FDF5E6",olive:"#808000",olivedrab:"#6B8E23",orange:"#FFA500",orangered:"#FF4500",orchid:"#DA70D6",palegoldenrod:"#EEE8AA",palegreen:"#98FB98",paleturquoise:"#AFEEEE",palevioletred:"#DB7093",papayawhip:"#FFEFD5",peachpuff:"#FFDAB9",peru:"#CD853F",pink:"#FFC0CB",plum:"#DDA0DD",powderblue:"#B0E0E6",purple:"#800080",rebeccapurple:"#663399",red:"#FF0000",rosybrown:"#BC8F8F",royalblue:"#4169E1",saddlebrown:"#8B4513",salmon:"#FA8072",sandybrown:"#F4A460",seagreen:"#2E8B57",seashell:"#FFF5EE",sienna:"#A0522D",silver:"#C0C0C0",skyblue:"#87CEEB",slateblue:"#6A5ACD",slategray:"#708090",slategrey:"#708090",snow:"#FFFAFA",springgreen:"#00FF7F",steelblue:"#4682B4",tan:"#D2B48C",teal:"#008080",thistle:"#D8BFD8",tomato:"#FF6347",turquoise:"#40E0D0",violet:"#EE82EE",wheat:"#F5DEB3",white:"#FFFFFF",whitesmoke:"#F5F5F5",yellow:"#FFFF00",yellowgreen:"#9ACD32"},r.Color.fromRgb=function(t){return a.fromSource(a.sourceFromRgb(t))},r.Color.sourceFromRgb=function(t){var n=t.match(a.reRGBa);if(n){var c=parseInt(n[1],10)/(/%$/.test(n[1])?100:1)*(/%$/.test(n[1])?255:1),d=parseInt(n[2],10)/(/%$/.test(n[2])?100:1)*(/%$/.test(n[2])?255:1),h=parseInt(n[3],10)/(/%$/.test(n[3])?100:1)*(/%$/.test(n[3])?255:1);return[parseInt(c,10),parseInt(d,10),parseInt(h,10),n[4]?parseFloat(n[4]):1]}},r.Color.fromRgba=a.fromRgb,r.Color.fromHsl=function(t){return a.fromSource(a.sourceFromHsl(t))},r.Color.sourceFromHsl=function(t){var n=t.match(a.reHSLa);if(n){var c,d,h,u=(parseFloat(n[1])%360+360)%360/360,_=parseFloat(n[2])/(/%$/.test(n[2])?100:1),y=parseFloat(n[3])/(/%$/.test(n[3])?100:1);if(_===0)c=d=h=y;else{var C=y<=.5?y*(_+1):y+_-y*_,x=2*y-C;c=l(x,C,u+1/3),d=l(x,C,u),h=l(x,C,u-1/3)}return[Math.round(255*c),Math.round(255*d),Math.round(255*h),n[4]?parseFloat(n[4]):1]}},r.Color.fromHsla=a.fromHsl,r.Color.fromHex=function(t){return a.fromSource(a.sourceFromHex(t))},r.Color.sourceFromHex=function(t){if(t.match(a.reHex)){var n=t.slice(t.indexOf("#")+1),c=n.length===3||n.length===4,d=n.length===8||n.length===4,h=c?n.charAt(0)+n.charAt(0):n.substring(0,2),u=c?n.charAt(1)+n.charAt(1):n.substring(2,4),_=c?n.charAt(2)+n.charAt(2):n.substring(4,6),y=d?c?n.charAt(3)+n.charAt(3):n.substring(6,8):"FF";return[parseInt(h,16),parseInt(u,16),parseInt(_,16),parseFloat((parseInt(y,16)/255).toFixed(2))]}},r.Color.fromSource=function(t){var n=new a;return n.setSource(t),n})}(i),function(o){var r=o.fabric||(o.fabric={}),a=["e","se","s","sw","w","nw","n","ne","e"],l=["ns","nesw","ew","nwse"],t={},n="left",c="top",d="right",h="bottom",u="center",_={top:h,bottom:c,left:d,right:n,center:u},y=r.util.radiansToDegrees,C=Math.sign||function(P){return(P>0)-(P<0)||+P};function x(P,R){var j=P.angle+y(Math.atan2(R.y,R.x))+360;return Math.round(j%360/45)}function S(P,R){var j=R.transform.target,z=j.canvas,V=r.util.object.clone(R);V.target=j,z&&z.fire("object:"+P,V),j.fire(P,R)}function w(P,R){var j=R.canvas,z=P[j.uniScaleKey];return j.uniformScaling&&!z||!j.uniformScaling&&z}function E(P){return P.originX===u&&P.originY===u}function M(P,R,j){var z=P.lockScalingX,V=P.lockScalingY;return!((!z||!V)&&(R||!z&&!V||!j)&&(!z||R!=="x")&&(!V||R!=="y"))}function F(P,R,j,z){return{e:P,transform:R,pointer:{x:j,y:z}}}function H(P){return function(R,j,z,V){var $=j.target,te=$.getCenterPoint(),J=$.translateToOriginPoint(te,j.originX,j.originY),q=P(R,j,z,V);return $.setPositionByOrigin(J,j.originX,j.originY),q}}function G(P,R){return function(j,z,V,$){var te=R(j,z,V,$);return te&&S(P,F(j,z,V,$)),te}}function U(P,R,j,z,V){var $=P.target,te=$.controls[P.corner],J=$.canvas.getZoom(),q=$.padding/J,ee=$.toLocalPoint(new r.Point(z,V),R,j);return ee.x>=q&&(ee.x-=q),ee.x<=-q&&(ee.x+=q),ee.y>=q&&(ee.y-=q),ee.y<=q&&(ee.y+=q),ee.x-=te.offsetX,ee.y-=te.offsetY,ee}function D(P){return P.flipX!==P.flipY}function I(P,R,j,z,V){if(P[R]!==0){var $=V/P._getTransformedDimensions()[z]*P[j];P.set(j,$)}}function N(P,R,j,z){var V,$=R.target,te=$._getTransformedDimensions(0,$.skewY),J=U(R,R.originX,R.originY,j,z),q=Math.abs(2*J.x)-te.x,ee=$.skewX;q<2?V=0:(V=y(Math.atan2(q/$.scaleX,te.y/$.scaleY)),R.originX===n&&R.originY===h&&(V=-V),R.originX===d&&R.originY===c&&(V=-V),D($)&&(V=-V));var Q=ee!==V;if(Q){var re=$._getTransformedDimensions().y;$.set("skewX",V),I($,"skewY","scaleY","y",re)}return Q}function W(P,R,j,z){var V,$=R.target,te=$._getTransformedDimensions($.skewX,0),J=U(R,R.originX,R.originY,j,z),q=Math.abs(2*J.y)-te.y,ee=$.skewY;q<2?V=0:(V=y(Math.atan2(q/$.scaleY,te.x/$.scaleX)),R.originX===n&&R.originY===h&&(V=-V),R.originX===d&&R.originY===c&&(V=-V),D($)&&(V=-V));var Q=ee!==V;if(Q){var re=$._getTransformedDimensions().x;$.set("skewY",V),I($,"skewX","scaleX","x",re)}return Q}function X(P,R,j,z,V){V=V||{};var $,te,J,q,ee,Q,re=R.target,se=re.lockScalingX,ne=re.lockScalingY,ue=V.by,pe=w(P,re),Fe=M(re,ue,pe),ze=R.gestureScale;if(Fe)return!1;if(ze)te=R.scaleX*ze,J=R.scaleY*ze;else{if($=U(R,R.originX,R.originY,j,z),ee=ue!=="y"?C($.x):1,Q=ue!=="x"?C($.y):1,R.signX||(R.signX=ee),R.signY||(R.signY=Q),re.lockScalingFlip&&(R.signX!==ee||R.signY!==Q))return!1;if(q=re._getTransformedDimensions(),pe&&!ue){var St=Math.abs($.x)+Math.abs($.y),_e=R.original,Be=St/(Math.abs(q.x*_e.scaleX/re.scaleX)+Math.abs(q.y*_e.scaleY/re.scaleY));te=_e.scaleX*Be,J=_e.scaleY*Be}else te=Math.abs($.x*re.scaleX/q.x),J=Math.abs($.y*re.scaleY/q.y);E(R)&&(te*=2,J*=2),R.signX!==ee&&ue!=="y"&&(R.originX=_[R.originX],te*=-1,R.signX=ee),R.signY!==Q&&ue!=="x"&&(R.originY=_[R.originY],J*=-1,R.signY=Q)}var kt=re.scaleX,xt=re.scaleY;return ue?(ue==="x"&&re.set("scaleX",te),ue==="y"&&re.set("scaleY",J)):(!se&&re.set("scaleX",te),!ne&&re.set("scaleY",J)),kt!==re.scaleX||xt!==re.scaleY}t.scaleCursorStyleHandler=function(P,R,j){var z=w(P,j),V="";if(R.x!==0&&R.y===0?V="x":R.x===0&&R.y!==0&&(V="y"),M(j,V,z))return"not-allowed";var $=x(j,R);return a[$]+"-resize"},t.skewCursorStyleHandler=function(P,R,j){var z="not-allowed";if(R.x!==0&&j.lockSkewingY||R.y!==0&&j.lockSkewingX)return z;var V=x(j,R)%4;return l[V]+"-resize"},t.scaleSkewCursorStyleHandler=function(P,R,j){return P[j.canvas.altActionKey]?t.skewCursorStyleHandler(P,R,j):t.scaleCursorStyleHandler(P,R,j)},t.rotationWithSnapping=G("rotating",H(function(P,R,j,z){var V=R,$=V.target,te=$.translateToOriginPoint($.getCenterPoint(),V.originX,V.originY);if($.lockRotation)return!1;var J,q=Math.atan2(V.ey-te.y,V.ex-te.x),ee=Math.atan2(z-te.y,j-te.x),Q=y(ee-q+V.theta);if($.snapAngle>0){var re=$.snapAngle,se=$.snapThreshold||re,ne=Math.ceil(Q/re)*re,ue=Math.floor(Q/re)*re;Math.abs(Q-ue)<se?Q=ue:Math.abs(Q-ne)<se&&(Q=ne)}return Q<0&&(Q=360+Q),Q%=360,J=$.angle!==Q,$.angle=Q,J})),t.scalingEqually=G("scaling",H(function(P,R,j,z){return X(P,R,j,z)})),t.scalingX=G("scaling",H(function(P,R,j,z){return X(P,R,j,z,{by:"x"})})),t.scalingY=G("scaling",H(function(P,R,j,z){return X(P,R,j,z,{by:"y"})})),t.scalingYOrSkewingX=function(P,R,j,z){return P[R.target.canvas.altActionKey]?t.skewHandlerX(P,R,j,z):t.scalingY(P,R,j,z)},t.scalingXOrSkewingY=function(P,R,j,z){return P[R.target.canvas.altActionKey]?t.skewHandlerY(P,R,j,z):t.scalingX(P,R,j,z)},t.changeWidth=G("resizing",H(function(P,R,j,z){var V=R.target,$=U(R,R.originX,R.originY,j,z),te=V.strokeWidth/(V.strokeUniform?V.scaleX:1),J=E(R)?2:1,q=V.width,ee=Math.abs($.x*J/V.scaleX)-te;return V.set("width",Math.max(ee,0)),q!==ee})),t.skewHandlerX=function(P,R,j,z){var V,$=R.target,te=$.skewX,J=R.originY;return!$.lockSkewingX&&(te===0?V=U(R,u,u,j,z).x>0?n:d:(te>0&&(V=J===c?n:d),te<0&&(V=J===c?d:n),D($)&&(V=V===n?d:n)),R.originX=V,G("skewing",H(N))(P,R,j,z))},t.skewHandlerY=function(P,R,j,z){var V,$=R.target,te=$.skewY,J=R.originX;return!$.lockSkewingY&&(te===0?V=U(R,u,u,j,z).y>0?c:h:(te>0&&(V=J===n?c:h),te<0&&(V=J===n?h:c),D($)&&(V=V===c?h:c)),R.originY=V,G("skewing",H(W))(P,R,j,z))},t.dragHandler=function(P,R,j,z){var V=R.target,$=j-R.offsetX,te=z-R.offsetY,J=!V.get("lockMovementX")&&V.left!==$,q=!V.get("lockMovementY")&&V.top!==te;return J&&V.set("left",$),q&&V.set("top",te),(J||q)&&S("moving",F(P,R,j,z)),J||q},t.scaleOrSkewActionName=function(P,R,j){var z=P[j.canvas.altActionKey];return R.x===0?z?"skewX":"scaleY":R.y===0?z?"skewY":"scaleX":void 0},t.rotationStyleHandler=function(P,R,j){return j.lockRotation?"not-allowed":R.cursorStyle},t.fireEvent=S,t.wrapWithFixedAnchor=H,t.wrapWithFireEvent=G,t.getLocalPoint=U,r.controlsUtils=t}(i),function(o){var r=o.fabric||(o.fabric={}),a=r.util.degreesToRadians,l=r.controlsUtils;l.renderCircleControl=function(t,n,c,d,h){d=d||{};var u,_=this.sizeX||d.cornerSize||h.cornerSize,y=this.sizeY||d.cornerSize||h.cornerSize,C=d.transparentCorners!==void 0?d.transparentCorners:h.transparentCorners,x=C?"stroke":"fill",S=!C&&(d.cornerStrokeColor||h.cornerStrokeColor),w=n,E=c;t.save(),t.fillStyle=d.cornerColor||h.cornerColor,t.strokeStyle=d.cornerStrokeColor||h.cornerStrokeColor,_>y?(u=_,t.scale(1,y/_),E=c*_/y):y>_?(u=y,t.scale(_/y,1),w=n*y/_):u=_,t.lineWidth=1,t.beginPath(),t.arc(w,E,u/2,0,2*Math.PI,!1),t[x](),S&&t.stroke(),t.restore()},l.renderSquareControl=function(t,n,c,d,h){d=d||{};var u=this.sizeX||d.cornerSize||h.cornerSize,_=this.sizeY||d.cornerSize||h.cornerSize,y=d.transparentCorners!==void 0?d.transparentCorners:h.transparentCorners,C=y?"stroke":"fill",x=!y&&(d.cornerStrokeColor||h.cornerStrokeColor),S=u/2,w=_/2;t.save(),t.fillStyle=d.cornerColor||h.cornerColor,t.strokeStyle=d.cornerStrokeColor||h.cornerStrokeColor,t.lineWidth=1,t.translate(n,c),t.rotate(a(h.angle)),t[C+"Rect"](-S,-w,u,_),x&&t.strokeRect(-S,-w,u,_),t.restore()}}(i),function(o){var r=o.fabric||(o.fabric={});r.Control=function(a){for(var l in a)this[l]=a[l]},r.Control.prototype={visible:!0,actionName:"scale",angle:0,x:0,y:0,offsetX:0,offsetY:0,sizeX:null,sizeY:null,touchSizeX:null,touchSizeY:null,cursorStyle:"crosshair",withConnection:!1,actionHandler:function(){},mouseDownHandler:function(){},mouseUpHandler:function(){},getActionHandler:function(){return this.actionHandler},getMouseDownHandler:function(){return this.mouseDownHandler},getMouseUpHandler:function(){return this.mouseUpHandler},cursorStyleHandler:function(a,l){return l.cursorStyle},getActionName:function(a,l){return l.actionName},getVisibility:function(a,l){var t=a._controlsVisibility;return t&&t[l]!==void 0?t[l]:this.visible},setVisibility:function(a){this.visible=a},positionHandler:function(a,l){return r.util.transformPoint({x:this.x*a.x+this.offsetX,y:this.y*a.y+this.offsetY},l)},calcCornerCoords:function(a,l,t,n,c){var d,h,u,_,y=c?this.touchSizeX:this.sizeX,C=c?this.touchSizeY:this.sizeY;if(y&&C&&y!==C){var x=Math.atan2(C,y),S=Math.sqrt(y*y+C*C)/2,w=x-r.util.degreesToRadians(a),E=Math.PI/2-x-r.util.degreesToRadians(a);d=S*r.util.cos(w),h=S*r.util.sin(w),u=S*r.util.cos(E),_=S*r.util.sin(E)}else S=.7071067812*(y&&C?y:l),w=r.util.degreesToRadians(45-a),d=u=S*r.util.cos(w),h=_=S*r.util.sin(w);return{tl:{x:t-_,y:n-u},tr:{x:t+d,y:n-h},bl:{x:t-d,y:n+h},br:{x:t+_,y:n+u}}},render:function(a,l,t,n,c){((n=n||{}).cornerStyle||c.cornerStyle)==="circle"?r.controlsUtils.renderCircleControl.call(this,a,l,t,n,c):r.controlsUtils.renderSquareControl.call(this,a,l,t,n,c)}}}(i),function(){function o(a,l){var t,n,c,d,h=a.getAttribute("style"),u=a.getAttribute("offset")||0;if(u=(u=parseFloat(u)/(/%$/.test(u)?100:1))<0?0:u>1?1:u,h){var _=h.split(/\s*;\s*/);for(_[_.length-1]===""&&_.pop(),d=_.length;d--;){var y=_[d].split(/\s*:\s*/),C=y[0].trim(),x=y[1].trim();C==="stop-color"?t=x:C==="stop-opacity"&&(c=x)}}return t||(t=a.getAttribute("stop-color")||"rgb(0,0,0)"),c||(c=a.getAttribute("stop-opacity")),n=(t=new v.Color(t)).getAlpha(),c=isNaN(parseFloat(c))?1:parseFloat(c),c*=n*l,{offset:u,color:t.toRgb(),opacity:c}}var r=v.util.object.clone;v.Gradient=v.util.createClass({offsetX:0,offsetY:0,gradientTransform:null,gradientUnits:"pixels",type:"linear",initialize:function(a){a||(a={}),a.coords||(a.coords={});var l,t=this;Object.keys(a).forEach(function(n){t[n]=a[n]}),this.id?this.id+="_"+v.Object.__uid++:this.id=v.Object.__uid++,l={x1:a.coords.x1||0,y1:a.coords.y1||0,x2:a.coords.x2||0,y2:a.coords.y2||0},this.type==="radial"&&(l.r1=a.coords.r1||0,l.r2=a.coords.r2||0),this.coords=l,this.colorStops=a.colorStops.slice()},addColorStop:function(a){for(var l in a){var t=new v.Color(a[l]);this.colorStops.push({offset:parseFloat(l),color:t.toRgb(),opacity:t.getAlpha()})}return this},toObject:function(a){var l={type:this.type,coords:this.coords,colorStops:this.colorStops,offsetX:this.offsetX,offsetY:this.offsetY,gradientUnits:this.gradientUnits,gradientTransform:this.gradientTransform?this.gradientTransform.concat():this.gradientTransform};return v.util.populateWithProperties(this,l,a),l},toSVG:function(a,l){var t,n,c,d,h=r(this.coords,!0),u=(l=l||{},r(this.colorStops,!0)),_=h.r1>h.r2,y=this.gradientTransform?this.gradientTransform.concat():v.iMatrix.concat(),C=-this.offsetX,x=-this.offsetY,S=!!l.additionalTransform,w=this.gradientUnits==="pixels"?"userSpaceOnUse":"objectBoundingBox";if(u.sort(function(H,G){return H.offset-G.offset}),w==="objectBoundingBox"?(C/=a.width,x/=a.height):(C+=a.width/2,x+=a.height/2),a.type==="path"&&this.gradientUnits!=="percentage"&&(C-=a.pathOffset.x,x-=a.pathOffset.y),y[4]-=C,y[5]-=x,d='id="SVGID_'+this.id+'" gradientUnits="'+w+'"',d+=' gradientTransform="'+(S?l.additionalTransform+" ":"")+v.util.matrixToSVG(y)+'" ',this.type==="linear"?c=["<linearGradient ",d,' x1="',h.x1,'" y1="',h.y1,'" x2="',h.x2,'" y2="',h.y2,`">
`]:this.type==="radial"&&(c=["<radialGradient ",d,' cx="',_?h.x1:h.x2,'" cy="',_?h.y1:h.y2,'" r="',_?h.r1:h.r2,'" fx="',_?h.x2:h.x1,'" fy="',_?h.y2:h.y1,`">
`]),this.type==="radial"){if(_)for((u=u.concat()).reverse(),t=0,n=u.length;t<n;t++)u[t].offset=1-u[t].offset;var E=Math.min(h.r1,h.r2);if(E>0){var M=E/Math.max(h.r1,h.r2);for(t=0,n=u.length;t<n;t++)u[t].offset+=M*(1-u[t].offset)}}for(t=0,n=u.length;t<n;t++){var F=u[t];c.push("<stop ",'offset="',100*F.offset+"%",'" style="stop-color:',F.color,F.opacity!==void 0?";stop-opacity: "+F.opacity:";",`"/>
`)}return c.push(this.type==="linear"?`</linearGradient>
`:`</radialGradient>
`),c.join("")},toLive:function(a){var l,t,n,c=v.util.object.clone(this.coords);if(this.type){for(this.type==="linear"?l=a.createLinearGradient(c.x1,c.y1,c.x2,c.y2):this.type==="radial"&&(l=a.createRadialGradient(c.x1,c.y1,c.r1,c.x2,c.y2,c.r2)),t=0,n=this.colorStops.length;t<n;t++){var d=this.colorStops[t].color,h=this.colorStops[t].opacity,u=this.colorStops[t].offset;h!==void 0&&(d=new v.Color(d).setAlpha(h).toRgba()),l.addColorStop(u,d)}return l}}}),v.util.object.extend(v.Gradient,{fromElement:function(a,l,t,n){var c=parseFloat(t)/(/%$/.test(t)?100:1);c=c<0?0:c>1?1:c,isNaN(c)&&(c=1);var d,h,u,_,y=a.getElementsByTagName("stop"),C=a.getAttribute("gradientUnits")==="userSpaceOnUse"?"pixels":"percentage",x=a.getAttribute("gradientTransform")||"",S=[],w=0,E=0;for(a.nodeName==="linearGradient"||a.nodeName==="LINEARGRADIENT"?(d="linear",h=function(M){return{x1:M.getAttribute("x1")||0,y1:M.getAttribute("y1")||0,x2:M.getAttribute("x2")||"100%",y2:M.getAttribute("y2")||0}}(a)):(d="radial",h=function(M){return{x1:M.getAttribute("fx")||M.getAttribute("cx")||"50%",y1:M.getAttribute("fy")||M.getAttribute("cy")||"50%",r1:0,x2:M.getAttribute("cx")||"50%",y2:M.getAttribute("cy")||"50%",r2:M.getAttribute("r")||"50%"}}(a)),u=y.length;u--;)S.push(o(y[u],c));return _=v.parseTransformAttribute(x),function(M,F,H,G){var U,D;Object.keys(F).forEach(function(I){(U=F[I])==="Infinity"?D=1:U==="-Infinity"?D=0:(D=parseFloat(F[I],10),typeof U=="string"&&/^(\d+\.\d+)%|(\d+)%$/.test(U)&&(D*=.01,G==="pixels"&&(I!=="x1"&&I!=="x2"&&I!=="r2"||(D*=H.viewBoxWidth||H.width),I!=="y1"&&I!=="y2"||(D*=H.viewBoxHeight||H.height)))),F[I]=D})}(0,h,n,C),C==="pixels"&&(w=-l.left,E=-l.top),new v.Gradient({id:a.getAttribute("id"),type:d,coords:h,colorStops:S,gradientUnits:C,gradientTransform:_,offsetX:w,offsetY:E})}})}(),de=v.util.toFixed,v.Pattern=v.util.createClass({repeat:"repeat",offsetX:0,offsetY:0,crossOrigin:"",patternTransform:null,initialize:function(o,r){if(o||(o={}),this.id=v.Object.__uid++,this.setOptions(o),!o.source||o.source&&typeof o.source!="string")r&&r(this);else{var a=this;this.source=v.util.createImage(),v.util.loadImage(o.source,function(l,t){a.source=l,r&&r(a,t)},null,this.crossOrigin)}},toObject:function(o){var r,a,l=v.Object.NUM_FRACTION_DIGITS;return typeof this.source.src=="string"?r=this.source.src:typeof this.source=="object"&&this.source.toDataURL&&(r=this.source.toDataURL()),a={type:"pattern",source:r,repeat:this.repeat,crossOrigin:this.crossOrigin,offsetX:de(this.offsetX,l),offsetY:de(this.offsetY,l),patternTransform:this.patternTransform?this.patternTransform.concat():null},v.util.populateWithProperties(this,a,o),a},toSVG:function(o){var r=typeof this.source=="function"?this.source():this.source,a=r.width/o.width,l=r.height/o.height,t=this.offsetX/o.width,n=this.offsetY/o.height,c="";return this.repeat!=="repeat-x"&&this.repeat!=="no-repeat"||(l=1,n&&(l+=Math.abs(n))),this.repeat!=="repeat-y"&&this.repeat!=="no-repeat"||(a=1,t&&(a+=Math.abs(t))),r.src?c=r.src:r.toDataURL&&(c=r.toDataURL()),'<pattern id="SVGID_'+this.id+'" x="'+t+'" y="'+n+'" width="'+a+'" height="'+l+`">
<image x="0" y="0" width="`+r.width+'" height="'+r.height+'" xlink:href="'+c+`"></image>
</pattern>
`},setOptions:function(o){for(var r in o)this[r]=o[r]},toLive:function(o){var r=this.source;return!r||r.src!==void 0&&(!r.complete||r.naturalWidth===0||r.naturalHeight===0)?"":o.createPattern(r,this.repeat)}}),function(o){var r=o.fabric||(o.fabric={}),a=r.util.toFixed;r.Shadow?r.warn("fabric.Shadow is already defined."):(r.Shadow=r.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:!1,includeDefaultValues:!0,nonScaling:!1,initialize:function(l){for(var t in typeof l=="string"&&(l=this._parseShadow(l)),l)this[t]=l[t];this.id=r.Object.__uid++},_parseShadow:function(l){var t=l.trim(),n=r.Shadow.reOffsetsAndBlur.exec(t)||[];return{color:(t.replace(r.Shadow.reOffsetsAndBlur,"")||"rgb(0,0,0)").trim(),offsetX:parseFloat(n[1],10)||0,offsetY:parseFloat(n[2],10)||0,blur:parseFloat(n[3],10)||0}},toString:function(){return[this.offsetX,this.offsetY,this.blur,this.color].join("px ")},toSVG:function(l){var t=40,n=40,c=r.Object.NUM_FRACTION_DIGITS,d=r.util.rotateVector({x:this.offsetX,y:this.offsetY},r.util.degreesToRadians(-l.angle)),h=new r.Color(this.color);return l.width&&l.height&&(t=100*a((Math.abs(d.x)+this.blur)/l.width,c)+20,n=100*a((Math.abs(d.y)+this.blur)/l.height,c)+20),l.flipX&&(d.x*=-1),l.flipY&&(d.y*=-1),'<filter id="SVGID_'+this.id+'" y="-'+n+'%" height="'+(100+2*n)+'%" x="-'+t+'%" width="'+(100+2*t)+`%" >
	<feGaussianBlur in="SourceAlpha" stdDeviation="`+a(this.blur?this.blur/2:0,c)+`"></feGaussianBlur>
	<feOffset dx="`+a(d.x,c)+'" dy="'+a(d.y,c)+`" result="oBlur" ></feOffset>
	<feFlood flood-color="`+h.toRgb()+'" flood-opacity="'+h.getAlpha()+`"/>
	<feComposite in2="oBlur" operator="in" />
	<feMerge>
		<feMergeNode></feMergeNode>
		<feMergeNode in="SourceGraphic"></feMergeNode>
	</feMerge>
</filter>
`},toObject:function(){if(this.includeDefaultValues)return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY,affectStroke:this.affectStroke,nonScaling:this.nonScaling};var l={},t=r.Shadow.prototype;return["color","blur","offsetX","offsetY","affectStroke","nonScaling"].forEach(function(n){this[n]!==t[n]&&(l[n]=this[n])},this),l}}),r.Shadow.reOffsetsAndBlur=/(?:\s|^)(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(-?\d+(?:\.\d*)?(?:px)?(?:\s?|$))?(\d+(?:\.\d*)?(?:px)?)?(?:\s?|$)(?:$|\s)/)}(i),function(){if(v.StaticCanvas)v.warn("fabric.StaticCanvas is already defined.");else{var o=v.util.object.extend,r=v.util.getElementOffset,a=v.util.removeFromArray,l=v.util.toFixed,t=v.util.transformPoint,n=v.util.invertTransform,c=v.util.getNodeCanvas,d=v.util.createCanvasElement,h=new Error("Could not initialize `canvas` element");v.StaticCanvas=v.util.createClass(v.CommonMethods,{initialize:function(u,_){_||(_={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(u,_)},backgroundColor:"",backgroundImage:null,overlayColor:"",overlayImage:null,includeDefaultValues:!0,stateful:!1,renderOnAddRemove:!0,controlsAboveOverlay:!1,allowTouchScrolling:!1,imageSmoothingEnabled:!0,viewportTransform:v.iMatrix.concat(),backgroundVpt:!0,overlayVpt:!0,enableRetinaScaling:!0,vptCoords:{},skipOffscreen:!0,clipPath:void 0,_initStatic:function(u,_){var y=this.requestRenderAllBound;this._objects=[],this._createLowerCanvas(u),this._initOptions(_),this.interactive||this._initRetinaScaling(),_.overlayImage&&this.setOverlayImage(_.overlayImage,y),_.backgroundImage&&this.setBackgroundImage(_.backgroundImage,y),_.backgroundColor&&this.setBackgroundColor(_.backgroundColor,y),_.overlayColor&&this.setOverlayColor(_.overlayColor,y),this.calcOffset()},_isRetinaScaling:function(){return v.devicePixelRatio>1&&this.enableRetinaScaling},getRetinaScaling:function(){return this._isRetinaScaling()?Math.max(1,v.devicePixelRatio):1},_initRetinaScaling:function(){if(this._isRetinaScaling()){var u=v.devicePixelRatio;this.__initRetinaScaling(u,this.lowerCanvasEl,this.contextContainer),this.upperCanvasEl&&this.__initRetinaScaling(u,this.upperCanvasEl,this.contextTop)}},__initRetinaScaling:function(u,_,y){_.setAttribute("width",this.width*u),_.setAttribute("height",this.height*u),y.scale(u,u)},calcOffset:function(){return this._offset=r(this.lowerCanvasEl),this},setOverlayImage:function(u,_,y){return this.__setBgOverlayImage("overlayImage",u,_,y)},setBackgroundImage:function(u,_,y){return this.__setBgOverlayImage("backgroundImage",u,_,y)},setOverlayColor:function(u,_){return this.__setBgOverlayColor("overlayColor",u,_)},setBackgroundColor:function(u,_){return this.__setBgOverlayColor("backgroundColor",u,_)},__setBgOverlayImage:function(u,_,y,C){return typeof _=="string"?v.util.loadImage(_,function(x,S){if(x){var w=new v.Image(x,C);this[u]=w,w.canvas=this}y&&y(x,S)},this,C&&C.crossOrigin):(C&&_.setOptions(C),this[u]=_,_&&(_.canvas=this),y&&y(_,!1)),this},__setBgOverlayColor:function(u,_,y){return this[u]=_,this._initGradient(_,u),this._initPattern(_,u,y),this},_createCanvasElement:function(){var u=d();if(!u||(u.style||(u.style={}),u.getContext===void 0))throw h;return u},_initOptions:function(u){var _=this.lowerCanvasEl;this._setOptions(u),this.width=this.width||parseInt(_.width,10)||0,this.height=this.height||parseInt(_.height,10)||0,this.lowerCanvasEl.style&&(_.width=this.width,_.height=this.height,_.style.width=this.width+"px",_.style.height=this.height+"px",this.viewportTransform=this.viewportTransform.slice())},_createLowerCanvas:function(u){u&&u.getContext?this.lowerCanvasEl=u:this.lowerCanvasEl=v.util.getById(u)||this._createCanvasElement(),v.util.addClass(this.lowerCanvasEl,"lower-canvas"),this._originalCanvasStyle=this.lowerCanvasEl.style,this.interactive&&this._applyCanvasStyle(this.lowerCanvasEl),this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(u,_){return this.setDimensions({width:u},_)},setHeight:function(u,_){return this.setDimensions({height:u},_)},setDimensions:function(u,_){var y;for(var C in _=_||{},u)y=u[C],_.cssOnly||(this._setBackstoreDimension(C,u[C]),y+="px",this.hasLostContext=!0),_.backstoreOnly||this._setCssDimension(C,y);return this._isCurrentlyDrawing&&this.freeDrawingBrush&&this.freeDrawingBrush._setBrushStyles(this.contextTop),this._initRetinaScaling(),this.calcOffset(),_.cssOnly||this.requestRenderAll(),this},_setBackstoreDimension:function(u,_){return this.lowerCanvasEl[u]=_,this.upperCanvasEl&&(this.upperCanvasEl[u]=_),this.cacheCanvasEl&&(this.cacheCanvasEl[u]=_),this[u]=_,this},_setCssDimension:function(u,_){return this.lowerCanvasEl.style[u]=_,this.upperCanvasEl&&(this.upperCanvasEl.style[u]=_),this.wrapperEl&&(this.wrapperEl.style[u]=_),this},getZoom:function(){return this.viewportTransform[0]},setViewportTransform:function(u){var _,y,C,x=this._activeObject,S=this.backgroundImage,w=this.overlayImage;for(this.viewportTransform=u,y=0,C=this._objects.length;y<C;y++)(_=this._objects[y]).group||_.setCoords(!0);return x&&x.setCoords(),S&&S.setCoords(!0),w&&w.setCoords(!0),this.calcViewportBoundaries(),this.renderOnAddRemove&&this.requestRenderAll(),this},zoomToPoint:function(u,_){var y=u,C=this.viewportTransform.slice(0);u=t(u,n(this.viewportTransform)),C[0]=_,C[3]=_;var x=t(u,C);return C[4]+=y.x-x.x,C[5]+=y.y-x.y,this.setViewportTransform(C)},setZoom:function(u){return this.zoomToPoint(new v.Point(0,0),u),this},absolutePan:function(u){var _=this.viewportTransform.slice(0);return _[4]=-u.x,_[5]=-u.y,this.setViewportTransform(_)},relativePan:function(u){return this.absolutePan(new v.Point(-u.x-this.viewportTransform[4],-u.y-this.viewportTransform[5]))},getElement:function(){return this.lowerCanvasEl},_onObjectAdded:function(u){this.stateful&&u.setupState(),u._set("canvas",this),u.setCoords(),this.fire("object:added",{target:u}),u.fire("added")},_onObjectRemoved:function(u){this.fire("object:removed",{target:u}),u.fire("removed"),delete u.canvas},clearContext:function(u){return u.clearRect(0,0,this.width,this.height),this},getContext:function(){return this.contextContainer},clear:function(){return this.remove.apply(this,this.getObjects()),this.backgroundImage=null,this.overlayImage=null,this.backgroundColor="",this.overlayColor="",this._hasITextHandlers&&(this.off("mouse:up",this._mouseUpITextHandler),this._iTextInstances=null,this._hasITextHandlers=!1),this.clearContext(this.contextContainer),this.fire("canvas:cleared"),this.renderOnAddRemove&&this.requestRenderAll(),this},renderAll:function(){var u=this.contextContainer;return this.renderCanvas(u,this._objects),this},renderAndReset:function(){this.isRendering=0,this.renderAll()},requestRenderAll:function(){return this.isRendering||(this.isRendering=v.util.requestAnimFrame(this.renderAndResetBound)),this},calcViewportBoundaries:function(){var u={},_=this.width,y=this.height,C=n(this.viewportTransform);return u.tl=t({x:0,y:0},C),u.br=t({x:_,y},C),u.tr=new v.Point(u.br.x,u.tl.y),u.bl=new v.Point(u.tl.x,u.br.y),this.vptCoords=u,u},cancelRequestedRender:function(){this.isRendering&&(v.util.cancelAnimFrame(this.isRendering),this.isRendering=0)},renderCanvas:function(u,_){var y=this.viewportTransform,C=this.clipPath;this.cancelRequestedRender(),this.calcViewportBoundaries(),this.clearContext(u),v.util.setImageSmoothing(u,this.imageSmoothingEnabled),this.fire("before:render",{ctx:u}),this._renderBackground(u),u.save(),u.transform(y[0],y[1],y[2],y[3],y[4],y[5]),this._renderObjects(u,_),u.restore(),!this.controlsAboveOverlay&&this.interactive&&this.drawControls(u),C&&(C.canvas=this,C.shouldCache(),C._transformDone=!0,C.renderCache({forClipping:!0}),this.drawClipPathOnCanvas(u)),this._renderOverlay(u),this.controlsAboveOverlay&&this.interactive&&this.drawControls(u),this.fire("after:render",{ctx:u})},drawClipPathOnCanvas:function(u){var _=this.viewportTransform,y=this.clipPath;u.save(),u.transform(_[0],_[1],_[2],_[3],_[4],_[5]),u.globalCompositeOperation="destination-in",y.transform(u),u.scale(1/y.zoomX,1/y.zoomY),u.drawImage(y._cacheCanvas,-y.cacheTranslationX,-y.cacheTranslationY),u.restore()},_renderObjects:function(u,_){var y,C;for(y=0,C=_.length;y<C;++y)_[y]&&_[y].render(u)},_renderBackgroundOrOverlay:function(u,_){var y=this[_+"Color"],C=this[_+"Image"],x=this.viewportTransform,S=this[_+"Vpt"];if(y||C){if(y){u.save(),u.beginPath(),u.moveTo(0,0),u.lineTo(this.width,0),u.lineTo(this.width,this.height),u.lineTo(0,this.height),u.closePath(),u.fillStyle=y.toLive?y.toLive(u,this):y,S&&u.transform(x[0],x[1],x[2],x[3],x[4],x[5]),u.transform(1,0,0,1,y.offsetX||0,y.offsetY||0);var w=y.gradientTransform||y.patternTransform;w&&u.transform(w[0],w[1],w[2],w[3],w[4],w[5]),u.fill(),u.restore()}C&&(u.save(),S&&u.transform(x[0],x[1],x[2],x[3],x[4],x[5]),C.render(u),u.restore())}},_renderBackground:function(u){this._renderBackgroundOrOverlay(u,"background")},_renderOverlay:function(u){this._renderBackgroundOrOverlay(u,"overlay")},getCenter:function(){return{top:this.height/2,left:this.width/2}},getCenterPoint:function(){return new v.Point(this.width/2,this.height/2)},centerObjectH:function(u){return this._centerObject(u,new v.Point(this.getCenterPoint().x,u.getCenterPoint().y))},centerObjectV:function(u){return this._centerObject(u,new v.Point(u.getCenterPoint().x,this.getCenterPoint().y))},centerObject:function(u){var _=this.getCenterPoint();return this._centerObject(u,_)},viewportCenterObject:function(u){var _=this.getVpCenter();return this._centerObject(u,_)},viewportCenterObjectH:function(u){var _=this.getVpCenter();return this._centerObject(u,new v.Point(_.x,u.getCenterPoint().y)),this},viewportCenterObjectV:function(u){var _=this.getVpCenter();return this._centerObject(u,new v.Point(u.getCenterPoint().x,_.y))},getVpCenter:function(){var u=this.getCenterPoint(),_=n(this.viewportTransform);return t(u,_)},_centerObject:function(u,_){return u.setPositionByOrigin(_,"center","center"),u.setCoords(),this.renderOnAddRemove&&this.requestRenderAll(),this},toDatalessJSON:function(u){return this.toDatalessObject(u)},toObject:function(u){return this._toObjectMethod("toObject",u)},toDatalessObject:function(u){return this._toObjectMethod("toDatalessObject",u)},_toObjectMethod:function(u,_){var y=this.clipPath,C={version:v.version,objects:this._toObjects(u,_)};return y&&!y.excludeFromExport&&(C.clipPath=this._toObject(this.clipPath,u,_)),o(C,this.__serializeBgOverlay(u,_)),v.util.populateWithProperties(this,C,_),C},_toObjects:function(u,_){return this._objects.filter(function(y){return!y.excludeFromExport}).map(function(y){return this._toObject(y,u,_)},this)},_toObject:function(u,_,y){var C;this.includeDefaultValues||(C=u.includeDefaultValues,u.includeDefaultValues=!1);var x=u[_](y);return this.includeDefaultValues||(u.includeDefaultValues=C),x},__serializeBgOverlay:function(u,_){var y={},C=this.backgroundImage,x=this.overlayImage,S=this.backgroundColor,w=this.overlayColor;return S&&S.toObject?S.excludeFromExport||(y.background=S.toObject(_)):S&&(y.background=S),w&&w.toObject?w.excludeFromExport||(y.overlay=w.toObject(_)):w&&(y.overlay=w),C&&!C.excludeFromExport&&(y.backgroundImage=this._toObject(C,u,_)),x&&!x.excludeFromExport&&(y.overlayImage=this._toObject(x,u,_)),y},svgViewportTransformation:!0,toSVG:function(u,_){u||(u={}),u.reviver=_;var y=[];return this._setSVGPreamble(y,u),this._setSVGHeader(y,u),this.clipPath&&y.push('<g clip-path="url(#'+this.clipPath.clipPathId+`)" >
`),this._setSVGBgOverlayColor(y,"background"),this._setSVGBgOverlayImage(y,"backgroundImage",_),this._setSVGObjects(y,_),this.clipPath&&y.push(`</g>
`),this._setSVGBgOverlayColor(y,"overlay"),this._setSVGBgOverlayImage(y,"overlayImage",_),y.push("</svg>"),y.join("")},_setSVGPreamble:function(u,_){_.suppressPreamble||u.push('<?xml version="1.0" encoding="',_.encoding||"UTF-8",`" standalone="no" ?>
`,'<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ',`"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
`)},_setSVGHeader:function(u,_){var y,C=_.width||this.width,x=_.height||this.height,S='viewBox="0 0 '+this.width+" "+this.height+'" ',w=v.Object.NUM_FRACTION_DIGITS;_.viewBox?S='viewBox="'+_.viewBox.x+" "+_.viewBox.y+" "+_.viewBox.width+" "+_.viewBox.height+'" ':this.svgViewportTransformation&&(y=this.viewportTransform,S='viewBox="'+l(-y[4]/y[0],w)+" "+l(-y[5]/y[3],w)+" "+l(this.width/y[0],w)+" "+l(this.height/y[3],w)+'" '),u.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',C,'" ','height="',x,'" ',S,`xml:space="preserve">
`,"<desc>Created with Fabric.js ",v.version,`</desc>
`,`<defs>
`,this.createSVGFontFacesMarkup(),this.createSVGRefElementsMarkup(),this.createSVGClipPathMarkup(_),`</defs>
`)},createSVGClipPathMarkup:function(u){var _=this.clipPath;return _?(_.clipPathId="CLIPPATH_"+v.Object.__uid++,'<clipPath id="'+_.clipPathId+`" >
`+this.clipPath.toClipPathSVG(u.reviver)+`</clipPath>
`):""},createSVGRefElementsMarkup:function(){var u=this;return["background","overlay"].map(function(_){var y=u[_+"Color"];if(y&&y.toLive){var C=u[_+"Vpt"],x=u.viewportTransform,S={width:u.width/(C?x[0]:1),height:u.height/(C?x[3]:1)};return y.toSVG(S,{additionalTransform:C?v.util.matrixToSVG(x):""})}}).join("")},createSVGFontFacesMarkup:function(){var u,_,y,C,x,S,w,E,M="",F={},H=v.fontPaths,G=[];for(this._objects.forEach(function D(I){G.push(I),I._objects&&I._objects.forEach(D)}),w=0,E=G.length;w<E;w++)if(_=(u=G[w]).fontFamily,u.type.indexOf("text")!==-1&&!F[_]&&H[_]&&(F[_]=!0,u.styles))for(x in y=u.styles)for(S in C=y[x])!F[_=C[S].fontFamily]&&H[_]&&(F[_]=!0);for(var U in F)M+=[`		@font-face {
`,"			font-family: '",U,`';
`,"			src: url('",H[U],`');
`,`		}
`].join("");return M&&(M=['	<style type="text/css">',`<![CDATA[
`,M,"]]>",`</style>
`].join("")),M},_setSVGObjects:function(u,_){var y,C,x,S=this._objects;for(C=0,x=S.length;C<x;C++)(y=S[C]).excludeFromExport||this._setSVGObject(u,y,_)},_setSVGObject:function(u,_,y){u.push(_.toSVG(y))},_setSVGBgOverlayImage:function(u,_,y){this[_]&&!this[_].excludeFromExport&&this[_].toSVG&&u.push(this[_].toSVG(y))},_setSVGBgOverlayColor:function(u,_){var y=this[_+"Color"],C=this.viewportTransform,x=this.width,S=this.height;if(y)if(y.toLive){var w=y.repeat,E=v.util.invertTransform(C),M=this[_+"Vpt"]?v.util.matrixToSVG(E):"";u.push('<rect transform="'+M+" translate(",x/2,",",S/2,')"',' x="',y.offsetX-x/2,'" y="',y.offsetY-S/2,'" ','width="',w==="repeat-y"||w==="no-repeat"?y.source.width:x,'" height="',w==="repeat-x"||w==="no-repeat"?y.source.height:S,'" fill="url(#SVGID_'+y.id+')"',`></rect>
`)}else u.push('<rect x="0" y="0" width="100%" height="100%" ','fill="',y,'"',`></rect>
`)},sendToBack:function(u){if(!u)return this;var _,y,C,x=this._activeObject;if(u===x&&u.type==="activeSelection")for(_=(C=x._objects).length;_--;)y=C[_],a(this._objects,y),this._objects.unshift(y);else a(this._objects,u),this._objects.unshift(u);return this.renderOnAddRemove&&this.requestRenderAll(),this},bringToFront:function(u){if(!u)return this;var _,y,C,x=this._activeObject;if(u===x&&u.type==="activeSelection")for(C=x._objects,_=0;_<C.length;_++)y=C[_],a(this._objects,y),this._objects.push(y);else a(this._objects,u),this._objects.push(u);return this.renderOnAddRemove&&this.requestRenderAll(),this},sendBackwards:function(u,_){if(!u)return this;var y,C,x,S,w,E=this._activeObject,M=0;if(u===E&&u.type==="activeSelection")for(w=E._objects,y=0;y<w.length;y++)C=w[y],(x=this._objects.indexOf(C))>0+M&&(S=x-1,a(this._objects,C),this._objects.splice(S,0,C)),M++;else(x=this._objects.indexOf(u))!==0&&(S=this._findNewLowerIndex(u,x,_),a(this._objects,u),this._objects.splice(S,0,u));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewLowerIndex:function(u,_,y){var C,x;if(y){for(C=_,x=_-1;x>=0;--x)if(u.intersectsWithObject(this._objects[x])||u.isContainedWithinObject(this._objects[x])||this._objects[x].isContainedWithinObject(u)){C=x;break}}else C=_-1;return C},bringForward:function(u,_){if(!u)return this;var y,C,x,S,w,E=this._activeObject,M=0;if(u===E&&u.type==="activeSelection")for(y=(w=E._objects).length;y--;)C=w[y],(x=this._objects.indexOf(C))<this._objects.length-1-M&&(S=x+1,a(this._objects,C),this._objects.splice(S,0,C)),M++;else(x=this._objects.indexOf(u))!==this._objects.length-1&&(S=this._findNewUpperIndex(u,x,_),a(this._objects,u),this._objects.splice(S,0,u));return this.renderOnAddRemove&&this.requestRenderAll(),this},_findNewUpperIndex:function(u,_,y){var C,x,S;if(y){for(C=_,x=_+1,S=this._objects.length;x<S;++x)if(u.intersectsWithObject(this._objects[x])||u.isContainedWithinObject(this._objects[x])||this._objects[x].isContainedWithinObject(u)){C=x;break}}else C=_+1;return C},moveTo:function(u,_){return a(this._objects,u),this._objects.splice(_,0,u),this.renderOnAddRemove&&this.requestRenderAll()},dispose:function(){return this.isRendering&&(v.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(u){u.dispose&&u.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),v.util.setStyle(this.lowerCanvasEl,this._originalCanvasStyle),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),v.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},toString:function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this._objects.length+" }>"}}),o(v.StaticCanvas.prototype,v.Observable),o(v.StaticCanvas.prototype,v.Collection),o(v.StaticCanvas.prototype,v.DataURLExporter),o(v.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',supports:function(u){var _=d();if(!_||!_.getContext)return null;var y=_.getContext("2d");return y&&u==="setLineDash"?y.setLineDash!==void 0:null}}),v.StaticCanvas.prototype.toJSON=v.StaticCanvas.prototype.toObject,v.isLikelyNode&&(v.StaticCanvas.prototype.createPNGStream=function(){var u=c(this.lowerCanvasEl);return u&&u.createPNGStream()},v.StaticCanvas.prototype.createJPEGStream=function(u){var _=c(this.lowerCanvasEl);return _&&_.createJPEGStream(u)})}}(),v.BaseBrush=v.util.createClass({color:"rgb(0, 0, 0)",width:1,shadow:null,strokeLineCap:"round",strokeLineJoin:"round",strokeMiterLimit:10,strokeDashArray:null,limitedToCanvasSize:!1,_setBrushStyles:function(o){o.strokeStyle=this.color,o.lineWidth=this.width,o.lineCap=this.strokeLineCap,o.miterLimit=this.strokeMiterLimit,o.lineJoin=this.strokeLineJoin,o.setLineDash(this.strokeDashArray||[])},_saveAndTransform:function(o){var r=this.canvas.viewportTransform;o.save(),o.transform(r[0],r[1],r[2],r[3],r[4],r[5])},_setShadow:function(){if(this.shadow){var o=this.canvas,r=this.shadow,a=o.contextTop,l=o.getZoom();o&&o._isRetinaScaling()&&(l*=v.devicePixelRatio),a.shadowColor=r.color,a.shadowBlur=r.blur*l,a.shadowOffsetX=r.offsetX*l,a.shadowOffsetY=r.offsetY*l}},needsFullRender:function(){return new v.Color(this.color).getAlpha()<1||!!this.shadow},_resetShadow:function(){var o=this.canvas.contextTop;o.shadowColor="",o.shadowBlur=o.shadowOffsetX=o.shadowOffsetY=0},_isOutSideCanvas:function(o){return o.x<0||o.x>this.canvas.getWidth()||o.y<0||o.y>this.canvas.getHeight()}}),v.PencilBrush=v.util.createClass(v.BaseBrush,{decimate:.4,drawStraightLine:!1,straightLineKey:"shiftKey",initialize:function(o){this.canvas=o,this._points=[]},needsFullRender:function(){return this.callSuper("needsFullRender")||this._hasStraightLine},_drawSegment:function(o,r,a){var l=r.midPointFrom(a);return o.quadraticCurveTo(r.x,r.y,l.x,l.y),l},onMouseDown:function(o,r){this.canvas._isMainEvent(r.e)&&(this.drawStraightLine=r.e[this.straightLineKey],this._prepareForDrawing(o),this._captureDrawingPath(o),this._render())},onMouseMove:function(o,r){if(this.canvas._isMainEvent(r.e)&&(this.drawStraightLine=r.e[this.straightLineKey],(this.limitedToCanvasSize!==!0||!this._isOutSideCanvas(o))&&this._captureDrawingPath(o)&&this._points.length>1))if(this.needsFullRender())this.canvas.clearContext(this.canvas.contextTop),this._render();else{var a=this._points,l=a.length,t=this.canvas.contextTop;this._saveAndTransform(t),this.oldEnd&&(t.beginPath(),t.moveTo(this.oldEnd.x,this.oldEnd.y)),this.oldEnd=this._drawSegment(t,a[l-2],a[l-1],!0),t.stroke(),t.restore()}},onMouseUp:function(o){return!this.canvas._isMainEvent(o.e)||(this.drawStraightLine=!1,this.oldEnd=void 0,this._finalizeAndAddPath(),!1)},_prepareForDrawing:function(o){var r=new v.Point(o.x,o.y);this._reset(),this._addPoint(r),this.canvas.contextTop.moveTo(r.x,r.y)},_addPoint:function(o){return!(this._points.length>1&&o.eq(this._points[this._points.length-1])||(this.drawStraightLine&&this._points.length>1&&(this._hasStraightLine=!0,this._points.pop()),this._points.push(o),0))},_reset:function(){this._points=[],this._setBrushStyles(this.canvas.contextTop),this._setShadow(),this._hasStraightLine=!1},_captureDrawingPath:function(o){var r=new v.Point(o.x,o.y);return this._addPoint(r)},_render:function(o){var r,a,l=this._points[0],t=this._points[1];if(o=o||this.canvas.contextTop,this._saveAndTransform(o),o.beginPath(),this._points.length===2&&l.x===t.x&&l.y===t.y){var n=this.width/1e3;l=new v.Point(l.x,l.y),t=new v.Point(t.x,t.y),l.x-=n,t.x+=n}for(o.moveTo(l.x,l.y),r=1,a=this._points.length;r<a;r++)this._drawSegment(o,l,t),l=this._points[r],t=this._points[r+1];o.lineTo(l.x,l.y),o.stroke(),o.restore()},convertPointsToSVGPath:function(o){var r=this.width/1e3;return v.util.getSmoothPathFromPoints(o,r)},_isEmptySVGPath:function(o){return v.util.joinPath(o)==="M 0 0 Q 0 0 0 0 L 0 0"},createPath:function(o){var r=new v.Path(o,{fill:null,stroke:this.color,strokeWidth:this.width,strokeLineCap:this.strokeLineCap,strokeMiterLimit:this.strokeMiterLimit,strokeLineJoin:this.strokeLineJoin,strokeDashArray:this.strokeDashArray});return this.shadow&&(this.shadow.affectStroke=!0,r.shadow=new v.Shadow(this.shadow)),r},decimatePoints:function(o,r){if(o.length<=2)return o;var a,l=this.canvas.getZoom(),t=Math.pow(r/l,2),n=o.length-1,c=o[0],d=[c];for(a=1;a<n-1;a++)Math.pow(c.x-o[a].x,2)+Math.pow(c.y-o[a].y,2)>=t&&(c=o[a],d.push(c));return d.push(o[n]),d},_finalizeAndAddPath:function(){this.canvas.contextTop.closePath(),this.decimate&&(this._points=this.decimatePoints(this._points,this.decimate));var o=this.convertPointsToSVGPath(this._points);if(this._isEmptySVGPath(o))this.canvas.requestRenderAll();else{var r=this.createPath(o);this.canvas.clearContext(this.canvas.contextTop),this.canvas.fire("before:path:created",{path:r}),this.canvas.add(r),this.canvas.requestRenderAll(),r.setCoords(),this._resetShadow(),this.canvas.fire("path:created",{path:r})}}}),v.CircleBrush=v.util.createClass(v.BaseBrush,{width:10,initialize:function(o){this.canvas=o,this.points=[]},drawDot:function(o){var r=this.addPoint(o),a=this.canvas.contextTop;this._saveAndTransform(a),this.dot(a,r),a.restore()},dot:function(o,r){o.fillStyle=r.fill,o.beginPath(),o.arc(r.x,r.y,r.radius,0,2*Math.PI,!1),o.closePath(),o.fill()},onMouseDown:function(o){this.points.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.drawDot(o)},_render:function(){var o,r,a=this.canvas.contextTop,l=this.points;for(this._saveAndTransform(a),o=0,r=l.length;o<r;o++)this.dot(a,l[o]);a.restore()},onMouseMove:function(o){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(o)||(this.needsFullRender()?(this.canvas.clearContext(this.canvas.contextTop),this.addPoint(o),this._render()):this.drawDot(o))},onMouseUp:function(){var o,r,a=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;var l=[];for(o=0,r=this.points.length;o<r;o++){var t=this.points[o],n=new v.Circle({radius:t.radius,left:t.x,top:t.y,originX:"center",originY:"center",fill:t.fill});this.shadow&&(n.shadow=new v.Shadow(this.shadow)),l.push(n)}var c=new v.Group(l);c.canvas=this.canvas,this.canvas.fire("before:path:created",{path:c}),this.canvas.add(c),this.canvas.fire("path:created",{path:c}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=a,this.canvas.requestRenderAll()},addPoint:function(o){var r=new v.Point(o.x,o.y),a=v.util.getRandomInt(Math.max(0,this.width-20),this.width+20)/2,l=new v.Color(this.color).setAlpha(v.util.getRandomInt(0,100)/100).toRgba();return r.radius=a,r.fill=l,this.points.push(r),r}}),v.SprayBrush=v.util.createClass(v.BaseBrush,{width:10,density:20,dotWidth:1,dotWidthVariance:1,randomOpacity:!1,optimizeOverlapping:!0,initialize:function(o){this.canvas=o,this.sprayChunks=[]},onMouseDown:function(o){this.sprayChunks.length=0,this.canvas.clearContext(this.canvas.contextTop),this._setShadow(),this.addSprayChunk(o),this.render(this.sprayChunkPoints)},onMouseMove:function(o){this.limitedToCanvasSize===!0&&this._isOutSideCanvas(o)||(this.addSprayChunk(o),this.render(this.sprayChunkPoints))},onMouseUp:function(){var o=this.canvas.renderOnAddRemove;this.canvas.renderOnAddRemove=!1;for(var r=[],a=0,l=this.sprayChunks.length;a<l;a++)for(var t=this.sprayChunks[a],n=0,c=t.length;n<c;n++){var d=new v.Rect({width:t[n].width,height:t[n].width,left:t[n].x+1,top:t[n].y+1,originX:"center",originY:"center",fill:this.color});r.push(d)}this.optimizeOverlapping&&(r=this._getOptimizedRects(r));var h=new v.Group(r);this.shadow&&h.set("shadow",new v.Shadow(this.shadow)),this.canvas.fire("before:path:created",{path:h}),this.canvas.add(h),this.canvas.fire("path:created",{path:h}),this.canvas.clearContext(this.canvas.contextTop),this._resetShadow(),this.canvas.renderOnAddRemove=o,this.canvas.requestRenderAll()},_getOptimizedRects:function(o){var r,a,l,t={};for(a=0,l=o.length;a<l;a++)t[r=o[a].left+""+o[a].top]||(t[r]=o[a]);var n=[];for(r in t)n.push(t[r]);return n},render:function(o){var r,a,l=this.canvas.contextTop;for(l.fillStyle=this.color,this._saveAndTransform(l),r=0,a=o.length;r<a;r++){var t=o[r];t.opacity!==void 0&&(l.globalAlpha=t.opacity),l.fillRect(t.x,t.y,t.width,t.width)}l.restore()},_render:function(){var o,r,a=this.canvas.contextTop;for(a.fillStyle=this.color,this._saveAndTransform(a),o=0,r=this.sprayChunks.length;o<r;o++)this.render(this.sprayChunks[o]);a.restore()},addSprayChunk:function(o){this.sprayChunkPoints=[];var r,a,l,t,n=this.width/2;for(t=0;t<this.density;t++){r=v.util.getRandomInt(o.x-n,o.x+n),a=v.util.getRandomInt(o.y-n,o.y+n),l=this.dotWidthVariance?v.util.getRandomInt(Math.max(1,this.dotWidth-this.dotWidthVariance),this.dotWidth+this.dotWidthVariance):this.dotWidth;var c=new v.Point(r,a);c.width=l,this.randomOpacity&&(c.opacity=v.util.getRandomInt(0,100)/100),this.sprayChunkPoints.push(c)}this.sprayChunks.push(this.sprayChunkPoints)}}),v.PatternBrush=v.util.createClass(v.PencilBrush,{getPatternSrc:function(){var o=v.util.createCanvasElement(),r=o.getContext("2d");return o.width=o.height=25,r.fillStyle=this.color,r.beginPath(),r.arc(10,10,10,0,2*Math.PI,!1),r.closePath(),r.fill(),o},getPatternSrcFunction:function(){return String(this.getPatternSrc).replace("this.color",'"'+this.color+'"')},getPattern:function(o){return o.createPattern(this.source||this.getPatternSrc(),"repeat")},_setBrushStyles:function(o){this.callSuper("_setBrushStyles",o),o.strokeStyle=this.getPattern(o)},createPath:function(o){var r=this.callSuper("createPath",o),a=r._getLeftTopCoords().scalarAdd(r.strokeWidth/2);return r.stroke=new v.Pattern({source:this.source||this.getPatternSrcFunction(),offsetX:-a.x,offsetY:-a.y}),r}}),function(){var o=v.util.getPointer,r=v.util.degreesToRadians,a=v.util.isTouchEvent;for(var l in v.Canvas=v.util.createClass(v.StaticCanvas,{initialize:function(t,n){n||(n={}),this.renderAndResetBound=this.renderAndReset.bind(this),this.requestRenderAllBound=this.requestRenderAll.bind(this),this._initStatic(t,n),this._initInteractive(),this._createCacheCanvas()},uniformScaling:!0,uniScaleKey:"shiftKey",centeredScaling:!1,centeredRotation:!1,centeredKey:"altKey",altActionKey:"shiftKey",interactive:!0,selection:!0,selectionKey:"shiftKey",altSelectionKey:null,selectionColor:"rgba(100, 100, 255, 0.3)",selectionDashArray:[],selectionBorderColor:"rgba(255, 255, 255, 0.3)",selectionLineWidth:1,selectionFullyContained:!1,hoverCursor:"move",moveCursor:"move",defaultCursor:"default",freeDrawingCursor:"crosshair",notAllowedCursor:"not-allowed",containerClass:"canvas-container",perPixelTargetFind:!1,targetFindTolerance:0,skipTargetFind:!1,isDrawingMode:!1,preserveObjectStacking:!1,snapAngle:0,snapThreshold:null,stopContextMenu:!1,fireRightClick:!1,fireMiddleClick:!1,targets:[],enablePointerEvents:!1,_hoveredTarget:null,_hoveredTargets:[],_initInteractive:function(){this._currentTransform=null,this._groupSelector=null,this._initWrapperElement(),this._createUpperCanvas(),this._initEventListeners(),this._initRetinaScaling(),this.freeDrawingBrush=v.PencilBrush&&new v.PencilBrush(this),this.calcOffset()},_chooseObjectsToRender:function(){var t,n,c,d=this.getActiveObjects();if(d.length>0&&!this.preserveObjectStacking){n=[],c=[];for(var h=0,u=this._objects.length;h<u;h++)t=this._objects[h],d.indexOf(t)===-1?n.push(t):c.push(t);d.length>1&&(this._activeObject._objects=c),n.push.apply(n,c)}else n=this._objects;return n},renderAll:function(){!this.contextTopDirty||this._groupSelector||this.isDrawingMode||(this.clearContext(this.contextTop),this.contextTopDirty=!1),this.hasLostContext&&(this.renderTopLayer(this.contextTop),this.hasLostContext=!1);var t=this.contextContainer;return this.renderCanvas(t,this._chooseObjectsToRender()),this},renderTopLayer:function(t){t.save(),this.isDrawingMode&&this._isCurrentlyDrawing&&(this.freeDrawingBrush&&this.freeDrawingBrush._render(),this.contextTopDirty=!0),this.selection&&this._groupSelector&&(this._drawSelection(t),this.contextTopDirty=!0),t.restore()},renderTop:function(){var t=this.contextTop;return this.clearContext(t),this.renderTopLayer(t),this.fire("after:render"),this},_normalizePointer:function(t,n){var c=t.calcTransformMatrix(),d=v.util.invertTransform(c),h=this.restorePointerVpt(n);return v.util.transformPoint(h,d)},isTargetTransparent:function(t,n,c){if(t.shouldCache()&&t._cacheCanvas&&t!==this._activeObject){var d=this._normalizePointer(t,{x:n,y:c}),h=Math.max(t.cacheTranslationX+d.x*t.zoomX,0),u=Math.max(t.cacheTranslationY+d.y*t.zoomY,0);return v.util.isTransparent(t._cacheContext,Math.round(h),Math.round(u),this.targetFindTolerance)}var _=this.contextCache,y=t.selectionBackgroundColor,C=this.viewportTransform;return t.selectionBackgroundColor="",this.clearContext(_),_.save(),_.transform(C[0],C[1],C[2],C[3],C[4],C[5]),t.render(_),_.restore(),t.selectionBackgroundColor=y,v.util.isTransparent(_,n,c,this.targetFindTolerance)},_isSelectionKeyPressed:function(t){return Array.isArray(this.selectionKey)?!!this.selectionKey.find(function(n){return t[n]===!0}):t[this.selectionKey]},_shouldClearSelection:function(t,n){var c=this.getActiveObjects(),d=this._activeObject;return!n||n&&d&&c.length>1&&c.indexOf(n)===-1&&d!==n&&!this._isSelectionKeyPressed(t)||n&&!n.evented||n&&!n.selectable&&d&&d!==n},_shouldCenterTransform:function(t,n,c){var d;if(t)return n==="scale"||n==="scaleX"||n==="scaleY"||n==="resizing"?d=this.centeredScaling||t.centeredScaling:n==="rotate"&&(d=this.centeredRotation||t.centeredRotation),d?!c:c},_getOriginFromCorner:function(t,n){var c={x:t.originX,y:t.originY};return n==="ml"||n==="tl"||n==="bl"?c.x="right":n!=="mr"&&n!=="tr"&&n!=="br"||(c.x="left"),n==="tl"||n==="mt"||n==="tr"?c.y="bottom":n!=="bl"&&n!=="mb"&&n!=="br"||(c.y="top"),c},_getActionFromCorner:function(t,n,c,d){if(!n||!t)return"drag";var h=d.controls[n];return h.getActionName(c,h,d)},_setupCurrentTransform:function(t,n,c){if(n){var d=this.getPointer(t),h=n.__corner,u=n.controls[h],_=c&&h?u.getActionHandler(t,n,u):v.controlsUtils.dragHandler,y=this._getActionFromCorner(c,h,t,n),C=this._getOriginFromCorner(n,h),x=t[this.centeredKey],S={target:n,action:y,actionHandler:_,corner:h,scaleX:n.scaleX,scaleY:n.scaleY,skewX:n.skewX,skewY:n.skewY,offsetX:d.x-n.left,offsetY:d.y-n.top,originX:C.x,originY:C.y,ex:d.x,ey:d.y,lastX:d.x,lastY:d.y,theta:r(n.angle),width:n.width*n.scaleX,shiftKey:t.shiftKey,altKey:x,original:v.util.saveObjectTransform(n)};this._shouldCenterTransform(n,y,x)&&(S.originX="center",S.originY="center"),S.original.originX=C.x,S.original.originY=C.y,this._currentTransform=S,this._beforeTransform(t)}},setCursor:function(t){this.upperCanvasEl.style.cursor=t},_drawSelection:function(t){var n=this._groupSelector,c=new v.Point(n.ex,n.ey),d=v.util.transformPoint(c,this.viewportTransform),h=new v.Point(n.ex+n.left,n.ey+n.top),u=v.util.transformPoint(h,this.viewportTransform),_=Math.min(d.x,u.x),y=Math.min(d.y,u.y),C=Math.max(d.x,u.x),x=Math.max(d.y,u.y),S=this.selectionLineWidth/2;this.selectionColor&&(t.fillStyle=this.selectionColor,t.fillRect(_,y,C-_,x-y)),this.selectionLineWidth&&this.selectionBorderColor&&(t.lineWidth=this.selectionLineWidth,t.strokeStyle=this.selectionBorderColor,_+=S,y+=S,C-=S,x-=S,v.Object.prototype._setLineDash.call(this,t,this.selectionDashArray),t.strokeRect(_,y,C-_,x-y))},findTarget:function(t,n){if(!this.skipTargetFind){var c,d,h=this.getPointer(t,!0),u=this._activeObject,_=this.getActiveObjects(),y=a(t),C=_.length>1&&!n||_.length===1;if(this.targets=[],C&&u._findTargetCorner(h,y)||_.length>1&&!n&&u===this._searchPossibleTargets([u],h))return u;if(_.length===1&&u===this._searchPossibleTargets([u],h)){if(!this.preserveObjectStacking)return u;c=u,d=this.targets,this.targets=[]}var x=this._searchPossibleTargets(this._objects,h);return t[this.altSelectionKey]&&x&&c&&x!==c&&(x=c,this.targets=d),x}},_checkTarget:function(t,n,c){if(n&&n.visible&&n.evented&&n.containsPoint(t)&&(!this.perPixelTargetFind&&!n.perPixelTargetFind||n.isEditing||!this.isTargetTransparent(n,c.x,c.y)))return!0},_searchPossibleTargets:function(t,n){for(var c,d,h=t.length;h--;){var u=t[h],_=u.group?this._normalizePointer(u.group,n):n;if(this._checkTarget(_,u,n)){(c=t[h]).subTargetCheck&&c instanceof v.Group&&(d=this._searchPossibleTargets(c._objects,n))&&this.targets.push(d);break}}return c},restorePointerVpt:function(t){return v.util.transformPoint(t,v.util.invertTransform(this.viewportTransform))},getPointer:function(t,n){if(this._absolutePointer&&!n)return this._absolutePointer;if(this._pointer&&n)return this._pointer;var c,d=o(t),h=this.upperCanvasEl,u=h.getBoundingClientRect(),_=u.width||0,y=u.height||0;_&&y||("top"in u&&"bottom"in u&&(y=Math.abs(u.top-u.bottom)),"right"in u&&"left"in u&&(_=Math.abs(u.right-u.left))),this.calcOffset(),d.x=d.x-this._offset.left,d.y=d.y-this._offset.top,n||(d=this.restorePointerVpt(d));var C=this.getRetinaScaling();return C!==1&&(d.x/=C,d.y/=C),c=_===0||y===0?{width:1,height:1}:{width:h.width/_,height:h.height/y},{x:d.x*c.width,y:d.y*c.height}},_createUpperCanvas:function(){var t=this.lowerCanvasEl.className.replace(/\s*lower-canvas\s*/,""),n=this.lowerCanvasEl,c=this.upperCanvasEl;c?c.className="":(c=this._createCanvasElement(),this.upperCanvasEl=c),v.util.addClass(c,"upper-canvas "+t),this.wrapperEl.appendChild(c),this._copyCanvasStyle(n,c),this._applyCanvasStyle(c),this.contextTop=c.getContext("2d")},getTopContext:function(){return this.contextTop},_createCacheCanvas:function(){this.cacheCanvasEl=this._createCanvasElement(),this.cacheCanvasEl.setAttribute("width",this.width),this.cacheCanvasEl.setAttribute("height",this.height),this.contextCache=this.cacheCanvasEl.getContext("2d")},_initWrapperElement:function(){this.wrapperEl=v.util.wrapElement(this.lowerCanvasEl,"div",{class:this.containerClass}),v.util.setStyle(this.wrapperEl,{width:this.width+"px",height:this.height+"px",position:"relative"}),v.util.makeElementUnselectable(this.wrapperEl)},_applyCanvasStyle:function(t){var n=this.width||t.width,c=this.height||t.height;v.util.setStyle(t,{position:"absolute",width:n+"px",height:c+"px",left:0,top:0,"touch-action":this.allowTouchScrolling?"manipulation":"none","-ms-touch-action":this.allowTouchScrolling?"manipulation":"none"}),t.width=n,t.height=c,v.util.makeElementUnselectable(t)},_copyCanvasStyle:function(t,n){n.style.cssText=t.style.cssText},getSelectionContext:function(){return this.contextTop},getSelectionElement:function(){return this.upperCanvasEl},getActiveObject:function(){return this._activeObject},getActiveObjects:function(){var t=this._activeObject;return t?t.type==="activeSelection"&&t._objects?t._objects.slice(0):[t]:[]},_onObjectRemoved:function(t){t===this._activeObject&&(this.fire("before:selection:cleared",{target:t}),this._discardActiveObject(),this.fire("selection:cleared",{target:t}),t.fire("deselected")),t===this._hoveredTarget&&(this._hoveredTarget=null,this._hoveredTargets=[]),this.callSuper("_onObjectRemoved",t)},_fireSelectionEvents:function(t,n){var c=!1,d=this.getActiveObjects(),h=[],u=[];t.forEach(function(_){d.indexOf(_)===-1&&(c=!0,_.fire("deselected",{e:n,target:_}),u.push(_))}),d.forEach(function(_){t.indexOf(_)===-1&&(c=!0,_.fire("selected",{e:n,target:_}),h.push(_))}),t.length>0&&d.length>0?c&&this.fire("selection:updated",{e:n,selected:h,deselected:u}):d.length>0?this.fire("selection:created",{e:n,selected:h}):t.length>0&&this.fire("selection:cleared",{e:n,deselected:u})},setActiveObject:function(t,n){var c=this.getActiveObjects();return this._setActiveObject(t,n),this._fireSelectionEvents(c,n),this},_setActiveObject:function(t,n){return this._activeObject!==t&&!!this._discardActiveObject(n,t)&&!t.onSelect({e:n})&&(this._activeObject=t,!0)},_discardActiveObject:function(t,n){var c=this._activeObject;if(c){if(c.onDeselect({e:t,object:n}))return!1;this._activeObject=null}return!0},discardActiveObject:function(t){var n=this.getActiveObjects(),c=this.getActiveObject();return n.length&&this.fire("before:selection:cleared",{target:c,e:t}),this._discardActiveObject(t),this._fireSelectionEvents(n,t),this},dispose:function(){var t=this.wrapperEl;return this.removeListeners(),t.removeChild(this.upperCanvasEl),t.removeChild(this.lowerCanvasEl),this.contextCache=null,this.contextTop=null,["upperCanvasEl","cacheCanvasEl"].forEach(function(n){v.util.cleanUpJsdomNode(this[n]),this[n]=void 0}.bind(this)),t.parentNode&&t.parentNode.replaceChild(this.lowerCanvasEl,this.wrapperEl),delete this.wrapperEl,v.StaticCanvas.prototype.dispose.call(this),this},clear:function(){return this.discardActiveObject(),this.clearContext(this.contextTop),this.callSuper("clear")},drawControls:function(t){var n=this._activeObject;n&&n._renderControls(t)},_toObject:function(t,n,c){var d=this._realizeGroupTransformOnObject(t),h=this.callSuper("_toObject",t,n,c);return this._unwindGroupTransformOnObject(t,d),h},_realizeGroupTransformOnObject:function(t){if(t.group&&t.group.type==="activeSelection"&&this._activeObject===t.group){var n={};return["angle","flipX","flipY","left","scaleX","scaleY","skewX","skewY","top"].forEach(function(c){n[c]=t[c]}),v.util.addTransformToObject(t,this._activeObject.calcOwnMatrix()),n}return null},_unwindGroupTransformOnObject:function(t,n){n&&t.set(n)},_setSVGObject:function(t,n,c){var d=this._realizeGroupTransformOnObject(n);this.callSuper("_setSVGObject",t,n,c),this._unwindGroupTransformOnObject(n,d)},setViewportTransform:function(t){this.renderOnAddRemove&&this._activeObject&&this._activeObject.isEditing&&this._activeObject.clearContextTop(),v.StaticCanvas.prototype.setViewportTransform.call(this,t)}}),v.StaticCanvas)l!=="prototype"&&(v.Canvas[l]=v.StaticCanvas[l])}(),function(){var o=v.util.addListener,r=v.util.removeListener,a={passive:!1};function l(t,n){return t.button&&t.button===n-1}v.util.object.extend(v.Canvas.prototype,{mainTouchId:null,_initEventListeners:function(){this.removeListeners(),this._bindEvents(),this.addOrRemove(o,"add")},_getEventPrefix:function(){return this.enablePointerEvents?"pointer":"mouse"},addOrRemove:function(t,n){var c=this.upperCanvasEl,d=this._getEventPrefix();t(v.window,"resize",this._onResize),t(c,d+"down",this._onMouseDown),t(c,d+"move",this._onMouseMove,a),t(c,d+"out",this._onMouseOut),t(c,d+"enter",this._onMouseEnter),t(c,"wheel",this._onMouseWheel),t(c,"contextmenu",this._onContextMenu),t(c,"dblclick",this._onDoubleClick),t(c,"dragover",this._onDragOver),t(c,"dragenter",this._onDragEnter),t(c,"dragleave",this._onDragLeave),t(c,"drop",this._onDrop),this.enablePointerEvents||t(c,"touchstart",this._onTouchStart,a),typeof eventjs<"u"&&n in eventjs&&(eventjs[n](c,"gesture",this._onGesture),eventjs[n](c,"drag",this._onDrag),eventjs[n](c,"orientation",this._onOrientationChange),eventjs[n](c,"shake",this._onShake),eventjs[n](c,"longpress",this._onLongPress))},removeListeners:function(){this.addOrRemove(r,"remove");var t=this._getEventPrefix();r(v.document,t+"up",this._onMouseUp),r(v.document,"touchend",this._onTouchEnd,a),r(v.document,t+"move",this._onMouseMove,a),r(v.document,"touchmove",this._onMouseMove,a)},_bindEvents:function(){this.eventsBound||(this._onMouseDown=this._onMouseDown.bind(this),this._onTouchStart=this._onTouchStart.bind(this),this._onMouseMove=this._onMouseMove.bind(this),this._onMouseUp=this._onMouseUp.bind(this),this._onTouchEnd=this._onTouchEnd.bind(this),this._onResize=this._onResize.bind(this),this._onGesture=this._onGesture.bind(this),this._onDrag=this._onDrag.bind(this),this._onShake=this._onShake.bind(this),this._onLongPress=this._onLongPress.bind(this),this._onOrientationChange=this._onOrientationChange.bind(this),this._onMouseWheel=this._onMouseWheel.bind(this),this._onMouseOut=this._onMouseOut.bind(this),this._onMouseEnter=this._onMouseEnter.bind(this),this._onContextMenu=this._onContextMenu.bind(this),this._onDoubleClick=this._onDoubleClick.bind(this),this._onDragOver=this._onDragOver.bind(this),this._onDragEnter=this._simpleEventHandler.bind(this,"dragenter"),this._onDragLeave=this._simpleEventHandler.bind(this,"dragleave"),this._onDrop=this._onDrop.bind(this),this.eventsBound=!0)},_onGesture:function(t,n){this.__onTransformGesture&&this.__onTransformGesture(t,n)},_onDrag:function(t,n){this.__onDrag&&this.__onDrag(t,n)},_onMouseWheel:function(t){this.__onMouseWheel(t)},_onMouseOut:function(t){var n=this._hoveredTarget;this.fire("mouse:out",{target:n,e:t}),this._hoveredTarget=null,n&&n.fire("mouseout",{e:t});var c=this;this._hoveredTargets.forEach(function(d){c.fire("mouse:out",{target:n,e:t}),d&&n.fire("mouseout",{e:t})}),this._hoveredTargets=[],this._iTextInstances&&this._iTextInstances.forEach(function(d){d.isEditing&&d.hiddenTextarea.focus()})},_onMouseEnter:function(t){this._currentTransform||this.findTarget(t)||(this.fire("mouse:over",{target:null,e:t}),this._hoveredTarget=null,this._hoveredTargets=[])},_onOrientationChange:function(t,n){this.__onOrientationChange&&this.__onOrientationChange(t,n)},_onShake:function(t,n){this.__onShake&&this.__onShake(t,n)},_onLongPress:function(t,n){this.__onLongPress&&this.__onLongPress(t,n)},_onDragOver:function(t){t.preventDefault();var n=this._simpleEventHandler("dragover",t);this._fireEnterLeaveEvents(n,t)},_onDrop:function(t){return this._simpleEventHandler("drop:before",t),this._simpleEventHandler("drop",t)},_onContextMenu:function(t){return this.stopContextMenu&&(t.stopPropagation(),t.preventDefault()),!1},_onDoubleClick:function(t){this._cacheTransformEventData(t),this._handleEvent(t,"dblclick"),this._resetTransformEventData(t)},getPointerId:function(t){var n=t.changedTouches;return n?n[0]&&n[0].identifier:this.enablePointerEvents?t.pointerId:-1},_isMainEvent:function(t){return t.isPrimary===!0||t.isPrimary!==!1&&(t.type==="touchend"&&t.touches.length===0||!t.changedTouches||t.changedTouches[0].identifier===this.mainTouchId)},_onTouchStart:function(t){t.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(t)),this.__onMouseDown(t),this._resetTransformEventData();var n=this.upperCanvasEl,c=this._getEventPrefix();o(v.document,"touchend",this._onTouchEnd,a),o(v.document,"touchmove",this._onMouseMove,a),r(n,c+"down",this._onMouseDown)},_onMouseDown:function(t){this.__onMouseDown(t),this._resetTransformEventData();var n=this.upperCanvasEl,c=this._getEventPrefix();r(n,c+"move",this._onMouseMove,a),o(v.document,c+"up",this._onMouseUp),o(v.document,c+"move",this._onMouseMove,a)},_onTouchEnd:function(t){if(!(t.touches.length>0)){this.__onMouseUp(t),this._resetTransformEventData(),this.mainTouchId=null;var n=this._getEventPrefix();r(v.document,"touchend",this._onTouchEnd,a),r(v.document,"touchmove",this._onMouseMove,a);var c=this;this._willAddMouseDown&&clearTimeout(this._willAddMouseDown),this._willAddMouseDown=setTimeout(function(){o(c.upperCanvasEl,n+"down",c._onMouseDown),c._willAddMouseDown=0},400)}},_onMouseUp:function(t){this.__onMouseUp(t),this._resetTransformEventData();var n=this.upperCanvasEl,c=this._getEventPrefix();this._isMainEvent(t)&&(r(v.document,c+"up",this._onMouseUp),r(v.document,c+"move",this._onMouseMove,a),o(n,c+"move",this._onMouseMove,a))},_onMouseMove:function(t){!this.allowTouchScrolling&&t.preventDefault&&t.preventDefault(),this.__onMouseMove(t)},_onResize:function(){this.calcOffset()},_shouldRender:function(t){var n=this._activeObject;return!!(!!n!=!!t||n&&t&&n!==t)||(n&&n.isEditing,!1)},__onMouseUp:function(t){var n,c=this._currentTransform,d=this._groupSelector,h=!1,u=!d||d.left===0&&d.top===0;if(this._cacheTransformEventData(t),n=this._target,this._handleEvent(t,"up:before"),l(t,3))this.fireRightClick&&this._handleEvent(t,"up",3,u);else{if(l(t,2))return this.fireMiddleClick&&this._handleEvent(t,"up",2,u),void this._resetTransformEventData();if(this.isDrawingMode&&this._isCurrentlyDrawing)this._onMouseUpInDrawingMode(t);else if(this._isMainEvent(t)){if(c&&(this._finalizeCurrentTransform(t),h=c.actionPerformed),!u){var _=n===this._activeObject;this._maybeGroupObjects(t),h||(h=this._shouldRender(n)||!_&&n===this._activeObject)}var y,C;if(n){if(y=n._findTargetCorner(this.getPointer(t,!0),v.util.isTouchEvent(t)),n.selectable&&n!==this._activeObject&&n.activeOn==="up")this.setActiveObject(n,t),h=!0;else{var x=n.controls[y],S=x&&x.getMouseUpHandler(t,n,x);S&&S(t,c,(C=this.getPointer(t)).x,C.y)}n.isMoving=!1}if(c&&(c.target!==n||c.corner!==y)){var w=c.target&&c.target.controls[c.corner],E=w&&w.getMouseUpHandler(t,n,x);C=C||this.getPointer(t),E&&E(t,c,C.x,C.y)}this._setCursorFromEvent(t,n),this._handleEvent(t,"up",1,u),this._groupSelector=null,this._currentTransform=null,n&&(n.__corner=0),h?this.requestRenderAll():u||this.renderTop()}}},_simpleEventHandler:function(t,n){var c=this.findTarget(n),d=this.targets,h={e:n,target:c,subTargets:d};if(this.fire(t,h),c&&c.fire(t,h),!d)return c;for(var u=0;u<d.length;u++)d[u].fire(t,h);return c},_handleEvent:function(t,n,c,d){var h=this._target,u=this.targets||[],_={e:t,target:h,subTargets:u,button:c||1,isClick:d||!1,pointer:this._pointer,absolutePointer:this._absolutePointer,transform:this._currentTransform};n==="up"&&(_.currentTarget=this.findTarget(t),_.currentSubTargets=this.targets),this.fire("mouse:"+n,_),h&&h.fire("mouse"+n,_);for(var y=0;y<u.length;y++)u[y].fire("mouse"+n,_)},_finalizeCurrentTransform:function(t){var n=this._currentTransform,c=n.target,d={e:t,target:c,transform:n,action:n.action};c._scaling&&(c._scaling=!1),c.setCoords(),(n.actionPerformed||this.stateful&&c.hasStateChanged())&&this._fire("modified",d)},_onMouseDownInDrawingMode:function(t){this._isCurrentlyDrawing=!0,this.getActiveObject()&&this.discardActiveObject(t).requestRenderAll();var n=this.getPointer(t);this.freeDrawingBrush.onMouseDown(n,{e:t,pointer:n}),this._handleEvent(t,"down")},_onMouseMoveInDrawingMode:function(t){if(this._isCurrentlyDrawing){var n=this.getPointer(t);this.freeDrawingBrush.onMouseMove(n,{e:t,pointer:n})}this.setCursor(this.freeDrawingCursor),this._handleEvent(t,"move")},_onMouseUpInDrawingMode:function(t){var n=this.getPointer(t);this._isCurrentlyDrawing=this.freeDrawingBrush.onMouseUp({e:t,pointer:n}),this._handleEvent(t,"up")},__onMouseDown:function(t){this._cacheTransformEventData(t),this._handleEvent(t,"down:before");var n=this._target;if(l(t,3))this.fireRightClick&&this._handleEvent(t,"down",3);else if(l(t,2))this.fireMiddleClick&&this._handleEvent(t,"down",2);else if(this.isDrawingMode)this._onMouseDownInDrawingMode(t);else if(this._isMainEvent(t)&&!this._currentTransform){var c=this._pointer;this._previousPointer=c;var d=this._shouldRender(n),h=this._shouldGroup(t,n);if(this._shouldClearSelection(t,n)?this.discardActiveObject(t):h&&(this._handleGrouping(t,n),n=this._activeObject),!this.selection||n&&(n.selectable||n.isEditing||n===this._activeObject)||(this._groupSelector={ex:this._absolutePointer.x,ey:this._absolutePointer.y,top:0,left:0}),n){var u=n===this._activeObject;n.selectable&&n.activeOn==="down"&&this.setActiveObject(n,t);var _=n._findTargetCorner(this.getPointer(t,!0),v.util.isTouchEvent(t));if(n.__corner=_,n===this._activeObject&&(_||!h)){this._setupCurrentTransform(t,n,u);var y=n.controls[_],C=(c=this.getPointer(t),y&&y.getMouseDownHandler(t,n,y));C&&C(t,this._currentTransform,c.x,c.y)}}this._handleEvent(t,"down"),(d||h)&&this.requestRenderAll()}},_resetTransformEventData:function(){this._target=null,this._pointer=null,this._absolutePointer=null},_cacheTransformEventData:function(t){this._resetTransformEventData(),this._pointer=this.getPointer(t,!0),this._absolutePointer=this.restorePointerVpt(this._pointer),this._target=this._currentTransform?this._currentTransform.target:this.findTarget(t)||null},_beforeTransform:function(t){var n=this._currentTransform;this.stateful&&n.target.saveState(),this.fire("before:transform",{e:t,transform:n})},__onMouseMove:function(t){var n,c;if(this._handleEvent(t,"move:before"),this._cacheTransformEventData(t),this.isDrawingMode)this._onMouseMoveInDrawingMode(t);else if(this._isMainEvent(t)){var d=this._groupSelector;d?(c=this._absolutePointer,d.left=c.x-d.ex,d.top=c.y-d.ey,this.renderTop()):this._currentTransform?this._transformObject(t):(n=this.findTarget(t)||null,this._setCursorFromEvent(t,n),this._fireOverOutEvents(n,t)),this._handleEvent(t,"move"),this._resetTransformEventData()}},_fireOverOutEvents:function(t,n){var c=this._hoveredTarget,d=this._hoveredTargets,h=this.targets,u=Math.max(d.length,h.length);this.fireSyntheticInOutEvents(t,n,{oldTarget:c,evtOut:"mouseout",canvasEvtOut:"mouse:out",evtIn:"mouseover",canvasEvtIn:"mouse:over"});for(var _=0;_<u;_++)this.fireSyntheticInOutEvents(h[_],n,{oldTarget:d[_],evtOut:"mouseout",evtIn:"mouseover"});this._hoveredTarget=t,this._hoveredTargets=this.targets.concat()},_fireEnterLeaveEvents:function(t,n){var c=this._draggedoverTarget,d=this._hoveredTargets,h=this.targets,u=Math.max(d.length,h.length);this.fireSyntheticInOutEvents(t,n,{oldTarget:c,evtOut:"dragleave",evtIn:"dragenter"});for(var _=0;_<u;_++)this.fireSyntheticInOutEvents(h[_],n,{oldTarget:d[_],evtOut:"dragleave",evtIn:"dragenter"});this._draggedoverTarget=t},fireSyntheticInOutEvents:function(t,n,c){var d,h,u,_=c.oldTarget,y=_!==t,C=c.canvasEvtIn,x=c.canvasEvtOut;y&&(d={e:n,target:t,previousTarget:_},h={e:n,target:_,nextTarget:t}),u=t&&y,_&&y&&(x&&this.fire(x,h),_.fire(c.evtOut,h)),u&&(C&&this.fire(C,d),t.fire(c.evtIn,d))},__onMouseWheel:function(t){this._cacheTransformEventData(t),this._handleEvent(t,"wheel"),this._resetTransformEventData()},_transformObject:function(t){var n=this.getPointer(t),c=this._currentTransform;c.reset=!1,c.shiftKey=t.shiftKey,c.altKey=t[this.centeredKey],this._performTransformAction(t,c,n),c.actionPerformed&&this.requestRenderAll()},_performTransformAction:function(t,n,c){var d=c.x,h=c.y,u=n.action,_=!1,y=n.actionHandler;y&&(_=y(t,n,d,h)),u==="drag"&&_&&(n.target.isMoving=!0,this.setCursor(n.target.moveCursor||this.moveCursor)),n.actionPerformed=n.actionPerformed||_},_fire:v.controlsUtils.fireEvent,_setCursorFromEvent:function(t,n){if(!n)return this.setCursor(this.defaultCursor),!1;var c=n.hoverCursor||this.hoverCursor,d=this._activeObject&&this._activeObject.type==="activeSelection"?this._activeObject:null,h=(!d||!d.contains(n))&&n._findTargetCorner(this.getPointer(t,!0));h?this.setCursor(this.getCornerCursor(h,n,t)):(n.subTargetCheck&&this.targets.concat().reverse().map(function(u){c=u.hoverCursor||c}),this.setCursor(c))},getCornerCursor:function(t,n,c){var d=n.controls[t];return d.cursorStyleHandler(c,d,n)}})}(),oe=Math.min,ae=Math.max,v.util.object.extend(v.Canvas.prototype,{_shouldGroup:function(o,r){var a=this._activeObject;return a&&this._isSelectionKeyPressed(o)&&r&&r.selectable&&this.selection&&(a!==r||a.type==="activeSelection")&&!r.onSelect({e:o})},_handleGrouping:function(o,r){var a=this._activeObject;a.__corner||(r!==a||(r=this.findTarget(o,!0))&&r.selectable)&&(a&&a.type==="activeSelection"?this._updateActiveSelection(r,o):this._createActiveSelection(r,o))},_updateActiveSelection:function(o,r){var a=this._activeObject,l=a._objects.slice(0);a.contains(o)?(a.removeWithUpdate(o),this._hoveredTarget=o,this._hoveredTargets=this.targets.concat(),a.size()===1&&this._setActiveObject(a.item(0),r)):(a.addWithUpdate(o),this._hoveredTarget=a,this._hoveredTargets=this.targets.concat()),this._fireSelectionEvents(l,r)},_createActiveSelection:function(o,r){var a=this.getActiveObjects(),l=this._createGroup(o);this._hoveredTarget=l,this._setActiveObject(l,r),this._fireSelectionEvents(a,r)},_createGroup:function(o){var r=this._objects,a=r.indexOf(this._activeObject)<r.indexOf(o)?[this._activeObject,o]:[o,this._activeObject];return this._activeObject.isEditing&&this._activeObject.exitEditing(),new v.ActiveSelection(a,{canvas:this})},_groupSelectedObjects:function(o){var r,a=this._collectObjects(o);a.length===1?this.setActiveObject(a[0],o):a.length>1&&(r=new v.ActiveSelection(a.reverse(),{canvas:this}),this.setActiveObject(r,o))},_collectObjects:function(o){for(var r,a=[],l=this._groupSelector.ex,t=this._groupSelector.ey,n=l+this._groupSelector.left,c=t+this._groupSelector.top,d=new v.Point(oe(l,n),oe(t,c)),h=new v.Point(ae(l,n),ae(t,c)),u=!this.selectionFullyContained,_=l===n&&t===c,y=this._objects.length;y--&&!((r=this._objects[y])&&r.selectable&&r.visible&&(u&&r.intersectsWithRect(d,h,!0)||r.isContainedWithinRect(d,h,!0)||u&&r.containsPoint(d,null,!0)||u&&r.containsPoint(h,null,!0))&&(a.push(r),_)););return a.length>1&&(a=a.filter(function(C){return!C.onSelect({e:o})})),a},_maybeGroupObjects:function(o){this.selection&&this._groupSelector&&this._groupSelectedObjects(o),this.setCursor(this.defaultCursor),this._groupSelector=null}}),v.util.object.extend(v.StaticCanvas.prototype,{toDataURL:function(o){o||(o={});var r=o.format||"png",a=o.quality||1,l=(o.multiplier||1)*(o.enableRetinaScaling?this.getRetinaScaling():1),t=this.toCanvasElement(l,o);return v.util.toDataURL(t,r,a)},toCanvasElement:function(o,r){o=o||1;var a=((r=r||{}).width||this.width)*o,l=(r.height||this.height)*o,t=this.getZoom(),n=this.width,c=this.height,d=t*o,h=this.viewportTransform,u=(h[4]-(r.left||0))*o,_=(h[5]-(r.top||0))*o,y=this.interactive,C=[d,0,0,d,u,_],x=this.enableRetinaScaling,S=v.util.createCanvasElement(),w=this.contextTop;return S.width=a,S.height=l,this.contextTop=null,this.enableRetinaScaling=!1,this.interactive=!1,this.viewportTransform=C,this.width=a,this.height=l,this.calcViewportBoundaries(),this.renderCanvas(S.getContext("2d"),this._objects),this.viewportTransform=h,this.width=n,this.height=c,this.calcViewportBoundaries(),this.interactive=y,this.enableRetinaScaling=x,this.contextTop=w,S}}),v.util.object.extend(v.StaticCanvas.prototype,{loadFromJSON:function(o,r,a){if(o){var l=typeof o=="string"?JSON.parse(o):v.util.object.clone(o),t=this,n=l.clipPath,c=this.renderOnAddRemove;return this.renderOnAddRemove=!1,delete l.clipPath,this._enlivenObjects(l.objects,function(d){t.clear(),t._setBgOverlay(l,function(){n?t._enlivenObjects([n],function(h){t.clipPath=h[0],t.__setupCanvas.call(t,l,d,c,r)}):t.__setupCanvas.call(t,l,d,c,r)})},a),this}},__setupCanvas:function(o,r,a,l){var t=this;r.forEach(function(n,c){t.insertAt(n,c)}),this.renderOnAddRemove=a,delete o.objects,delete o.backgroundImage,delete o.overlayImage,delete o.background,delete o.overlay,this._setOptions(o),this.renderAll(),l&&l()},_setBgOverlay:function(o,r){var a={backgroundColor:!1,overlayColor:!1,backgroundImage:!1,overlayImage:!1};if(o.backgroundImage||o.overlayImage||o.background||o.overlay){var l=function(){a.backgroundImage&&a.overlayImage&&a.backgroundColor&&a.overlayColor&&r&&r()};this.__setBgOverlay("backgroundImage",o.backgroundImage,a,l),this.__setBgOverlay("overlayImage",o.overlayImage,a,l),this.__setBgOverlay("backgroundColor",o.background,a,l),this.__setBgOverlay("overlayColor",o.overlay,a,l)}else r&&r()},__setBgOverlay:function(o,r,a,l){var t=this;if(!r)return a[o]=!0,void(l&&l());o==="backgroundImage"||o==="overlayImage"?v.util.enlivenObjects([r],function(n){t[o]=n[0],a[o]=!0,l&&l()}):this["set"+v.util.string.capitalize(o,!0)](r,function(){a[o]=!0,l&&l()})},_enlivenObjects:function(o,r,a){o&&o.length!==0?v.util.enlivenObjects(o,function(l){r&&r(l)},null,a):r&&r([])},_toDataURL:function(o,r){this.clone(function(a){r(a.toDataURL(o))})},_toDataURLWithMultiplier:function(o,r,a){this.clone(function(l){a(l.toDataURLWithMultiplier(o,r))})},clone:function(o,r){var a=JSON.stringify(this.toJSON(r));this.cloneWithoutData(function(l){l.loadFromJSON(a,function(){o&&o(l)})})},cloneWithoutData:function(o){var r=v.util.createCanvasElement();r.width=this.width,r.height=this.height;var a=new v.Canvas(r);this.backgroundImage?(a.setBackgroundImage(this.backgroundImage.src,function(){a.renderAll(),o&&o(a)}),a.backgroundImageOpacity=this.backgroundImageOpacity,a.backgroundImageStretch=this.backgroundImageStretch):o&&o(a)}}),function(o){var r=o.fabric||(o.fabric={}),a=r.util.object.extend,l=r.util.object.clone,t=r.util.toFixed,n=r.util.string.capitalize,c=r.util.degreesToRadians,d=!r.isLikelyNode;r.Object||(r.Object=r.util.createClass(r.CommonMethods,{type:"object",originX:"left",originY:"top",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:!1,flipY:!1,opacity:1,angle:0,skewX:0,skewY:0,cornerSize:13,touchCornerSize:24,transparentCorners:!0,hoverCursor:null,moveCursor:null,padding:0,borderColor:"rgb(178,204,255)",borderDashArray:null,cornerColor:"rgb(178,204,255)",cornerStrokeColor:null,cornerStyle:"rect",cornerDashArray:null,centeredScaling:!1,centeredRotation:!0,fill:"rgb(0,0,0)",fillRule:"nonzero",globalCompositeOperation:"source-over",backgroundColor:"",selectionBackgroundColor:"",stroke:null,strokeWidth:1,strokeDashArray:null,strokeDashOffset:0,strokeLineCap:"butt",strokeLineJoin:"miter",strokeMiterLimit:4,shadow:null,borderOpacityWhenMoving:.4,borderScaleFactor:1,minScaleLimit:0,selectable:!0,evented:!0,visible:!0,hasControls:!0,hasBorders:!0,perPixelTargetFind:!1,includeDefaultValues:!0,lockMovementX:!1,lockMovementY:!1,lockRotation:!1,lockScalingX:!1,lockScalingY:!1,lockSkewingX:!1,lockSkewingY:!1,lockScalingFlip:!1,excludeFromExport:!1,objectCaching:d,statefullCache:!1,noScaleCache:!0,strokeUniform:!1,dirty:!0,__corner:0,paintFirst:"fill",activeOn:"down",stateProperties:"top left width height scaleX scaleY flipX flipY originX originY transformMatrix stroke strokeWidth strokeDashArray strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit angle opacity fill globalCompositeOperation shadow visible backgroundColor skewX skewY fillRule paintFirst clipPath strokeUniform".split(" "),cacheProperties:"fill stroke strokeWidth strokeDashArray width height paintFirst strokeUniform strokeLineCap strokeDashOffset strokeLineJoin strokeMiterLimit backgroundColor clipPath".split(" "),colorProperties:"fill stroke backgroundColor".split(" "),clipPath:void 0,inverted:!1,absolutePositioned:!1,initialize:function(h){h&&this.setOptions(h)},_createCacheCanvas:function(){this._cacheProperties={},this._cacheCanvas=r.util.createCanvasElement(),this._cacheContext=this._cacheCanvas.getContext("2d"),this._updateCacheCanvas(),this.dirty=!0},_limitCacheSize:function(h){var u=r.perfLimitSizeTotal,_=h.width,y=h.height,C=r.maxCacheSideLimit,x=r.minCacheSideLimit;if(_<=C&&y<=C&&_*y<=u)return _<x&&(h.width=x),y<x&&(h.height=x),h;var S=_/y,w=r.util.limitDimsByArea(S,u),E=r.util.capValue,M=E(x,w.x,C),F=E(x,w.y,C);return _>M&&(h.zoomX/=_/M,h.width=M,h.capped=!0),y>F&&(h.zoomY/=y/F,h.height=F,h.capped=!0),h},_getCacheCanvasDimensions:function(){var h=this.getTotalObjectScaling(),u=this._getTransformedDimensions(0,0),_=u.x*h.scaleX/this.scaleX,y=u.y*h.scaleY/this.scaleY;return{width:_+2,height:y+2,zoomX:h.scaleX,zoomY:h.scaleY,x:_,y}},_updateCacheCanvas:function(){var h=this.canvas;if(this.noScaleCache&&h&&h._currentTransform){var u=h._currentTransform.target,_=h._currentTransform.action;if(this===u&&_.slice&&_.slice(0,5)==="scale")return!1}var y,C,x=this._cacheCanvas,S=this._limitCacheSize(this._getCacheCanvasDimensions()),w=r.minCacheSideLimit,E=S.width,M=S.height,F=S.zoomX,H=S.zoomY,G=E!==this.cacheWidth||M!==this.cacheHeight,U=this.zoomX!==F||this.zoomY!==H,D=G||U,I=0,N=0,W=!1;if(G){var X=this._cacheCanvas.width,P=this._cacheCanvas.height,R=E>X||M>P;W=R||(E<.9*X||M<.9*P)&&X>w&&P>w,R&&!S.capped&&(E>w||M>w)&&(I=.1*E,N=.1*M)}return this instanceof r.Text&&this.path&&(D=!0,W=!0,I+=this.getHeightOfLine(0)*this.zoomX,N+=this.getHeightOfLine(0)*this.zoomY),!!D&&(W?(x.width=Math.ceil(E+I),x.height=Math.ceil(M+N)):(this._cacheContext.setTransform(1,0,0,1,0,0),this._cacheContext.clearRect(0,0,x.width,x.height)),y=S.x/2,C=S.y/2,this.cacheTranslationX=Math.round(x.width/2-y)+y,this.cacheTranslationY=Math.round(x.height/2-C)+C,this.cacheWidth=E,this.cacheHeight=M,this._cacheContext.translate(this.cacheTranslationX,this.cacheTranslationY),this._cacheContext.scale(F,H),this.zoomX=F,this.zoomY=H,!0)},setOptions:function(h){this._setOptions(h),this._initGradient(h.fill,"fill"),this._initGradient(h.stroke,"stroke"),this._initPattern(h.fill,"fill"),this._initPattern(h.stroke,"stroke")},transform:function(h){var u=this.group&&!this.group._transformDone||this.group&&this.canvas&&h===this.canvas.contextTop,_=this.calcTransformMatrix(!u);h.transform(_[0],_[1],_[2],_[3],_[4],_[5])},toObject:function(h){var u=r.Object.NUM_FRACTION_DIGITS,_={type:this.type,version:r.version,originX:this.originX,originY:this.originY,left:t(this.left,u),top:t(this.top,u),width:t(this.width,u),height:t(this.height,u),fill:this.fill&&this.fill.toObject?this.fill.toObject():this.fill,stroke:this.stroke&&this.stroke.toObject?this.stroke.toObject():this.stroke,strokeWidth:t(this.strokeWidth,u),strokeDashArray:this.strokeDashArray?this.strokeDashArray.concat():this.strokeDashArray,strokeLineCap:this.strokeLineCap,strokeDashOffset:this.strokeDashOffset,strokeLineJoin:this.strokeLineJoin,strokeUniform:this.strokeUniform,strokeMiterLimit:t(this.strokeMiterLimit,u),scaleX:t(this.scaleX,u),scaleY:t(this.scaleY,u),angle:t(this.angle,u),flipX:this.flipX,flipY:this.flipY,opacity:t(this.opacity,u),shadow:this.shadow&&this.shadow.toObject?this.shadow.toObject():this.shadow,visible:this.visible,backgroundColor:this.backgroundColor,fillRule:this.fillRule,paintFirst:this.paintFirst,globalCompositeOperation:this.globalCompositeOperation,skewX:t(this.skewX,u),skewY:t(this.skewY,u)};return this.clipPath&&!this.clipPath.excludeFromExport&&(_.clipPath=this.clipPath.toObject(h),_.clipPath.inverted=this.clipPath.inverted,_.clipPath.absolutePositioned=this.clipPath.absolutePositioned),r.util.populateWithProperties(this,_,h),this.includeDefaultValues||(_=this._removeDefaultValues(_)),_},toDatalessObject:function(h){return this.toObject(h)},_removeDefaultValues:function(h){var u=r.util.getKlass(h.type).prototype;return u.stateProperties.forEach(function(_){_!=="left"&&_!=="top"&&(h[_]===u[_]&&delete h[_],Array.isArray(h[_])&&Array.isArray(u[_])&&h[_].length===0&&u[_].length===0&&delete h[_])}),h},toString:function(){return"#<fabric."+n(this.type)+">"},getObjectScaling:function(){if(!this.group)return{scaleX:this.scaleX,scaleY:this.scaleY};var h=r.util.qrDecompose(this.calcTransformMatrix());return{scaleX:Math.abs(h.scaleX),scaleY:Math.abs(h.scaleY)}},getTotalObjectScaling:function(){var h=this.getObjectScaling(),u=h.scaleX,_=h.scaleY;if(this.canvas){var y=this.canvas.getZoom(),C=this.canvas.getRetinaScaling();u*=y*C,_*=y*C}return{scaleX:u,scaleY:_}},getObjectOpacity:function(){var h=this.opacity;return this.group&&(h*=this.group.getObjectOpacity()),h},_set:function(h,u){var _=h==="scaleX"||h==="scaleY",y=this[h]!==u,C=!1;return _&&(u=this._constrainScale(u)),h==="scaleX"&&u<0?(this.flipX=!this.flipX,u*=-1):h==="scaleY"&&u<0?(this.flipY=!this.flipY,u*=-1):h!=="shadow"||!u||u instanceof r.Shadow?h==="dirty"&&this.group&&this.group.set("dirty",u):u=new r.Shadow(u),this[h]=u,y&&(C=this.group&&this.group.isOnACache(),this.cacheProperties.indexOf(h)>-1?(this.dirty=!0,C&&this.group.set("dirty",!0)):C&&this.stateProperties.indexOf(h)>-1&&this.group.set("dirty",!0)),this},setOnGroup:function(){},getViewportTransform:function(){return this.canvas&&this.canvas.viewportTransform?this.canvas.viewportTransform:r.iMatrix.concat()},isNotVisible:function(){return this.opacity===0||!this.width&&!this.height&&this.strokeWidth===0||!this.visible},render:function(h){this.isNotVisible()||this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(h.save(),this._setupCompositeOperation(h),this.drawSelectionBackground(h),this.transform(h),this._setOpacity(h),this._setShadow(h,this),this.shouldCache()?(this.renderCache(),this.drawCacheOnCanvas(h)):(this._removeCacheCanvas(),this.dirty=!1,this.drawObject(h),this.objectCaching&&this.statefullCache&&this.saveState({propertySet:"cacheProperties"})),h.restore())},renderCache:function(h){h=h||{},this._cacheCanvas&&this._cacheContext||this._createCacheCanvas(),this.isCacheDirty()&&(this.statefullCache&&this.saveState({propertySet:"cacheProperties"}),this.drawObject(this._cacheContext,h.forClipping),this.dirty=!1)},_removeCacheCanvas:function(){this._cacheCanvas=null,this._cacheContext=null,this.cacheWidth=0,this.cacheHeight=0},hasStroke:function(){return this.stroke&&this.stroke!=="transparent"&&this.strokeWidth!==0},hasFill:function(){return this.fill&&this.fill!=="transparent"},needsItsOwnCache:function(){return!(this.paintFirst!=="stroke"||!this.hasFill()||!this.hasStroke()||typeof this.shadow!="object")||!!this.clipPath},shouldCache:function(){return this.ownCaching=this.needsItsOwnCache()||this.objectCaching&&(!this.group||!this.group.isOnACache()),this.ownCaching},willDrawShadow:function(){return!!this.shadow&&(this.shadow.offsetX!==0||this.shadow.offsetY!==0)},drawClipPathOnCache:function(h,u){if(h.save(),u.inverted?h.globalCompositeOperation="destination-out":h.globalCompositeOperation="destination-in",u.absolutePositioned){var _=r.util.invertTransform(this.calcTransformMatrix());h.transform(_[0],_[1],_[2],_[3],_[4],_[5])}u.transform(h),h.scale(1/u.zoomX,1/u.zoomY),h.drawImage(u._cacheCanvas,-u.cacheTranslationX,-u.cacheTranslationY),h.restore()},drawObject:function(h,u){var _=this.fill,y=this.stroke;u?(this.fill="black",this.stroke="",this._setClippingProperties(h)):this._renderBackground(h),this._render(h),this._drawClipPath(h,this.clipPath),this.fill=_,this.stroke=y},_drawClipPath:function(h,u){u&&(u.canvas=this.canvas,u.shouldCache(),u._transformDone=!0,u.renderCache({forClipping:!0}),this.drawClipPathOnCache(h,u))},drawCacheOnCanvas:function(h){h.scale(1/this.zoomX,1/this.zoomY),h.drawImage(this._cacheCanvas,-this.cacheTranslationX,-this.cacheTranslationY)},isCacheDirty:function(h){if(this.isNotVisible())return!1;if(this._cacheCanvas&&this._cacheContext&&!h&&this._updateCacheCanvas())return!0;if(this.dirty||this.clipPath&&this.clipPath.absolutePositioned||this.statefullCache&&this.hasStateChanged("cacheProperties")){if(this._cacheCanvas&&this._cacheContext&&!h){var u=this.cacheWidth/this.zoomX,_=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-u/2,-_/2,u,_)}return!0}return!1},_renderBackground:function(h){if(this.backgroundColor){var u=this._getNonTransformedDimensions();h.fillStyle=this.backgroundColor,h.fillRect(-u.x/2,-u.y/2,u.x,u.y),this._removeShadow(h)}},_setOpacity:function(h){this.group&&!this.group._transformDone?h.globalAlpha=this.getObjectOpacity():h.globalAlpha*=this.opacity},_setStrokeStyles:function(h,u){var _=u.stroke;_&&(h.lineWidth=u.strokeWidth,h.lineCap=u.strokeLineCap,h.lineDashOffset=u.strokeDashOffset,h.lineJoin=u.strokeLineJoin,h.miterLimit=u.strokeMiterLimit,_.toLive?_.gradientUnits==="percentage"||_.gradientTransform||_.patternTransform?this._applyPatternForTransformedGradient(h,_):(h.strokeStyle=_.toLive(h,this),this._applyPatternGradientTransform(h,_)):h.strokeStyle=u.stroke)},_setFillStyles:function(h,u){var _=u.fill;_&&(_.toLive?(h.fillStyle=_.toLive(h,this),this._applyPatternGradientTransform(h,u.fill)):h.fillStyle=_)},_setClippingProperties:function(h){h.globalAlpha=1,h.strokeStyle="transparent",h.fillStyle="#000000"},_setLineDash:function(h,u){u&&u.length!==0&&(1&u.length&&u.push.apply(u,u),h.setLineDash(u))},_renderControls:function(h,u){var _,y,C,x=this.getViewportTransform(),S=this.calcTransformMatrix();y=(u=u||{}).hasBorders!==void 0?u.hasBorders:this.hasBorders,C=u.hasControls!==void 0?u.hasControls:this.hasControls,S=r.util.multiplyTransformMatrices(x,S),_=r.util.qrDecompose(S),h.save(),h.translate(_.translateX,_.translateY),h.lineWidth=1*this.borderScaleFactor,this.group||(h.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1),this.flipX&&(_.angle-=180),h.rotate(c(this.group?_.angle:this.angle)),u.forActiveSelection||this.group?y&&this.drawBordersInGroup(h,_,u):y&&this.drawBorders(h,u),C&&this.drawControls(h,u),h.restore()},_setShadow:function(h){if(this.shadow){var u,_=this.shadow,y=this.canvas,C=y&&y.viewportTransform[0]||1,x=y&&y.viewportTransform[3]||1;u=_.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),y&&y._isRetinaScaling()&&(C*=r.devicePixelRatio,x*=r.devicePixelRatio),h.shadowColor=_.color,h.shadowBlur=_.blur*r.browserShadowBlurConstant*(C+x)*(u.scaleX+u.scaleY)/4,h.shadowOffsetX=_.offsetX*C*u.scaleX,h.shadowOffsetY=_.offsetY*x*u.scaleY}},_removeShadow:function(h){this.shadow&&(h.shadowColor="",h.shadowBlur=h.shadowOffsetX=h.shadowOffsetY=0)},_applyPatternGradientTransform:function(h,u){if(!u||!u.toLive)return{offsetX:0,offsetY:0};var _=u.gradientTransform||u.patternTransform,y=-this.width/2+u.offsetX||0,C=-this.height/2+u.offsetY||0;return u.gradientUnits==="percentage"?h.transform(this.width,0,0,this.height,y,C):h.transform(1,0,0,1,y,C),_&&h.transform(_[0],_[1],_[2],_[3],_[4],_[5]),{offsetX:y,offsetY:C}},_renderPaintInOrder:function(h){this.paintFirst==="stroke"?(this._renderStroke(h),this._renderFill(h)):(this._renderFill(h),this._renderStroke(h))},_render:function(){},_renderFill:function(h){this.fill&&(h.save(),this._setFillStyles(h,this),this.fillRule==="evenodd"?h.fill("evenodd"):h.fill(),h.restore())},_renderStroke:function(h){if(this.stroke&&this.strokeWidth!==0){if(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(h),h.save(),this.strokeUniform&&this.group){var u=this.getObjectScaling();h.scale(1/u.scaleX,1/u.scaleY)}else this.strokeUniform&&h.scale(1/this.scaleX,1/this.scaleY);this._setLineDash(h,this.strokeDashArray),this._setStrokeStyles(h,this),h.stroke(),h.restore()}},_applyPatternForTransformedGradient:function(h,u){var _,y=this._limitCacheSize(this._getCacheCanvasDimensions()),C=r.util.createCanvasElement(),x=this.canvas.getRetinaScaling(),S=y.x/this.scaleX/x,w=y.y/this.scaleY/x;C.width=S,C.height=w,(_=C.getContext("2d")).beginPath(),_.moveTo(0,0),_.lineTo(S,0),_.lineTo(S,w),_.lineTo(0,w),_.closePath(),_.translate(S/2,w/2),_.scale(y.zoomX/this.scaleX/x,y.zoomY/this.scaleY/x),this._applyPatternGradientTransform(_,u),_.fillStyle=u.toLive(h),_.fill(),h.translate(-this.width/2-this.strokeWidth/2,-this.height/2-this.strokeWidth/2),h.scale(x*this.scaleX/y.zoomX,x*this.scaleY/y.zoomY),h.strokeStyle=_.createPattern(C,"no-repeat")},_findCenterFromElement:function(){return{x:this.left+this.width/2,y:this.top+this.height/2}},_assignTransformMatrixProps:function(){if(this.transformMatrix){var h=r.util.qrDecompose(this.transformMatrix);this.flipX=!1,this.flipY=!1,this.set("scaleX",h.scaleX),this.set("scaleY",h.scaleY),this.angle=h.angle,this.skewX=h.skewX,this.skewY=0}},_removeTransformMatrix:function(h){var u=this._findCenterFromElement();this.transformMatrix&&(this._assignTransformMatrixProps(),u=r.util.transformPoint(u,this.transformMatrix)),this.transformMatrix=null,h&&(this.scaleX*=h.scaleX,this.scaleY*=h.scaleY,this.cropX=h.cropX,this.cropY=h.cropY,u.x+=h.offsetLeft,u.y+=h.offsetTop,this.width=h.width,this.height=h.height),this.setPositionByOrigin(u,"center","center")},clone:function(h,u){var _=this.toObject(u);this.constructor.fromObject?this.constructor.fromObject(_,h):r.Object._fromObject("Object",_,h)},cloneAsImage:function(h,u){var _=this.toCanvasElement(u);return h&&h(new r.Image(_)),this},toCanvasElement:function(h){h||(h={});var u=r.util,_=u.saveObjectTransform(this),y=this.group,C=this.shadow,x=Math.abs,S=(h.multiplier||1)*(h.enableRetinaScaling?r.devicePixelRatio:1);delete this.group,h.withoutTransform&&u.resetObjectTransform(this),h.withoutShadow&&(this.shadow=null);var w,E,M,F,H=r.util.createCanvasElement(),G=this.getBoundingRect(!0,!0),U=this.shadow,D={x:0,y:0};U&&(E=U.blur,w=U.nonScaling?{scaleX:1,scaleY:1}:this.getObjectScaling(),D.x=2*Math.round(x(U.offsetX)+E)*x(w.scaleX),D.y=2*Math.round(x(U.offsetY)+E)*x(w.scaleY)),M=G.width+D.x,F=G.height+D.y,H.width=Math.ceil(M),H.height=Math.ceil(F);var I=new r.StaticCanvas(H,{enableRetinaScaling:!1,renderOnAddRemove:!1,skipOffscreen:!1});h.format==="jpeg"&&(I.backgroundColor="#fff"),this.setPositionByOrigin(new r.Point(I.width/2,I.height/2),"center","center");var N=this.canvas;I.add(this);var W=I.toCanvasElement(S||1,h);return this.shadow=C,this.set("canvas",N),y&&(this.group=y),this.set(_).setCoords(),I._objects=[],I.dispose(),I=null,W},toDataURL:function(h){return h||(h={}),r.util.toDataURL(this.toCanvasElement(h),h.format||"png",h.quality||1)},isType:function(h){return arguments.length>1?Array.from(arguments).includes(this.type):this.type===h},complexity:function(){return 1},toJSON:function(h){return this.toObject(h)},rotate:function(h){var u=(this.originX!=="center"||this.originY!=="center")&&this.centeredRotation;return u&&this._setOriginToCenter(),this.set("angle",h),u&&this._resetOrigin(),this},centerH:function(){return this.canvas&&this.canvas.centerObjectH(this),this},viewportCenterH:function(){return this.canvas&&this.canvas.viewportCenterObjectH(this),this},centerV:function(){return this.canvas&&this.canvas.centerObjectV(this),this},viewportCenterV:function(){return this.canvas&&this.canvas.viewportCenterObjectV(this),this},center:function(){return this.canvas&&this.canvas.centerObject(this),this},viewportCenter:function(){return this.canvas&&this.canvas.viewportCenterObject(this),this},getLocalPointer:function(h,u){u=u||this.canvas.getPointer(h);var _=new r.Point(u.x,u.y),y=this._getLeftTopCoords();return this.angle&&(_=r.util.rotatePoint(_,y,c(-this.angle))),{x:_.x-y.x,y:_.y-y.y}},_setupCompositeOperation:function(h){this.globalCompositeOperation&&(h.globalCompositeOperation=this.globalCompositeOperation)},dispose:function(){r.runningAnimations&&r.runningAnimations.cancelByTarget(this)}}),r.util.createAccessors&&r.util.createAccessors(r.Object),a(r.Object.prototype,r.Observable),r.Object.NUM_FRACTION_DIGITS=2,r.Object.ENLIVEN_PROPS=["clipPath"],r.Object._fromObject=function(h,u,_,y){var C=r[h];u=l(u,!0),r.util.enlivenPatterns([u.fill,u.stroke],function(x){x[0]!==void 0&&(u.fill=x[0]),x[1]!==void 0&&(u.stroke=x[1]),r.util.enlivenObjectEnlivables(u,u,function(){var S=y?new C(u[y],u):new C(u);_&&_(S)})})},r.Object.__uid=0)}(i),ve=v.util.degreesToRadians,Ee={left:-.5,center:0,right:.5},Ie={top:-.5,center:0,bottom:.5},v.util.object.extend(v.Object.prototype,{translateToGivenOrigin:function(o,r,a,l,t){var n,c,d,h=o.x,u=o.y;return typeof r=="string"?r=Ee[r]:r-=.5,typeof l=="string"?l=Ee[l]:l-=.5,typeof a=="string"?a=Ie[a]:a-=.5,typeof t=="string"?t=Ie[t]:t-=.5,c=t-a,((n=l-r)||c)&&(d=this._getTransformedDimensions(),h=o.x+n*d.x,u=o.y+c*d.y),new v.Point(h,u)},translateToCenterPoint:function(o,r,a){var l=this.translateToGivenOrigin(o,r,a,"center","center");return this.angle?v.util.rotatePoint(l,o,ve(this.angle)):l},translateToOriginPoint:function(o,r,a){var l=this.translateToGivenOrigin(o,"center","center",r,a);return this.angle?v.util.rotatePoint(l,o,ve(this.angle)):l},getCenterPoint:function(){var o=new v.Point(this.left,this.top);return this.translateToCenterPoint(o,this.originX,this.originY)},getPointByOrigin:function(o,r){var a=this.getCenterPoint();return this.translateToOriginPoint(a,o,r)},toLocalPoint:function(o,r,a){var l,t,n=this.getCenterPoint();return l=r!==void 0&&a!==void 0?this.translateToGivenOrigin(n,"center","center",r,a):new v.Point(this.left,this.top),t=new v.Point(o.x,o.y),this.angle&&(t=v.util.rotatePoint(t,n,-ve(this.angle))),t.subtractEquals(l)},setPositionByOrigin:function(o,r,a){var l=this.translateToCenterPoint(o,r,a),t=this.translateToOriginPoint(l,this.originX,this.originY);this.set("left",t.x),this.set("top",t.y)},adjustPosition:function(o){var r,a,l=ve(this.angle),t=this.getScaledWidth(),n=v.util.cos(l)*t,c=v.util.sin(l)*t;r=typeof this.originX=="string"?Ee[this.originX]:this.originX-.5,a=typeof o=="string"?Ee[o]:o-.5,this.left+=n*(a-r),this.top+=c*(a-r),this.setCoords(),this.originX=o},_setOriginToCenter:function(){this._originalOriginX=this.originX,this._originalOriginY=this.originY;var o=this.getCenterPoint();this.originX="center",this.originY="center",this.left=o.x,this.top=o.y},_resetOrigin:function(){var o=this.translateToOriginPoint(this.getCenterPoint(),this._originalOriginX,this._originalOriginY);this.originX=this._originalOriginX,this.originY=this._originalOriginY,this.left=o.x,this.top=o.y,this._originalOriginX=null,this._originalOriginY=null},_getLeftTopCoords:function(){return this.translateToOriginPoint(this.getCenterPoint(),"left","top")}}),function(){var o=v.util,r=o.degreesToRadians,a=o.multiplyTransformMatrices,l=o.transformPoint;o.object.extend(v.Object.prototype,{oCoords:null,aCoords:null,lineCoords:null,ownMatrixCache:null,matrixCache:null,controls:{},_getCoords:function(t,n){return n?t?this.calcACoords():this.calcLineCoords():(this.aCoords&&this.lineCoords||this.setCoords(!0),t?this.aCoords:this.lineCoords)},getCoords:function(t,n){return c=this._getCoords(t,n),[new v.Point(c.tl.x,c.tl.y),new v.Point(c.tr.x,c.tr.y),new v.Point(c.br.x,c.br.y),new v.Point(c.bl.x,c.bl.y)];var c},intersectsWithRect:function(t,n,c,d){var h=this.getCoords(c,d);return v.Intersection.intersectPolygonRectangle(h,t,n).status==="Intersection"},intersectsWithObject:function(t,n,c){return v.Intersection.intersectPolygonPolygon(this.getCoords(n,c),t.getCoords(n,c)).status==="Intersection"||t.isContainedWithinObject(this,n,c)||this.isContainedWithinObject(t,n,c)},isContainedWithinObject:function(t,n,c){for(var d=this.getCoords(n,c),h=n?t.aCoords:t.lineCoords,u=0,_=t._getImageLines(h);u<4;u++)if(!t.containsPoint(d[u],_))return!1;return!0},isContainedWithinRect:function(t,n,c,d){var h=this.getBoundingRect(c,d);return h.left>=t.x&&h.left+h.width<=n.x&&h.top>=t.y&&h.top+h.height<=n.y},containsPoint:function(t,n,c,d){var h=this._getCoords(c,d),u=(n=n||this._getImageLines(h),this._findCrossPoints(t,n));return u!==0&&u%2==1},isOnScreen:function(t){if(!this.canvas)return!1;var n=this.canvas.vptCoords.tl,c=this.canvas.vptCoords.br;return!!this.getCoords(!0,t).some(function(d){return d.x<=c.x&&d.x>=n.x&&d.y<=c.y&&d.y>=n.y})||!!this.intersectsWithRect(n,c,!0,t)||this._containsCenterOfCanvas(n,c,t)},_containsCenterOfCanvas:function(t,n,c){var d={x:(t.x+n.x)/2,y:(t.y+n.y)/2};return!!this.containsPoint(d,null,!0,c)},isPartiallyOnScreen:function(t){if(!this.canvas)return!1;var n=this.canvas.vptCoords.tl,c=this.canvas.vptCoords.br;return!!this.intersectsWithRect(n,c,!0,t)||this.getCoords(!0,t).every(function(d){return(d.x>=c.x||d.x<=n.x)&&(d.y>=c.y||d.y<=n.y)})&&this._containsCenterOfCanvas(n,c,t)},_getImageLines:function(t){return{topline:{o:t.tl,d:t.tr},rightline:{o:t.tr,d:t.br},bottomline:{o:t.br,d:t.bl},leftline:{o:t.bl,d:t.tl}}},_findCrossPoints:function(t,n){var c,d,h,u=0;for(var _ in n)if(!((h=n[_]).o.y<t.y&&h.d.y<t.y||h.o.y>=t.y&&h.d.y>=t.y||(h.o.x===h.d.x&&h.o.x>=t.x?d=h.o.x:(c=(h.d.y-h.o.y)/(h.d.x-h.o.x),d=-(t.y-0*t.x-(h.o.y-c*h.o.x))/(0-c)),d>=t.x&&(u+=1),u!==2)))break;return u},getBoundingRect:function(t,n){var c=this.getCoords(t,n);return o.makeBoundingBoxFromPoints(c)},getScaledWidth:function(){return this._getTransformedDimensions().x},getScaledHeight:function(){return this._getTransformedDimensions().y},_constrainScale:function(t){return Math.abs(t)<this.minScaleLimit?t<0?-this.minScaleLimit:this.minScaleLimit:t===0?1e-4:t},scale:function(t){return this._set("scaleX",t),this._set("scaleY",t),this.setCoords()},scaleToWidth:function(t,n){var c=this.getBoundingRect(n).width/this.getScaledWidth();return this.scale(t/this.width/c)},scaleToHeight:function(t,n){var c=this.getBoundingRect(n).height/this.getScaledHeight();return this.scale(t/this.height/c)},calcLineCoords:function(){var t=this.getViewportTransform(),n=this.padding,c=r(this.angle),d=o.cos(c)*n,h=o.sin(c)*n,u=d+h,_=d-h,y=this.calcACoords(),C={tl:l(y.tl,t),tr:l(y.tr,t),bl:l(y.bl,t),br:l(y.br,t)};return n&&(C.tl.x-=_,C.tl.y-=u,C.tr.x+=u,C.tr.y-=_,C.bl.x-=u,C.bl.y+=_,C.br.x+=_,C.br.y+=u),C},calcOCoords:function(){var t=this._calcRotateMatrix(),n=this._calcTranslateMatrix(),c=this.getViewportTransform(),d=a(c,n),h=a(d,t),u=(h=a(h,[1/c[0],0,0,1/c[3],0,0]),this._calculateCurrentDimensions()),_={};return this.forEachControl(function(y,C,x){_[C]=y.positionHandler(u,h,x)}),_},calcACoords:function(){var t=this._calcRotateMatrix(),n=this._calcTranslateMatrix(),c=a(n,t),d=this._getTransformedDimensions(),h=d.x/2,u=d.y/2;return{tl:l({x:-h,y:-u},c),tr:l({x:h,y:-u},c),bl:l({x:-h,y:u},c),br:l({x:h,y:u},c)}},setCoords:function(t){return this.aCoords=this.calcACoords(),this.lineCoords=this.group?this.aCoords:this.calcLineCoords(),t||(this.oCoords=this.calcOCoords(),this._setCornerCoords&&this._setCornerCoords()),this},_calcRotateMatrix:function(){return o.calcRotateMatrix(this)},_calcTranslateMatrix:function(){var t=this.getCenterPoint();return[1,0,0,1,t.x,t.y]},transformMatrixKey:function(t){var n="_",c="";return!t&&this.group&&(c=this.group.transformMatrixKey(t)+n),c+this.top+n+this.left+n+this.scaleX+n+this.scaleY+n+this.skewX+n+this.skewY+n+this.angle+n+this.originX+n+this.originY+n+this.width+n+this.height+n+this.strokeWidth+this.flipX+this.flipY},calcTransformMatrix:function(t){var n=this.calcOwnMatrix();if(t||!this.group)return n;var c=this.transformMatrixKey(t),d=this.matrixCache||(this.matrixCache={});return d.key===c?d.value:(this.group&&(n=a(this.group.calcTransformMatrix(!1),n)),d.key=c,d.value=n,n)},calcOwnMatrix:function(){var t=this.transformMatrixKey(!0),n=this.ownMatrixCache||(this.ownMatrixCache={});if(n.key===t)return n.value;var c=this._calcTranslateMatrix(),d={angle:this.angle,translateX:c[4],translateY:c[5],scaleX:this.scaleX,scaleY:this.scaleY,skewX:this.skewX,skewY:this.skewY,flipX:this.flipX,flipY:this.flipY};return n.key=t,n.value=o.composeMatrix(d),n.value},_getNonTransformedDimensions:function(){var t=this.strokeWidth;return{x:this.width+t,y:this.height+t}},_getTransformedDimensions:function(t,n){t===void 0&&(t=this.skewX),n===void 0&&(n=this.skewY);var c,d,h,u=t===0&&n===0;if(this.strokeUniform?(d=this.width,h=this.height):(d=(c=this._getNonTransformedDimensions()).x,h=c.y),u)return this._finalizeDimensions(d*this.scaleX,h*this.scaleY);var _=o.sizeAfterTransform(d,h,{scaleX:this.scaleX,scaleY:this.scaleY,skewX:t,skewY:n});return this._finalizeDimensions(_.x,_.y)},_finalizeDimensions:function(t,n){return this.strokeUniform?{x:t+this.strokeWidth,y:n+this.strokeWidth}:{x:t,y:n}},_calculateCurrentDimensions:function(){var t=this.getViewportTransform(),n=this._getTransformedDimensions();return l(n,t,!0).scalarAdd(2*this.padding)}})}(),v.util.object.extend(v.Object.prototype,{sendToBack:function(){return this.group?v.StaticCanvas.prototype.sendToBack.call(this.group,this):this.canvas&&this.canvas.sendToBack(this),this},bringToFront:function(){return this.group?v.StaticCanvas.prototype.bringToFront.call(this.group,this):this.canvas&&this.canvas.bringToFront(this),this},sendBackwards:function(o){return this.group?v.StaticCanvas.prototype.sendBackwards.call(this.group,this,o):this.canvas&&this.canvas.sendBackwards(this,o),this},bringForward:function(o){return this.group?v.StaticCanvas.prototype.bringForward.call(this.group,this,o):this.canvas&&this.canvas.bringForward(this,o),this},moveTo:function(o){return this.group&&this.group.type!=="activeSelection"?v.StaticCanvas.prototype.moveTo.call(this.group,this,o):this.canvas&&this.canvas.moveTo(this,o),this}}),function(){function o(a,l){if(l){if(l.toLive)return a+": url(#SVGID_"+l.id+"); ";var t=new v.Color(l),n=a+": "+t.toRgb()+"; ",c=t.getAlpha();return c!==1&&(n+=a+"-opacity: "+c.toString()+"; "),n}return a+": none; "}var r=v.util.toFixed;v.util.object.extend(v.Object.prototype,{getSvgStyles:function(a){var l=this.fillRule?this.fillRule:"nonzero",t=this.strokeWidth?this.strokeWidth:"0",n=this.strokeDashArray?this.strokeDashArray.join(" "):"none",c=this.strokeDashOffset?this.strokeDashOffset:"0",d=this.strokeLineCap?this.strokeLineCap:"butt",h=this.strokeLineJoin?this.strokeLineJoin:"miter",u=this.strokeMiterLimit?this.strokeMiterLimit:"4",_=this.opacity!==void 0?this.opacity:"1",y=this.visible?"":" visibility: hidden;",C=a?"":this.getSvgFilter(),x=o("fill",this.fill);return[o("stroke",this.stroke),"stroke-width: ",t,"; ","stroke-dasharray: ",n,"; ","stroke-linecap: ",d,"; ","stroke-dashoffset: ",c,"; ","stroke-linejoin: ",h,"; ","stroke-miterlimit: ",u,"; ",x,"fill-rule: ",l,"; ","opacity: ",_,";",C,y].join("")},getSvgSpanStyles:function(a,l){var t="; ",n=a.fontFamily?"font-family: "+(a.fontFamily.indexOf("'")===-1&&a.fontFamily.indexOf('"')===-1?"'"+a.fontFamily+"'":a.fontFamily)+t:"",c=a.strokeWidth?"stroke-width: "+a.strokeWidth+t:"",d=a.fontSize?"font-size: "+a.fontSize+"px"+t:"",h=a.fontStyle?"font-style: "+a.fontStyle+t:"",u=a.fontWeight?"font-weight: "+a.fontWeight+t:"",_=a.fill?o("fill",a.fill):"",y=a.stroke?o("stroke",a.stroke):"",C=this.getSvgTextDecoration(a);return C&&(C="text-decoration: "+C+t),[y,c,n,d,h,u,C,_,a.deltaY?"baseline-shift: "+-a.deltaY+"; ":"",l?"white-space: pre; ":""].join("")},getSvgTextDecoration:function(a){return["overline","underline","line-through"].filter(function(l){return a[l.replace("-","")]}).join(" ")},getSvgFilter:function(){return this.shadow?"filter: url(#SVGID_"+this.shadow.id+");":""},getSvgCommons:function(){return[this.id?'id="'+this.id+'" ':"",this.clipPath?'clip-path="url(#'+this.clipPath.clipPathId+')" ':""].join("")},getSvgTransform:function(a,l){var t=a?this.calcTransformMatrix():this.calcOwnMatrix();return'transform="'+v.util.matrixToSVG(t)+(l||"")+'" '},_setSVGBg:function(a){if(this.backgroundColor){var l=v.Object.NUM_FRACTION_DIGITS;a.push("		<rect ",this._getFillAttributes(this.backgroundColor),' x="',r(-this.width/2,l),'" y="',r(-this.height/2,l),'" width="',r(this.width,l),'" height="',r(this.height,l),`"></rect>
`)}},toSVG:function(a){return this._createBaseSVGMarkup(this._toSVG(a),{reviver:a})},toClipPathSVG:function(a){return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(a),{reviver:a})},_createBaseClipPathSVGMarkup:function(a,l){var t=(l=l||{}).reviver,n=l.additionalTransform||"",c=[this.getSvgTransform(!0,n),this.getSvgCommons()].join(""),d=a.indexOf("COMMON_PARTS");return a[d]=c,t?t(a.join("")):a.join("")},_createBaseSVGMarkup:function(a,l){var t,n,c=(l=l||{}).noStyle,d=l.reviver,h=c?"":'style="'+this.getSvgStyles()+'" ',u=l.withShadow?'style="'+this.getSvgFilter()+'" ':"",_=this.clipPath,y=this.strokeUniform?'vector-effect="non-scaling-stroke" ':"",C=_&&_.absolutePositioned,x=this.stroke,S=this.fill,w=this.shadow,E=[],M=a.indexOf("COMMON_PARTS"),F=l.additionalTransform;return _&&(_.clipPathId="CLIPPATH_"+v.Object.__uid++,n='<clipPath id="'+_.clipPathId+`" >
`+_.toClipPathSVG(d)+`</clipPath>
`),C&&E.push("<g ",u,this.getSvgCommons(),` >
`),E.push("<g ",this.getSvgTransform(!1),C?"":u+this.getSvgCommons(),` >
`),t=[h,y,c?"":this.addPaintOrder()," ",F?'transform="'+F+'" ':""].join(""),a[M]=t,S&&S.toLive&&E.push(S.toSVG(this)),x&&x.toLive&&E.push(x.toSVG(this)),w&&E.push(w.toSVG(this)),_&&E.push(n),E.push(a.join("")),E.push(`</g>
`),C&&E.push(`</g>
`),d?d(E.join("")):E.join("")},addPaintOrder:function(){return this.paintFirst!=="fill"?' paint-order="'+this.paintFirst+'" ':""}})}(),function(){var o=v.util.object.extend,r="stateProperties";function a(t,n,c){var d={};c.forEach(function(h){d[h]=t[h]}),o(t[n],d,!0)}function l(t,n,c){if(t===n)return!0;if(Array.isArray(t)){if(!Array.isArray(n)||t.length!==n.length)return!1;for(var d=0,h=t.length;d<h;d++)if(!l(t[d],n[d]))return!1;return!0}if(t&&typeof t=="object"){var u,_=Object.keys(t);if(!n||typeof n!="object"||!c&&_.length!==Object.keys(n).length)return!1;for(d=0,h=_.length;d<h;d++)if((u=_[d])!=="canvas"&&u!=="group"&&!l(t[u],n[u]))return!1;return!0}}v.util.object.extend(v.Object.prototype,{hasStateChanged:function(t){var n="_"+(t=t||r);return Object.keys(this[n]).length<this[t].length||!l(this[n],this,!0)},saveState:function(t){var n=t&&t.propertySet||r,c="_"+n;return this[c]?(a(this,c,this[n]),t&&t.stateProperties&&a(this,c,t.stateProperties),this):this.setupState(t)},setupState:function(t){var n=(t=t||{}).propertySet||r;return t.propertySet=n,this["_"+n]={},this.saveState(t),this}})}(),function(){var o=v.util.degreesToRadians;v.util.object.extend(v.Object.prototype,{_findTargetCorner:function(r,a){if(!this.hasControls||this.group||!this.canvas||this.canvas._activeObject!==this)return!1;var l,t,n,c=r.x,d=r.y,h=Object.keys(this.oCoords),u=h.length-1;for(this.__corner=0;u>=0;u--)if(n=h[u],this.isControlVisible(n)&&(t=this._getImageLines(a?this.oCoords[n].touchCorner:this.oCoords[n].corner),(l=this._findCrossPoints({x:c,y:d},t))!==0&&l%2==1))return this.__corner=n,n;return!1},forEachControl:function(r){for(var a in this.controls)r(this.controls[a],a,this)},_setCornerCoords:function(){var r=this.oCoords;for(var a in r){var l=this.controls[a];r[a].corner=l.calcCornerCoords(this.angle,this.cornerSize,r[a].x,r[a].y,!1),r[a].touchCorner=l.calcCornerCoords(this.angle,this.touchCornerSize,r[a].x,r[a].y,!0)}},drawSelectionBackground:function(r){if(!this.selectionBackgroundColor||this.canvas&&!this.canvas.interactive||this.canvas&&this.canvas._activeObject!==this)return this;r.save();var a=this.getCenterPoint(),l=this._calculateCurrentDimensions(),t=this.canvas.viewportTransform;return r.translate(a.x,a.y),r.scale(1/t[0],1/t[3]),r.rotate(o(this.angle)),r.fillStyle=this.selectionBackgroundColor,r.fillRect(-l.x/2,-l.y/2,l.x,l.y),r.restore(),this},drawBorders:function(r,a){a=a||{};var l=this._calculateCurrentDimensions(),t=this.borderScaleFactor,n=l.x+t,c=l.y+t,d=a.hasControls!==void 0?a.hasControls:this.hasControls,h=!1;return r.save(),r.strokeStyle=a.borderColor||this.borderColor,this._setLineDash(r,a.borderDashArray||this.borderDashArray),r.strokeRect(-n/2,-c/2,n,c),d&&(r.beginPath(),this.forEachControl(function(u,_,y){u.withConnection&&u.getVisibility(y,_)&&(h=!0,r.moveTo(u.x*n,u.y*c),r.lineTo(u.x*n+u.offsetX,u.y*c+u.offsetY))}),h&&r.stroke()),r.restore(),this},drawBordersInGroup:function(r,a,l){l=l||{};var t=v.util.sizeAfterTransform(this.width,this.height,a),n=this.strokeWidth,c=this.strokeUniform,d=this.borderScaleFactor,h=t.x+n*(c?this.canvas.getZoom():a.scaleX)+d,u=t.y+n*(c?this.canvas.getZoom():a.scaleY)+d;return r.save(),this._setLineDash(r,l.borderDashArray||this.borderDashArray),r.strokeStyle=l.borderColor||this.borderColor,r.strokeRect(-h/2,-u/2,h,u),r.restore(),this},drawControls:function(r,a){a=a||{},r.save();var l,t,n=this.canvas.getRetinaScaling();return r.setTransform(n,0,0,n,0,0),r.strokeStyle=r.fillStyle=a.cornerColor||this.cornerColor,this.transparentCorners||(r.strokeStyle=a.cornerStrokeColor||this.cornerStrokeColor),this._setLineDash(r,a.cornerDashArray||this.cornerDashArray),this.setCoords(),this.group&&(l=this.group.calcTransformMatrix()),this.forEachControl(function(c,d,h){t=h.oCoords[d],c.getVisibility(h,d)&&(l&&(t=v.util.transformPoint(t,l)),c.render(r,t.x,t.y,a,h))}),r.restore(),this},isControlVisible:function(r){return this.controls[r]&&this.controls[r].getVisibility(this,r)},setControlVisible:function(r,a){return this._controlsVisibility||(this._controlsVisibility={}),this._controlsVisibility[r]=a,this},setControlsVisibility:function(r){for(var a in r||(r={}),r)this.setControlVisible(a,r[a]);return this},onDeselect:function(){},onSelect:function(){}})}(),v.util.object.extend(v.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(o,r){var a=function(){},l=(r=r||{}).onComplete||a,t=r.onChange||a,n=this;return v.util.animate({target:this,startValue:o.left,endValue:this.getCenterPoint().x,duration:this.FX_DURATION,onChange:function(c){o.set("left",c),n.requestRenderAll(),t()},onComplete:function(){o.setCoords(),l()}})},fxCenterObjectV:function(o,r){var a=function(){},l=(r=r||{}).onComplete||a,t=r.onChange||a,n=this;return v.util.animate({target:this,startValue:o.top,endValue:this.getCenterPoint().y,duration:this.FX_DURATION,onChange:function(c){o.set("top",c),n.requestRenderAll(),t()},onComplete:function(){o.setCoords(),l()}})},fxRemove:function(o,r){var a=function(){},l=(r=r||{}).onComplete||a,t=r.onChange||a,n=this;return v.util.animate({target:this,startValue:o.opacity,endValue:0,duration:this.FX_DURATION,onChange:function(c){o.set("opacity",c),n.requestRenderAll(),t()},onComplete:function(){n.remove(o),l()}})}}),v.util.object.extend(v.Object.prototype,{animate:function(){if(arguments[0]&&typeof arguments[0]=="object"){var o,r,a=[],l=[];for(o in arguments[0])a.push(o);for(var t=0,n=a.length;t<n;t++)o=a[t],r=t!==n-1,l.push(this._animate(o,arguments[0][o],arguments[1],r));return l}return this._animate.apply(this,arguments)},_animate:function(o,r,a,l){var t,n=this;r=r.toString(),a=a?v.util.object.clone(a):{},~o.indexOf(".")&&(t=o.split("."));var c=n.colorProperties.indexOf(o)>-1||t&&n.colorProperties.indexOf(t[1])>-1,d=t?this.get(t[0])[t[1]]:this.get(o);"from"in a||(a.from=d),c||(r=~r.indexOf("=")?d+parseFloat(r.replace("=","")):parseFloat(r));var h={target:this,startValue:a.from,endValue:r,byValue:a.by,easing:a.easing,duration:a.duration,abort:a.abort&&function(u,_,y){return a.abort.call(n,u,_,y)},onChange:function(u,_,y){t?n[t[0]][t[1]]=u:n.set(o,u),l||a.onChange&&a.onChange(u,_,y)},onComplete:function(u,_,y){l||(n.setCoords(),a.onComplete&&a.onComplete(u,_,y))}};return c?v.util.animateColor(h.startValue,h.endValue,h.duration,h):v.util.animate(h)}}),function(o){var r=o.fabric||(o.fabric={}),a=r.util.object.extend,l=r.util.object.clone,t={x1:1,x2:1,y1:1,y2:1};function n(c,d){var h=c.origin,u=c.axis1,_=c.axis2,y=c.dimension,C=d.nearest,x=d.center,S=d.farthest;return function(){switch(this.get(h)){case C:return Math.min(this.get(u),this.get(_));case x:return Math.min(this.get(u),this.get(_))+.5*this.get(y);case S:return Math.max(this.get(u),this.get(_))}}}r.Line?r.warn("fabric.Line is already defined"):(r.Line=r.util.createClass(r.Object,{type:"line",x1:0,y1:0,x2:0,y2:0,cacheProperties:r.Object.prototype.cacheProperties.concat("x1","x2","y1","y2"),initialize:function(c,d){c||(c=[0,0,0,0]),this.callSuper("initialize",d),this.set("x1",c[0]),this.set("y1",c[1]),this.set("x2",c[2]),this.set("y2",c[3]),this._setWidthHeight(d)},_setWidthHeight:function(c){c||(c={}),this.width=Math.abs(this.x2-this.x1),this.height=Math.abs(this.y2-this.y1),this.left="left"in c?c.left:this._getLeftToOriginX(),this.top="top"in c?c.top:this._getTopToOriginY()},_set:function(c,d){return this.callSuper("_set",c,d),t[c]!==void 0&&this._setWidthHeight(),this},_getLeftToOriginX:n({origin:"originX",axis1:"x1",axis2:"x2",dimension:"width"},{nearest:"left",center:"center",farthest:"right"}),_getTopToOriginY:n({origin:"originY",axis1:"y1",axis2:"y2",dimension:"height"},{nearest:"top",center:"center",farthest:"bottom"}),_render:function(c){c.beginPath();var d=this.calcLinePoints();c.moveTo(d.x1,d.y1),c.lineTo(d.x2,d.y2),c.lineWidth=this.strokeWidth;var h=c.strokeStyle;c.strokeStyle=this.stroke||c.fillStyle,this.stroke&&this._renderStroke(c),c.strokeStyle=h},_findCenterFromElement:function(){return{x:(this.x1+this.x2)/2,y:(this.y1+this.y2)/2}},toObject:function(c){return a(this.callSuper("toObject",c),this.calcLinePoints())},_getNonTransformedDimensions:function(){var c=this.callSuper("_getNonTransformedDimensions");return this.strokeLineCap==="butt"&&(this.width===0&&(c.y-=this.strokeWidth),this.height===0&&(c.x-=this.strokeWidth)),c},calcLinePoints:function(){var c=this.x1<=this.x2?-1:1,d=this.y1<=this.y2?-1:1,h=c*this.width*.5,u=d*this.height*.5;return{x1:h,x2:c*this.width*-.5,y1:u,y2:d*this.height*-.5}},_toSVG:function(){var c=this.calcLinePoints();return["<line ","COMMON_PARTS",'x1="',c.x1,'" y1="',c.y1,'" x2="',c.x2,'" y2="',c.y2,`" />
`]}}),r.Line.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat("x1 y1 x2 y2".split(" ")),r.Line.fromElement=function(c,d,h){h=h||{};var u=r.parseAttributes(c,r.Line.ATTRIBUTE_NAMES),_=[u.x1||0,u.y1||0,u.x2||0,u.y2||0];d(new r.Line(_,a(u,h)))},r.Line.fromObject=function(c,d){var h=l(c,!0);h.points=[c.x1,c.y1,c.x2,c.y2],r.Object._fromObject("Line",h,function(u){delete u.points,d&&d(u)},"points")})}(i),function(o){var r=o.fabric||(o.fabric={}),a=r.util.degreesToRadians;r.Circle?r.warn("fabric.Circle is already defined."):(r.Circle=r.util.createClass(r.Object,{type:"circle",radius:0,startAngle:0,endAngle:360,cacheProperties:r.Object.prototype.cacheProperties.concat("radius","startAngle","endAngle"),_set:function(l,t){return this.callSuper("_set",l,t),l==="radius"&&this.setRadius(t),this},toObject:function(l){return this.callSuper("toObject",["radius","startAngle","endAngle"].concat(l))},_toSVG:function(){var l,t=(this.endAngle-this.startAngle)%360;if(t===0)l=["<circle ","COMMON_PARTS",'cx="0" cy="0" ','r="',this.radius,`" />
`];else{var n=a(this.startAngle),c=a(this.endAngle),d=this.radius;l=['<path d="M '+r.util.cos(n)*d+" "+r.util.sin(n)*d," A "+d+" "+d," 0 ",+(t>180?"1":"0")+" 1"," "+r.util.cos(c)*d+" "+r.util.sin(c)*d,'" ',"COMMON_PARTS",` />
`]}return l},_render:function(l){l.beginPath(),l.arc(0,0,this.radius,a(this.startAngle),a(this.endAngle),!1),this._renderPaintInOrder(l)},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(l){return this.radius=l,this.set("width",2*l).set("height",2*l)}}),r.Circle.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat("cx cy r".split(" ")),r.Circle.fromElement=function(l,t){var n,c=r.parseAttributes(l,r.Circle.ATTRIBUTE_NAMES);if(!("radius"in(n=c)&&n.radius>=0))throw new Error("value of `r` attribute is required and can not be negative");c.left=(c.left||0)-c.radius,c.top=(c.top||0)-c.radius,t(new r.Circle(c))},r.Circle.fromObject=function(l,t){r.Object._fromObject("Circle",l,t)})}(i),function(o){var r=o.fabric||(o.fabric={});r.Triangle?r.warn("fabric.Triangle is already defined"):(r.Triangle=r.util.createClass(r.Object,{type:"triangle",width:100,height:100,_render:function(a){var l=this.width/2,t=this.height/2;a.beginPath(),a.moveTo(-l,t),a.lineTo(0,-t),a.lineTo(l,t),a.closePath(),this._renderPaintInOrder(a)},_toSVG:function(){var a=this.width/2,l=this.height/2;return["<polygon ","COMMON_PARTS",'points="',[-a+" "+l,"0 "+-l,a+" "+l].join(","),'" />']}}),r.Triangle.fromObject=function(a,l){return r.Object._fromObject("Triangle",a,l)})}(i),function(o){var r=o.fabric||(o.fabric={}),a=2*Math.PI;r.Ellipse?r.warn("fabric.Ellipse is already defined."):(r.Ellipse=r.util.createClass(r.Object,{type:"ellipse",rx:0,ry:0,cacheProperties:r.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(l){this.callSuper("initialize",l),this.set("rx",l&&l.rx||0),this.set("ry",l&&l.ry||0)},_set:function(l,t){switch(this.callSuper("_set",l,t),l){case"rx":this.rx=t,this.set("width",2*t);break;case"ry":this.ry=t,this.set("height",2*t)}return this},getRx:function(){return this.get("rx")*this.get("scaleX")},getRy:function(){return this.get("ry")*this.get("scaleY")},toObject:function(l){return this.callSuper("toObject",["rx","ry"].concat(l))},_toSVG:function(){return["<ellipse ","COMMON_PARTS",'cx="0" cy="0" ','rx="',this.rx,'" ry="',this.ry,`" />
`]},_render:function(l){l.beginPath(),l.save(),l.transform(1,0,0,this.ry/this.rx,0,0),l.arc(0,0,this.rx,0,a,!1),l.restore(),this._renderPaintInOrder(l)}}),r.Ellipse.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat("cx cy rx ry".split(" ")),r.Ellipse.fromElement=function(l,t){var n=r.parseAttributes(l,r.Ellipse.ATTRIBUTE_NAMES);n.left=(n.left||0)-n.rx,n.top=(n.top||0)-n.ry,t(new r.Ellipse(n))},r.Ellipse.fromObject=function(l,t){r.Object._fromObject("Ellipse",l,t)})}(i),function(o){var r=o.fabric||(o.fabric={}),a=r.util.object.extend;r.Rect?r.warn("fabric.Rect is already defined"):(r.Rect=r.util.createClass(r.Object,{stateProperties:r.Object.prototype.stateProperties.concat("rx","ry"),type:"rect",rx:0,ry:0,cacheProperties:r.Object.prototype.cacheProperties.concat("rx","ry"),initialize:function(l){this.callSuper("initialize",l),this._initRxRy()},_initRxRy:function(){this.rx&&!this.ry?this.ry=this.rx:this.ry&&!this.rx&&(this.rx=this.ry)},_render:function(l){var t=this.rx?Math.min(this.rx,this.width/2):0,n=this.ry?Math.min(this.ry,this.height/2):0,c=this.width,d=this.height,h=-this.width/2,u=-this.height/2,_=t!==0||n!==0,y=.4477152502;l.beginPath(),l.moveTo(h+t,u),l.lineTo(h+c-t,u),_&&l.bezierCurveTo(h+c-y*t,u,h+c,u+y*n,h+c,u+n),l.lineTo(h+c,u+d-n),_&&l.bezierCurveTo(h+c,u+d-y*n,h+c-y*t,u+d,h+c-t,u+d),l.lineTo(h+t,u+d),_&&l.bezierCurveTo(h+y*t,u+d,h,u+d-y*n,h,u+d-n),l.lineTo(h,u+n),_&&l.bezierCurveTo(h,u+y*n,h+y*t,u,h+t,u),l.closePath(),this._renderPaintInOrder(l)},toObject:function(l){return this.callSuper("toObject",["rx","ry"].concat(l))},_toSVG:function(){return["<rect ","COMMON_PARTS",'x="',-this.width/2,'" y="',-this.height/2,'" rx="',this.rx,'" ry="',this.ry,'" width="',this.width,'" height="',this.height,`" />
`]}}),r.Rect.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat("x y rx ry width height".split(" ")),r.Rect.fromElement=function(l,t,n){if(!l)return t(null);n=n||{};var c=r.parseAttributes(l,r.Rect.ATTRIBUTE_NAMES);c.left=c.left||0,c.top=c.top||0,c.height=c.height||0,c.width=c.width||0;var d=new r.Rect(a(n?r.util.object.clone(n):{},c));d.visible=d.visible&&d.width>0&&d.height>0,t(d)},r.Rect.fromObject=function(l,t){return r.Object._fromObject("Rect",l,t)})}(i),function(o){var r=o.fabric||(o.fabric={}),a=r.util.object.extend,l=r.util.array.min,t=r.util.array.max,n=r.util.toFixed,c=r.util.projectStrokeOnPoints;r.Polyline?r.warn("fabric.Polyline is already defined"):(r.Polyline=r.util.createClass(r.Object,{type:"polyline",points:null,exactBoundingBox:!1,cacheProperties:r.Object.prototype.cacheProperties.concat("points"),initialize:function(d,h){h=h||{},this.points=d||[],this.callSuper("initialize",h),this._setPositionDimensions(h)},_projectStrokeOnPoints:function(){return c(this.points,this,!0)},_setPositionDimensions:function(d){var h,u=this._calcDimensions(d),_=this.exactBoundingBox?this.strokeWidth:0;this.width=u.width-_,this.height=u.height-_,d.fromSVG||(h=this.translateToGivenOrigin({x:u.left-this.strokeWidth/2+_/2,y:u.top-this.strokeWidth/2+_/2},"left","top",this.originX,this.originY)),d.left===void 0&&(this.left=d.fromSVG?u.left:h.x),d.top===void 0&&(this.top=d.fromSVG?u.top:h.y),this.pathOffset={x:u.left+this.width/2+_/2,y:u.top+this.height/2+_/2}},_calcDimensions:function(){var d=this.exactBoundingBox?this._projectStrokeOnPoints():this.points,h=l(d,"x")||0,u=l(d,"y")||0;return{left:h,top:u,width:(t(d,"x")||0)-h,height:(t(d,"y")||0)-u}},toObject:function(d){return a(this.callSuper("toObject",d),{points:this.points.concat()})},_toSVG:function(){for(var d=[],h=this.pathOffset.x,u=this.pathOffset.y,_=r.Object.NUM_FRACTION_DIGITS,y=0,C=this.points.length;y<C;y++)d.push(n(this.points[y].x-h,_),",",n(this.points[y].y-u,_)," ");return["<"+this.type+" ","COMMON_PARTS",'points="',d.join(""),`" />
`]},commonRender:function(d){var h,u=this.points.length,_=this.pathOffset.x,y=this.pathOffset.y;if(!u||isNaN(this.points[u-1].y))return!1;d.beginPath(),d.moveTo(this.points[0].x-_,this.points[0].y-y);for(var C=0;C<u;C++)h=this.points[C],d.lineTo(h.x-_,h.y-y);return!0},_render:function(d){this.commonRender(d)&&this._renderPaintInOrder(d)},complexity:function(){return this.get("points").length}}),r.Polyline.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat(),r.Polyline.fromElementGenerator=function(d){return function(h,u,_){if(!h)return u(null);_||(_={});var y=r.parsePointsAttribute(h.getAttribute("points")),C=r.parseAttributes(h,r[d].ATTRIBUTE_NAMES);C.fromSVG=!0,u(new r[d](y,a(C,_)))}},r.Polyline.fromElement=r.Polyline.fromElementGenerator("Polyline"),r.Polyline.fromObject=function(d,h){return r.Object._fromObject("Polyline",d,h,"points")})}(i),function(o){var r=o.fabric||(o.fabric={}),a=r.util.projectStrokeOnPoints;r.Polygon?r.warn("fabric.Polygon is already defined"):(r.Polygon=r.util.createClass(r.Polyline,{type:"polygon",_projectStrokeOnPoints:function(){return a(this.points,this)},_render:function(l){this.commonRender(l)&&(l.closePath(),this._renderPaintInOrder(l))}}),r.Polygon.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat(),r.Polygon.fromElement=r.Polyline.fromElementGenerator("Polygon"),r.Polygon.fromObject=function(l,t){r.Object._fromObject("Polygon",l,t,"points")})}(i),function(o){var r=o.fabric||(o.fabric={}),a=r.util.array.min,l=r.util.array.max,t=r.util.object.extend,n=r.util.object.clone,c=r.util.toFixed;r.Path?r.warn("fabric.Path is already defined"):(r.Path=r.util.createClass(r.Object,{type:"path",path:null,cacheProperties:r.Object.prototype.cacheProperties.concat("path","fillRule"),stateProperties:r.Object.prototype.stateProperties.concat("path"),initialize:function(d,h){delete(h=n(h||{})).path,this.callSuper("initialize",h),this._setPath(d||[],h)},_setPath:function(d,h){this.path=r.util.makePathSimpler(Array.isArray(d)?d:r.util.parsePath(d)),r.Polyline.prototype._setPositionDimensions.call(this,h||{})},_renderPathCommands:function(d){var h,u=0,_=0,y=0,C=0,x=0,S=0,w=-this.pathOffset.x,E=-this.pathOffset.y;d.beginPath();for(var M=0,F=this.path.length;M<F;++M)switch((h=this.path[M])[0]){case"L":y=h[1],C=h[2],d.lineTo(y+w,C+E);break;case"M":u=y=h[1],_=C=h[2],d.moveTo(y+w,C+E);break;case"C":y=h[5],C=h[6],x=h[3],S=h[4],d.bezierCurveTo(h[1]+w,h[2]+E,x+w,S+E,y+w,C+E);break;case"Q":d.quadraticCurveTo(h[1]+w,h[2]+E,h[3]+w,h[4]+E),y=h[3],C=h[4],x=h[1],S=h[2];break;case"z":case"Z":y=u,C=_,d.closePath()}},_render:function(d){this._renderPathCommands(d),this._renderPaintInOrder(d)},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(d){return t(this.callSuper("toObject",d),{path:this.path.map(function(h){return h.slice()})})},toDatalessObject:function(d){var h=this.toObject(["sourcePath"].concat(d));return h.sourcePath&&delete h.path,h},_toSVG:function(){return["<path ","COMMON_PARTS",'d="',r.util.joinPath(this.path),'" stroke-linecap="round" ',`/>
`]},_getOffsetTransform:function(){var d=r.Object.NUM_FRACTION_DIGITS;return" translate("+c(-this.pathOffset.x,d)+", "+c(-this.pathOffset.y,d)+")"},toClipPathSVG:function(d){var h=this._getOffsetTransform();return"	"+this._createBaseClipPathSVGMarkup(this._toSVG(),{reviver:d,additionalTransform:h})},toSVG:function(d){var h=this._getOffsetTransform();return this._createBaseSVGMarkup(this._toSVG(),{reviver:d,additionalTransform:h})},complexity:function(){return this.path.length},_calcDimensions:function(){for(var d,h,u=[],_=[],y=0,C=0,x=0,S=0,w=0,E=this.path.length;w<E;++w){switch((d=this.path[w])[0]){case"L":x=d[1],S=d[2],h=[];break;case"M":y=x=d[1],C=S=d[2],h=[];break;case"C":h=r.util.getBoundsOfCurve(x,S,d[1],d[2],d[3],d[4],d[5],d[6]),x=d[5],S=d[6];break;case"Q":h=r.util.getBoundsOfCurve(x,S,d[1],d[2],d[1],d[2],d[3],d[4]),x=d[3],S=d[4];break;case"z":case"Z":x=y,S=C}h.forEach(function(H){u.push(H.x),_.push(H.y)}),u.push(x),_.push(S)}var M=a(u)||0,F=a(_)||0;return{left:M,top:F,width:(l(u)||0)-M,height:(l(_)||0)-F}}}),r.Path.fromObject=function(d,h){if(typeof d.sourcePath=="string"){var u=d.sourcePath;r.loadSVGFromURL(u,function(_){var y=_[0];y.setOptions(d),h&&h(y)})}else r.Object._fromObject("Path",d,h,"path")},r.Path.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat(["d"]),r.Path.fromElement=function(d,h,u){var _=r.parseAttributes(d,r.Path.ATTRIBUTE_NAMES);_.fromSVG=!0,h(new r.Path(_.d,t(_,u)))})}(i),function(o){var r=o.fabric||(o.fabric={}),a=r.util.array.min,l=r.util.array.max;r.Group||(r.Group=r.util.createClass(r.Object,r.Collection,{type:"group",strokeWidth:0,subTargetCheck:!1,cacheProperties:[],useSetOnGroup:!1,initialize:function(t,n,c){n=n||{},this._objects=[],c&&this.callSuper("initialize",n),this._objects=t||[];for(var d=this._objects.length;d--;)this._objects[d].group=this;if(c)this._updateObjectsACoords();else{var h=n&&n.centerPoint;n.originX!==void 0&&(this.originX=n.originX),n.originY!==void 0&&(this.originY=n.originY),h||this._calcBounds(),this._updateObjectsCoords(h),delete n.centerPoint,this.callSuper("initialize",n)}this.setCoords()},_updateObjectsACoords:function(){for(var t=this._objects.length;t--;)this._objects[t].setCoords(!0)},_updateObjectsCoords:function(t){t=t||this.getCenterPoint();for(var n=this._objects.length;n--;)this._updateObjectCoords(this._objects[n],t)},_updateObjectCoords:function(t,n){var c=t.left,d=t.top;t.set({left:c-n.x,top:d-n.y}),t.group=this,t.setCoords(!0)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},addWithUpdate:function(t){var n=!!this.group;return this._restoreObjectsState(),r.util.resetObjectTransform(this),t&&(n&&r.util.removeTransformFromObject(t,this.group.calcTransformMatrix()),this._objects.push(t),t.group=this,t._set("canvas",this.canvas)),this._calcBounds(),this._updateObjectsCoords(),this.dirty=!0,n?this.group.addWithUpdate():this.setCoords(),this},removeWithUpdate:function(t){return this._restoreObjectsState(),r.util.resetObjectTransform(this),this.remove(t),this._calcBounds(),this._updateObjectsCoords(),this.setCoords(),this.dirty=!0,this},_onObjectAdded:function(t){this.dirty=!0,t.group=this,t._set("canvas",this.canvas)},_onObjectRemoved:function(t){this.dirty=!0,delete t.group},_set:function(t,n){var c=this._objects.length;if(this.useSetOnGroup)for(;c--;)this._objects[c].setOnGroup(t,n);if(t==="canvas")for(;c--;)this._objects[c]._set(t,n);r.Object.prototype._set.call(this,t,n)},toObject:function(t){var n=this.includeDefaultValues,c=this._objects.filter(function(h){return!h.excludeFromExport}).map(function(h){var u=h.includeDefaultValues;h.includeDefaultValues=n;var _=h.toObject(t);return h.includeDefaultValues=u,_}),d=r.Object.prototype.toObject.call(this,t);return d.objects=c,d},toDatalessObject:function(t){var n,c=this.sourcePath;if(c)n=c;else{var d=this.includeDefaultValues;n=this._objects.map(function(u){var _=u.includeDefaultValues;u.includeDefaultValues=d;var y=u.toDatalessObject(t);return u.includeDefaultValues=_,y})}var h=r.Object.prototype.toDatalessObject.call(this,t);return h.objects=n,h},render:function(t){this._transformDone=!0,this.callSuper("render",t),this._transformDone=!1},shouldCache:function(){var t=r.Object.prototype.shouldCache.call(this);if(t){for(var n=0,c=this._objects.length;n<c;n++)if(this._objects[n].willDrawShadow())return this.ownCaching=!1,!1}return t},willDrawShadow:function(){if(r.Object.prototype.willDrawShadow.call(this))return!0;for(var t=0,n=this._objects.length;t<n;t++)if(this._objects[t].willDrawShadow())return!0;return!1},isOnACache:function(){return this.ownCaching||this.group&&this.group.isOnACache()},drawObject:function(t){for(var n=0,c=this._objects.length;n<c;n++)this._objects[n].render(t);this._drawClipPath(t,this.clipPath)},isCacheDirty:function(t){if(this.callSuper("isCacheDirty",t))return!0;if(!this.statefullCache)return!1;for(var n=0,c=this._objects.length;n<c;n++)if(this._objects[n].isCacheDirty(!0)){if(this._cacheCanvas){var d=this.cacheWidth/this.zoomX,h=this.cacheHeight/this.zoomY;this._cacheContext.clearRect(-d/2,-h/2,d,h)}return!0}return!1},_restoreObjectsState:function(){var t=this.calcOwnMatrix();return this._objects.forEach(function(n){r.util.addTransformToObject(n,t),delete n.group,n.setCoords()}),this},destroy:function(){return this._objects.forEach(function(t){t.set("dirty",!0)}),this._restoreObjectsState()},dispose:function(){this.callSuper("dispose"),this.forEachObject(function(t){t.dispose&&t.dispose()}),this._objects=[]},toActiveSelection:function(){if(this.canvas){var t=this._objects,n=this.canvas;this._objects=[];var c=this.toObject();delete c.objects;var d=new r.ActiveSelection([]);return d.set(c),d.type="activeSelection",n.remove(this),t.forEach(function(h){h.group=d,h.dirty=!0,n.add(h)}),d.canvas=n,d._objects=t,n._activeObject=d,d.setCoords(),d}},ungroupOnCanvas:function(){return this._restoreObjectsState()},setObjectsCoords:function(){return this.forEachObject(function(t){t.setCoords(!0)}),this},_calcBounds:function(t){for(var n,c,d,h,u=[],_=[],y=["tr","br","bl","tl"],C=0,x=this._objects.length,S=y.length;C<x;++C){for(d=(n=this._objects[C]).calcACoords(),h=0;h<S;h++)c=y[h],u.push(d[c].x),_.push(d[c].y);n.aCoords=d}this._getBounds(u,_,t)},_getBounds:function(t,n,c){var d=new r.Point(a(t),a(n)),h=new r.Point(l(t),l(n)),u=d.y||0,_=d.x||0,y=h.x-d.x||0,C=h.y-d.y||0;this.width=y,this.height=C,c||this.setPositionByOrigin({x:_,y:u},"left","top")},_toSVG:function(t){for(var n=["<g ","COMMON_PARTS",` >
`],c=0,d=this._objects.length;c<d;c++)n.push("		",this._objects[c].toSVG(t));return n.push(`</g>
`),n},getSvgStyles:function(){var t=this.opacity!==void 0&&this.opacity!==1?"opacity: "+this.opacity+";":"",n=this.visible?"":" visibility: hidden;";return[t,this.getSvgFilter(),n].join("")},toClipPathSVG:function(t){for(var n=[],c=0,d=this._objects.length;c<d;c++)n.push("	",this._objects[c].toClipPathSVG(t));return this._createBaseClipPathSVGMarkup(n,{reviver:t})}}),r.Group.fromObject=function(t,n){var c=t.objects,d=r.util.object.clone(t,!0);delete d.objects,typeof c!="string"?r.util.enlivenObjects(c,function(h){var u=r.util.object.clone(t,!0);delete u.objects,r.util.enlivenObjectEnlivables(t,u,function(){n&&n(new r.Group(h,u,!0))})}):r.loadSVGFromURL(c,function(h){var u=r.util.groupSVGElements(h,t,c);u.set(d),n&&n(u)})})}(i),function(o){var r=o.fabric||(o.fabric={});r.ActiveSelection||(r.ActiveSelection=r.util.createClass(r.Group,{type:"activeSelection",initialize:function(a,l){l=l||{},this._objects=a||[];for(var t=this._objects.length;t--;)this._objects[t].group=this;l.originX&&(this.originX=l.originX),l.originY&&(this.originY=l.originY),this._calcBounds(),this._updateObjectsCoords(),r.Object.prototype.initialize.call(this,l),this.setCoords()},toGroup:function(){var a=this._objects.concat();this._objects=[];var l=r.Object.prototype.toObject.call(this),t=new r.Group([]);if(delete l.type,t.set(l),a.forEach(function(c){c.canvas.remove(c),c.group=t}),t._objects=a,!this.canvas)return t;var n=this.canvas;return n.add(t),n._activeObject=t,t.setCoords(),t},onDeselect:function(){return this.destroy(),!1},toString:function(){return"#<fabric.ActiveSelection: ("+this.complexity()+")>"},shouldCache:function(){return!1},isOnACache:function(){return!1},_renderControls:function(a,l,t){a.save(),a.globalAlpha=this.isMoving?this.borderOpacityWhenMoving:1,this.callSuper("_renderControls",a,l),(t=t||{}).hasControls===void 0&&(t.hasControls=!1),t.forActiveSelection=!0;for(var n=0,c=this._objects.length;n<c;n++)this._objects[n]._renderControls(a,t);a.restore()}}),r.ActiveSelection.fromObject=function(a,l){r.util.enlivenObjects(a.objects,function(t){delete a.objects,l&&l(new r.ActiveSelection(t,a,!0))})})}(i),function(o){var r=v.util.object.extend;o.fabric||(o.fabric={}),o.fabric.Image?v.warn("fabric.Image is already defined."):(v.Image=v.util.createClass(v.Object,{type:"image",strokeWidth:0,srcFromAttribute:!1,_lastScaleX:1,_lastScaleY:1,_filterScalingX:1,_filterScalingY:1,minimumScaleTrigger:.5,stateProperties:v.Object.prototype.stateProperties.concat("cropX","cropY"),cacheProperties:v.Object.prototype.cacheProperties.concat("cropX","cropY"),cacheKey:"",cropX:0,cropY:0,imageSmoothing:!0,initialize:function(a,l){l||(l={}),this.filters=[],this.cacheKey="texture"+v.Object.__uid++,this.callSuper("initialize",l),this._initElement(a,l)},getElement:function(){return this._element||{}},setElement:function(a,l){return this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._element=a,this._originalElement=a,this._initConfig(l),this.filters.length!==0&&this.applyFilters(),this.resizeFilter&&this.applyResizeFilters(),this},removeTexture:function(a){var l=v.filterBackend;l&&l.evictCachesForKey&&l.evictCachesForKey(a)},dispose:function(){this.callSuper("dispose"),this.removeTexture(this.cacheKey),this.removeTexture(this.cacheKey+"_filtered"),this._cacheContext=void 0,["_originalElement","_element","_filteredEl","_cacheCanvas"].forEach(function(a){v.util.cleanUpJsdomNode(this[a]),this[a]=void 0}.bind(this))},getCrossOrigin:function(){return this._originalElement&&(this._originalElement.crossOrigin||null)},getOriginalSize:function(){var a=this.getElement();return{width:a.naturalWidth||a.width,height:a.naturalHeight||a.height}},_stroke:function(a){if(this.stroke&&this.strokeWidth!==0){var l=this.width/2,t=this.height/2;a.beginPath(),a.moveTo(-l,-t),a.lineTo(l,-t),a.lineTo(l,t),a.lineTo(-l,t),a.lineTo(-l,-t),a.closePath()}},toObject:function(a){var l=[];this.filters.forEach(function(n){n&&l.push(n.toObject())});var t=r(this.callSuper("toObject",["cropX","cropY"].concat(a)),{src:this.getSrc(),crossOrigin:this.getCrossOrigin(),filters:l});return this.resizeFilter&&(t.resizeFilter=this.resizeFilter.toObject()),t},hasCrop:function(){return this.cropX||this.cropY||this.width<this._element.width||this.height<this._element.height},_toSVG:function(){var a,l=[],t=[],n=this._element,c=-this.width/2,d=-this.height/2,h="",u="";if(!n)return[];if(this.hasCrop()){var _=v.Object.__uid++;l.push('<clipPath id="imageCrop_'+_+`">
`,'	<rect x="'+c+'" y="'+d+'" width="'+this.width+'" height="'+this.height+`" />
`,`</clipPath>
`),h=' clip-path="url(#imageCrop_'+_+')" '}if(this.imageSmoothing||(u='" image-rendering="optimizeSpeed'),t.push("	<image ","COMMON_PARTS",'xlink:href="',this.getSvgSrc(!0),'" x="',c-this.cropX,'" y="',d-this.cropY,'" width="',n.width||n.naturalWidth,'" height="',n.height||n.height,u,'"',h,`></image>
`),this.stroke||this.strokeDashArray){var y=this.fill;this.fill=null,a=["	<rect ",'x="',c,'" y="',d,'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),`"/>
`],this.fill=y}return this.paintFirst!=="fill"?l.concat(a,t):l.concat(t,a)},getSrc:function(a){var l=a?this._element:this._originalElement;return l?l.toDataURL?l.toDataURL():this.srcFromAttribute?l.getAttribute("src"):l.src:this.src||""},setSrc:function(a,l,t){return v.util.loadImage(a,function(n,c){this.setElement(n,t),this._setWidthHeight(),l&&l(this,c)},this,t&&t.crossOrigin),this},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},applyResizeFilters:function(){var a=this.resizeFilter,l=this.minimumScaleTrigger,t=this.getTotalObjectScaling(),n=t.scaleX,c=t.scaleY,d=this._filteredEl||this._originalElement;if(this.group&&this.set("dirty",!0),!a||n>l&&c>l)return this._element=d,this._filterScalingX=1,this._filterScalingY=1,this._lastScaleX=n,void(this._lastScaleY=c);v.filterBackend||(v.filterBackend=v.initFilterBackend());var h=v.util.createCanvasElement(),u=this._filteredEl?this.cacheKey+"_filtered":this.cacheKey,_=d.width,y=d.height;h.width=_,h.height=y,this._element=h,this._lastScaleX=a.scaleX=n,this._lastScaleY=a.scaleY=c,v.filterBackend.applyFilters([a],d,_,y,this._element,u),this._filterScalingX=h.width/this._originalElement.width,this._filterScalingY=h.height/this._originalElement.height},applyFilters:function(a){if(a=(a=a||this.filters||[]).filter(function(d){return d&&!d.isNeutralState()}),this.set("dirty",!0),this.removeTexture(this.cacheKey+"_filtered"),a.length===0)return this._element=this._originalElement,this._filteredEl=null,this._filterScalingX=1,this._filterScalingY=1,this;var l=this._originalElement,t=l.naturalWidth||l.width,n=l.naturalHeight||l.height;if(this._element===this._originalElement){var c=v.util.createCanvasElement();c.width=t,c.height=n,this._element=c,this._filteredEl=c}else this._element=this._filteredEl,this._filteredEl.getContext("2d").clearRect(0,0,t,n),this._lastScaleX=1,this._lastScaleY=1;return v.filterBackend||(v.filterBackend=v.initFilterBackend()),v.filterBackend.applyFilters(a,this._originalElement,t,n,this._element,this.cacheKey),this._originalElement.width===this._element.width&&this._originalElement.height===this._element.height||(this._filterScalingX=this._element.width/this._originalElement.width,this._filterScalingY=this._element.height/this._originalElement.height),this},_render:function(a){v.util.setImageSmoothing(a,this.imageSmoothing),this.isMoving!==!0&&this.resizeFilter&&this._needsResize()&&this.applyResizeFilters(),this._stroke(a),this._renderPaintInOrder(a)},drawCacheOnCanvas:function(a){v.util.setImageSmoothing(a,this.imageSmoothing),v.Object.prototype.drawCacheOnCanvas.call(this,a)},shouldCache:function(){return this.needsItsOwnCache()},_renderFill:function(a){var l=this._element;if(l){var t=this._filterScalingX,n=this._filterScalingY,c=this.width,d=this.height,h=Math.min,u=Math.max,_=u(this.cropX,0),y=u(this.cropY,0),C=l.naturalWidth||l.width,x=l.naturalHeight||l.height,S=_*t,w=y*n,E=h(c*t,C-S),M=h(d*n,x-w),F=-c/2,H=-d/2,G=h(c,C/t-_),U=h(d,x/n-y);l&&a.drawImage(l,S,w,E,M,F,H,G,U)}},_needsResize:function(){var a=this.getTotalObjectScaling();return a.scaleX!==this._lastScaleX||a.scaleY!==this._lastScaleY},_resetWidthHeight:function(){this.set(this.getOriginalSize())},_initElement:function(a,l){this.setElement(v.util.getById(a),l),v.util.addClass(this.getElement(),v.Image.CSS_CANVAS)},_initConfig:function(a){a||(a={}),this.setOptions(a),this._setWidthHeight(a)},_initFilters:function(a,l){a&&a.length?v.util.enlivenObjects(a,function(t){l&&l(t)},"fabric.Image.filters"):l&&l()},_setWidthHeight:function(a){a||(a={});var l=this.getElement();this.width=a.width||l.naturalWidth||l.width||0,this.height=a.height||l.naturalHeight||l.height||0},parsePreserveAspectRatioAttribute:function(){var a,l=v.util.parsePreserveAspectRatioAttribute(this.preserveAspectRatio||""),t=this._element.width,n=this._element.height,c=1,d=1,h=0,u=0,_=0,y=0,C=this.width,x=this.height,S={width:C,height:x};return!l||l.alignX==="none"&&l.alignY==="none"?(c=C/t,d=x/n):(l.meetOrSlice==="meet"&&(a=(C-t*(c=d=v.util.findScaleToFit(this._element,S)))/2,l.alignX==="Min"&&(h=-a),l.alignX==="Max"&&(h=a),a=(x-n*d)/2,l.alignY==="Min"&&(u=-a),l.alignY==="Max"&&(u=a)),l.meetOrSlice==="slice"&&(a=t-C/(c=d=v.util.findScaleToCover(this._element,S)),l.alignX==="Mid"&&(_=a/2),l.alignX==="Max"&&(_=a),a=n-x/d,l.alignY==="Mid"&&(y=a/2),l.alignY==="Max"&&(y=a),t=C/c,n=x/d)),{width:t,height:n,scaleX:c,scaleY:d,offsetLeft:h,offsetTop:u,cropX:_,cropY:y}}}),v.Image.CSS_CANVAS="canvas-img",v.Image.prototype.getSvgSrc=v.Image.prototype.getSrc,v.Image.fromObject=function(a,l){var t=v.util.object.clone(a);v.util.loadImage(t.src,function(n,c){c?l&&l(null,!0):v.Image.prototype._initFilters.call(t,t.filters,function(d){t.filters=d||[],v.Image.prototype._initFilters.call(t,[t.resizeFilter],function(h){t.resizeFilter=h[0],v.util.enlivenObjectEnlivables(t,t,function(){var u=new v.Image(n,t);l(u,!1)})})})},null,t.crossOrigin)},v.Image.fromURL=function(a,l,t){v.util.loadImage(a,function(n,c){l&&l(new v.Image(n,t),c)},null,t&&t.crossOrigin)},v.Image.ATTRIBUTE_NAMES=v.SHARED_ATTRIBUTES.concat("x y width height preserveAspectRatio xlink:href crossOrigin image-rendering".split(" ")),v.Image.fromElement=function(a,l,t){var n=v.parseAttributes(a,v.Image.ATTRIBUTE_NAMES);v.Image.fromURL(n["xlink:href"],l,r(t?v.util.object.clone(t):{},n))})}(i),v.util.object.extend(v.Object.prototype,{_getAngleValueForStraighten:function(){var o=this.angle%360;return o>0?90*Math.round((o-1)/90):90*Math.round(o/90)},straighten:function(){return this.rotate(this._getAngleValueForStraighten())},fxStraighten:function(o){var r=function(){},a=(o=o||{}).onComplete||r,l=o.onChange||r,t=this;return v.util.animate({target:this,startValue:this.get("angle"),endValue:this._getAngleValueForStraighten(),duration:this.FX_DURATION,onChange:function(n){t.rotate(n),l()},onComplete:function(){t.setCoords(),a()}})}}),v.util.object.extend(v.StaticCanvas.prototype,{straightenObject:function(o){return o.straighten(),this.requestRenderAll(),this},fxStraightenObject:function(o){return o.fxStraighten({onChange:this.requestRenderAllBound})}}),function(){function o(a,l){var t="precision "+l+` float;
void main(){}`,n=a.createShader(a.FRAGMENT_SHADER);return a.shaderSource(n,t),a.compileShader(n),!!a.getShaderParameter(n,a.COMPILE_STATUS)}function r(a){a&&a.tileSize&&(this.tileSize=a.tileSize),this.setupGLContext(this.tileSize,this.tileSize),this.captureGPUInfo()}v.isWebglSupported=function(a){if(v.isLikelyNode)return!1;a=a||v.WebglFilterBackend.prototype.tileSize;var l=document.createElement("canvas"),t=l.getContext("webgl")||l.getContext("experimental-webgl"),n=!1;if(t){v.maxTextureSize=t.getParameter(t.MAX_TEXTURE_SIZE),n=v.maxTextureSize>=a;for(var c=["highp","mediump","lowp"],d=0;d<3;d++)if(o(t,c[d])){v.webGlPrecision=c[d];break}}return this.isSupported=n,n},v.WebglFilterBackend=r,r.prototype={tileSize:2048,resources:{},setupGLContext:function(a,l){this.dispose(),this.createWebGLCanvas(a,l),this.aPosition=new Float32Array([0,0,0,1,1,0,1,1]),this.chooseFastestCopyGLTo2DMethod(a,l)},chooseFastestCopyGLTo2DMethod:function(a,l){var t,n=window.performance!==void 0;try{new ImageData(1,1),t=!0}catch(x){t=!1}var c=typeof ArrayBuffer<"u",d=typeof Uint8ClampedArray<"u";if(n&&t&&c&&d){var h=v.util.createCanvasElement(),u=new ArrayBuffer(a*l*4);if(v.forceGLPutImageData)return this.imageBuffer=u,void(this.copyGLTo2D=We);var _,y,C={imageBuffer:u,destinationWidth:a,destinationHeight:l,targetCanvas:h};h.width=a,h.height=l,_=window.performance.now(),Ve.call(C,this.gl,C),y=window.performance.now()-_,_=window.performance.now(),We.call(C,this.gl,C),y>window.performance.now()-_?(this.imageBuffer=u,this.copyGLTo2D=We):this.copyGLTo2D=Ve}},createWebGLCanvas:function(a,l){var t=v.util.createCanvasElement();t.width=a,t.height=l;var n={alpha:!0,premultipliedAlpha:!1,depth:!1,stencil:!1,antialias:!1},c=t.getContext("webgl",n);c||(c=t.getContext("experimental-webgl",n)),c&&(c.clearColor(0,0,0,0),this.canvas=t,this.gl=c)},applyFilters:function(a,l,t,n,c,d){var h,u=this.gl;d&&(h=this.getCachedTexture(d,l));var _={originalWidth:l.width||l.originalWidth,originalHeight:l.height||l.originalHeight,sourceWidth:t,sourceHeight:n,destinationWidth:t,destinationHeight:n,context:u,sourceTexture:this.createTexture(u,t,n,!h&&l),targetTexture:this.createTexture(u,t,n),originalTexture:h||this.createTexture(u,t,n,!h&&l),passes:a.length,webgl:!0,aPosition:this.aPosition,programCache:this.programCache,pass:0,filterBackend:this,targetCanvas:c},y=u.createFramebuffer();return u.bindFramebuffer(u.FRAMEBUFFER,y),a.forEach(function(C){C&&C.applyTo(_)}),function(C){var x=C.targetCanvas,S=x.width,w=x.height,E=C.destinationWidth,M=C.destinationHeight;S===E&&w===M||(x.width=E,x.height=M)}(_),this.copyGLTo2D(u,_),u.bindTexture(u.TEXTURE_2D,null),u.deleteTexture(_.sourceTexture),u.deleteTexture(_.targetTexture),u.deleteFramebuffer(y),c.getContext("2d").setTransform(1,0,0,1,0,0),_},dispose:function(){this.canvas&&(this.canvas=null,this.gl=null),this.clearWebGLCaches()},clearWebGLCaches:function(){this.programCache={},this.textureCache={}},createTexture:function(a,l,t,n){var c=a.createTexture();return a.bindTexture(a.TEXTURE_2D,c),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MAG_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_MIN_FILTER,a.NEAREST),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_S,a.CLAMP_TO_EDGE),a.texParameteri(a.TEXTURE_2D,a.TEXTURE_WRAP_T,a.CLAMP_TO_EDGE),n?a.texImage2D(a.TEXTURE_2D,0,a.RGBA,a.RGBA,a.UNSIGNED_BYTE,n):a.texImage2D(a.TEXTURE_2D,0,a.RGBA,l,t,0,a.RGBA,a.UNSIGNED_BYTE,null),c},getCachedTexture:function(a,l){if(this.textureCache[a])return this.textureCache[a];var t=this.createTexture(this.gl,l.width,l.height,l);return this.textureCache[a]=t,t},evictCachesForKey:function(a){this.textureCache[a]&&(this.gl.deleteTexture(this.textureCache[a]),delete this.textureCache[a])},copyGLTo2D:Ve,captureGPUInfo:function(){if(this.gpuInfo)return this.gpuInfo;var a=this.gl,l={renderer:"",vendor:""};if(!a)return l;var t=a.getExtension("WEBGL_debug_renderer_info");if(t){var n=a.getParameter(t.UNMASKED_RENDERER_WEBGL),c=a.getParameter(t.UNMASKED_VENDOR_WEBGL);n&&(l.renderer=n.toLowerCase()),c&&(l.vendor=c.toLowerCase())}return this.gpuInfo=l,l}}}(),function(){var o=function(){};function r(){}v.Canvas2dFilterBackend=r,r.prototype={evictCachesForKey:o,dispose:o,clearWebGLCaches:o,resources:{},applyFilters:function(a,l,t,n,c){var d=c.getContext("2d");d.drawImage(l,0,0,t,n);var h={sourceWidth:t,sourceHeight:n,imageData:d.getImageData(0,0,t,n),originalEl:l,originalImageData:d.getImageData(0,0,t,n),canvasEl:c,ctx:d,filterBackend:this};return a.forEach(function(u){u.applyTo(h)}),h.imageData.width===t&&h.imageData.height===n||(c.width=h.imageData.width,c.height=h.imageData.height),d.putImageData(h.imageData,0,0),h}}}(),v.Image=v.Image||{},v.Image.filters=v.Image.filters||{},v.Image.filters.BaseFilter=v.util.createClass({type:"BaseFilter",vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
void main() {
vTexCoord = aPosition;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:`precision highp float;
varying vec2 vTexCoord;
uniform sampler2D uTexture;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
}`,initialize:function(o){o&&this.setOptions(o)},setOptions:function(o){for(var r in o)this[r]=o[r]},createProgram:function(o,r,a){r=r||this.fragmentSource,a=a||this.vertexSource,v.webGlPrecision!=="highp"&&(r=r.replace(/precision highp float/g,"precision "+v.webGlPrecision+" float"));var l=o.createShader(o.VERTEX_SHADER);if(o.shaderSource(l,a),o.compileShader(l),!o.getShaderParameter(l,o.COMPILE_STATUS))throw new Error("Vertex shader compile error for "+this.type+": "+o.getShaderInfoLog(l));var t=o.createShader(o.FRAGMENT_SHADER);if(o.shaderSource(t,r),o.compileShader(t),!o.getShaderParameter(t,o.COMPILE_STATUS))throw new Error("Fragment shader compile error for "+this.type+": "+o.getShaderInfoLog(t));var n=o.createProgram();if(o.attachShader(n,l),o.attachShader(n,t),o.linkProgram(n),!o.getProgramParameter(n,o.LINK_STATUS))throw new Error('Shader link error for "${this.type}" '+o.getProgramInfoLog(n));var c=this.getAttributeLocations(o,n),d=this.getUniformLocations(o,n)||{};return d.uStepW=o.getUniformLocation(n,"uStepW"),d.uStepH=o.getUniformLocation(n,"uStepH"),{program:n,attributeLocations:c,uniformLocations:d}},getAttributeLocations:function(o,r){return{aPosition:o.getAttribLocation(r,"aPosition")}},getUniformLocations:function(){return{}},sendAttributeData:function(o,r,a){var l=r.aPosition,t=o.createBuffer();o.bindBuffer(o.ARRAY_BUFFER,t),o.enableVertexAttribArray(l),o.vertexAttribPointer(l,2,o.FLOAT,!1,0,0),o.bufferData(o.ARRAY_BUFFER,a,o.STATIC_DRAW)},_setupFrameBuffer:function(o){var r,a,l=o.context;o.passes>1?(r=o.destinationWidth,a=o.destinationHeight,o.sourceWidth===r&&o.sourceHeight===a||(l.deleteTexture(o.targetTexture),o.targetTexture=o.filterBackend.createTexture(l,r,a)),l.framebufferTexture2D(l.FRAMEBUFFER,l.COLOR_ATTACHMENT0,l.TEXTURE_2D,o.targetTexture,0)):(l.bindFramebuffer(l.FRAMEBUFFER,null),l.finish())},_swapTextures:function(o){o.passes--,o.pass++;var r=o.targetTexture;o.targetTexture=o.sourceTexture,o.sourceTexture=r},isNeutralState:function(){var o=this.mainParameter,r=v.Image.filters[this.type].prototype;if(o){if(Array.isArray(r[o])){for(var a=r[o].length;a--;)if(this[o][a]!==r[o][a])return!1;return!0}return r[o]===this[o]}return!1},applyTo:function(o){o.webgl?(this._setupFrameBuffer(o),this.applyToWebGL(o),this._swapTextures(o)):this.applyTo2d(o)},retrieveShader:function(o){return o.programCache.hasOwnProperty(this.type)||(o.programCache[this.type]=this.createProgram(o.context)),o.programCache[this.type]},applyToWebGL:function(o){var r=o.context,a=this.retrieveShader(o);o.pass===0&&o.originalTexture?r.bindTexture(r.TEXTURE_2D,o.originalTexture):r.bindTexture(r.TEXTURE_2D,o.sourceTexture),r.useProgram(a.program),this.sendAttributeData(r,a.attributeLocations,o.aPosition),r.uniform1f(a.uniformLocations.uStepW,1/o.sourceWidth),r.uniform1f(a.uniformLocations.uStepH,1/o.sourceHeight),this.sendUniformData(r,a.uniformLocations),r.viewport(0,0,o.destinationWidth,o.destinationHeight),r.drawArrays(r.TRIANGLE_STRIP,0,4)},bindAdditionalTexture:function(o,r,a){o.activeTexture(a),o.bindTexture(o.TEXTURE_2D,r),o.activeTexture(o.TEXTURE0)},unbindAdditionalTexture:function(o,r){o.activeTexture(r),o.bindTexture(o.TEXTURE_2D,null),o.activeTexture(o.TEXTURE0)},getMainParameter:function(){return this[this.mainParameter]},setMainParameter:function(o){this[this.mainParameter]=o},sendUniformData:function(){},createHelpLayer:function(o){if(!o.helpLayer){var r=document.createElement("canvas");r.width=o.sourceWidth,r.height=o.sourceHeight,o.helpLayer=r}},toObject:function(){var o={type:this.type},r=this.mainParameter;return r&&(o[r]=this[r]),o},toJSON:function(){return this.toObject()}}),v.Image.filters.BaseFilter.fromObject=function(o,r){var a=new v.Image.filters[o.type](o);return r&&r(a),a},function(o){var r=o.fabric||(o.fabric={}),a=r.Image.filters,l=r.util.createClass;a.ColorMatrix=l(a.BaseFilter,{type:"ColorMatrix",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
uniform mat4 uColorMatrix;
uniform vec4 uConstants;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color *= uColorMatrix;
color += uConstants;
gl_FragColor = color;
}`,matrix:[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],mainParameter:"matrix",colorsOnly:!0,initialize:function(t){this.callSuper("initialize",t),this.matrix=this.matrix.slice(0)},applyTo2d:function(t){var n,c,d,h,u,_=t.imageData.data,y=_.length,C=this.matrix,x=this.colorsOnly;for(u=0;u<y;u+=4)n=_[u],c=_[u+1],d=_[u+2],x?(_[u]=n*C[0]+c*C[1]+d*C[2]+255*C[4],_[u+1]=n*C[5]+c*C[6]+d*C[7]+255*C[9],_[u+2]=n*C[10]+c*C[11]+d*C[12]+255*C[14]):(h=_[u+3],_[u]=n*C[0]+c*C[1]+d*C[2]+h*C[3]+255*C[4],_[u+1]=n*C[5]+c*C[6]+d*C[7]+h*C[8]+255*C[9],_[u+2]=n*C[10]+c*C[11]+d*C[12]+h*C[13]+255*C[14],_[u+3]=n*C[15]+c*C[16]+d*C[17]+h*C[18]+255*C[19])},getUniformLocations:function(t,n){return{uColorMatrix:t.getUniformLocation(n,"uColorMatrix"),uConstants:t.getUniformLocation(n,"uConstants")}},sendUniformData:function(t,n){var c=this.matrix,d=[c[0],c[1],c[2],c[3],c[5],c[6],c[7],c[8],c[10],c[11],c[12],c[13],c[15],c[16],c[17],c[18]],h=[c[4],c[9],c[14],c[19]];t.uniformMatrix4fv(n.uColorMatrix,!1,d),t.uniform4fv(n.uConstants,h)}}),r.Image.filters.ColorMatrix.fromObject=r.Image.filters.BaseFilter.fromObject}(i),function(o){var r=o.fabric||(o.fabric={}),a=r.Image.filters,l=r.util.createClass;a.Brightness=l(a.BaseFilter,{type:"Brightness",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBrightness;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += uBrightness;
gl_FragColor = color;
}`,brightness:0,mainParameter:"brightness",applyTo2d:function(t){if(this.brightness!==0){var n,c=t.imageData.data,d=c.length,h=Math.round(255*this.brightness);for(n=0;n<d;n+=4)c[n]=c[n]+h,c[n+1]=c[n+1]+h,c[n+2]=c[n+2]+h}},getUniformLocations:function(t,n){return{uBrightness:t.getUniformLocation(n,"uBrightness")}},sendUniformData:function(t,n){t.uniform1f(n.uBrightness,this.brightness)}}),r.Image.filters.Brightness.fromObject=r.Image.filters.BaseFilter.fromObject}(i),function(o){var r=o.fabric||(o.fabric={}),a=r.util.object.extend,l=r.Image.filters,t=r.util.createClass;l.Convolute=t(l.BaseFilter,{type:"Convolute",opaque:!1,matrix:[0,0,0,0,1,0,0,0,0],fragmentSource:{Convolute_3_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1), uStepH * (h - 1));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 3.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_3_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[9];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 3.0; h+=1.0) {
for (float w = 0.0; w < 3.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 1.0), uStepH * (h - 1.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 3.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_5_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 5.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_5_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[25];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 5.0; h+=1.0) {
for (float w = 0.0; w < 5.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 2.0), uStepH * (h - 2.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 5.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_7_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 7.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_7_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[49];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 7.0; h+=1.0) {
for (float w = 0.0; w < 7.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 3.0), uStepH * (h - 3.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 7.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`,Convolute_9_1:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 0);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color += texture2D(uTexture, vTexCoord + matrixPos) * uMatrix[int(h * 9.0 + w)];
}
}
gl_FragColor = color;
}`,Convolute_9_0:`precision highp float;
uniform sampler2D uTexture;
uniform float uMatrix[81];
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
vec4 color = vec4(0, 0, 0, 1);
for (float h = 0.0; h < 9.0; h+=1.0) {
for (float w = 0.0; w < 9.0; w+=1.0) {
vec2 matrixPos = vec2(uStepW * (w - 4.0), uStepH * (h - 4.0));
color.rgb += texture2D(uTexture, vTexCoord + matrixPos).rgb * uMatrix[int(h * 9.0 + w)];
}
}
float alpha = texture2D(uTexture, vTexCoord).a;
gl_FragColor = color;
gl_FragColor.a = alpha;
}`},retrieveShader:function(n){var c=Math.sqrt(this.matrix.length),d=this.type+"_"+c+"_"+(this.opaque?1:0),h=this.fragmentSource[d];return n.programCache.hasOwnProperty(d)||(n.programCache[d]=this.createProgram(n.context,h)),n.programCache[d]},applyTo2d:function(n){var c,d,h,u,_,y,C,x,S,w,E,M,F,H=n.imageData,G=H.data,U=this.matrix,D=Math.round(Math.sqrt(U.length)),I=Math.floor(D/2),N=H.width,W=H.height,X=n.ctx.createImageData(N,W),P=X.data,R=this.opaque?1:0;for(E=0;E<W;E++)for(w=0;w<N;w++){for(_=4*(E*N+w),c=0,d=0,h=0,u=0,F=0;F<D;F++)for(M=0;M<D;M++)y=w+M-I,(C=E+F-I)<0||C>=W||y<0||y>=N||(x=4*(C*N+y),S=U[F*D+M],c+=G[x]*S,d+=G[x+1]*S,h+=G[x+2]*S,R||(u+=G[x+3]*S));P[_]=c,P[_+1]=d,P[_+2]=h,P[_+3]=R?G[_+3]:u}n.imageData=X},getUniformLocations:function(n,c){return{uMatrix:n.getUniformLocation(c,"uMatrix"),uOpaque:n.getUniformLocation(c,"uOpaque"),uHalfSize:n.getUniformLocation(c,"uHalfSize"),uSize:n.getUniformLocation(c,"uSize")}},sendUniformData:function(n,c){n.uniform1fv(c.uMatrix,this.matrix)},toObject:function(){return a(this.callSuper("toObject"),{opaque:this.opaque,matrix:this.matrix})}}),r.Image.filters.Convolute.fromObject=r.Image.filters.BaseFilter.fromObject}(i),function(o){var r=o.fabric||(o.fabric={}),a=r.Image.filters,l=r.util.createClass;a.Grayscale=l(a.BaseFilter,{type:"Grayscale",fragmentSource:{average:`precision highp float;
uniform sampler2D uTexture;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float average = (color.r + color.b + color.g) / 3.0;
gl_FragColor = vec4(average, average, average, color.a);
}`,lightness:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = (max(max(col.r, col.g),col.b) + min(min(col.r, col.g),col.b)) / 2.0;
gl_FragColor = vec4(average, average, average, col.a);
}`,luminosity:`precision highp float;
uniform sampler2D uTexture;
uniform int uMode;
varying vec2 vTexCoord;
void main() {
vec4 col = texture2D(uTexture, vTexCoord);
float average = 0.21 * col.r + 0.72 * col.g + 0.07 * col.b;
gl_FragColor = vec4(average, average, average, col.a);
}`},mode:"average",mainParameter:"mode",applyTo2d:function(t){var n,c,d=t.imageData.data,h=d.length,u=this.mode;for(n=0;n<h;n+=4)u==="average"?c=(d[n]+d[n+1]+d[n+2])/3:u==="lightness"?c=(Math.min(d[n],d[n+1],d[n+2])+Math.max(d[n],d[n+1],d[n+2]))/2:u==="luminosity"&&(c=.21*d[n]+.72*d[n+1]+.07*d[n+2]),d[n]=c,d[n+1]=c,d[n+2]=c},retrieveShader:function(t){var n=this.type+"_"+this.mode;if(!t.programCache.hasOwnProperty(n)){var c=this.fragmentSource[this.mode];t.programCache[n]=this.createProgram(t.context,c)}return t.programCache[n]},getUniformLocations:function(t,n){return{uMode:t.getUniformLocation(n,"uMode")}},sendUniformData:function(t,n){t.uniform1i(n.uMode,1)},isNeutralState:function(){return!1}}),r.Image.filters.Grayscale.fromObject=r.Image.filters.BaseFilter.fromObject}(i),function(o){var r=o.fabric||(o.fabric={}),a=r.Image.filters,l=r.util.createClass;a.Invert=l(a.BaseFilter,{type:"Invert",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform int uInvert;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
if (uInvert == 1) {
gl_FragColor = vec4(1.0 - color.r,1.0 -color.g,1.0 -color.b,color.a);
} else {
gl_FragColor = color;
}
}`,invert:!0,mainParameter:"invert",applyTo2d:function(t){var n,c=t.imageData.data,d=c.length;for(n=0;n<d;n+=4)c[n]=255-c[n],c[n+1]=255-c[n+1],c[n+2]=255-c[n+2]},isNeutralState:function(){return!this.invert},getUniformLocations:function(t,n){return{uInvert:t.getUniformLocation(n,"uInvert")}},sendUniformData:function(t,n){t.uniform1i(n.uInvert,this.invert)}}),r.Image.filters.Invert.fromObject=r.Image.filters.BaseFilter.fromObject}(i),function(o){var r=o.fabric||(o.fabric={}),a=r.util.object.extend,l=r.Image.filters,t=r.util.createClass;l.Noise=t(l.BaseFilter,{type:"Noise",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uStepH;
uniform float uNoise;
uniform float uSeed;
varying vec2 vTexCoord;
float rand(vec2 co, float seed, float vScale) {
return fract(sin(dot(co.xy * vScale ,vec2(12.9898 , 78.233))) * 43758.5453 * (seed + 0.01) / 2.0);
}
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
color.rgb += (0.5 - rand(vTexCoord, uSeed, 0.1 / uStepH)) * uNoise;
gl_FragColor = color;
}`,mainParameter:"noise",noise:0,applyTo2d:function(n){if(this.noise!==0){var c,d,h=n.imageData.data,u=h.length,_=this.noise;for(c=0,u=h.length;c<u;c+=4)d=(.5-Math.random())*_,h[c]+=d,h[c+1]+=d,h[c+2]+=d}},getUniformLocations:function(n,c){return{uNoise:n.getUniformLocation(c,"uNoise"),uSeed:n.getUniformLocation(c,"uSeed")}},sendUniformData:function(n,c){n.uniform1f(c.uNoise,this.noise/255),n.uniform1f(c.uSeed,Math.random())},toObject:function(){return a(this.callSuper("toObject"),{noise:this.noise})}}),r.Image.filters.Noise.fromObject=r.Image.filters.BaseFilter.fromObject}(i),function(o){var r=o.fabric||(o.fabric={}),a=r.Image.filters,l=r.util.createClass;a.Pixelate=l(a.BaseFilter,{type:"Pixelate",blocksize:4,mainParameter:"blocksize",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uBlocksize;
uniform float uStepW;
uniform float uStepH;
varying vec2 vTexCoord;
void main() {
float blockW = uBlocksize * uStepW;
float blockH = uBlocksize * uStepW;
int posX = int(vTexCoord.x / blockW);
int posY = int(vTexCoord.y / blockH);
float fposX = float(posX);
float fposY = float(posY);
vec2 squareCoords = vec2(fposX * blockW, fposY * blockH);
vec4 color = texture2D(uTexture, squareCoords);
gl_FragColor = color;
}`,applyTo2d:function(t){var n,c,d,h,u,_,y,C,x,S,w,E=t.imageData,M=E.data,F=E.height,H=E.width;for(c=0;c<F;c+=this.blocksize)for(d=0;d<H;d+=this.blocksize)for(h=M[n=4*c*H+4*d],u=M[n+1],_=M[n+2],y=M[n+3],S=Math.min(c+this.blocksize,F),w=Math.min(d+this.blocksize,H),C=c;C<S;C++)for(x=d;x<w;x++)M[n=4*C*H+4*x]=h,M[n+1]=u,M[n+2]=_,M[n+3]=y},isNeutralState:function(){return this.blocksize===1},getUniformLocations:function(t,n){return{uBlocksize:t.getUniformLocation(n,"uBlocksize"),uStepW:t.getUniformLocation(n,"uStepW"),uStepH:t.getUniformLocation(n,"uStepH")}},sendUniformData:function(t,n){t.uniform1f(n.uBlocksize,this.blocksize)}}),r.Image.filters.Pixelate.fromObject=r.Image.filters.BaseFilter.fromObject}(i),function(o){var r=o.fabric||(o.fabric={}),a=r.util.object.extend,l=r.Image.filters,t=r.util.createClass;l.RemoveColor=t(l.BaseFilter,{type:"RemoveColor",color:"#FFFFFF",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uLow;
uniform vec4 uHigh;
varying vec2 vTexCoord;
void main() {
gl_FragColor = texture2D(uTexture, vTexCoord);
if(all(greaterThan(gl_FragColor.rgb,uLow.rgb)) && all(greaterThan(uHigh.rgb,gl_FragColor.rgb))) {
gl_FragColor.a = 0.0;
}
}`,distance:.02,useAlpha:!1,applyTo2d:function(n){var c,d,h,u,_=n.imageData.data,y=255*this.distance,C=new r.Color(this.color).getSource(),x=[C[0]-y,C[1]-y,C[2]-y],S=[C[0]+y,C[1]+y,C[2]+y];for(c=0;c<_.length;c+=4)d=_[c],h=_[c+1],u=_[c+2],d>x[0]&&h>x[1]&&u>x[2]&&d<S[0]&&h<S[1]&&u<S[2]&&(_[c+3]=0)},getUniformLocations:function(n,c){return{uLow:n.getUniformLocation(c,"uLow"),uHigh:n.getUniformLocation(c,"uHigh")}},sendUniformData:function(n,c){var d=new r.Color(this.color).getSource(),h=parseFloat(this.distance),u=[0+d[0]/255-h,0+d[1]/255-h,0+d[2]/255-h,1],_=[d[0]/255+h,d[1]/255+h,d[2]/255+h,1];n.uniform4fv(c.uLow,u),n.uniform4fv(c.uHigh,_)},toObject:function(){return a(this.callSuper("toObject"),{color:this.color,distance:this.distance})}}),r.Image.filters.RemoveColor.fromObject=r.Image.filters.BaseFilter.fromObject}(i),function(o){var r=o.fabric||(o.fabric={}),a=r.Image.filters,l=r.util.createClass,t={Brownie:[.5997,.34553,-.27082,0,.186,-.0377,.86095,.15059,0,-.1449,.24113,-.07441,.44972,0,-.02965,0,0,0,1,0],Vintage:[.62793,.32021,-.03965,0,.03784,.02578,.64411,.03259,0,.02926,.0466,-.08512,.52416,0,.02023,0,0,0,1,0],Kodachrome:[1.12855,-.39673,-.03992,0,.24991,-.16404,1.08352,-.05498,0,.09698,-.16786,-.56034,1.60148,0,.13972,0,0,0,1,0],Technicolor:[1.91252,-.85453,-.09155,0,.04624,-.30878,1.76589,-.10601,0,-.27589,-.2311,-.75018,1.84759,0,.12137,0,0,0,1,0],Polaroid:[1.438,-.062,-.062,0,0,-.122,1.378,-.122,0,0,-.016,-.016,1.483,0,0,0,0,0,1,0],Sepia:[.393,.769,.189,0,0,.349,.686,.168,0,0,.272,.534,.131,0,0,0,0,0,1,0],BlackWhite:[1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,1.5,1.5,1.5,0,-1,0,0,0,1,0]};for(var n in t)a[n]=l(a.ColorMatrix,{type:n,matrix:t[n],mainParameter:!1,colorsOnly:!0}),r.Image.filters[n].fromObject=r.Image.filters.BaseFilter.fromObject}(i),function(o){var r=o.fabric,a=r.Image.filters,l=r.util.createClass;a.BlendColor=l(a.BaseFilter,{type:"BlendColor",color:"#F95C63",mode:"multiply",alpha:1,fragmentSource:{multiply:`gl_FragColor.rgb *= uColor.rgb;
`,screen:`gl_FragColor.rgb = 1.0 - (1.0 - gl_FragColor.rgb) * (1.0 - uColor.rgb);
`,add:`gl_FragColor.rgb += uColor.rgb;
`,diff:`gl_FragColor.rgb = abs(gl_FragColor.rgb - uColor.rgb);
`,subtract:`gl_FragColor.rgb -= uColor.rgb;
`,lighten:`gl_FragColor.rgb = max(gl_FragColor.rgb, uColor.rgb);
`,darken:`gl_FragColor.rgb = min(gl_FragColor.rgb, uColor.rgb);
`,exclusion:`gl_FragColor.rgb += uColor.rgb - 2.0 * (uColor.rgb * gl_FragColor.rgb);
`,overlay:`if (uColor.r < 0.5) {
gl_FragColor.r *= 2.0 * uColor.r;
} else {
gl_FragColor.r = 1.0 - 2.0 * (1.0 - gl_FragColor.r) * (1.0 - uColor.r);
}
if (uColor.g < 0.5) {
gl_FragColor.g *= 2.0 * uColor.g;
} else {
gl_FragColor.g = 1.0 - 2.0 * (1.0 - gl_FragColor.g) * (1.0 - uColor.g);
}
if (uColor.b < 0.5) {
gl_FragColor.b *= 2.0 * uColor.b;
} else {
gl_FragColor.b = 1.0 - 2.0 * (1.0 - gl_FragColor.b) * (1.0 - uColor.b);
}
`,tint:`gl_FragColor.rgb *= (1.0 - uColor.a);
gl_FragColor.rgb += uColor.rgb;
`},buildSource:function(t){return`precision highp float;
uniform sampler2D uTexture;
uniform vec4 uColor;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
gl_FragColor = color;
if (color.a > 0.0) {
`+this.fragmentSource[t]+`}
}`},retrieveShader:function(t){var n,c=this.type+"_"+this.mode;return t.programCache.hasOwnProperty(c)||(n=this.buildSource(this.mode),t.programCache[c]=this.createProgram(t.context,n)),t.programCache[c]},applyTo2d:function(t){var n,c,d,h,u,_,y,C=t.imageData.data,x=C.length,S=1-this.alpha;n=(y=new r.Color(this.color).getSource())[0]*this.alpha,c=y[1]*this.alpha,d=y[2]*this.alpha;for(var w=0;w<x;w+=4)switch(h=C[w],u=C[w+1],_=C[w+2],this.mode){case"multiply":C[w]=h*n/255,C[w+1]=u*c/255,C[w+2]=_*d/255;break;case"screen":C[w]=255-(255-h)*(255-n)/255,C[w+1]=255-(255-u)*(255-c)/255,C[w+2]=255-(255-_)*(255-d)/255;break;case"add":C[w]=h+n,C[w+1]=u+c,C[w+2]=_+d;break;case"diff":case"difference":C[w]=Math.abs(h-n),C[w+1]=Math.abs(u-c),C[w+2]=Math.abs(_-d);break;case"subtract":C[w]=h-n,C[w+1]=u-c,C[w+2]=_-d;break;case"darken":C[w]=Math.min(h,n),C[w+1]=Math.min(u,c),C[w+2]=Math.min(_,d);break;case"lighten":C[w]=Math.max(h,n),C[w+1]=Math.max(u,c),C[w+2]=Math.max(_,d);break;case"overlay":C[w]=n<128?2*h*n/255:255-2*(255-h)*(255-n)/255,C[w+1]=c<128?2*u*c/255:255-2*(255-u)*(255-c)/255,C[w+2]=d<128?2*_*d/255:255-2*(255-_)*(255-d)/255;break;case"exclusion":C[w]=n+h-2*n*h/255,C[w+1]=c+u-2*c*u/255,C[w+2]=d+_-2*d*_/255;break;case"tint":C[w]=n+h*S,C[w+1]=c+u*S,C[w+2]=d+_*S}},getUniformLocations:function(t,n){return{uColor:t.getUniformLocation(n,"uColor")}},sendUniformData:function(t,n){var c=new r.Color(this.color).getSource();c[0]=this.alpha*c[0]/255,c[1]=this.alpha*c[1]/255,c[2]=this.alpha*c[2]/255,c[3]=this.alpha,t.uniform4fv(n.uColor,c)},toObject:function(){return{type:this.type,color:this.color,mode:this.mode,alpha:this.alpha}}}),r.Image.filters.BlendColor.fromObject=r.Image.filters.BaseFilter.fromObject}(i),function(o){var r=o.fabric,a=r.Image.filters,l=r.util.createClass;a.BlendImage=l(a.BaseFilter,{type:"BlendImage",image:null,mode:"multiply",alpha:1,vertexSource:`attribute vec2 aPosition;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
uniform mat3 uTransformMatrix;
void main() {
vTexCoord = aPosition;
vTexCoord2 = (uTransformMatrix * vec3(aPosition, 1.0)).xy;
gl_Position = vec4(aPosition * 2.0 - 1.0, 0.0, 1.0);
}`,fragmentSource:{multiply:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.rgba *= color2.rgba;
gl_FragColor = color;
}`,mask:`precision highp float;
uniform sampler2D uTexture;
uniform sampler2D uImage;
uniform vec4 uColor;
varying vec2 vTexCoord;
varying vec2 vTexCoord2;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec4 color2 = texture2D(uImage, vTexCoord2);
color.a = color2.a;
gl_FragColor = color;
}`},retrieveShader:function(t){var n=this.type+"_"+this.mode,c=this.fragmentSource[this.mode];return t.programCache.hasOwnProperty(n)||(t.programCache[n]=this.createProgram(t.context,c)),t.programCache[n]},applyToWebGL:function(t){var n=t.context,c=this.createTexture(t.filterBackend,this.image);this.bindAdditionalTexture(n,c,n.TEXTURE1),this.callSuper("applyToWebGL",t),this.unbindAdditionalTexture(n,n.TEXTURE1)},createTexture:function(t,n){return t.getCachedTexture(n.cacheKey,n._element)},calculateMatrix:function(){var t=this.image,n=t._element.width,c=t._element.height;return[1/t.scaleX,0,0,0,1/t.scaleY,0,-t.left/n,-t.top/c,1]},applyTo2d:function(t){var n,c,d,h,u,_,y,C,x,S,w,E=t.imageData,M=t.filterBackend.resources,F=E.data,H=F.length,G=E.width,U=E.height,D=this.image;M.blendImage||(M.blendImage=r.util.createCanvasElement()),S=(x=M.blendImage).getContext("2d"),x.width!==G||x.height!==U?(x.width=G,x.height=U):S.clearRect(0,0,G,U),S.setTransform(D.scaleX,0,0,D.scaleY,D.left,D.top),S.drawImage(D._element,0,0,G,U),w=S.getImageData(0,0,G,U).data;for(var I=0;I<H;I+=4)switch(u=F[I],_=F[I+1],y=F[I+2],C=F[I+3],n=w[I],c=w[I+1],d=w[I+2],h=w[I+3],this.mode){case"multiply":F[I]=u*n/255,F[I+1]=_*c/255,F[I+2]=y*d/255,F[I+3]=C*h/255;break;case"mask":F[I+3]=h}},getUniformLocations:function(t,n){return{uTransformMatrix:t.getUniformLocation(n,"uTransformMatrix"),uImage:t.getUniformLocation(n,"uImage")}},sendUniformData:function(t,n){var c=this.calculateMatrix();t.uniform1i(n.uImage,1),t.uniformMatrix3fv(n.uTransformMatrix,!1,c)},toObject:function(){return{type:this.type,image:this.image&&this.image.toObject(),mode:this.mode,alpha:this.alpha}}}),r.Image.filters.BlendImage.fromObject=function(t,n){r.Image.fromObject(t.image,function(c){var d=r.util.object.clone(t);d.image=c,n(new r.Image.filters.BlendImage(d))})}}(i),function(o){var r=o.fabric||(o.fabric={}),a=Math.pow,l=Math.floor,t=Math.sqrt,n=Math.abs,c=Math.round,d=Math.sin,h=Math.ceil,u=r.Image.filters,_=r.util.createClass;u.Resize=_(u.BaseFilter,{type:"Resize",resizeType:"hermite",scaleX:1,scaleY:1,lanczosLobes:3,getUniformLocations:function(y,C){return{uDelta:y.getUniformLocation(C,"uDelta"),uTaps:y.getUniformLocation(C,"uTaps")}},sendUniformData:function(y,C){y.uniform2fv(C.uDelta,this.horizontal?[1/this.width,0]:[0,1/this.height]),y.uniform1fv(C.uTaps,this.taps)},retrieveShader:function(y){var C=this.getFilterWindow(),x=this.type+"_"+C;if(!y.programCache.hasOwnProperty(x)){var S=this.generateShader(C);y.programCache[x]=this.createProgram(y.context,S)}return y.programCache[x]},getFilterWindow:function(){var y=this.tempScale;return Math.ceil(this.lanczosLobes/y)},getTaps:function(){for(var y=this.lanczosCreate(this.lanczosLobes),C=this.tempScale,x=this.getFilterWindow(),S=new Array(x),w=1;w<=x;w++)S[w-1]=y(w*C);return S},generateShader:function(y){for(var C=new Array(y),x=this.fragmentSourceTOP,S=1;S<=y;S++)C[S-1]=S+".0 * uDelta";return x+="uniform float uTaps["+y+`];
`,x+=`void main() {
`,x+=`  vec4 color = texture2D(uTexture, vTexCoord);
`,x+=`  float sum = 1.0;
`,C.forEach(function(w,E){x+="  color += texture2D(uTexture, vTexCoord + "+w+") * uTaps["+E+`];
`,x+="  color += texture2D(uTexture, vTexCoord - "+w+") * uTaps["+E+`];
`,x+="  sum += 2.0 * uTaps["+E+`];
`}),x+=`  gl_FragColor = color / sum;
`,x+="}"},fragmentSourceTOP:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
`,applyTo:function(y){y.webgl?(y.passes++,this.width=y.sourceWidth,this.horizontal=!0,this.dW=Math.round(this.width*this.scaleX),this.dH=y.sourceHeight,this.tempScale=this.dW/this.width,this.taps=this.getTaps(),y.destinationWidth=this.dW,this._setupFrameBuffer(y),this.applyToWebGL(y),this._swapTextures(y),y.sourceWidth=y.destinationWidth,this.height=y.sourceHeight,this.horizontal=!1,this.dH=Math.round(this.height*this.scaleY),this.tempScale=this.dH/this.height,this.taps=this.getTaps(),y.destinationHeight=this.dH,this._setupFrameBuffer(y),this.applyToWebGL(y),this._swapTextures(y),y.sourceHeight=y.destinationHeight):this.applyTo2d(y)},isNeutralState:function(){return this.scaleX===1&&this.scaleY===1},lanczosCreate:function(y){return function(C){if(C>=y||C<=-y)return 0;if(C<11920929e-14&&C>-11920929e-14)return 1;var x=(C*=Math.PI)/y;return d(C)/C*d(x)/x}},applyTo2d:function(y){var C=y.imageData,x=this.scaleX,S=this.scaleY;this.rcpScaleX=1/x,this.rcpScaleY=1/S;var w,E=C.width,M=C.height,F=c(E*x),H=c(M*S);this.resizeType==="sliceHack"?w=this.sliceByTwo(y,E,M,F,H):this.resizeType==="hermite"?w=this.hermiteFastResize(y,E,M,F,H):this.resizeType==="bilinear"?w=this.bilinearFiltering(y,E,M,F,H):this.resizeType==="lanczos"&&(w=this.lanczosResize(y,E,M,F,H)),y.imageData=w},sliceByTwo:function(y,C,x,S,w){var E,M,F=y.imageData,H=.5,G=!1,U=!1,D=C*H,I=x*H,N=r.filterBackend.resources,W=0,X=0,P=C,R=0;for(N.sliceByTwo||(N.sliceByTwo=document.createElement("canvas")),((E=N.sliceByTwo).width<1.5*C||E.height<x)&&(E.width=1.5*C,E.height=x),(M=E.getContext("2d")).clearRect(0,0,1.5*C,x),M.putImageData(F,0,0),S=l(S),w=l(w);!G||!U;)C=D,x=I,S<l(D*H)?D=l(D*H):(D=S,G=!0),w<l(I*H)?I=l(I*H):(I=w,U=!0),M.drawImage(E,W,X,C,x,P,R,D,I),W=P,X=R,R+=I;return M.getImageData(W,X,S,w)},lanczosResize:function(y,C,x,S,w){var E=y.imageData.data,M=y.ctx.createImageData(S,w),F=M.data,H=this.lanczosCreate(this.lanczosLobes),G=this.rcpScaleX,U=this.rcpScaleY,D=2/this.rcpScaleX,I=2/this.rcpScaleY,N=h(G*this.lanczosLobes/2),W=h(U*this.lanczosLobes/2),X={},P={},R={};return function j(z){var V,$,te,J,q,ee,Q,re,se,ne,ue;for(P.x=(z+.5)*G,R.x=l(P.x),V=0;V<w;V++){for(P.y=(V+.5)*U,R.y=l(P.y),q=0,ee=0,Q=0,re=0,se=0,$=R.x-N;$<=R.x+N;$++)if(!($<0||$>=C)){ne=l(1e3*n($-P.x)),X[ne]||(X[ne]={});for(var pe=R.y-W;pe<=R.y+W;pe++)pe<0||pe>=x||(ue=l(1e3*n(pe-P.y)),X[ne][ue]||(X[ne][ue]=H(t(a(ne*D,2)+a(ue*I,2))/1e3)),(te=X[ne][ue])>0&&(q+=te,ee+=te*E[J=4*(pe*C+$)],Q+=te*E[J+1],re+=te*E[J+2],se+=te*E[J+3]))}F[J=4*(V*S+z)]=ee/q,F[J+1]=Q/q,F[J+2]=re/q,F[J+3]=se/q}return++z<S?j(z):M}(0)},bilinearFiltering:function(y,C,x,S,w){var E,M,F,H,G,U,D,I,N,W=0,X=this.rcpScaleX,P=this.rcpScaleY,R=4*(C-1),j=y.imageData.data,z=y.ctx.createImageData(S,w),V=z.data;for(F=0;F<w;F++)for(H=0;H<S;H++)for(G=X*H-(E=l(X*H)),U=P*F-(M=l(P*F)),N=4*(M*C+E),D=0;D<4;D++)I=j[N+D]*(1-G)*(1-U)+j[N+4+D]*G*(1-U)+j[N+R+D]*U*(1-G)+j[N+R+4+D]*G*U,V[W++]=I;return z},hermiteFastResize:function(y,C,x,S,w){for(var E=this.rcpScaleX,M=this.rcpScaleY,F=h(E/2),H=h(M/2),G=y.imageData.data,U=y.ctx.createImageData(S,w),D=U.data,I=0;I<w;I++)for(var N=0;N<S;N++){for(var W=4*(N+I*S),X=0,P=0,R=0,j=0,z=0,V=0,$=0,te=(I+.5)*M,J=l(I*M);J<(I+1)*M;J++)for(var q=n(te-(J+.5))/H,ee=(N+.5)*E,Q=q*q,re=l(N*E);re<(N+1)*E;re++){var se=n(ee-(re+.5))/F,ne=t(Q+se*se);ne>1&&ne<-1||(X=2*ne*ne*ne-3*ne*ne+1)>0&&($+=X*G[3+(se=4*(re+J*C))],R+=X,G[se+3]<255&&(X=X*G[se+3]/250),j+=X*G[se],z+=X*G[se+1],V+=X*G[se+2],P+=X)}D[W]=j/P,D[W+1]=z/P,D[W+2]=V/P,D[W+3]=$/R}return U},toObject:function(){return{type:this.type,scaleX:this.scaleX,scaleY:this.scaleY,resizeType:this.resizeType,lanczosLobes:this.lanczosLobes}}}),r.Image.filters.Resize.fromObject=r.Image.filters.BaseFilter.fromObject}(i),function(o){var r=o.fabric||(o.fabric={}),a=r.Image.filters,l=r.util.createClass;a.Contrast=l(a.BaseFilter,{type:"Contrast",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uContrast;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float contrastF = 1.015 * (uContrast + 1.0) / (1.0 * (1.015 - uContrast));
color.rgb = contrastF * (color.rgb - 0.5) + 0.5;
gl_FragColor = color;
}`,contrast:0,mainParameter:"contrast",applyTo2d:function(t){if(this.contrast!==0){var n,c=t.imageData.data,d=c.length,h=Math.floor(255*this.contrast),u=259*(h+255)/(255*(259-h));for(n=0;n<d;n+=4)c[n]=u*(c[n]-128)+128,c[n+1]=u*(c[n+1]-128)+128,c[n+2]=u*(c[n+2]-128)+128}},getUniformLocations:function(t,n){return{uContrast:t.getUniformLocation(n,"uContrast")}},sendUniformData:function(t,n){t.uniform1f(n.uContrast,this.contrast)}}),r.Image.filters.Contrast.fromObject=r.Image.filters.BaseFilter.fromObject}(i),function(o){var r=o.fabric||(o.fabric={}),a=r.Image.filters,l=r.util.createClass;a.Saturation=l(a.BaseFilter,{type:"Saturation",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uSaturation;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float rgMax = max(color.r, color.g);
float rgbMax = max(rgMax, color.b);
color.r += rgbMax != color.r ? (rgbMax - color.r) * uSaturation : 0.00;
color.g += rgbMax != color.g ? (rgbMax - color.g) * uSaturation : 0.00;
color.b += rgbMax != color.b ? (rgbMax - color.b) * uSaturation : 0.00;
gl_FragColor = color;
}`,saturation:0,mainParameter:"saturation",applyTo2d:function(t){if(this.saturation!==0){var n,c,d=t.imageData.data,h=d.length,u=-this.saturation;for(n=0;n<h;n+=4)c=Math.max(d[n],d[n+1],d[n+2]),d[n]+=c!==d[n]?(c-d[n])*u:0,d[n+1]+=c!==d[n+1]?(c-d[n+1])*u:0,d[n+2]+=c!==d[n+2]?(c-d[n+2])*u:0}},getUniformLocations:function(t,n){return{uSaturation:t.getUniformLocation(n,"uSaturation")}},sendUniformData:function(t,n){t.uniform1f(n.uSaturation,-this.saturation)}}),r.Image.filters.Saturation.fromObject=r.Image.filters.BaseFilter.fromObject}(i),function(o){var r=o.fabric||(o.fabric={}),a=r.Image.filters,l=r.util.createClass;a.Vibrance=l(a.BaseFilter,{type:"Vibrance",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform float uVibrance;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
float max = max(color.r, max(color.g, color.b));
float avg = (color.r + color.g + color.b) / 3.0;
float amt = (abs(max - avg) * 2.0) * uVibrance;
color.r += max != color.r ? (max - color.r) * amt : 0.00;
color.g += max != color.g ? (max - color.g) * amt : 0.00;
color.b += max != color.b ? (max - color.b) * amt : 0.00;
gl_FragColor = color;
}`,vibrance:0,mainParameter:"vibrance",applyTo2d:function(t){if(this.vibrance!==0){var n,c,d,h,u=t.imageData.data,_=u.length,y=-this.vibrance;for(n=0;n<_;n+=4)c=Math.max(u[n],u[n+1],u[n+2]),d=(u[n]+u[n+1]+u[n+2])/3,h=2*Math.abs(c-d)/255*y,u[n]+=c!==u[n]?(c-u[n])*h:0,u[n+1]+=c!==u[n+1]?(c-u[n+1])*h:0,u[n+2]+=c!==u[n+2]?(c-u[n+2])*h:0}},getUniformLocations:function(t,n){return{uVibrance:t.getUniformLocation(n,"uVibrance")}},sendUniformData:function(t,n){t.uniform1f(n.uVibrance,-this.vibrance)}}),r.Image.filters.Vibrance.fromObject=r.Image.filters.BaseFilter.fromObject}(i),function(o){var r=o.fabric||(o.fabric={}),a=r.Image.filters,l=r.util.createClass;a.Blur=l(a.BaseFilter,{type:"Blur",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec2 uDelta;
varying vec2 vTexCoord;
const float nSamples = 15.0;
vec3 v3offset = vec3(12.9898, 78.233, 151.7182);
float random(vec3 scale) {
return fract(sin(dot(gl_FragCoord.xyz, scale)) * 43758.5453);
}
void main() {
vec4 color = vec4(0.0);
float total = 0.0;
float offset = random(v3offset);
for (float t = -nSamples; t <= nSamples; t++) {
float percent = (t + offset - 0.5) / nSamples;
float weight = 1.0 - abs(percent);
color += texture2D(uTexture, vTexCoord + uDelta * percent) * weight;
total += weight;
}
gl_FragColor = color / total;
}`,blur:0,mainParameter:"blur",applyTo:function(t){t.webgl?(this.aspectRatio=t.sourceWidth/t.sourceHeight,t.passes++,this._setupFrameBuffer(t),this.horizontal=!0,this.applyToWebGL(t),this._swapTextures(t),this._setupFrameBuffer(t),this.horizontal=!1,this.applyToWebGL(t),this._swapTextures(t)):this.applyTo2d(t)},applyTo2d:function(t){t.imageData=this.simpleBlur(t)},simpleBlur:function(t){var n,c,d=t.filterBackend.resources,h=t.imageData.width,u=t.imageData.height;d.blurLayer1||(d.blurLayer1=r.util.createCanvasElement(),d.blurLayer2=r.util.createCanvasElement()),n=d.blurLayer1,c=d.blurLayer2,n.width===h&&n.height===u||(c.width=n.width=h,c.height=n.height=u);var _,y,C,x,S=n.getContext("2d"),w=c.getContext("2d"),E=.06*this.blur*.5;for(S.putImageData(t.imageData,0,0),w.clearRect(0,0,h,u),x=-15;x<=15;x++)C=E*(y=x/15)*h+(_=(Math.random()-.5)/4),w.globalAlpha=1-Math.abs(y),w.drawImage(n,C,_),S.drawImage(c,0,0),w.globalAlpha=1,w.clearRect(0,0,c.width,c.height);for(x=-15;x<=15;x++)C=E*(y=x/15)*u+(_=(Math.random()-.5)/4),w.globalAlpha=1-Math.abs(y),w.drawImage(n,_,C),S.drawImage(c,0,0),w.globalAlpha=1,w.clearRect(0,0,c.width,c.height);t.ctx.drawImage(n,0,0);var M=t.ctx.getImageData(0,0,n.width,n.height);return S.globalAlpha=1,S.clearRect(0,0,n.width,n.height),M},getUniformLocations:function(t,n){return{delta:t.getUniformLocation(n,"uDelta")}},sendUniformData:function(t,n){var c=this.chooseRightDelta();t.uniform2fv(n.delta,c)},chooseRightDelta:function(){var t,n=1,c=[0,0];return this.horizontal?this.aspectRatio>1&&(n=1/this.aspectRatio):this.aspectRatio<1&&(n=this.aspectRatio),t=n*this.blur*.12,this.horizontal?c[0]=t:c[1]=t,c}}),a.Blur.fromObject=r.Image.filters.BaseFilter.fromObject}(i),function(o){var r=o.fabric||(o.fabric={}),a=r.Image.filters,l=r.util.createClass;a.Gamma=l(a.BaseFilter,{type:"Gamma",fragmentSource:`precision highp float;
uniform sampler2D uTexture;
uniform vec3 uGamma;
varying vec2 vTexCoord;
void main() {
vec4 color = texture2D(uTexture, vTexCoord);
vec3 correction = (1.0 / uGamma);
color.r = pow(color.r, correction.r);
color.g = pow(color.g, correction.g);
color.b = pow(color.b, correction.b);
gl_FragColor = color;
gl_FragColor.rgb *= color.a;
}`,gamma:[1,1,1],mainParameter:"gamma",initialize:function(t){this.gamma=[1,1,1],a.BaseFilter.prototype.initialize.call(this,t)},applyTo2d:function(t){var n,c=t.imageData.data,d=this.gamma,h=c.length,u=1/d[0],_=1/d[1],y=1/d[2];for(this.rVals||(this.rVals=new Uint8Array(256),this.gVals=new Uint8Array(256),this.bVals=new Uint8Array(256)),n=0,h=256;n<h;n++)this.rVals[n]=255*Math.pow(n/255,u),this.gVals[n]=255*Math.pow(n/255,_),this.bVals[n]=255*Math.pow(n/255,y);for(n=0,h=c.length;n<h;n+=4)c[n]=this.rVals[c[n]],c[n+1]=this.gVals[c[n+1]],c[n+2]=this.bVals[c[n+2]]},getUniformLocations:function(t,n){return{uGamma:t.getUniformLocation(n,"uGamma")}},sendUniformData:function(t,n){t.uniform3fv(n.uGamma,this.gamma)}}),r.Image.filters.Gamma.fromObject=r.Image.filters.BaseFilter.fromObject}(i),function(o){var r=o.fabric||(o.fabric={}),a=r.Image.filters,l=r.util.createClass;a.Composed=l(a.BaseFilter,{type:"Composed",subFilters:[],initialize:function(t){this.callSuper("initialize",t),this.subFilters=this.subFilters.slice(0)},applyTo:function(t){t.passes+=this.subFilters.length-1,this.subFilters.forEach(function(n){n.applyTo(t)})},toObject:function(){return r.util.object.extend(this.callSuper("toObject"),{subFilters:this.subFilters.map(function(t){return t.toObject()})})},isNeutralState:function(){return!this.subFilters.some(function(t){return!t.isNeutralState()})}}),r.Image.filters.Composed.fromObject=function(t,n){var c=(t.subFilters||[]).map(function(h){return new r.Image.filters[h.type](h)}),d=new r.Image.filters.Composed({subFilters:c});return n&&n(d),d}}(i),function(o){var r=o.fabric||(o.fabric={}),a=r.Image.filters,l=r.util.createClass;a.HueRotation=l(a.ColorMatrix,{type:"HueRotation",rotation:0,mainParameter:"rotation",calculateMatrix:function(){var t=this.rotation*Math.PI,n=r.util.cos(t),c=r.util.sin(t),d=1/3,h=Math.sqrt(d)*c,u=1-n;this.matrix=[1,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,1,0],this.matrix[0]=n+u/3,this.matrix[1]=d*u-h,this.matrix[2]=d*u+h,this.matrix[5]=d*u+h,this.matrix[6]=n+d*u,this.matrix[7]=d*u-h,this.matrix[10]=d*u-h,this.matrix[11]=d*u+h,this.matrix[12]=n+d*u},isNeutralState:function(t){return this.calculateMatrix(),a.BaseFilter.prototype.isNeutralState.call(this,t)},applyTo:function(t){this.calculateMatrix(),a.BaseFilter.prototype.applyTo.call(this,t)}}),r.Image.filters.HueRotation.fromObject=r.Image.filters.BaseFilter.fromObject}(i),function(o){var r=o.fabric||(o.fabric={}),a=r.util.object.clone;if(r.Text)r.warn("fabric.Text is already defined");else{var l="fontFamily fontWeight fontSize text underline overline linethrough textAlign fontStyle lineHeight textBackgroundColor charSpacing styles direction path pathStartOffset pathSide pathAlign".split(" ");r.Text=r.util.createClass(r.Object,{_dimensionAffectingProps:["fontSize","fontWeight","fontFamily","fontStyle","lineHeight","text","charSpacing","textAlign","styles","path","pathStartOffset","pathSide","pathAlign"],_reNewline:/\r?\n/,_reSpacesAndTabs:/[ \t\r]/g,_reSpaceAndTab:/[ \t\r]/,_reWords:/\S+/g,type:"text",fontSize:40,fontWeight:"normal",fontFamily:"Times New Roman",underline:!1,overline:!1,linethrough:!1,textAlign:"left",fontStyle:"normal",lineHeight:1.16,superscript:{size:.6,baseline:-.35},subscript:{size:.6,baseline:.11},textBackgroundColor:"",stateProperties:r.Object.prototype.stateProperties.concat(l),cacheProperties:r.Object.prototype.cacheProperties.concat(l),stroke:null,shadow:null,path:null,pathStartOffset:0,pathSide:"left",pathAlign:"baseline",_fontSizeFraction:.222,offsets:{underline:.1,linethrough:-.315,overline:-.88},_fontSizeMult:1.13,charSpacing:0,styles:null,_measuringContext:null,deltaY:0,direction:"ltr",_styleProperties:["stroke","strokeWidth","fill","fontFamily","fontSize","fontWeight","fontStyle","underline","overline","linethrough","deltaY","textBackgroundColor"],__charBounds:[],CACHE_FONT_SIZE:400,MIN_TEXT_WIDTH:2,initialize:function(t,n){this.styles=n&&n.styles||{},this.text=t,this.__skipDimension=!0,this.callSuper("initialize",n),this.path&&this.setPathInfo(),this.__skipDimension=!1,this.initDimensions(),this.setCoords(),this.setupState({propertySet:"_dimensionAffectingProps"})},setPathInfo:function(){var t=this.path;t&&(t.segmentsInfo=r.util.getPathSegmentsInfo(t.path))},getMeasuringContext:function(){return r._measuringContext||(r._measuringContext=this.canvas&&this.canvas.contextCache||r.util.createCanvasElement().getContext("2d")),r._measuringContext},_splitText:function(){var t=this._splitTextIntoLines(this.text);return this.textLines=t.lines,this._textLines=t.graphemeLines,this._unwrappedTextLines=t._unwrappedLines,this._text=t.graphemeText,t},initDimensions:function(){this.__skipDimension||(this._splitText(),this._clearCache(),this.path?(this.width=this.path.width,this.height=this.path.height):(this.width=this.calcTextWidth()||this.cursorWidth||this.MIN_TEXT_WIDTH,this.height=this.calcTextHeight()),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.saveState({propertySet:"_dimensionAffectingProps"}))},enlargeSpaces:function(){for(var t,n,c,d,h,u,_,y=0,C=this._textLines.length;y<C;y++)if((this.textAlign==="justify"||y!==C-1&&!this.isEndOfWrapping(y))&&(d=0,h=this._textLines[y],(n=this.getLineWidth(y))<this.width&&(_=this.textLines[y].match(this._reSpacesAndTabs)))){c=_.length,t=(this.width-n)/c;for(var x=0,S=h.length;x<=S;x++)u=this.__charBounds[y][x],this._reSpaceAndTab.test(h[x])?(u.width+=t,u.kernedWidth+=t,u.left+=d,d+=t):u.left+=d}},isEndOfWrapping:function(t){return t===this._textLines.length-1},missingNewlineOffset:function(){return 1},toString:function(){return"#<fabric.Text ("+this.complexity()+'): { "text": "'+this.text+'", "fontFamily": "'+this.fontFamily+'" }>'},_getCacheCanvasDimensions:function(){var t=this.callSuper("_getCacheCanvasDimensions"),n=this.fontSize;return t.width+=n*t.zoomX,t.height+=n*t.zoomY,t},_render:function(t){var n=this.path;n&&!n.isNotVisible()&&n._render(t),this._setTextStyles(t),this._renderTextLinesBackground(t),this._renderTextDecoration(t,"underline"),this._renderText(t),this._renderTextDecoration(t,"overline"),this._renderTextDecoration(t,"linethrough")},_renderText:function(t){this.paintFirst==="stroke"?(this._renderTextStroke(t),this._renderTextFill(t)):(this._renderTextFill(t),this._renderTextStroke(t))},_setTextStyles:function(t,n,c){if(t.textBaseline="alphabetical",this.path)switch(this.pathAlign){case"center":t.textBaseline="middle";break;case"ascender":t.textBaseline="top";break;case"descender":t.textBaseline="bottom"}t.font=this._getFontDeclaration(n,c)},calcTextWidth:function(){for(var t=this.getLineWidth(0),n=1,c=this._textLines.length;n<c;n++){var d=this.getLineWidth(n);d>t&&(t=d)}return t},_renderTextLine:function(t,n,c,d,h,u){this._renderChars(t,n,c,d,h,u)},_renderTextLinesBackground:function(t){if(this.textBackgroundColor||this.styleHas("textBackgroundColor")){for(var n,c,d,h,u,_,y,C=t.fillStyle,x=this._getLeftOffset(),S=this._getTopOffset(),w=0,E=0,M=this.path,F=0,H=this._textLines.length;F<H;F++)if(n=this.getHeightOfLine(F),this.textBackgroundColor||this.styleHas("textBackgroundColor",F)){d=this._textLines[F],c=this._getLineLeftOffset(F),E=0,w=0,h=this.getValueOfPropertyAt(F,0,"textBackgroundColor");for(var G=0,U=d.length;G<U;G++)u=this.__charBounds[F][G],_=this.getValueOfPropertyAt(F,G,"textBackgroundColor"),M?(t.save(),t.translate(u.renderLeft,u.renderTop),t.rotate(u.angle),t.fillStyle=_,_&&t.fillRect(-u.width/2,-n/this.lineHeight*(1-this._fontSizeFraction),u.width,n/this.lineHeight),t.restore()):_!==h?(y=x+c+w,this.direction==="rtl"&&(y=this.width-y-E),t.fillStyle=h,h&&t.fillRect(y,S,E,n/this.lineHeight),w=u.left,E=u.width,h=_):E+=u.kernedWidth;_&&!M&&(y=x+c+w,this.direction==="rtl"&&(y=this.width-y-E),t.fillStyle=_,t.fillRect(y,S,E,n/this.lineHeight)),S+=n}else S+=n;t.fillStyle=C,this._removeShadow(t)}},getFontCache:function(t){var n=t.fontFamily.toLowerCase();r.charWidthsCache[n]||(r.charWidthsCache[n]={});var c=r.charWidthsCache[n],d=t.fontStyle.toLowerCase()+"_"+(t.fontWeight+"").toLowerCase();return c[d]||(c[d]={}),c[d]},_measureChar:function(t,n,c,d){var h,u,_,y,C=this.getFontCache(n),x=c+t,S=this._getFontDeclaration(n)===this._getFontDeclaration(d),w=n.fontSize/this.CACHE_FONT_SIZE;if(c&&C[c]!==void 0&&(_=C[c]),C[t]!==void 0&&(y=h=C[t]),S&&C[x]!==void 0&&(y=(u=C[x])-_),h===void 0||_===void 0||u===void 0){var E=this.getMeasuringContext();this._setTextStyles(E,n,!0)}return h===void 0&&(y=h=E.measureText(t).width,C[t]=h),_===void 0&&S&&c&&(_=E.measureText(c).width,C[c]=_),S&&u===void 0&&(u=E.measureText(x).width,C[x]=u,y=u-_),{width:h*w,kernedWidth:y*w}},getHeightOfChar:function(t,n){return this.getValueOfPropertyAt(t,n,"fontSize")},measureLine:function(t){var n=this._measureLine(t);return this.charSpacing!==0&&(n.width-=this._getWidthOfCharSpacing()),n.width<0&&(n.width=0),n},_measureLine:function(t){var n,c,d,h,u,_,y=0,C=this._textLines[t],x=new Array(C.length),S=0,w=this.path,E=this.pathSide==="right";for(this.__charBounds[t]=x,n=0;n<C.length;n++)c=C[n],h=this._getGraphemeBox(c,t,n,d),x[n]=h,y+=h.kernedWidth,d=c;if(x[n]={left:h?h.left+h.width:0,width:0,kernedWidth:0,height:this.fontSize},w){switch(_=w.segmentsInfo[w.segmentsInfo.length-1].length,(u=r.util.getPointOnPath(w.path,0,w.segmentsInfo)).x+=w.pathOffset.x,u.y+=w.pathOffset.y,this.textAlign){case"left":S=E?_-y:0;break;case"center":S=(_-y)/2;break;case"right":S=E?0:_-y}for(S+=this.pathStartOffset*(E?-1:1),n=E?C.length-1:0;E?n>=0:n<C.length;E?n--:n++)h=x[n],S>_?S%=_:S<0&&(S+=_),this._setGraphemeOnPath(S,h,u),S+=h.kernedWidth}return{width:y,numOfSpaces:0}},_setGraphemeOnPath:function(t,n,c){var d=t+n.kernedWidth/2,h=this.path,u=r.util.getPointOnPath(h.path,d,h.segmentsInfo);n.renderLeft=u.x-c.x,n.renderTop=u.y-c.y,n.angle=u.angle+(this.pathSide==="right"?Math.PI:0)},_getGraphemeBox:function(t,n,c,d,h){var u,_=this.getCompleteStyleDeclaration(n,c),y=d?this.getCompleteStyleDeclaration(n,c-1):{},C=this._measureChar(t,_,d,y),x=C.kernedWidth,S=C.width;this.charSpacing!==0&&(S+=u=this._getWidthOfCharSpacing(),x+=u);var w={width:S,left:0,height:_.fontSize,kernedWidth:x,deltaY:_.deltaY};if(c>0&&!h){var E=this.__charBounds[n][c-1];w.left=E.left+E.width+C.kernedWidth-C.width}return w},getHeightOfLine:function(t){if(this.__lineHeights[t])return this.__lineHeights[t];for(var n=this._textLines[t],c=this.getHeightOfChar(t,0),d=1,h=n.length;d<h;d++)c=Math.max(this.getHeightOfChar(t,d),c);return this.__lineHeights[t]=c*this.lineHeight*this._fontSizeMult},calcTextHeight:function(){for(var t,n=0,c=0,d=this._textLines.length;c<d;c++)t=this.getHeightOfLine(c),n+=c===d-1?t/this.lineHeight:t;return n},_getLeftOffset:function(){return this.direction==="ltr"?-this.width/2:this.width/2},_getTopOffset:function(){return-this.height/2},_renderTextCommon:function(t,n){t.save();for(var c=0,d=this._getLeftOffset(),h=this._getTopOffset(),u=0,_=this._textLines.length;u<_;u++){var y=this.getHeightOfLine(u),C=y/this.lineHeight,x=this._getLineLeftOffset(u);this._renderTextLine(n,t,this._textLines[u],d+x,h+c+C,u),c+=y}t.restore()},_renderTextFill:function(t){(this.fill||this.styleHas("fill"))&&this._renderTextCommon(t,"fillText")},_renderTextStroke:function(t){(this.stroke&&this.strokeWidth!==0||!this.isEmptyStyles())&&(this.shadow&&!this.shadow.affectStroke&&this._removeShadow(t),t.save(),this._setLineDash(t,this.strokeDashArray),t.beginPath(),this._renderTextCommon(t,"strokeText"),t.closePath(),t.restore())},_renderChars:function(t,n,c,d,h,u){var _,y,C,x,S,w=this.getHeightOfLine(u),E=this.textAlign.indexOf("justify")!==-1,M="",F=0,H=this.path,G=!E&&this.charSpacing===0&&this.isEmptyStyles(u)&&!H,U=this.direction==="ltr",D=this.direction==="ltr"?1:-1,I=n.canvas.getAttribute("dir");if(n.save(),I!==this.direction&&(n.canvas.setAttribute("dir",U?"ltr":"rtl"),n.direction=U?"ltr":"rtl",n.textAlign=U?"left":"right"),h-=w*this._fontSizeFraction/this.lineHeight,G)return this._renderChar(t,n,u,0,c.join(""),d,h,w),void n.restore();for(var N=0,W=c.length-1;N<=W;N++)x=N===W||this.charSpacing||H,M+=c[N],C=this.__charBounds[u][N],F===0?(d+=D*(C.kernedWidth-C.width),F+=C.width):F+=C.kernedWidth,E&&!x&&this._reSpaceAndTab.test(c[N])&&(x=!0),x||(_=_||this.getCompleteStyleDeclaration(u,N),y=this.getCompleteStyleDeclaration(u,N+1),x=this._hasStyleChanged(_,y)),x&&(H?(n.save(),n.translate(C.renderLeft,C.renderTop),n.rotate(C.angle),this._renderChar(t,n,u,N,M,-F/2,0,w),n.restore()):(S=d,this._renderChar(t,n,u,N,M,S,h,w)),M="",_=y,d+=D*F,F=0);n.restore()},_applyPatternGradientTransformText:function(t){var n,c=r.util.createCanvasElement(),d=this.width+this.strokeWidth,h=this.height+this.strokeWidth;return c.width=d,c.height=h,(n=c.getContext("2d")).beginPath(),n.moveTo(0,0),n.lineTo(d,0),n.lineTo(d,h),n.lineTo(0,h),n.closePath(),n.translate(d/2,h/2),n.fillStyle=t.toLive(n),this._applyPatternGradientTransform(n,t),n.fill(),n.createPattern(c,"no-repeat")},handleFiller:function(t,n,c){var d,h;return c.toLive?c.gradientUnits==="percentage"||c.gradientTransform||c.patternTransform?(d=-this.width/2,h=-this.height/2,t.translate(d,h),t[n]=this._applyPatternGradientTransformText(c),{offsetX:d,offsetY:h}):(t[n]=c.toLive(t,this),this._applyPatternGradientTransform(t,c)):(t[n]=c,{offsetX:0,offsetY:0})},_setStrokeStyles:function(t,n){return t.lineWidth=n.strokeWidth,t.lineCap=this.strokeLineCap,t.lineDashOffset=this.strokeDashOffset,t.lineJoin=this.strokeLineJoin,t.miterLimit=this.strokeMiterLimit,this.handleFiller(t,"strokeStyle",n.stroke)},_setFillStyles:function(t,n){return this.handleFiller(t,"fillStyle",n.fill)},_renderChar:function(t,n,c,d,h,u,_){var y,C,x=this._getStyleDeclaration(c,d),S=this.getCompleteStyleDeclaration(c,d),w=t==="fillText"&&S.fill,E=t==="strokeText"&&S.stroke&&S.strokeWidth;(E||w)&&(n.save(),w&&(y=this._setFillStyles(n,S)),E&&(C=this._setStrokeStyles(n,S)),n.font=this._getFontDeclaration(S),x&&x.textBackgroundColor&&this._removeShadow(n),x&&x.deltaY&&(_+=x.deltaY),w&&n.fillText(h,u-y.offsetX,_-y.offsetY),E&&n.strokeText(h,u-C.offsetX,_-C.offsetY),n.restore())},setSuperscript:function(t,n){return this._setScript(t,n,this.superscript)},setSubscript:function(t,n){return this._setScript(t,n,this.subscript)},_setScript:function(t,n,c){var d=this.get2DCursorLocation(t,!0),h=this.getValueOfPropertyAt(d.lineIndex,d.charIndex,"fontSize"),u=this.getValueOfPropertyAt(d.lineIndex,d.charIndex,"deltaY"),_={fontSize:h*c.size,deltaY:u+h*c.baseline};return this.setSelectionStyles(_,t,n),this},_hasStyleChanged:function(t,n){return t.fill!==n.fill||t.stroke!==n.stroke||t.strokeWidth!==n.strokeWidth||t.fontSize!==n.fontSize||t.fontFamily!==n.fontFamily||t.fontWeight!==n.fontWeight||t.fontStyle!==n.fontStyle||t.deltaY!==n.deltaY},_hasStyleChangedForSvg:function(t,n){return this._hasStyleChanged(t,n)||t.overline!==n.overline||t.underline!==n.underline||t.linethrough!==n.linethrough},_getLineLeftOffset:function(t){var n=this.getLineWidth(t),c=this.width-n,d=this.textAlign,h=this.direction,u=0,_=this.isEndOfWrapping(t);return d==="justify"||d==="justify-center"&&!_||d==="justify-right"&&!_||d==="justify-left"&&!_?0:(d==="center"&&(u=c/2),d==="right"&&(u=c),d==="justify-center"&&(u=c/2),d==="justify-right"&&(u=c),h==="rtl"&&(u-=c),u)},_clearCache:function(){this.__lineWidths=[],this.__lineHeights=[],this.__charBounds=[]},_shouldClearDimensionCache:function(){var t=this._forceClearCache;return t||(t=this.hasStateChanged("_dimensionAffectingProps")),t&&(this.dirty=!0,this._forceClearCache=!1),t},getLineWidth:function(t){if(this.__lineWidths[t]!==void 0)return this.__lineWidths[t];var n=this.measureLine(t).width;return this.__lineWidths[t]=n,n},_getWidthOfCharSpacing:function(){return this.charSpacing!==0?this.fontSize*this.charSpacing/1e3:0},getValueOfPropertyAt:function(t,n,c){var d=this._getStyleDeclaration(t,n);return d&&d[c]!==void 0?d[c]:this[c]},_renderTextDecoration:function(t,n){if(this[n]||this.styleHas(n)){for(var c,d,h,u,_,y,C,x,S,w,E,M,F,H,G,U,D=this._getLeftOffset(),I=this._getTopOffset(),N=this.path,W=this._getWidthOfCharSpacing(),X=this.offsets[n],P=0,R=this._textLines.length;P<R;P++)if(c=this.getHeightOfLine(P),this[n]||this.styleHas(n,P)){C=this._textLines[P],H=c/this.lineHeight,u=this._getLineLeftOffset(P),w=0,E=0,x=this.getValueOfPropertyAt(P,0,n),U=this.getValueOfPropertyAt(P,0,"fill"),S=I+H*(1-this._fontSizeFraction),d=this.getHeightOfChar(P,0),_=this.getValueOfPropertyAt(P,0,"deltaY");for(var j=0,z=C.length;j<z;j++)if(M=this.__charBounds[P][j],F=this.getValueOfPropertyAt(P,j,n),G=this.getValueOfPropertyAt(P,j,"fill"),h=this.getHeightOfChar(P,j),y=this.getValueOfPropertyAt(P,j,"deltaY"),N&&F&&G)t.save(),t.fillStyle=U,t.translate(M.renderLeft,M.renderTop),t.rotate(M.angle),t.fillRect(-M.kernedWidth/2,X*h+y,M.kernedWidth,this.fontSize/15),t.restore();else if((F!==x||G!==U||h!==d||y!==_)&&E>0){var V=D+u+w;this.direction==="rtl"&&(V=this.width-V-E),x&&U&&(t.fillStyle=U,t.fillRect(V,S+X*d+_,E,this.fontSize/15)),w=M.left,E=M.width,x=F,U=G,d=h,_=y}else E+=M.kernedWidth;V=D+u+w,this.direction==="rtl"&&(V=this.width-V-E),t.fillStyle=G,F&&G&&t.fillRect(V,S+X*d+_,E-W,this.fontSize/15),I+=c}else I+=c;this._removeShadow(t)}},_getFontDeclaration:function(t,n){var c=t||this,d=this.fontFamily,h=r.Text.genericFonts.indexOf(d.toLowerCase())>-1,u=d===void 0||d.indexOf("'")>-1||d.indexOf(",")>-1||d.indexOf('"')>-1||h?c.fontFamily:'"'+c.fontFamily+'"';return[r.isLikelyNode?c.fontWeight:c.fontStyle,r.isLikelyNode?c.fontStyle:c.fontWeight,n?this.CACHE_FONT_SIZE+"px":c.fontSize+"px",u].join(" ")},render:function(t){this.visible&&(this.canvas&&this.canvas.skipOffscreen&&!this.group&&!this.isOnScreen()||(this._shouldClearDimensionCache()&&this.initDimensions(),this.callSuper("render",t)))},_splitTextIntoLines:function(t){for(var n=t.split(this._reNewline),c=new Array(n.length),d=[`
`],h=[],u=0;u<n.length;u++)c[u]=r.util.string.graphemeSplit(n[u]),h=h.concat(c[u],d);return h.pop(),{_unwrappedLines:c,lines:n,graphemeText:h,graphemeLines:c}},toObject:function(t){var n=l.concat(t),c=this.callSuper("toObject",n);return c.styles=a(this.styles,!0),c.path&&(c.path=this.path.toObject()),c},set:function(t,n){this.callSuper("set",t,n);var c=!1,d=!1;if(typeof t=="object")for(var h in t)h==="path"&&this.setPathInfo(),c=c||this._dimensionAffectingProps.indexOf(h)!==-1,d=d||h==="path";else c=this._dimensionAffectingProps.indexOf(t)!==-1,d=t==="path";return d&&this.setPathInfo(),c&&(this.initDimensions(),this.setCoords()),this},complexity:function(){return 1}}),r.Text.ATTRIBUTE_NAMES=r.SHARED_ATTRIBUTES.concat("x y dx dy font-family font-style font-weight font-size letter-spacing text-decoration text-anchor".split(" ")),r.Text.DEFAULT_SVG_FONT_SIZE=16,r.Text.fromElement=function(t,n,c){if(!t)return n(null);var d=r.parseAttributes(t,r.Text.ATTRIBUTE_NAMES),h=d.textAnchor||"left";if((c=r.util.object.extend(c?a(c):{},d)).top=c.top||0,c.left=c.left||0,d.textDecoration){var u=d.textDecoration;u.indexOf("underline")!==-1&&(c.underline=!0),u.indexOf("overline")!==-1&&(c.overline=!0),u.indexOf("line-through")!==-1&&(c.linethrough=!0),delete c.textDecoration}"dx"in d&&(c.left+=d.dx),"dy"in d&&(c.top+=d.dy),"fontSize"in c||(c.fontSize=r.Text.DEFAULT_SVG_FONT_SIZE);var _="";"textContent"in t?_=t.textContent:"firstChild"in t&&t.firstChild!==null&&"data"in t.firstChild&&t.firstChild.data!==null&&(_=t.firstChild.data),_=_.replace(/^\s+|\s+$|\n+/g,"").replace(/\s+/g," ");var y=c.strokeWidth;c.strokeWidth=0;var C=new r.Text(_,c),x=C.getScaledHeight()/C.height,S=((C.height+C.strokeWidth)*C.lineHeight-C.height)*x,w=C.getScaledHeight()+S,E=0;h==="center"&&(E=C.getScaledWidth()/2),h==="right"&&(E=C.getScaledWidth()),C.set({left:C.left-E,top:C.top-(w-C.fontSize*(.07+C._fontSizeFraction))/C.lineHeight,strokeWidth:y!==void 0?y:1}),n(C)},r.Text.fromObject=function(t,n){var c=a(t),d=t.path;return delete c.path,r.Object._fromObject("Text",c,function(h){d?r.Object._fromObject("Path",d,function(u){h.set("path",u),n(h)},"path"):n(h)},"text")},r.Text.genericFonts=["sans-serif","serif","cursive","fantasy","monospace"],r.util.createAccessors&&r.util.createAccessors(r.Text)}}(i),v.util.object.extend(v.Text.prototype,{isEmptyStyles:function(o){if(!this.styles||o!==void 0&&!this.styles[o])return!0;var r=o===void 0?this.styles:{line:this.styles[o]};for(var a in r)for(var l in r[a])for(var t in r[a][l])return!1;return!0},styleHas:function(o,r){if(!this.styles||!o||o===""||r!==void 0&&!this.styles[r])return!1;var a=r===void 0?this.styles:{0:this.styles[r]};for(var l in a)for(var t in a[l])if(a[l][t][o]!==void 0)return!0;return!1},cleanStyle:function(o){if(!this.styles||!o||o==="")return!1;var r,a,l=this.styles,t=0,n=!0,c=0;for(var d in l){for(var h in r=0,l[d]){var u;t++,(u=l[d][h]).hasOwnProperty(o)?(a?u[o]!==a&&(n=!1):a=u[o],u[o]===this[o]&&delete u[o]):n=!1,Object.keys(u).length!==0?r++:delete l[d][h]}r===0&&delete l[d]}for(var _=0;_<this._textLines.length;_++)c+=this._textLines[_].length;n&&t===c&&(this[o]=a,this.removeStyle(o))},removeStyle:function(o){if(this.styles&&o&&o!==""){var r,a,l,t=this.styles;for(a in t){for(l in r=t[a])delete r[l][o],Object.keys(r[l]).length===0&&delete r[l];Object.keys(r).length===0&&delete t[a]}}},_extendStyles:function(o,r){var a=this.get2DCursorLocation(o);this._getLineStyle(a.lineIndex)||this._setLineStyle(a.lineIndex),this._getStyleDeclaration(a.lineIndex,a.charIndex)||this._setStyleDeclaration(a.lineIndex,a.charIndex,{}),v.util.object.extend(this._getStyleDeclaration(a.lineIndex,a.charIndex),r)},get2DCursorLocation:function(o,r){o===void 0&&(o=this.selectionStart);for(var a=r?this._unwrappedTextLines:this._textLines,l=a.length,t=0;t<l;t++){if(o<=a[t].length)return{lineIndex:t,charIndex:o};o-=a[t].length+this.missingNewlineOffset(t)}return{lineIndex:t-1,charIndex:a[t-1].length<o?a[t-1].length:o}},getSelectionStyles:function(o,r,a){o===void 0&&(o=this.selectionStart||0),r===void 0&&(r=this.selectionEnd||o);for(var l=[],t=o;t<r;t++)l.push(this.getStyleAtPosition(t,a));return l},getStyleAtPosition:function(o,r){var a=this.get2DCursorLocation(o);return(r?this.getCompleteStyleDeclaration(a.lineIndex,a.charIndex):this._getStyleDeclaration(a.lineIndex,a.charIndex))||{}},setSelectionStyles:function(o,r,a){r===void 0&&(r=this.selectionStart||0),a===void 0&&(a=this.selectionEnd||r);for(var l=r;l<a;l++)this._extendStyles(l,o);return this._forceClearCache=!0,this},_getStyleDeclaration:function(o,r){var a=this.styles&&this.styles[o];return a?a[r]:null},getCompleteStyleDeclaration:function(o,r){for(var a,l=this._getStyleDeclaration(o,r)||{},t={},n=0;n<this._styleProperties.length;n++)t[a=this._styleProperties[n]]=l[a]===void 0?this[a]:l[a];return t},_setStyleDeclaration:function(o,r,a){this.styles[o][r]=a},_deleteStyleDeclaration:function(o,r){delete this.styles[o][r]},_getLineStyle:function(o){return!!this.styles[o]},_setLineStyle:function(o){this.styles[o]={}},_deleteLineStyle:function(o){delete this.styles[o]}}),function(){function o(r){r.textDecoration&&(r.textDecoration.indexOf("underline")>-1&&(r.underline=!0),r.textDecoration.indexOf("line-through")>-1&&(r.linethrough=!0),r.textDecoration.indexOf("overline")>-1&&(r.overline=!0),delete r.textDecoration)}v.IText=v.util.createClass(v.Text,v.Observable,{type:"i-text",selectionStart:0,selectionEnd:0,selectionColor:"rgba(17,119,255,0.3)",isEditing:!1,editable:!0,editingBorderColor:"rgba(102,153,255,0.25)",cursorWidth:2,cursorColor:"",cursorDelay:1e3,cursorDuration:600,caching:!0,hiddenTextareaContainer:null,_reSpace:/\s|\n/,_currentCursorOpacity:0,_selectionDirection:null,_abortCursorAnimation:!1,__widthOfSpace:[],inCompositionMode:!1,initialize:function(r,a){this.callSuper("initialize",r,a),this.initBehavior()},setSelectionStart:function(r){r=Math.max(r,0),this._updateAndFire("selectionStart",r)},setSelectionEnd:function(r){r=Math.min(r,this.text.length),this._updateAndFire("selectionEnd",r)},_updateAndFire:function(r,a){this[r]!==a&&(this._fireSelectionChanged(),this[r]=a),this._updateTextarea()},_fireSelectionChanged:function(){this.fire("selection:changed"),this.canvas&&this.canvas.fire("text:selection:changed",{target:this})},initDimensions:function(){this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this.callSuper("initDimensions")},render:function(r){this.clearContextTop(),this.callSuper("render",r),this.cursorOffsetCache={},this.renderCursorOrSelection()},_render:function(r){this.callSuper("_render",r)},clearContextTop:function(r){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var a=this.canvas.contextTop,l=this.canvas.viewportTransform;a.save(),a.transform(l[0],l[1],l[2],l[3],l[4],l[5]),this.transform(a),this._clearTextArea(a),r||a.restore()}},renderCursorOrSelection:function(){if(this.isEditing&&this.canvas&&this.canvas.contextTop){var r=this._getCursorBoundaries(),a=this.canvas.contextTop;this.clearContextTop(!0),this.selectionStart===this.selectionEnd?this.renderCursor(r,a):this.renderSelection(r,a),a.restore()}},_clearTextArea:function(r){var a=this.width+4,l=this.height+4;r.clearRect(-a/2,-l/2,a,l)},_getCursorBoundaries:function(r){r===void 0&&(r=this.selectionStart);var a=this._getLeftOffset(),l=this._getTopOffset(),t=this._getCursorBoundariesOffsets(r);return{left:a,top:l,leftOffset:t.left,topOffset:t.top}},_getCursorBoundariesOffsets:function(r){if(this.cursorOffsetCache&&"top"in this.cursorOffsetCache)return this.cursorOffsetCache;var a,l,t,n,c=0,d=0,h=this.get2DCursorLocation(r);t=h.charIndex,l=h.lineIndex;for(var u=0;u<l;u++)c+=this.getHeightOfLine(u);a=this._getLineLeftOffset(l);var _=this.__charBounds[l][t];return _&&(d=_.left),this.charSpacing!==0&&t===this._textLines[l].length&&(d-=this._getWidthOfCharSpacing()),n={top:c,left:a+(d>0?d:0)},this.direction==="rtl"&&(n.left*=-1),this.cursorOffsetCache=n,this.cursorOffsetCache},renderCursor:function(r,a){var l=this.get2DCursorLocation(),t=l.lineIndex,n=l.charIndex>0?l.charIndex-1:0,c=this.getValueOfPropertyAt(t,n,"fontSize"),d=this.scaleX*this.canvas.getZoom(),h=this.cursorWidth/d,u=r.topOffset,_=this.getValueOfPropertyAt(t,n,"deltaY");u+=(1-this._fontSizeFraction)*this.getHeightOfLine(t)/this.lineHeight-c*(1-this._fontSizeFraction),this.inCompositionMode&&this.renderSelection(r,a),a.fillStyle=this.cursorColor||this.getValueOfPropertyAt(t,n,"fill"),a.globalAlpha=this.__isMousedown?1:this._currentCursorOpacity,a.fillRect(r.left+r.leftOffset-h/2,u+r.top+_,h,c)},renderSelection:function(r,a){for(var l=this.inCompositionMode?this.hiddenTextarea.selectionStart:this.selectionStart,t=this.inCompositionMode?this.hiddenTextarea.selectionEnd:this.selectionEnd,n=this.textAlign.indexOf("justify")!==-1,c=this.get2DCursorLocation(l),d=this.get2DCursorLocation(t),h=c.lineIndex,u=d.lineIndex,_=c.charIndex<0?0:c.charIndex,y=d.charIndex<0?0:d.charIndex,C=h;C<=u;C++){var x,S=this._getLineLeftOffset(C)||0,w=this.getHeightOfLine(C),E=0,M=0;if(C===h&&(E=this.__charBounds[h][_].left),C>=h&&C<u)M=n&&!this.isEndOfWrapping(C)?this.width:this.getLineWidth(C)||5;else if(C===u)if(y===0)M=this.__charBounds[u][y].left;else{var F=this._getWidthOfCharSpacing();M=this.__charBounds[u][y-1].left+this.__charBounds[u][y-1].width-F}x=w,(this.lineHeight<1||C===u&&this.lineHeight>1)&&(w/=this.lineHeight);var H=r.left+S+E,G=M-E,U=w,D=0;this.inCompositionMode?(a.fillStyle=this.compositionColor||"black",U=1,D=w):a.fillStyle=this.selectionColor,this.direction==="rtl"&&(H=this.width-H-G),a.fillRect(H,r.top+r.topOffset+D,G,U),r.topOffset+=x}},getCurrentCharFontSize:function(){var r=this._getCurrentCharIndex();return this.getValueOfPropertyAt(r.l,r.c,"fontSize")},getCurrentCharColor:function(){var r=this._getCurrentCharIndex();return this.getValueOfPropertyAt(r.l,r.c,"fill")},_getCurrentCharIndex:function(){var r=this.get2DCursorLocation(this.selectionStart,!0),a=r.charIndex>0?r.charIndex-1:0;return{l:r.lineIndex,c:a}}}),v.IText.fromObject=function(r,a){if(o(r),r.styles)for(var l in r.styles)for(var t in r.styles[l])o(r.styles[l][t]);v.Object._fromObject("IText",r,a,"text")}}(),Ce=v.util.object.clone,v.util.object.extend(v.IText.prototype,{initBehavior:function(){this.initAddedHandler(),this.initRemovedHandler(),this.initCursorSelectionHandlers(),this.initDoubleClickSimulation(),this.mouseMoveHandler=this.mouseMoveHandler.bind(this)},onDeselect:function(){this.isEditing&&this.exitEditing(),this.selected=!1},initAddedHandler:function(){var o=this;this.on("added",function(){var r=o.canvas;r&&(r._hasITextHandlers||(r._hasITextHandlers=!0,o._initCanvasHandlers(r)),r._iTextInstances=r._iTextInstances||[],r._iTextInstances.push(o))})},initRemovedHandler:function(){var o=this;this.on("removed",function(){var r=o.canvas;r&&(r._iTextInstances=r._iTextInstances||[],v.util.removeFromArray(r._iTextInstances,o),r._iTextInstances.length===0&&(r._hasITextHandlers=!1,o._removeCanvasHandlers(r)))})},_initCanvasHandlers:function(o){o._mouseUpITextHandler=function(){o._iTextInstances&&o._iTextInstances.forEach(function(r){r.__isMousedown=!1})},o.on("mouse:up",o._mouseUpITextHandler)},_removeCanvasHandlers:function(o){o.off("mouse:up",o._mouseUpITextHandler)},_tick:function(){this._currentTickState=this._animateCursor(this,1,this.cursorDuration,"_onTickComplete")},_animateCursor:function(o,r,a,l){var t;return t={isAborted:!1,abort:function(){this.isAborted=!0}},o.animate("_currentCursorOpacity",r,{duration:a,onComplete:function(){t.isAborted||o[l]()},onChange:function(){o.canvas&&o.selectionStart===o.selectionEnd&&o.renderCursorOrSelection()},abort:function(){return t.isAborted}}),t},_onTickComplete:function(){var o=this;this._cursorTimeout1&&clearTimeout(this._cursorTimeout1),this._cursorTimeout1=setTimeout(function(){o._currentTickCompleteState=o._animateCursor(o,0,this.cursorDuration/2,"_tick")},100)},initDelayedCursor:function(o){var r=this,a=o?0:this.cursorDelay;this.abortCursorAnimation(),this._currentCursorOpacity=1,this._cursorTimeout2=setTimeout(function(){r._tick()},a)},abortCursorAnimation:function(){var o=this._currentTickState||this._currentTickCompleteState,r=this.canvas;this._currentTickState&&this._currentTickState.abort(),this._currentTickCompleteState&&this._currentTickCompleteState.abort(),clearTimeout(this._cursorTimeout1),clearTimeout(this._cursorTimeout2),this._currentCursorOpacity=0,o&&r&&r.clearContext(r.contextTop||r.contextContainer)},selectAll:function(){return this.selectionStart=0,this.selectionEnd=this._text.length,this._fireSelectionChanged(),this._updateTextarea(),this},getSelectedText:function(){return this._text.slice(this.selectionStart,this.selectionEnd).join("")},findWordBoundaryLeft:function(o){var r=0,a=o-1;if(this._reSpace.test(this._text[a]))for(;this._reSpace.test(this._text[a]);)r++,a--;for(;/\S/.test(this._text[a])&&a>-1;)r++,a--;return o-r},findWordBoundaryRight:function(o){var r=0,a=o;if(this._reSpace.test(this._text[a]))for(;this._reSpace.test(this._text[a]);)r++,a++;for(;/\S/.test(this._text[a])&&a<this._text.length;)r++,a++;return o+r},findLineBoundaryLeft:function(o){for(var r=0,a=o-1;!/\n/.test(this._text[a])&&a>-1;)r++,a--;return o-r},findLineBoundaryRight:function(o){for(var r=0,a=o;!/\n/.test(this._text[a])&&a<this._text.length;)r++,a++;return o+r},searchWordBoundary:function(o,r){for(var a=this._text,l=this._reSpace.test(a[o])?o-1:o,t=a[l],n=v.reNonWord;!n.test(t)&&l>0&&l<a.length;)t=a[l+=r];return n.test(t)&&(l+=r===1?0:1),l},selectWord:function(o){o=o||this.selectionStart;var r=this.searchWordBoundary(o,-1),a=this.searchWordBoundary(o,1);this.selectionStart=r,this.selectionEnd=a,this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()},selectLine:function(o){o=o||this.selectionStart;var r=this.findLineBoundaryLeft(o),a=this.findLineBoundaryRight(o);return this.selectionStart=r,this.selectionEnd=a,this._fireSelectionChanged(),this._updateTextarea(),this},enterEditing:function(o){if(!this.isEditing&&this.editable)return this.canvas&&(this.canvas.calcOffset(),this.exitEditingOnOthers(this.canvas)),this.isEditing=!0,this.initHiddenTextarea(o),this.hiddenTextarea.focus(),this.hiddenTextarea.value=this.text,this._updateTextarea(),this._saveEditingProps(),this._setEditingProps(),this._textBeforeEdit=this.text,this._tick(),this.fire("editing:entered"),this._fireSelectionChanged(),this.canvas?(this.canvas.fire("text:editing:entered",{target:this}),this.initMouseMoveHandler(),this.canvas.requestRenderAll(),this):this},exitEditingOnOthers:function(o){o._iTextInstances&&o._iTextInstances.forEach(function(r){r.selected=!1,r.isEditing&&r.exitEditing()})},initMouseMoveHandler:function(){this.canvas.on("mouse:move",this.mouseMoveHandler)},mouseMoveHandler:function(o){if(this.__isMousedown&&this.isEditing){var r=this.getSelectionStartFromPointer(o.e),a=this.selectionStart,l=this.selectionEnd;(r===this.__selectionStartOnMouseDown&&a!==l||a!==r&&l!==r)&&(r>this.__selectionStartOnMouseDown?(this.selectionStart=this.__selectionStartOnMouseDown,this.selectionEnd=r):(this.selectionStart=r,this.selectionEnd=this.__selectionStartOnMouseDown),this.selectionStart===a&&this.selectionEnd===l||(this.restartCursorIfNeeded(),this._fireSelectionChanged(),this._updateTextarea(),this.renderCursorOrSelection()))}},_setEditingProps:function(){this.hoverCursor="text",this.canvas&&(this.canvas.defaultCursor=this.canvas.moveCursor="text"),this.borderColor=this.editingBorderColor,this.hasControls=this.selectable=!1,this.lockMovementX=this.lockMovementY=!0},fromStringToGraphemeSelection:function(o,r,a){var l=a.slice(0,o),t=v.util.string.graphemeSplit(l).length;if(o===r)return{selectionStart:t,selectionEnd:t};var n=a.slice(o,r);return{selectionStart:t,selectionEnd:t+v.util.string.graphemeSplit(n).length}},fromGraphemeToStringSelection:function(o,r,a){var l=a.slice(0,o).join("").length;return o===r?{selectionStart:l,selectionEnd:l}:{selectionStart:l,selectionEnd:l+a.slice(o,r).join("").length}},_updateTextarea:function(){if(this.cursorOffsetCache={},this.hiddenTextarea){if(!this.inCompositionMode){var o=this.fromGraphemeToStringSelection(this.selectionStart,this.selectionEnd,this._text);this.hiddenTextarea.selectionStart=o.selectionStart,this.hiddenTextarea.selectionEnd=o.selectionEnd}this.updateTextareaPosition()}},updateFromTextArea:function(){if(this.hiddenTextarea){this.cursorOffsetCache={},this.text=this.hiddenTextarea.value,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords());var o=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value);this.selectionEnd=this.selectionStart=o.selectionEnd,this.inCompositionMode||(this.selectionStart=o.selectionStart),this.updateTextareaPosition()}},updateTextareaPosition:function(){if(this.selectionStart===this.selectionEnd){var o=this._calcTextareaPosition();this.hiddenTextarea.style.left=o.left,this.hiddenTextarea.style.top=o.top}},_calcTextareaPosition:function(){if(!this.canvas)return{x:1,y:1};var o=this.inCompositionMode?this.compositionStart:this.selectionStart,r=this._getCursorBoundaries(o),a=this.get2DCursorLocation(o),l=a.lineIndex,t=a.charIndex,n=this.getValueOfPropertyAt(l,t,"fontSize")*this.lineHeight,c=r.leftOffset,d=this.calcTransformMatrix(),h={x:r.left+c,y:r.top+r.topOffset+n},u=this.canvas.getRetinaScaling(),_=this.canvas.upperCanvasEl,y=_.width/u,C=_.height/u,x=y-n,S=C-n,w=_.clientWidth/y,E=_.clientHeight/C;return h=v.util.transformPoint(h,d),(h=v.util.transformPoint(h,this.canvas.viewportTransform)).x*=w,h.y*=E,h.x<0&&(h.x=0),h.x>x&&(h.x=x),h.y<0&&(h.y=0),h.y>S&&(h.y=S),h.x+=this.canvas._offset.left,h.y+=this.canvas._offset.top,{left:h.x+"px",top:h.y+"px",fontSize:n+"px",charHeight:n}},_saveEditingProps:function(){this._savedProps={hasControls:this.hasControls,borderColor:this.borderColor,lockMovementX:this.lockMovementX,lockMovementY:this.lockMovementY,hoverCursor:this.hoverCursor,selectable:this.selectable,defaultCursor:this.canvas&&this.canvas.defaultCursor,moveCursor:this.canvas&&this.canvas.moveCursor}},_restoreEditingProps:function(){this._savedProps&&(this.hoverCursor=this._savedProps.hoverCursor,this.hasControls=this._savedProps.hasControls,this.borderColor=this._savedProps.borderColor,this.selectable=this._savedProps.selectable,this.lockMovementX=this._savedProps.lockMovementX,this.lockMovementY=this._savedProps.lockMovementY,this.canvas&&(this.canvas.defaultCursor=this._savedProps.defaultCursor,this.canvas.moveCursor=this._savedProps.moveCursor))},exitEditing:function(){var o=this._textBeforeEdit!==this.text,r=this.hiddenTextarea;return this.selected=!1,this.isEditing=!1,this.selectionEnd=this.selectionStart,r&&(r.blur&&r.blur(),r.parentNode&&r.parentNode.removeChild(r)),this.hiddenTextarea=null,this.abortCursorAnimation(),this._restoreEditingProps(),this._currentCursorOpacity=0,this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this.fire("editing:exited"),o&&this.fire("modified"),this.canvas&&(this.canvas.off("mouse:move",this.mouseMoveHandler),this.canvas.fire("text:editing:exited",{target:this}),o&&this.canvas.fire("object:modified",{target:this})),this},_removeExtraneousStyles:function(){for(var o in this.styles)this._textLines[o]||delete this.styles[o]},removeStyleFromTo:function(o,r){var a,l,t=this.get2DCursorLocation(o,!0),n=this.get2DCursorLocation(r,!0),c=t.lineIndex,d=t.charIndex,h=n.lineIndex,u=n.charIndex;if(c!==h){if(this.styles[c])for(a=d;a<this._unwrappedTextLines[c].length;a++)delete this.styles[c][a];if(this.styles[h])for(a=u;a<this._unwrappedTextLines[h].length;a++)(l=this.styles[h][a])&&(this.styles[c]||(this.styles[c]={}),this.styles[c][d+a-u]=l);for(a=c+1;a<=h;a++)delete this.styles[a];this.shiftLineStyles(h,c-h)}else if(this.styles[c]){l=this.styles[c];var _,y,C=u-d;for(a=d;a<u;a++)delete l[a];for(y in this.styles[c])(_=parseInt(y,10))>=u&&(l[_-C]=l[y],delete l[y])}},shiftLineStyles:function(o,r){var a=Ce(this.styles);for(var l in this.styles){var t=parseInt(l,10);t>o&&(this.styles[t+r]=a[t],a[t-r]||delete this.styles[t])}},restartCursorIfNeeded:function(){this._currentTickState&&!this._currentTickState.isAborted&&this._currentTickCompleteState&&!this._currentTickCompleteState.isAborted||this.initDelayedCursor()},insertNewlineStyleObject:function(o,r,a,l){var t,n={},c=!1,d=this._unwrappedTextLines[o].length===r;for(var h in a||(a=1),this.shiftLineStyles(o,a),this.styles[o]&&(t=this.styles[o][r===0?r:r-1]),this.styles[o]){var u=parseInt(h,10);u>=r&&(c=!0,n[u-r]=this.styles[o][h],d&&r===0||delete this.styles[o][h])}var _=!1;for(c&&!d&&(this.styles[o+a]=n,_=!0),_&&a--;a>0;)l&&l[a-1]?this.styles[o+a]={0:Ce(l[a-1])}:t?this.styles[o+a]={0:Ce(t)}:delete this.styles[o+a],a--;this._forceClearCache=!0},insertCharStyleObject:function(o,r,a,l){this.styles||(this.styles={});var t=this.styles[o],n=t?Ce(t):{};for(var c in a||(a=1),n){var d=parseInt(c,10);d>=r&&(t[d+a]=n[d],n[d-a]||delete t[d])}if(this._forceClearCache=!0,l)for(;a--;)Object.keys(l[a]).length&&(this.styles[o]||(this.styles[o]={}),this.styles[o][r+a]=Ce(l[a]));else if(t)for(var h=t[r?r-1:1];h&&a--;)this.styles[o][r+a]=Ce(h)},insertNewStyleBlock:function(o,r,a){for(var l=this.get2DCursorLocation(r,!0),t=[0],n=0,c=0;c<o.length;c++)o[c]===`
`?t[++n]=0:t[n]++;for(t[0]>0&&(this.insertCharStyleObject(l.lineIndex,l.charIndex,t[0],a),a=a&&a.slice(t[0]+1)),n&&this.insertNewlineStyleObject(l.lineIndex,l.charIndex+t[0],n),c=1;c<n;c++)t[c]>0?this.insertCharStyleObject(l.lineIndex+c,0,t[c],a):a&&this.styles[l.lineIndex+c]&&a[0]&&(this.styles[l.lineIndex+c][0]=a[0]),a=a&&a.slice(t[c]+1);t[c]>0&&this.insertCharStyleObject(l.lineIndex+c,0,t[c],a)},setSelectionStartEndWithShift:function(o,r,a){a<=o?(r===o?this._selectionDirection="left":this._selectionDirection==="right"&&(this._selectionDirection="left",this.selectionEnd=o),this.selectionStart=a):a>o&&a<r?this._selectionDirection==="right"?this.selectionEnd=a:this.selectionStart=a:(r===o?this._selectionDirection="right":this._selectionDirection==="left"&&(this._selectionDirection="right",this.selectionStart=r),this.selectionEnd=a)},setSelectionInBoundaries:function(){var o=this.text.length;this.selectionStart>o?this.selectionStart=o:this.selectionStart<0&&(this.selectionStart=0),this.selectionEnd>o?this.selectionEnd=o:this.selectionEnd<0&&(this.selectionEnd=0)}}),v.util.object.extend(v.IText.prototype,{initDoubleClickSimulation:function(){this.__lastClickTime=+new Date,this.__lastLastClickTime=+new Date,this.__lastPointer={},this.on("mousedown",this.onMouseDown)},onMouseDown:function(o){if(this.canvas){this.__newClickTime=+new Date;var r=o.pointer;this.isTripleClick(r)&&(this.fire("tripleclick",o),this._stopEvent(o.e)),this.__lastLastClickTime=this.__lastClickTime,this.__lastClickTime=this.__newClickTime,this.__lastPointer=r,this.__lastIsEditing=this.isEditing,this.__lastSelected=this.selected}},isTripleClick:function(o){return this.__newClickTime-this.__lastClickTime<500&&this.__lastClickTime-this.__lastLastClickTime<500&&this.__lastPointer.x===o.x&&this.__lastPointer.y===o.y},_stopEvent:function(o){o.preventDefault&&o.preventDefault(),o.stopPropagation&&o.stopPropagation()},initCursorSelectionHandlers:function(){this.initMousedownHandler(),this.initMouseupHandler(),this.initClicks()},doubleClickHandler:function(o){this.isEditing&&this.selectWord(this.getSelectionStartFromPointer(o.e))},tripleClickHandler:function(o){this.isEditing&&this.selectLine(this.getSelectionStartFromPointer(o.e))},initClicks:function(){this.on("mousedblclick",this.doubleClickHandler),this.on("tripleclick",this.tripleClickHandler)},_mouseDownHandler:function(o){!this.canvas||!this.editable||o.e.button&&o.e.button!==1||(this.__isMousedown=!0,this.selected&&(this.inCompositionMode=!1,this.setCursorByClick(o.e)),this.isEditing&&(this.__selectionStartOnMouseDown=this.selectionStart,this.selectionStart===this.selectionEnd&&this.abortCursorAnimation(),this.renderCursorOrSelection()))},_mouseDownHandlerBefore:function(o){!this.canvas||!this.editable||o.e.button&&o.e.button!==1||(this.selected=this===this.canvas._activeObject)},initMousedownHandler:function(){this.on("mousedown",this._mouseDownHandler),this.on("mousedown:before",this._mouseDownHandlerBefore)},initMouseupHandler:function(){this.on("mouseup",this.mouseUpHandler)},mouseUpHandler:function(o){if(this.__isMousedown=!1,!(!this.editable||this.group||o.transform&&o.transform.actionPerformed||o.e.button&&o.e.button!==1)){if(this.canvas){var r=this.canvas._activeObject;if(r&&r!==this)return}this.__lastSelected&&!this.__corner?(this.selected=!1,this.__lastSelected=!1,this.enterEditing(o.e),this.selectionStart===this.selectionEnd?this.initDelayedCursor(!0):this.renderCursorOrSelection()):this.selected=!0}},setCursorByClick:function(o){var r=this.getSelectionStartFromPointer(o),a=this.selectionStart,l=this.selectionEnd;o.shiftKey?this.setSelectionStartEndWithShift(a,l,r):(this.selectionStart=r,this.selectionEnd=r),this.isEditing&&(this._fireSelectionChanged(),this._updateTextarea())},getSelectionStartFromPointer:function(o){for(var r,a=this.getLocalPointer(o),l=0,t=0,n=0,c=0,d=0,h=0,u=this._textLines.length;h<u&&n<=a.y;h++)n+=this.getHeightOfLine(h)*this.scaleY,d=h,h>0&&(c+=this._textLines[h-1].length+this.missingNewlineOffset(h-1));t=this._getLineLeftOffset(d)*this.scaleX,r=this._textLines[d],this.direction==="rtl"&&(a.x=this.width*this.scaleX-a.x+t);for(var _=0,y=r.length;_<y&&(l=t,(t+=this.__charBounds[d][_].kernedWidth*this.scaleX)<=a.x);_++)c++;return this._getNewSelectionStartFromOffset(a,l,t,c,y)},_getNewSelectionStartFromOffset:function(o,r,a,l,t){var n=o.x-r,c=a-o.x,d=l+(c>n||c<0?0:1);return this.flipX&&(d=t-d),d>this._text.length&&(d=this._text.length),d}}),v.util.object.extend(v.IText.prototype,{initHiddenTextarea:function(){this.hiddenTextarea=v.document.createElement("textarea"),this.hiddenTextarea.setAttribute("autocapitalize","off"),this.hiddenTextarea.setAttribute("autocorrect","off"),this.hiddenTextarea.setAttribute("autocomplete","off"),this.hiddenTextarea.setAttribute("spellcheck","false"),this.hiddenTextarea.setAttribute("data-fabric-hiddentextarea",""),this.hiddenTextarea.setAttribute("wrap","off");var o=this._calcTextareaPosition();this.hiddenTextarea.style.cssText="position: absolute; top: "+o.top+"; left: "+o.left+"; z-index: -999; opacity: 0; width: 1px; height: 1px; font-size: 1px; padding\uFF70top: "+o.fontSize+";",this.hiddenTextareaContainer?this.hiddenTextareaContainer.appendChild(this.hiddenTextarea):v.document.body.appendChild(this.hiddenTextarea),v.util.addListener(this.hiddenTextarea,"keydown",this.onKeyDown.bind(this)),v.util.addListener(this.hiddenTextarea,"keyup",this.onKeyUp.bind(this)),v.util.addListener(this.hiddenTextarea,"input",this.onInput.bind(this)),v.util.addListener(this.hiddenTextarea,"copy",this.copy.bind(this)),v.util.addListener(this.hiddenTextarea,"cut",this.copy.bind(this)),v.util.addListener(this.hiddenTextarea,"paste",this.paste.bind(this)),v.util.addListener(this.hiddenTextarea,"compositionstart",this.onCompositionStart.bind(this)),v.util.addListener(this.hiddenTextarea,"compositionupdate",this.onCompositionUpdate.bind(this)),v.util.addListener(this.hiddenTextarea,"compositionend",this.onCompositionEnd.bind(this)),!this._clickHandlerInitialized&&this.canvas&&(v.util.addListener(this.canvas.upperCanvasEl,"click",this.onClick.bind(this)),this._clickHandlerInitialized=!0)},keysMap:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorRight",36:"moveCursorLeft",37:"moveCursorLeft",38:"moveCursorUp",39:"moveCursorRight",40:"moveCursorDown"},keysMapRtl:{9:"exitEditing",27:"exitEditing",33:"moveCursorUp",34:"moveCursorDown",35:"moveCursorLeft",36:"moveCursorRight",37:"moveCursorRight",38:"moveCursorUp",39:"moveCursorLeft",40:"moveCursorDown"},ctrlKeysMapUp:{67:"copy",88:"cut"},ctrlKeysMapDown:{65:"selectAll"},onClick:function(){this.hiddenTextarea&&this.hiddenTextarea.focus()},onKeyDown:function(o){if(this.isEditing){var r=this.direction==="rtl"?this.keysMapRtl:this.keysMap;if(o.keyCode in r)this[r[o.keyCode]](o);else{if(!(o.keyCode in this.ctrlKeysMapDown)||!o.ctrlKey&&!o.metaKey)return;this[this.ctrlKeysMapDown[o.keyCode]](o)}o.stopImmediatePropagation(),o.preventDefault(),o.keyCode>=33&&o.keyCode<=40?(this.inCompositionMode=!1,this.clearContextTop(),this.renderCursorOrSelection()):this.canvas&&this.canvas.requestRenderAll()}},onKeyUp:function(o){!this.isEditing||this._copyDone||this.inCompositionMode?this._copyDone=!1:o.keyCode in this.ctrlKeysMapUp&&(o.ctrlKey||o.metaKey)&&(this[this.ctrlKeysMapUp[o.keyCode]](o),o.stopImmediatePropagation(),o.preventDefault(),this.canvas&&this.canvas.requestRenderAll())},onInput:function(o){var r=this.fromPaste;if(this.fromPaste=!1,o&&o.stopPropagation(),this.isEditing){var a,l,t,n,c,d=this._splitTextIntoLines(this.hiddenTextarea.value).graphemeText,h=this._text.length,u=d.length,_=u-h,y=this.selectionStart,C=this.selectionEnd,x=y!==C;if(this.hiddenTextarea.value==="")return this.styles={},this.updateFromTextArea(),this.fire("changed"),void(this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll()));var S=this.fromStringToGraphemeSelection(this.hiddenTextarea.selectionStart,this.hiddenTextarea.selectionEnd,this.hiddenTextarea.value),w=y>S.selectionStart;x?(a=this._text.slice(y,C),_+=C-y):u<h&&(a=w?this._text.slice(C+_,C):this._text.slice(y,y-_)),l=d.slice(S.selectionEnd-_,S.selectionEnd),a&&a.length&&(l.length&&(t=this.getSelectionStyles(y,y+1,!1),t=l.map(function(){return t[0]})),x?(n=y,c=C):w?(n=C-a.length,c=C):(n=C,c=C+a.length),this.removeStyleFromTo(n,c)),l.length&&(r&&l.join("")===v.copiedText&&!v.disableStyleCopyPaste&&(t=v.copiedTextStyle),this.insertNewStyleBlock(l,y,t)),this.updateFromTextArea(),this.fire("changed"),this.canvas&&(this.canvas.fire("text:changed",{target:this}),this.canvas.requestRenderAll())}},onCompositionStart:function(){this.inCompositionMode=!0},onCompositionEnd:function(){this.inCompositionMode=!1},onCompositionUpdate:function(o){this.compositionStart=o.target.selectionStart,this.compositionEnd=o.target.selectionEnd,this.updateTextareaPosition()},copy:function(){this.selectionStart!==this.selectionEnd&&(v.copiedText=this.getSelectedText(),v.disableStyleCopyPaste?v.copiedTextStyle=null:v.copiedTextStyle=this.getSelectionStyles(this.selectionStart,this.selectionEnd,!0),this._copyDone=!0)},paste:function(){this.fromPaste=!0},_getClipboardData:function(o){return o&&o.clipboardData||v.window.clipboardData},_getWidthBeforeCursor:function(o,r){var a,l=this._getLineLeftOffset(o);return r>0&&(l+=(a=this.__charBounds[o][r-1]).left+a.width),l},getDownCursorOffset:function(o,r){var a=this._getSelectionForOffset(o,r),l=this.get2DCursorLocation(a),t=l.lineIndex;if(t===this._textLines.length-1||o.metaKey||o.keyCode===34)return this._text.length-a;var n=l.charIndex,c=this._getWidthBeforeCursor(t,n),d=this._getIndexOnLine(t+1,c);return this._textLines[t].slice(n).length+d+1+this.missingNewlineOffset(t)},_getSelectionForOffset:function(o,r){return o.shiftKey&&this.selectionStart!==this.selectionEnd&&r?this.selectionEnd:this.selectionStart},getUpCursorOffset:function(o,r){var a=this._getSelectionForOffset(o,r),l=this.get2DCursorLocation(a),t=l.lineIndex;if(t===0||o.metaKey||o.keyCode===33)return-a;var n=l.charIndex,c=this._getWidthBeforeCursor(t,n),d=this._getIndexOnLine(t-1,c),h=this._textLines[t].slice(0,n),u=this.missingNewlineOffset(t-1);return-this._textLines[t-1].length+d-h.length+(1-u)},_getIndexOnLine:function(o,r){for(var a,l,t=this._textLines[o],n=this._getLineLeftOffset(o),c=0,d=0,h=t.length;d<h;d++)if((n+=a=this.__charBounds[o][d].width)>r){l=!0;var u=n-a,_=n,y=Math.abs(u-r);c=Math.abs(_-r)<y?d:d-1;break}return l||(c=t.length-1),c},moveCursorDown:function(o){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorUpOrDown("Down",o)},moveCursorUp:function(o){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorUpOrDown("Up",o)},_moveCursorUpOrDown:function(o,r){var a=this["get"+o+"CursorOffset"](r,this._selectionDirection==="right");r.shiftKey?this.moveCursorWithShift(a):this.moveCursorWithoutShift(a),a!==0&&(this.setSelectionInBoundaries(),this.abortCursorAnimation(),this._currentCursorOpacity=1,this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorWithShift:function(o){var r=this._selectionDirection==="left"?this.selectionStart+o:this.selectionEnd+o;return this.setSelectionStartEndWithShift(this.selectionStart,this.selectionEnd,r),o!==0},moveCursorWithoutShift:function(o){return o<0?(this.selectionStart+=o,this.selectionEnd=this.selectionStart):(this.selectionEnd+=o,this.selectionStart=this.selectionEnd),o!==0},moveCursorLeft:function(o){this.selectionStart===0&&this.selectionEnd===0||this._moveCursorLeftOrRight("Left",o)},_move:function(o,r,a){var l;if(o.altKey)l=this["findWordBoundary"+a](this[r]);else{if(!o.metaKey&&o.keyCode!==35&&o.keyCode!==36)return this[r]+=a==="Left"?-1:1,!0;l=this["findLineBoundary"+a](this[r])}if(typeof l!==void 0&&this[r]!==l)return this[r]=l,!0},_moveLeft:function(o,r){return this._move(o,r,"Left")},_moveRight:function(o,r){return this._move(o,r,"Right")},moveCursorLeftWithoutShift:function(o){var r=!0;return this._selectionDirection="left",this.selectionEnd===this.selectionStart&&this.selectionStart!==0&&(r=this._moveLeft(o,"selectionStart")),this.selectionEnd=this.selectionStart,r},moveCursorLeftWithShift:function(o){return this._selectionDirection==="right"&&this.selectionStart!==this.selectionEnd?this._moveLeft(o,"selectionEnd"):this.selectionStart!==0?(this._selectionDirection="left",this._moveLeft(o,"selectionStart")):void 0},moveCursorRight:function(o){this.selectionStart>=this._text.length&&this.selectionEnd>=this._text.length||this._moveCursorLeftOrRight("Right",o)},_moveCursorLeftOrRight:function(o,r){var a="moveCursor"+o+"With";this._currentCursorOpacity=1,r.shiftKey?a+="Shift":a+="outShift",this[a](r)&&(this.abortCursorAnimation(),this.initDelayedCursor(),this._fireSelectionChanged(),this._updateTextarea())},moveCursorRightWithShift:function(o){return this._selectionDirection==="left"&&this.selectionStart!==this.selectionEnd?this._moveRight(o,"selectionStart"):this.selectionEnd!==this._text.length?(this._selectionDirection="right",this._moveRight(o,"selectionEnd")):void 0},moveCursorRightWithoutShift:function(o){var r=!0;return this._selectionDirection="right",this.selectionStart===this.selectionEnd?(r=this._moveRight(o,"selectionStart"),this.selectionEnd=this.selectionStart):this.selectionStart=this.selectionEnd,r},removeChars:function(o,r){r===void 0&&(r=o+1),this.removeStyleFromTo(o,r),this._text.splice(o,r-o),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()},insertChars:function(o,r,a,l){l===void 0&&(l=a),l>a&&this.removeStyleFromTo(a,l);var t=v.util.string.graphemeSplit(o);this.insertNewStyleBlock(t,a,r),this._text=[].concat(this._text.slice(0,a),t,this._text.slice(l)),this.text=this._text.join(""),this.set("dirty",!0),this._shouldClearDimensionCache()&&(this.initDimensions(),this.setCoords()),this._removeExtraneousStyles()}}),function(){var o=v.util.toFixed,r=/  +/g;v.util.object.extend(v.Text.prototype,{_toSVG:function(){var a=this._getSVGLeftTopOffsets(),l=this._getSVGTextAndBg(a.textTop,a.textLeft);return this._wrapSVGTextAndBg(l)},toSVG:function(a){return this._createBaseSVGMarkup(this._toSVG(),{reviver:a,noStyle:!0,withShadow:!0})},_getSVGLeftTopOffsets:function(){return{textLeft:-this.width/2,textTop:-this.height/2,lineTop:this.getHeightOfLine(0)}},_wrapSVGTextAndBg:function(a){var l=this.getSvgTextDecoration(this);return[a.textBgRects.join(""),'		<text xml:space="preserve" ',this.fontFamily?'font-family="'+this.fontFamily.replace(/"/g,"'")+'" ':"",this.fontSize?'font-size="'+this.fontSize+'" ':"",this.fontStyle?'font-style="'+this.fontStyle+'" ':"",this.fontWeight?'font-weight="'+this.fontWeight+'" ':"",l?'text-decoration="'+l+'" ':"",'style="',this.getSvgStyles(!0),'"',this.addPaintOrder()," >",a.textSpans.join(""),`</text>
`]},_getSVGTextAndBg:function(a,l){var t,n=[],c=[],d=a;this._setSVGBg(c);for(var h=0,u=this._textLines.length;h<u;h++)t=this._getLineLeftOffset(h),(this.textBackgroundColor||this.styleHas("textBackgroundColor",h))&&this._setSVGTextLineBg(c,h,l+t,d),this._setSVGTextLineText(n,h,l+t,d),d+=this.getHeightOfLine(h);return{textSpans:n,textBgRects:c}},_createTextCharSpan:function(a,l,t,n){var c=a!==a.trim()||a.match(r),d=this.getSvgSpanStyles(l,c),h=d?'style="'+d+'"':"",u=l.deltaY,_="",y=v.Object.NUM_FRACTION_DIGITS;return u&&(_=' dy="'+o(u,y)+'" '),['<tspan x="',o(t,y),'" y="',o(n,y),'" ',_,h,">",v.util.string.escapeXml(a),"</tspan>"].join("")},_setSVGTextLineText:function(a,l,t,n){var c,d,h,u,_,y=this.getHeightOfLine(l),C=this.textAlign.indexOf("justify")!==-1,x="",S=0,w=this._textLines[l];n+=y*(1-this._fontSizeFraction)/this.lineHeight;for(var E=0,M=w.length-1;E<=M;E++)_=E===M||this.charSpacing,x+=w[E],h=this.__charBounds[l][E],S===0?(t+=h.kernedWidth-h.width,S+=h.width):S+=h.kernedWidth,C&&!_&&this._reSpaceAndTab.test(w[E])&&(_=!0),_||(c=c||this.getCompleteStyleDeclaration(l,E),d=this.getCompleteStyleDeclaration(l,E+1),_=this._hasStyleChangedForSvg(c,d)),_&&(u=this._getStyleDeclaration(l,E)||{},a.push(this._createTextCharSpan(x,u,t,n)),x="",c=d,t+=S,S=0)},_pushTextBgRect:function(a,l,t,n,c,d){var h=v.Object.NUM_FRACTION_DIGITS;a.push("		<rect ",this._getFillAttributes(l),' x="',o(t,h),'" y="',o(n,h),'" width="',o(c,h),'" height="',o(d,h),`"></rect>
`)},_setSVGTextLineBg:function(a,l,t,n){for(var c,d,h=this._textLines[l],u=this.getHeightOfLine(l)/this.lineHeight,_=0,y=0,C=this.getValueOfPropertyAt(l,0,"textBackgroundColor"),x=0,S=h.length;x<S;x++)c=this.__charBounds[l][x],(d=this.getValueOfPropertyAt(l,x,"textBackgroundColor"))!==C?(C&&this._pushTextBgRect(a,C,t+y,n,_,u),y=c.left,_=c.width,C=d):_+=c.kernedWidth;d&&this._pushTextBgRect(a,d,t+y,n,_,u)},_getFillAttributes:function(a){var l=a&&typeof a=="string"?new v.Color(a):"";return l&&l.getSource()&&l.getAlpha()!==1?'opacity="'+l.getAlpha()+'" fill="'+l.setAlpha(1).toRgb()+'"':'fill="'+a+'"'},_getSVGLineTopOffset:function(a){for(var l,t=0,n=0;n<a;n++)t+=this.getHeightOfLine(n);return l=this.getHeightOfLine(n),{lineTop:t,offset:(this._fontSizeMult-this._fontSizeFraction)*l/(this.lineHeight*this._fontSizeMult)}},getSvgStyles:function(a){return v.Object.prototype.getSvgStyles.call(this,a)+" white-space: pre;"}})}(),function(o){var r=o.fabric||(o.fabric={});r.Textbox=r.util.createClass(r.IText,r.Observable,{type:"textbox",minWidth:20,dynamicMinWidth:2,__cachedLines:null,lockScalingFlip:!0,noScaleCache:!1,_dimensionAffectingProps:r.Text.prototype._dimensionAffectingProps.concat("width"),_wordJoiners:/[ \t\r]/,splitByGrapheme:!1,initDimensions:function(){this.__skipDimension||(this.isEditing&&this.initDelayedCursor(),this.clearContextTop(),this._clearCache(),this.dynamicMinWidth=0,this._styleMap=this._generateStyleMap(this._splitText()),this.dynamicMinWidth>this.width&&this._set("width",this.dynamicMinWidth),this.textAlign.indexOf("justify")!==-1&&this.enlargeSpaces(),this.height=this.calcTextHeight(),this.saveState({propertySet:"_dimensionAffectingProps"}))},_generateStyleMap:function(a){for(var l=0,t=0,n=0,c={},d=0;d<a.graphemeLines.length;d++)a.graphemeText[n]===`
`&&d>0?(t=0,n++,l++):!this.splitByGrapheme&&this._reSpaceAndTab.test(a.graphemeText[n])&&d>0&&(t++,n++),c[d]={line:l,offset:t},n+=a.graphemeLines[d].length,t+=a.graphemeLines[d].length;return c},styleHas:function(a,l){if(this._styleMap&&!this.isWrapping){var t=this._styleMap[l];t&&(l=t.line)}return r.Text.prototype.styleHas.call(this,a,l)},isEmptyStyles:function(a){if(!this.styles)return!0;var l,t,n=0,c=!1,d=this._styleMap[a],h=this._styleMap[a+1];for(var u in d&&(a=d.line,n=d.offset),h&&(c=h.line===a,l=h.offset),t=a===void 0?this.styles:{line:this.styles[a]})for(var _ in t[u])if(_>=n&&(!c||_<l))for(var y in t[u][_])return!1;return!0},_getStyleDeclaration:function(a,l){if(this._styleMap&&!this.isWrapping){var t=this._styleMap[a];if(!t)return null;a=t.line,l=t.offset+l}return this.callSuper("_getStyleDeclaration",a,l)},_setStyleDeclaration:function(a,l,t){var n=this._styleMap[a];a=n.line,l=n.offset+l,this.styles[a][l]=t},_deleteStyleDeclaration:function(a,l){var t=this._styleMap[a];a=t.line,l=t.offset+l,delete this.styles[a][l]},_getLineStyle:function(a){var l=this._styleMap[a];return!!this.styles[l.line]},_setLineStyle:function(a){var l=this._styleMap[a];this.styles[l.line]={}},_wrapText:function(a,l){var t,n=[];for(this.isWrapping=!0,t=0;t<a.length;t++)n=n.concat(this._wrapLine(a[t],t,l));return this.isWrapping=!1,n},_measureWord:function(a,l,t){var n,c=0;t=t||0;for(var d=0,h=a.length;d<h;d++)c+=this._getGraphemeBox(a[d],l,d+t,n,!0).kernedWidth,n=a[d];return c},_wrapLine:function(a,l,t,n){var c=0,d=this.splitByGrapheme,h=[],u=[],_=d?r.util.string.graphemeSplit(a):a.split(this._wordJoiners),y="",C=0,x=d?"":" ",S=0,w=0,E=0,M=!0,F=this._getWidthOfCharSpacing();n=n||0,_.length===0&&_.push([]),t-=n;for(var H=0;H<_.length;H++)y=d?_[H]:r.util.string.graphemeSplit(_[H]),S=this._measureWord(y,l,C),C+=y.length,(c+=w+S-F)>t&&!M?(h.push(u),u=[],c=S,M=!0):c+=F,M||d||u.push(x),u=u.concat(y),w=d?0:this._measureWord([x],l,C),C++,M=!1,S>E&&(E=S);return H&&h.push(u),E+n>this.dynamicMinWidth&&(this.dynamicMinWidth=E-F+n),h},isEndOfWrapping:function(a){return!this._styleMap[a+1]||this._styleMap[a+1].line!==this._styleMap[a].line},missingNewlineOffset:function(a){return this.splitByGrapheme?this.isEndOfWrapping(a)?1:0:1},_splitTextIntoLines:function(a){for(var l=r.Text.prototype._splitTextIntoLines.call(this,a),t=this._wrapText(l.lines,this.width),n=new Array(t.length),c=0;c<t.length;c++)n[c]=t[c].join("");return l.lines=n,l.graphemeLines=t,l},getMinWidth:function(){return Math.max(this.minWidth,this.dynamicMinWidth)},_removeExtraneousStyles:function(){var a={};for(var l in this._styleMap)this._textLines[l]&&(a[this._styleMap[l].line]=1);for(var l in this.styles)a[l]||delete this.styles[l]},toObject:function(a){return this.callSuper("toObject",["minWidth","splitByGrapheme"].concat(a))}}),r.Textbox.fromObject=function(a,l){return r.Object._fromObject("Textbox",a,l,"text")}}(i),function(){var o=v.controlsUtils,r=o.scaleSkewCursorStyleHandler,a=o.scaleCursorStyleHandler,l=o.scalingEqually,t=o.scalingYOrSkewingX,n=o.scalingXOrSkewingY,c=o.scaleOrSkewActionName,d=v.Object.prototype.controls;if(d.ml=new v.Control({x:-.5,y:0,cursorStyleHandler:r,actionHandler:n,getActionName:c}),d.mr=new v.Control({x:.5,y:0,cursorStyleHandler:r,actionHandler:n,getActionName:c}),d.mb=new v.Control({x:0,y:.5,cursorStyleHandler:r,actionHandler:t,getActionName:c}),d.mt=new v.Control({x:0,y:-.5,cursorStyleHandler:r,actionHandler:t,getActionName:c}),d.tl=new v.Control({x:-.5,y:-.5,cursorStyleHandler:a,actionHandler:l}),d.tr=new v.Control({x:.5,y:-.5,cursorStyleHandler:a,actionHandler:l}),d.bl=new v.Control({x:-.5,y:.5,cursorStyleHandler:a,actionHandler:l}),d.br=new v.Control({x:.5,y:.5,cursorStyleHandler:a,actionHandler:l}),d.mtr=new v.Control({x:0,y:-.5,actionHandler:o.rotationWithSnapping,cursorStyleHandler:o.rotationStyleHandler,offsetY:-40,withConnection:!0,actionName:"rotate"}),v.Textbox){var h=v.Textbox.prototype.controls={};h.mtr=d.mtr,h.tr=d.tr,h.br=d.br,h.tl=d.tl,h.bl=d.bl,h.mt=d.mt,h.mb=d.mb,h.mr=new v.Control({x:.5,y:0,actionHandler:o.changeWidth,cursorStyleHandler:r,actionName:"resizing"}),h.ml=new v.Control({x:-.5,y:0,actionHandler:o.changeWidth,cursorStyleHandler:r,actionName:"resizing"})}}()},192:()=>{},898:()=>{},245:()=>{}},Gn={};function ut(e){var i=Gn[e];if(i!==void 0)return i.exports;var s=Gn[e]={exports:{}};return Hl[e](s,s.exports,ut),s.exports}ut.d=(e,i)=>{for(var s in i)ut.o(i,s)&&!ut.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:i[s]})},ut.o=(e,i)=>Object.prototype.hasOwnProperty.call(e,i);var po={};(()=>{let e;ut.d(po,{R:()=>e}),e=typeof document<"u"&&typeof window<"u"?ut(653).fabric:{version:"5.2.1"}})();var be=po.R;/*!
 * Dynamsoft JavaScript Library
 * @product Dynamsoft Camera Enhancer JS Edition
 * @website https://www.dynamsoft.com
 * @copyright Copyright 2023, Dynamsoft Corporation
 * @author Dynamsoft
 * @version 3.3.9 (js 20231205)
 * @fileoverview Dynamsoft JavaScript Library for Camera Enhancer
 * More info on DCE JS: https://www.dynamsoft.com/camera-enhancer/docs/programming/javascript/?ver=latest
 */const Ur=typeof self>"u";let Wt,Ke,di,gr,He;if(typeof navigator<"u"&&(Wt=navigator,Ke=Wt.userAgent,di=Wt.platform,gr=Wt.mediaDevices),!Ur){const e={Edge:{search:"Edg",verSearch:"Edg"},OPR:null,Chrome:null,Safari:{str:Wt.vendor,search:"Apple",verSearch:["Version","iPhone OS","CPU OS"]},Firefox:null,Explorer:{search:"MSIE",verSearch:"MSIE"}},i={HarmonyOS:null,Android:null,iPhone:null,iPad:null,Windows:{str:di,search:"Win"},Mac:{str:di},Linux:{str:di}};let s="unknownBrowser",f=0,g="unknownOS";for(let p in e){const m=e[p]||{};let b=m.str||Ke,T=m.search||p,A=m.verStr||Ke,O=m.verSearch||p;if(O instanceof Array||(O=[O]),b.indexOf(T)!=-1){s=p;for(let B of O){let k=A.indexOf(B);if(k!=-1){f=parseFloat(A.substring(k+B.length+1));break}}break}}for(let p in i){const m=i[p]||{};let b=m.str||Ke,T=m.search||p;if(b.indexOf(T)!=-1){g=p;break}}g=="Linux"&&Ke.indexOf("Windows NT")!=-1&&(g="HarmonyOS"),He={browser:s,version:f,OS:g}}Ur&&(He={browser:"ssr",version:0,OS:"ssr"});typeof WebAssembly<"u"&&Ke&&(/Safari/.test(Ke)&&!/Chrome/.test(Ke)&&/\(.+\s11_2_([2-6]).*\)/.test(Ke));!gr||gr.getUserMedia;He.browser==="Chrome"&&He.version>66||He.browser==="Safari"&&He.version>13||He.browser==="OPR"&&He.version>43||He.browser==="Edge"&&He.version;(()=>{if(!Ur&&document.currentScript){let e=document.currentScript.src,i=e.indexOf("?");if(i!=-1)e=e.substring(0,i);else{let s=e.indexOf("#");s!=-1&&(e=e.substring(0,s))}return e.substring(0,e.lastIndexOf("/")+1)}return"./"})();typeof document<"u"&&typeof window<"u"&&(be.StaticCanvas.prototype.dispose=function(){return this.isRendering&&(be.util.cancelAnimFrame(this.isRendering),this.isRendering=0),this.forEachObject(function(e){e.dispose&&e.dispose()}),this._objects=[],this.backgroundImage&&this.backgroundImage.dispose&&this.backgroundImage.dispose(),this.backgroundImage=null,this.overlayImage&&this.overlayImage.dispose&&this.overlayImage.dispose(),this.overlayImage=null,this._iTextInstances=null,this.contextContainer=null,this.lowerCanvasEl.classList.remove("lower-canvas"),delete this._originalCanvasStyle,this.lowerCanvasEl.setAttribute("width",this.width),this.lowerCanvasEl.setAttribute("height",this.height),be.util.cleanUpJsdomNode(this.lowerCanvasEl),this.lowerCanvasEl=void 0,this},be.Object.prototype.transparentCorners=!1,be.Object.prototype.cornerSize=20,be.Object.prototype.touchCornerSize=100,be.Object.prototype.cornerColor="rgb(254,142,20)",be.Object.prototype.cornerStyle="circle",be.Object.prototype.strokeUniform=!0,be.Object.prototype.hasBorders=!1,be.Canvas.prototype.containerClass="",be.Canvas.prototype.getPointer=function(e,i){if(this._absolutePointer&&!i)return this._absolutePointer;if(this._pointer&&i)return this._pointer;var s,f=this.upperCanvasEl,g=be.util.getPointer(e,f),p=f.getBoundingClientRect(),m=p.width||0,b=p.height||0;m&&b||("top"in p&&"bottom"in p&&(b=Math.abs(p.top-p.bottom)),"right"in p&&"left"in p&&(m=Math.abs(p.right-p.left))),this.calcOffset(),g.x=g.x-this._offset.left,g.y=g.y-this._offset.top,i||(g=this.restorePointerVpt(g));var T=this.getRetinaScaling();if(T!==1&&(g.x/=T,g.y/=T),m!==0&&b!==0){var A=window.getComputedStyle(f).objectFit,O=f.width,B=f.height,k=m,Z=b;s={width:O/k,height:B/Z};var ie,le,ce=O/B,de=k/Z;return A==="contain"?ce>de?(ie=k,le=k/ce,{x:g.x*s.width,y:(g.y-(Z-le)/2)*s.width}):(ie=Z*ce,le=Z,{x:(g.x-(k-ie)/2)*s.height,y:g.y*s.height}):A==="cover"?ce>de?{x:(O-s.height*k)/2+g.x*s.height,y:g.y*s.height}:{x:g.x*s.width,y:(B-s.width*Z)/2+g.y*s.width}:{x:g.x*s.width,y:g.y*s.height}}return s={width:1,height:1},{x:g.x*s.width,y:g.y*s.height}},be.Canvas.prototype._onTouchStart=function(e){var i=this.findTarget(e);!this.allowTouchScrolling&&e.cancelable&&e.preventDefault&&e.preventDefault(),i&&e.cancelable&&e.preventDefault&&e.preventDefault(),this.mainTouchId===null&&(this.mainTouchId=this.getPointerId(e)),this.__onMouseDown(e),this._resetTransformEventData();var s=this.upperCanvasEl,f=this._getEventPrefix();be.util.addListener(be.document,"touchend",this._onTouchEnd,{passive:!1}),be.util.addListener(be.document,"touchmove",this._onMouseMove,{passive:!1}),be.util.removeListener(s,f+"down",this._onMouseDown)},be.Textbox.prototype._wrapLine=function(e,i,s,f){const g=e.match(/[\u3040-\u30ff\u3400-\u4dbf\u4e00-\u9fff\uf900-\ufaff\uff66-\uff9f]/g),p=!(!g||!g.length);var m=0,b=this.splitByGrapheme||p,T=[],A=[],O=b?be.util.string.graphemeSplit(e):e.split(this._wordJoiners),B="",k=0,Z=b?"":" ",ie=0,le=0,ce=0,de=!0,oe=this._getWidthOfCharSpacing();f=f||0,O.length===0&&O.push([]),s-=f;for(var ae=0;ae<O.length;ae++)B=b?O[ae]:be.util.string.graphemeSplit(O[ae]),ie=this._measureWord(B,i,k),k+=B.length,(m+=le+ie-oe)>s&&!de?(T.push(A),A=[],m=ie,de=!0):m+=oe,de||b||A.push(Z),A=A.concat(B),le=b?0:this._measureWord([Z],i,k),k++,de=!1,ie>ce&&(ce=ie);return ae&&T.push(A),ce+f>this.dynamicMinWidth&&(this.dynamicMinWidth=ce-oe+f),T});var Vn;(function(e){e.GREY="grey",e.GREY32="grey32",e.RGBA="rgba",e.RBGA="rbga",e.GRBA="grba",e.GBRA="gbra",e.BRGA="brga",e.BGRA="bgra"})(Vn||(Vn={}));var Wn,Hn,Xn,Yn,zn,$n,Kn,qn,Zn,Jn,Qn,es,ts,is,rs,ns,ss,os,as,cs,ls,hs,us,fs,ds,ps;(function(e){e[e.BICM_DARK_ON_LIGHT=1]="BICM_DARK_ON_LIGHT",e[e.BICM_LIGHT_ON_DARK=2]="BICM_LIGHT_ON_DARK",e[e.BICM_DARK_ON_DARK=4]="BICM_DARK_ON_DARK",e[e.BICM_LIGHT_ON_LIGHT=8]="BICM_LIGHT_ON_LIGHT",e[e.BICM_DARK_LIGHT_MIXED=16]="BICM_DARK_LIGHT_MIXED",e[e.BICM_DARK_ON_LIGHT_DARK_SURROUNDING=32]="BICM_DARK_ON_LIGHT_DARK_SURROUNDING",e[e.BICM_SKIP=0]="BICM_SKIP",e[e.BICM_REV=2147483648]="BICM_REV"})(Wn||(Wn={})),function(e){e[e.BCM_AUTO=1]="BCM_AUTO",e[e.BCM_GENERAL=2]="BCM_GENERAL",e[e.BCM_SKIP=0]="BCM_SKIP",e[e.BCM_REV=2147483648]="BCM_REV"}(Hn||(Hn={})),function(e){e[e.BF2_NULL=0]="BF2_NULL",e[e.BF2_POSTALCODE=32505856]="BF2_POSTALCODE",e[e.BF2_NONSTANDARD_BARCODE=1]="BF2_NONSTANDARD_BARCODE",e[e.BF2_USPSINTELLIGENTMAIL=1048576]="BF2_USPSINTELLIGENTMAIL",e[e.BF2_POSTNET=2097152]="BF2_POSTNET",e[e.BF2_PLANET=4194304]="BF2_PLANET",e[e.BF2_AUSTRALIANPOST=8388608]="BF2_AUSTRALIANPOST",e[e.BF2_RM4SCC=16777216]="BF2_RM4SCC",e[e.BF2_DOTCODE=2]="BF2_DOTCODE",e[e.BF2_PHARMACODE_ONE_TRACK=4]="BF2_PHARMACODE_ONE_TRACK",e[e.BF2_PHARMACODE_TWO_TRACK=8]="BF2_PHARMACODE_TWO_TRACK",e[e.BF2_PHARMACODE=12]="BF2_PHARMACODE",e[e.BF2_ALL=-1]="BF2_ALL"}(Xn||(Xn={})),function(e){e[e.BM_AUTO=1]="BM_AUTO",e[e.BM_LOCAL_BLOCK=2]="BM_LOCAL_BLOCK",e[e.BM_SKIP=0]="BM_SKIP",e[e.BM_THRESHOLD=4]="BM_THRESHOLD",e[e.BM_REV=2147483648]="BM_REV"}(Yn||(Yn={})),function(e){e[e.ECCM_CONTRAST=1]="ECCM_CONTRAST"}(zn||(zn={})),function(e){e[e.CFM_GENERAL=1]="CFM_GENERAL"}($n||($n={})),function(e){e[e.CCM_AUTO=1]="CCM_AUTO",e[e.CCM_GENERAL_HSV=2]="CCM_GENERAL_HSV",e[e.CCM_SKIP=0]="CCM_SKIP",e[e.CCM_REV=2147483648]="CCM_REV"}(Kn||(Kn={})),function(e){e[e.CICM_GENERAL=1]="CICM_GENERAL",e[e.CICM_SKIP=0]="CICM_SKIP",e[e.CICM_REV=2147483648]="CICM_REV"}(qn||(qn={})),function(e){e[e.CM_IGNORE=1]="CM_IGNORE",e[e.CM_OVERWRITE=2]="CM_OVERWRITE"}(Zn||(Zn={})),function(e){e[e.DM_SKIP=0]="DM_SKIP",e[e.DM_DIRECT_BINARIZATION=1]="DM_DIRECT_BINARIZATION",e[e.DM_THRESHOLD_BINARIZATION=2]="DM_THRESHOLD_BINARIZATION",e[e.DM_GRAY_EQUALIZATION=4]="DM_GRAY_EQUALIZATION",e[e.DM_SMOOTHING=8]="DM_SMOOTHING",e[e.DM_MORPHING=16]="DM_MORPHING",e[e.DM_DEEP_ANALYSIS=32]="DM_DEEP_ANALYSIS",e[e.DM_SHARPENING=64]="DM_SHARPENING",e[e.DM_BASED_ON_LOC_BIN=128]="DM_BASED_ON_LOC_BIN",e[e.DM_SHARPENING_SMOOTHING=256]="DM_SHARPENING_SMOOTHING"}(Jn||(Jn={})),function(e){e[e.DRM_AUTO=1]="DRM_AUTO",e[e.DRM_GENERAL=2]="DRM_GENERAL",e[e.DRM_BROAD_WARP=4]="DRM_BROAD_WARP",e[e.DRM_LOCAL_REFERENCE=8]="DRM_LOCAL_REFERENCE",e[e.DRM_DEWRINKLE=16]="DRM_DEWRINKLE",e[e.DRM_SKIP=0]="DRM_SKIP",e[e.DRM_REV=2147483648]="DRM_REV"}(Qn||(Qn={})),function(e){e[e.DPMCRM_AUTO=1]="DPMCRM_AUTO",e[e.DPMCRM_GENERAL=2]="DPMCRM_GENERAL",e[e.DPMCRM_SKIP=0]="DPMCRM_SKIP",e[e.DPMCRM_REV=2147483648]="DPMCRM_REV"}(es||(es={})),function(e){e[e.GTM_INVERTED=1]="GTM_INVERTED",e[e.GTM_ORIGINAL=2]="GTM_ORIGINAL",e[e.GTM_SKIP=0]="GTM_SKIP",e[e.GTM_REV=2147483648]="GTM_REV"}(ts||(ts={})),function(e){e[e.IPM_AUTO=1]="IPM_AUTO",e[e.IPM_GENERAL=2]="IPM_GENERAL",e[e.IPM_GRAY_EQUALIZE=4]="IPM_GRAY_EQUALIZE",e[e.IPM_GRAY_SMOOTH=8]="IPM_GRAY_SMOOTH",e[e.IPM_SHARPEN_SMOOTH=16]="IPM_SHARPEN_SMOOTH",e[e.IPM_MORPHOLOGY=32]="IPM_MORPHOLOGY",e[e.IPM_SKIP=0]="IPM_SKIP",e[e.IPM_REV=2147483648]="IPM_REV"}(is||(is={})),function(e){e[e.IRSM_MEMORY=1]="IRSM_MEMORY",e[e.IRSM_FILESYSTEM=2]="IRSM_FILESYSTEM",e[e.IRSM_BOTH=4]="IRSM_BOTH"}(rs||(rs={})),function(e){e[e.LM_SKIP=0]="LM_SKIP",e[e.LM_AUTO=1]="LM_AUTO",e[e.LM_CONNECTED_BLOCKS=2]="LM_CONNECTED_BLOCKS",e[e.LM_LINES=8]="LM_LINES",e[e.LM_STATISTICS=4]="LM_STATISTICS",e[e.LM_SCAN_DIRECTLY=16]="LM_SCAN_DIRECTLY",e[e.LM_STATISTICS_MARKS=32]="LM_STATISTICS_MARKS",e[e.LM_STATISTICS_POSTAL_CODE=64]="LM_STATISTICS_POSTAL_CODE",e[e.LM_CENTRE=128]="LM_CENTRE",e[e.LM_ONED_FAST_SCAN=256]="LM_ONED_FAST_SCAN",e[e.LM_REV=2147483648]="LM_REV"}(ns||(ns={})),function(e){e[e.PDFRM_RASTER=1]="PDFRM_RASTER",e[e.PDFRM_AUTO=2]="PDFRM_AUTO",e[e.PDFRM_VECTOR=4]="PDFRM_VECTOR",e[e.PDFRM_REV=2147483648]="PDFRM_REV"}(ss||(ss={})),function(e){e[e.QRECL_ERROR_CORRECTION_H=0]="QRECL_ERROR_CORRECTION_H",e[e.QRECL_ERROR_CORRECTION_L=1]="QRECL_ERROR_CORRECTION_L",e[e.QRECL_ERROR_CORRECTION_M=2]="QRECL_ERROR_CORRECTION_M",e[e.QRECL_ERROR_CORRECTION_Q=3]="QRECL_ERROR_CORRECTION_Q"}(os||(os={})),function(e){e[e.RPM_AUTO=1]="RPM_AUTO",e[e.RPM_GENERAL=2]="RPM_GENERAL",e[e.RPM_GENERAL_RGB_CONTRAST=4]="RPM_GENERAL_RGB_CONTRAST",e[e.RPM_GENERAL_GRAY_CONTRAST=8]="RPM_GENERAL_GRAY_CONTRAST",e[e.RPM_GENERAL_HSV_CONTRAST=16]="RPM_GENERAL_HSV_CONTRAST",e[e.RPM_SKIP=0]="RPM_SKIP",e[e.RPM_REV=2147483648]="RPM_REV"}(as||(as={})),function(e){e[e.RCT_PIXEL=1]="RCT_PIXEL",e[e.RCT_PERCENTAGE=2]="RCT_PERCENTAGE"}(cs||(cs={})),function(e){e[e.RT_STANDARD_TEXT=0]="RT_STANDARD_TEXT",e[e.RT_RAW_TEXT=1]="RT_RAW_TEXT",e[e.RT_CANDIDATE_TEXT=2]="RT_CANDIDATE_TEXT",e[e.RT_PARTIAL_TEXT=3]="RT_PARTIAL_TEXT"}(ls||(ls={})),function(e){e[e.SUM_AUTO=1]="SUM_AUTO",e[e.SUM_LINEAR_INTERPOLATION=2]="SUM_LINEAR_INTERPOLATION",e[e.SUM_NEAREST_NEIGHBOUR_INTERPOLATION=4]="SUM_NEAREST_NEIGHBOUR_INTERPOLATION",e[e.SUM_SKIP=0]="SUM_SKIP",e[e.SUM_REV=2147483648]="SUM_REV"}(hs||(hs={})),function(e){e[e.TP_REGION_PREDETECTED=1]="TP_REGION_PREDETECTED",e[e.TP_IMAGE_PREPROCESSED=2]="TP_IMAGE_PREPROCESSED",e[e.TP_IMAGE_BINARIZED=4]="TP_IMAGE_BINARIZED",e[e.TP_BARCODE_LOCALIZED=8]="TP_BARCODE_LOCALIZED",e[e.TP_BARCODE_TYPE_DETERMINED=16]="TP_BARCODE_TYPE_DETERMINED",e[e.TP_BARCODE_RECOGNIZED=32]="TP_BARCODE_RECOGNIZED"}(us||(us={})),function(e){e[e.TFM_AUTO=1]="TFM_AUTO",e[e.TFM_GENERAL_CONTOUR=2]="TFM_GENERAL_CONTOUR",e[e.TFM_SKIP=0]="TFM_SKIP",e[e.TFM_REV=2147483648]="TFM_REV"}(fs||(fs={})),function(e){e[e.TROM_CONFIDENCE=1]="TROM_CONFIDENCE",e[e.TROM_POSITION=2]="TROM_POSITION",e[e.TROM_FORMAT=4]="TROM_FORMAT",e[e.TROM_SKIP=0]="TROM_SKIP",e[e.TROM_REV=2147483648]="TROM_REV"}(ds||(ds={})),function(e){e[e.TDM_AUTO=1]="TDM_AUTO",e[e.TDM_GENERAL_WIDTH_CONCENTRATION=2]="TDM_GENERAL_WIDTH_CONCENTRATION",e[e.TDM_SKIP=0]="TDM_SKIP",e[e.TDM_REV=2147483648]="TDM_REV"}(ps||(ps={}));L.license="DLS2eyJvcmdhbml6YXRpb25JRCI6IjIwMDAwMSJ9";L.engineResourcePath="https://cdn.jsdelivr.net/npm/dynamsoft-javascript-barcode@9.6.32/dist/";function Gr(e,i,s,f,g,p,m,b){var T=typeof e=="function"?e.options:e;i&&(T.render=i,T.staticRenderFns=s,T._compiled=!0),f&&(T.functional=!0),p&&(T._scopeId="data-v-"+p);var A;if(m?(A=function(k){k=k||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext,!k&&typeof __VUE_SSR_CONTEXT__<"u"&&(k=__VUE_SSR_CONTEXT__),g&&g.call(this,k),k&&k._registeredComponents&&k._registeredComponents.add(m)},T._ssrRegister=A):g&&(A=b?function(){g.call(this,(T.functional?this.parent:this).$root.$options.shadowRoot)}:g),A)if(T.functional){T._injectStyles=A;var O=T.render;T.render=function(Z,ie){return A.call(ie),O(Z,ie)}}else{var B=T.beforeCreate;T.beforeCreate=B?[].concat(B,A):[A]}return{exports:e,options:T}}const Xl={name:"ImgDecode",data(){return{pReader:null,bars_array:[]}},methods:{push_barcode(e){this.bars_array.push({code:e,status:""})},async decodeImg(e){var i;try{let f=await(await(this.pReader=this.pReader||L.createInstance())).decode(e.target.files[0]);for(let g of f)this.push_barcode(g.barcodeText);f.length||alert("No barcode found")}catch(s){let f;(i=s.message)!=null&&i.includes("network connection error")?f="Failed to connect to Dynamsoft License Server: network connection error. Check your Internet connection or contact Dynamsoft Support (support@dynamsoft.com) to acquire an offline license.":f=s.message||s,console.error(f),alert(f)}e.target.value=""}},async beforeDestroy(){this.pReader&&((await this.pReader).destroyContext(),console.log("ImgDecode Component Unmount"))}};var Yl=function(){var i=this,s=i._self._c;return s("div",[s("div",{staticClass:"ImgDecode"},[s("input",{attrs:{type:"file"},on:{change:i.decodeImg}})]),s("table",{staticClass:"w3-table w3-striped"},i._l(i.bars_array,function(f,g){return s("tr",{key:g},[s("td",[i._v(" "+i._s(f.code)+" ")])])}),0)])},zl=[],$l=Gr(Xl,Yl,zl,!1,null,"1d3b3417",null,null);const Kl=$l.exports,ql=""+new URL("logo.da9b9095.svg",import.meta.url).href;const Zl={name:"HelloWorld",data(){return{bShowScanner:!0,bShowImgDecode:!1}},async mounted(){var e;try{await L.loadWasm()}catch(i){let s;(e=i.message)!=null&&e.includes("network connection error")?s="Failed to connect to Dynamsoft License Server: network connection error. Check your Internet connection or contact Dynamsoft Support (support@dynamsoft.com) to acquire an offline license.":s=i.message||i,console.error(s),alert(s)}},components:{ImgDecode:Kl},methods:{showScanner(){this.bShowScanner=!0,this.bShowImgDecode=!1},showImgDecode(){this.bShowScanner=!1,this.bShowImgDecode=!0}}};var Jl=function(){var i=this,s=i._self._c;return s("div",{staticClass:"helloWorld"},[i._m(0),s("div",[s("button",{style:{backgroundColor:i.bShowImgDecode?"rgb(255,174,55)":"white"},on:{click:i.showImgDecode}},[i._v("Image Decode")])]),s("div",{staticClass:"container"},[i.bShowImgDecode?s("ImgDecode"):i._e()],1)])},Ql=[function(){var e=this,i=e._self._c;return i("h1",[e._v("Hello World for Vue"),i("img",{staticClass:"applogo",attrs:{alt:"Vue logo",src:ql}})])}],eh=Gr(Zl,Jl,Ql,!1,null,"ee3d34fd",null,null);const th=eh.exports;const ih={name:"App",components:{HelloWorld:th}};var rh=function(){var i=this,s=i._self._c;return s("div",{attrs:{id:"app"}},[s("HelloWorld")],1)},nh=[],sh=Gr(ih,rh,nh,!1,null,null,null,null);const oh=sh.exports;new Se({render:e=>e(oh)}).$mount("#app");export{ah as __vite_legacy_guard};
